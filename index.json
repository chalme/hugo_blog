[{"content":"æ»‘åŠ¨çª—å£ ç››æœ€å¤šæ°´çš„å®¹å™¨ https://leetcode.cn/problems/container-with-most-water/ class Solution { public int maxArea(int[] height) { int l = 0, r = height.length - 1; int res = 0; while (l \u0026lt; r) { int area = Math.min(height[l], height[r]) * (r - l); res = Math.max(res, area); if (height[l] \u0026lt;= height[r]) { l++; } else { r--; } } return res; } } æ¥é›¨æ°´ dp æ¯ä¸€ä¸ªiçš„æœ€å¤šæ¥çš„é›¨æ°´ï¼Œ maxï¼ˆleftMax(i), rightMax(i)) -height(i) åŒæŒ‡é’ˆ class Solution { public int trap(int[] height) { int len = height.length; int[] left = new int[len]; int[] right = new int[len]; left[0] = height[0]; for (int i = 1; i \u0026lt; len; i++) { left[i] = Math.max(left[i - 1], height[i]); } right[len - 1] = height[len - 1]; for (int i = len - 2; i \u0026gt;= 0; i--) { right[i] = Math.max(right[i + 1], height[i]); } int res = 0; for (int i = 0; i \u0026lt; len; i++) { res += Math.min(left[i], right[i]) - height[i]; } return res; } } class Solution { public int trap(int[] height) { int len = height.length; int left = 0, right = len -1; int leftMax = 0, rightMax = 0; int res = 0; while (left \u0026lt;= right) { leftMax = Math.max(leftMax, height[left]); rightMax = Math.max(rightMax, height[right]); if (height[left] \u0026lt;= height[right]) { res += leftMax - height[left]; left ++; } else { res += rightMax - height[right]; right --; } } return res; } } æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² class Solution { public int lengthOfLongestSubstring(String s) { int len = s.length(); if (len \u0026lt;= 1) { return len; } HashSet\u0026lt;Character\u0026gt; set = new HashSet\u0026lt;\u0026gt;(); int l = 0, r = 1; int res = 0; set.add(s.charAt(l)); while (r \u0026lt; len) { while (r \u0026lt; len \u0026amp;\u0026amp; !set.contains(s.charAt(r))) { set.add(s.charAt(r)); r++; } res = Math.max(res, r - l); set.remove(s.charAt(l)); l++; } return res; } } DFS/BFS 200 å²›å±¿æ•°é‡ class Solution { public int numIslands(char[][] grid) { int res = 0; for (int i = 0; i \u0026lt; grid.length; i++) { for (int j = 0; j \u0026lt; grid[0].length; j++) { if (grid[i][j] == \u0026#39;1\u0026#39;) { dfs(grid, i, j); res++; } } } return res; } void dfs(char[][] grid, int i, int j) { if (i \u0026lt; 0 || i \u0026gt;= grid.length || j \u0026lt; 0 || j \u0026gt;= grid[0].length || grid[i][j] != \u0026#39;1\u0026#39;) { return; } grid[i][j] = \u0026#39;2\u0026#39;; dfs(grid, i + 1, j); dfs(grid, i - 1, j); dfs(grid, i, j + 1); dfs(grid, i, j - 1); } } ä¸åŒçš„äºŒå‰æœç´¢æ ‘ class Solution { Map\u0026lt;Integer, Integer\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); public int numTrees(int n) { if (n == 0 || n == 1) { return 1; } if (map.containsKey(n)) { return map.get(n); } int count = 0; for (int i = 1; i \u0026lt;= n; i++) { int leftNum = numTrees(i - 1); int rightNum = numTrees(n - i); count += leftNum * rightNum; } map.put(n, count); return count; } } åŠ¨æ€è§„åˆ’ 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II 123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III 213 æ‰“å®¶åŠ«èˆII // 121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº // dp class Solution { public int maxProfit(int[] prices) { int cost = Integer.MAX_VALUE, profit = 0; for (int price : prices) { cost = Math.min(cost, price); profit = Math.max(profit, price - cost); } return profit; } } // 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II class Solution { public int maxProfit(int[] prices) { int n = prices.length; int[][] dp = new int[n][2]; for (int i=0; i\u0026lt;n; i++) { if (i==0) { dp[i][0] = 0; dp[i][1] = -prices[i]; } else { dp[i][0] = Math.max(dp[i-1][0], dp[i-1][1]+prices[i]); dp[i][1] = Math.max(dp[i-1][1], dp[i-1][0]-prices[i]); } } return dp[n-1][0]; } } // 123 // https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iii/ class Solution { public int maxProfit(int[] prices) { int len = prices.length; // è¾¹ç•Œåˆ¤æ–­, é¢˜ç›®ä¸­ length \u0026gt;= 1, æ‰€ä»¥å¯çœå» if (prices.length == 0) return 0; /* * å®šä¹‰ 5 ç§çŠ¶æ€: * 0: æ²¡æœ‰æ“ä½œ, 1: ç¬¬ä¸€æ¬¡ä¹°å…¥, 2: ç¬¬ä¸€æ¬¡å–å‡º, 3: ç¬¬äºŒæ¬¡ä¹°å…¥, 4: ç¬¬äºŒæ¬¡å–å‡º */ int[][] dp = new int[len][5]; dp[0][1] = -prices[0]; // åˆå§‹åŒ–ç¬¬äºŒæ¬¡ä¹°å…¥çš„çŠ¶æ€æ˜¯ç¡®ä¿ æœ€åç»“æœæ˜¯æœ€å¤šä¸¤æ¬¡ä¹°å–çš„æœ€å¤§åˆ©æ¶¦ dp[0][3] = -prices[0]; for (int i = 1; i \u0026lt; len; i++) { dp[i][1] = Math.max(dp[i - 1][1], -prices[i]); dp[i][2] = Math.max(dp[i - 1][2], dp[i][1] + prices[i]); dp[i][3] = Math.max(dp[i - 1][3], dp[i][2] - prices[i]); dp[i][4] = Math.max(dp[i - 1][4], dp[i][3] + prices[i]); } return dp[len - 1][4]; } } // 213 class Solution { public int rob(int[] nums) { int len = nums.length; if (len == 1) { return nums[0]; } // dp1 å–0ï¼Œ ä¸å–len-1ï¼Œ dp2 å–n-1ï¼Œ ä¸å–0 int[] dp1 = new int[len]; int[] dp2 = new int[len]; dp1[0] = nums[0]; dp1[1] = Math.max(nums[0], nums[1]); dp2[1] = nums[1]; for (int i = 2; i \u0026lt; len; i++) { dp1[i] = Math.max(dp1[i - 1], dp1[i - 2] + nums[i]); dp2[i] = Math.max(dp2[i - 1], dp2[i - 2] + nums[i]); } return Math.max(dp1[len - 2], dp2[len - 1]); } } é€’å½’ï¼šLeetCode70ã€112ã€509 //70 çˆ¬æ¥¼åº• class Solution { public int climbStairs(int n) { if (n == 1) { return 1; } if (n == 2) { return 2; } int[] dp = new int[n]; dp[0] = 1; dp[1] = 2; for (int i=2; i\u0026lt;n; i++) { dp[i] = dp[i-1] + dp[i-2]; } return dp[n-1]; } } // 112. è·¯å¾„æ€»å’Œ class Solution { public boolean hasPathSum(TreeNode root, int targetSum) { if (root == null) { return false; } if (root.left == null \u0026amp;\u0026amp; root.right == null) { return targetSum == root.val; } return hasPathSum(root.left, targetSum - root.val) || hasPathSum(root.right, targetSum - root.val); } } // 509. æ–æ³¢é‚£å¥‘æ•° æ‰“è¡¨ã€é€’å½’ã€å¾ªåº class Solution { public int fib(int n) { if (n \u0026lt; 2) { return n; } int p = 0, q = 0, r = 1; for (int i = 2; i \u0026lt;= n; ++i) { p = q; q = r; r = p + q; } return r; } } åˆ†æ²»ï¼šLeetCode23ã€169ã€240 // 23. åˆå¹¶ K ä¸ªå‡åºé“¾è¡¨ class Solution { public ListNode mergeKLists(ListNode[] lists) { int len = lists.length; if (len == 0) { return null; } PriorityQueue\u0026lt;ListNode\u0026gt; queue = new PriorityQueue\u0026lt;\u0026gt;(len, (l1, l2) -\u0026gt; l1.val - l2.val); for (int i = 0; i \u0026lt; len; i++) { if (lists[i] != null) { queue.add(lists[i]); } } ListNode dummy = new ListNode(); ListNode tmp = dummy; while (!queue.isEmpty()) { ListNode node = queue.poll(); if (node.next != null) { queue.add(node.next); } tmp.next = node; tmp = node; } return dummy.next; } } //169. å¤šæ•°å…ƒç´  class Solution { /** * 1. hash O(n)/O(n) * 2. æ’åº O(nlgn)/O(nlogn) * 3. æŠ•ç¥¨ O(n)/O(n) * åˆ†æ²» */ public int majorityElement(int[] nums) { Integer candidate = null; int count = 0; for (int num : nums) { if (count == 0) { candidate = num; } count += (candidate == num) ? 1 : -1; } return candidate; } } // 240. æœç´¢äºŒç»´çŸ©é˜µ II class Solution { /** * z å‹æœç´¢ O(n+m) */ public boolean searchMatrix(int[][] matrix, int target) { int n = matrix.length, m = matrix[0].length; int x = 0, y = m - 1; while (x \u0026lt; n \u0026amp;\u0026amp; y \u0026gt;= 0) { if (matrix[x][y] == target) { return true; } else if (matrix[x][y] \u0026lt; target) { x++; } else { y--; } } return false; } } å•è°ƒæ ˆï¼šLeetCode84ã€85ã€739ã€503 // 84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ class Solution { public int largestRectangleArea(int[] heights) { int[] newHeights = Arrays.copyOf(heights, heights.length + 1); int maxArea = 0; Deque\u0026lt;Integer\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); for (int i = 0; i \u0026lt; newHeights.length; i++) { while (!stack.isEmpty() \u0026amp;\u0026amp; newHeights[stack.peek()] \u0026gt; newHeights[i]) { int height = newHeights[stack.pop()]; int width = stack.isEmpty() ? i : i - stack.peek() - 1; maxArea = Math.max(maxArea, height * width); } stack.push(i); } return maxArea; } } // 85. æœ€å¤§çŸ©å½¢ class Solution { /** * left[i][j] ä»£è¡¨ ç¬¬ i è¡Œç¬¬ j åˆ—å…ƒç´ çš„å·¦è¾¹è¿ç»­ 1 çš„æ•°é‡ï¼Œ æš´åŠ› */ public int maximalRectangle(char[][] matrix) { int n = matrix.length; if (n == 0) { return 0; } int m = matrix[0].length; int[][] left = new int[n][m]; for (int i = 0; i \u0026lt; n; i++) { for (int j = 0; j \u0026lt; m; j++) { if (matrix[i][j] == \u0026#39;1\u0026#39;) { left[i][j] = j == 0 ? 1 : left[i][j - 1] + 1; } } } int res = 0; for (int i = 0; i \u0026lt; n; i++) { for (int j = 0; j \u0026lt; m; j++) { if (matrix[i][j] == \u0026#39;0\u0026#39;) continue; int width = left[i][j]; res = Math.max(width, res); for (int k = i - 1; k \u0026gt;= 0; k--) { width = Math.min(left[k][j], width); res = Math.max(res, width * (i - k + 1)); } } } return res; } } // 739. æ¯æ—¥æ¸©åº¦ class Solution { /** * å•è°ƒé€’å‡æ ˆ */ public int[] dailyTemperatures(int[] temperatures) { int len = temperatures.length; int[] ans = new int[len]; Deque\u0026lt;Integer\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); for (int i = 0; i \u0026lt; len; i++) { while (!stack.isEmpty() \u0026amp;\u0026amp; temperatures[stack.peek()] \u0026lt; temperatures[i]) { int prevIndex = stack.pop(); ans[prevIndex] = i - prevIndex; } stack.push(i); } return ans; } } // 530. äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·® class Solution { int pre; int ans; public int getMinimumDifference(TreeNode root) { pre = -1; ans = Integer.MAX_VALUE; dfs(root); return ans; } void dfs(TreeNode root) { if (root == null) { return; } dfs(root.left); if (pre == -1) { pre = root.val; } else { ans = Math.min(ans, root.val - pre); pre = root.val; } dfs(root.right); } } å¹¶æŸ¥é›†ï¼šLeetCode547ã€200ã€684 // 547. çœä»½æ•°é‡ // dfs class Solution { public int findCircleNum(int[][] isConnected) { int cities = isConnected.length; boolean[] visited = new boolean[cities]; int res = 0; for (int i=0; i\u0026lt;cities; i++) { if (!visited[i]) { dfs(isConnected, visited, cities, i); res ++; } } return res; } void dfs(int[][] isConnected, boolean[] visited, int cities, int i) { for (int j=0; j\u0026lt;cities; j++) { if (isConnected[i][j] == 1 \u0026amp;\u0026amp; !visited[j]) { visited[j] = true; dfs(isConnected, visited, cities, j); } } } } // å¹¶æŸ¥é›† class Solution { public int findCircleNum(int[][] isConnected) { int cities = isConnected.length; int[] parent = new int[cities]; for (int i = 0; i \u0026lt; cities; i++) { parent[i] = i; } for (int i = 0; i \u0026lt; cities; i++) { for (int j = i + 1; j \u0026lt; cities; j++) { if (isConnected[i][j] == 1) { union(parent, i, j); } } } int provinces = 0; for (int i = 0; i \u0026lt; cities; i++) { if (parent[i] == i) { provinces++; } } return provinces; } public void union(int[] parent, int index1, int index2) { parent[find(parent, index1)] = find(parent, index2); } public int find(int[] parent, int index) { if (parent[index] != index) { parent[index] = find(parent, parent[index]); } return parent[index]; } } // 200. å²›å±¿æ•°é‡ dfs class Solution { public int numIslands(char[][] grid) { int res = 0; for (int i = 0; i \u0026lt; grid.length; i++) { for (int j = 0; j \u0026lt; grid[0].length; j++) { if (grid[i][j] == \u0026#39;1\u0026#39;) { dfs(grid, i, j); res++; } } } return res; } void dfs(char[][] grid, int i, int j) { if (i \u0026lt; 0 || i \u0026gt;= grid.length || j \u0026lt; 0 || j \u0026gt;= grid[0].length || grid[i][j] != \u0026#39;1\u0026#39;) { return; } grid[i][j] = \u0026#39;2\u0026#39;; dfs(grid, i + 1, j); dfs(grid, i - 1, j); dfs(grid, i, j + 1); dfs(grid, i, j - 1); } } // 684. å†—ä½™è¿æ¥ class Solution { public int[] findRedundantConnection(int[][] edges) { int n = edges.length; int[] parent = new int[n + 1]; for (int i=1; i\u0026lt;n+1; i++) { parent[i] = i; } for (int i=0; i\u0026lt;n; i++) { int[] edge = edges[i]; int node1 = edge[0], node2 = edge[1]; if (find(parent, node1) != find(parent, node2)) { union(parent, node1, node2); } else { return edge; } } return new int[0]; } public void union(int[] parent, int index1, int index2) { parent[find(parent, index1)] = find(parent, index2); } public int find(int[] parent, int index) { if (parent[index] != index) { parent[index] = find(parent, parent[index]); } return parent[index]; } } æ»‘åŠ¨çª—å£ï¼šLeetCode209ã€3ã€1004ã€1208 // 209. é•¿åº¦æœ€å°çš„å­æ•°ç»„ class Solution { public int minSubArrayLen(int target, int[] nums) { int n = nums.length; int left = 0, right = 0; int res = Integer.MAX_VALUE; int sum = 0; while (right \u0026lt; n) { sum += nums[right]; while (sum \u0026gt;= target) { if (right - left + 1 \u0026lt; res) { res = right - left + 1; } sum -= nums[left]; left++; } right++; } return res == Integer.MAX_VALUE ? 0 : res; } } // 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² class Solution { public int lengthOfLongestSubstring(String s) { int len = s.length(); if (len \u0026lt;= 1) { return len; } HashSet\u0026lt;Character\u0026gt; set = new HashSet\u0026lt;\u0026gt;(); int l = 0, r = 1; int res = 0; set.add(s.charAt(l)); while (r \u0026lt; len) { while (r \u0026lt; len \u0026amp;\u0026amp; !set.contains(s.charAt(r))) { set.add(s.charAt(r)); r++; } res = Math.max(res, r - l); set.remove(s.charAt(l)); l++; } return res; } } // 1004. æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III class Solution { public int longestOnes(int[] nums, int k) { int len = nums.length; int l = 0, r = 0; int res = 0; int zeroCount = 0; while (r \u0026lt; len) { if (nums[r] == 0) { zeroCount++; } while (zeroCount \u0026gt; k) { if (nums[l] == 0) { zeroCount--; } l++; } res = Math.max(res, r - l + 1); r++; } return res; } } // 1208. å°½å¯èƒ½ä½¿å­—ç¬¦ä¸²ç›¸ç­‰ class Solution { public int equalSubstring(String s, String t, int maxCost) { int n = s.length(); int[] diff = new int[n]; for (int i = 0; i \u0026lt; n; i++) { diff[i] = Math.abs(s.charAt(i) - t.charAt(i)); } int maxLength = 0; int start = 0, end = 0; int sum = 0; while (end \u0026lt; n) { sum += diff[end]; while (sum \u0026gt; maxCost) { sum -= diff[start]; start++; } maxLength = Math.max(maxLength, end - start + 1); end++; } return maxLength; } } å‰ç¼€å’Œï¼šLeetCode724ã€560ã€437ã€1248 // 724. å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡ class Solution { public int pivotIndex(int[] nums) { int sumLeft = 0, sumRight = Arrays.stream(nums).sum(); for (int i=0; i\u0026lt;nums.length; i++) { sumRight -= nums[i]; if (sumLeft == sumRight) { return i; } sumLeft += nums[i]; } return -1; } } // 560. å’Œä¸º K çš„å­æ•°ç»„ // å‰ç¼€å’Œ+æš´åŠ› class Solution { public int subarraySum(int[] nums, int k) { int n = nums.length; // å‰ç¼€å’Œå±çŒª int[] pre = new int[n + 1]; pre[0] = 0; for (int i = 0; i \u0026lt; n; i++) { pre[i + 1] = pre[i] + nums[i]; } int count = 0; for (int i = 0; i \u0026lt; n; i++) { for (int j = i; j \u0026lt; n; j++) { if (pre[j + 1] - pre[i] == k) { count++; } } } return count; } } // å‰ç¼€å’Œ + hash class Solution { public int subarraySum(int[] nums, int k) { // keyï¼šå‰ç¼€å’Œï¼Œvalueï¼škey å¯¹åº”çš„å‰ç¼€å’Œçš„ä¸ªæ•° Map\u0026lt;Integer, Integer\u0026gt; preSumFreq = new HashMap\u0026lt;\u0026gt;(); preSumFreq.put(0, 1); int preSum = 0; int count = 0; // preSum - (preSum - k) == k for (int num : nums) { preSum += num; if (preSumFreq.containsKey(preSum - k)) { count += preSumFreq.get(preSum - k); } // ç„¶åç»´æŠ¤ preSumFreq çš„å®šä¹‰ preSumFreq.put(preSum, preSumFreq.getOrDefault(preSum, 0) + 1); } return count; } } // 437. è·¯å¾„æ€»å’Œ III // äºŒå‰æ ‘å‰ç¼€å’Œ class Solution { Map\u0026lt;Long, Integer\u0026gt; prefixMap; public int pathSum(TreeNode root, int targetSum) { prefixMap = new HashMap\u0026lt;\u0026gt;(); prefixMap.put(0L, 1); return dfs(root, 0, targetSum); } public int dfs(TreeNode node, long sum, int target) { if (node == null) { return 0; } int res = 0; sum += node.val; res += prefixMap.getOrDefault(sum - target, 0); prefixMap.put(sum, prefixMap.getOrDefault(sum, 0) + 1); int left = dfs(node.left, sum, target); int right = dfs(node.right, sum, target); res = res + left + right; prefixMap.put(sum, prefixMap.get(sum) - 1); return res; } } // 1248. ç»Ÿè®¡ã€Œä¼˜ç¾å­æ•°ç»„ã€ class Solution { public int numberOfSubarrays(int[] nums, int k) { Map\u0026lt;Integer, Integer\u0026gt; preMap = new HashMap\u0026lt;\u0026gt;(); preMap.put(0, 1); // sum - (sum - k) = k int sum = 0; int cnt = 0; for (int num : nums) { sum += num\u0026amp;1; cnt += preMap.getOrDefault(sum - k, 0); preMap.put(sum, preMap.getOrDefault(sum, 0) + 1); } return cnt; } } å·®åˆ†ï¼šLeetCode1094 // 1094. æ‹¼è½¦ class Solution { public boolean carPooling(int[][] trips, int capacity) { int[] nums = new int[1010]; for (int[] t: trips) { int c = t[0], a = t[1], b = t[2]; nums[a+1] += c; nums[b+1] -= c; } for (int i=1; i\u0026lt;= 1000; i++) { nums[i] += nums[i-1]; if (nums[i] \u0026gt; capacity) return false; } return true; } } æ‹“æ‰‘æ’åºï¼šLeetCode210 // 210. è¯¾ç¨‹è¡¨ II // BFS https://leetcode.cn/problems/course-schedule-ii/solutions/221559/java-jian-dan-hao-li-jie-de-tuo-bu-pai-xu-by-kelly/ public int[] findOrder(int numCourses, int[][] prerequisites) { if (numCourses == 0) return new int[0]; int[] inDegrees = new int[numCourses]; // å»ºç«‹å…¥åº¦è¡¨ for (int[] p : prerequisites) { // å¯¹äºæœ‰å…ˆä¿®è¯¾çš„è¯¾ç¨‹ï¼Œè®¡ç®—æœ‰å‡ é—¨å…ˆä¿®è¯¾ inDegrees[p[0]]++; } // å…¥åº¦ä¸º0çš„èŠ‚ç‚¹é˜Ÿåˆ— Queue\u0026lt;Integer\u0026gt; queue = new LinkedList\u0026lt;\u0026gt;(); for (int i = 0; i \u0026lt; inDegrees.length; i++) { if (inDegrees[i] == 0) queue.offer(i); } int count = 0; // è®°å½•å¯ä»¥å­¦å®Œçš„è¯¾ç¨‹æ•°é‡ int[] res = new int[numCourses]; // å¯ä»¥å­¦å®Œçš„è¯¾ç¨‹ // æ ¹æ®æä¾›çš„å…ˆä¿®è¯¾åˆ—è¡¨ï¼Œåˆ é™¤å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹ while (!queue.isEmpty()){ int curr = queue.poll(); res[count++] = curr; // å°†å¯ä»¥å­¦å®Œçš„è¯¾ç¨‹åŠ å…¥ç»“æœå½“ä¸­ for (int[] p : prerequisites) { if (p[1] == curr){ inDegrees[p[0]]--; if (inDegrees[p[0]] == 0) queue.offer(p[0]); } } } if (count == numCourses) return res; return new int[0]; } å­—ç¬¦ä¸²ï¼šLeetCode5ã€20ã€43ã€93 // 5. æœ€é•¿å›æ–‡å­ä¸² // ä¸­å¿ƒæ‰©å±• class Solution { public String longestPalindrome(String s) { if (s.length() \u0026lt;= 1) { return s; } int left = 0, right = 0; for (int i = 0; i \u0026lt; s.length(); i++) { int len1 = expandAroundCenter(s, i, i); int len2 = expandAroundCenter(s, i, i + 1); int len = Math.max(len1, len2); if (right - left \u0026lt; len) { left = i - (len - 1) / 2; right = i + len / 2; } } return s.substring(left, right + 1); } public int expandAroundCenter(String s, int left, int right) { while (left \u0026gt;= 0 \u0026amp;\u0026amp; right \u0026lt; s.length() \u0026amp;\u0026amp; s.charAt(left) == s.charAt(right)) { left--; right++; } return right - left - 1; } } // dp class Solution { public String longestPalindrome(String s) { if (s == null || s.length() == 1) { return s; } int len = s.length(); int maxLeft = 0; int maxRight = 0; int maxLen = 0; boolean dp[][] = new boolean[len][len]; for (int r = 1; r\u0026lt;len; r++) { for (int l=0; l\u0026lt;r; l++) { if (s.charAt(l) == s.charAt(r) \u0026amp;\u0026amp; (r-l \u0026lt;=2 || dp[l+1][r-1])) { dp[l][r] = true; if (r - l + 1 \u0026gt; maxLen) { maxLen = r - l + 1; maxLeft = l; maxRight = r; } } } } return s.substring(maxLeft, maxRight + 1); } } // 20 æ ˆå¤„ç† class Solution { public boolean isValid(String s) { Map\u0026lt;Character, Character\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#39;)\u0026#39;, \u0026#39;(\u0026#39;); map.put(\u0026#39;}\u0026#39;, \u0026#39;{\u0026#39;); map.put(\u0026#39;]\u0026#39;, \u0026#39;[\u0026#39;); Deque\u0026lt;Character\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); for (int i = 0; i \u0026lt; s.length(); i++) { char c = s.charAt(i); if (!stack.isEmpty() \u0026amp;\u0026amp; stack.peek() == map.get(c)) { stack.pop(); } else { stack.push(c); } } return stack.isEmpty(); } } // 43. å­—ç¬¦ä¸²ç›¸ä¹˜ class Solution { /** * è®¡ç®—å½¢å¼ * num1 * x num2 * ------ * result */ public String multiply(String num1, String num2) { if (num1.equals(\u0026#34;0\u0026#34;) || num2.equals(\u0026#34;0\u0026#34;)) { return \u0026#34;0\u0026#34;; } // ä¿å­˜è®¡ç®—ç»“æœ String res = \u0026#34;0\u0026#34;; // num2 é€ä½ä¸ num1 ç›¸ä¹˜ for (int i = num2.length() - 1; i \u0026gt;= 0; i--) { int carry = 0; // ä¿å­˜ num2 ç¬¬iä½æ•°å­—ä¸ num1 ç›¸ä¹˜çš„ç»“æœ StringBuilder temp = new StringBuilder(); // è¡¥ 0 for (int j = 0; j \u0026lt; num2.length() - 1 - i; j++) { temp.append(0); } int n2 = num2.charAt(i) - \u0026#39;0\u0026#39;; // num2 çš„ç¬¬ i ä½æ•°å­— n2 ä¸ num1 ç›¸ä¹˜ for (int j = num1.length() - 1; j \u0026gt;= 0 || carry != 0; j--) { int n1 = j \u0026lt; 0 ? 0 : num1.charAt(j) - \u0026#39;0\u0026#39;; int product = (n1 * n2 + carry) % 10; temp.append(product); carry = (n1 * n2 + carry) / 10; } // å°†å½“å‰ç»“æœä¸æ–°è®¡ç®—çš„ç»“æœæ±‚å’Œä½œä¸ºæ–°çš„ç»“æœ res = addStrings(res, temp.reverse().toString()); } return res; } /** * å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²æ•°å­—è¿›è¡Œç›¸åŠ ï¼Œè¿”å›å­—ç¬¦ä¸²å½¢å¼çš„å’Œ */ public String addStrings(String num1, String num2) { StringBuilder builder = new StringBuilder(); int carry = 0; for (int i = num1.length() - 1, j = num2.length() - 1; i \u0026gt;= 0 || j \u0026gt;= 0 || carry != 0; i--, j--) { int x = i \u0026lt; 0 ? 0 : num1.charAt(i) - \u0026#39;0\u0026#39;; int y = j \u0026lt; 0 ? 0 : num2.charAt(j) - \u0026#39;0\u0026#39;; int sum = (x + y + carry) % 10; builder.append(sum); carry = (x + y + carry) / 10; } return builder.reverse().toString(); } } // 93. å¤åŸ IP åœ°å€ class Solution { public List\u0026lt;String\u0026gt; restoreIpAddresses(String s) { int len = s.length(); List\u0026lt;String\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); if (len \u0026lt; 4 || len \u0026gt; 12) { return res; } Deque\u0026lt;String\u0026gt; tmp = new LinkedList\u0026lt;\u0026gt;(); dfs(s, len, 0, 4, tmp, res); return res; } private void dfs(String s, int len, int start, int left, Deque\u0026lt;String\u0026gt; path, List\u0026lt;String\u0026gt; res) { if (start == len) { if (left == 0) { res.add(String.join(\u0026#34;.\u0026#34;, path)); } return; } for (int i=start; i\u0026lt;start + 3; i++) { if (i \u0026gt;= len) { break; } if (left * 3 \u0026lt; len - i) { continue; } String sub = s.substring(start, i+1); if (judge(sub)) { path.addLast(sub); dfs(s, len, i + 1, left - 1, path, res); path.removeLast(); } } } private boolean judge(String s) { int len = s.length(); if (len \u0026gt; 1 \u0026amp;\u0026amp; s.charAt(0) == \u0026#39;0\u0026#39;) { return false; } int t = Integer.valueOf(s); return t \u0026gt;= 0 \u0026amp;\u0026amp; t \u0026lt;= 255; } } äºŒåˆ†æŸ¥æ‰¾ï¼šLeetCode33ã€34 // 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ class Solution { public int search(int[] nums, int target) { int len = nums.length; if (len == 0) { return -1; } int i = 0, j = len -1; while (i \u0026lt;= j) { int mid = (i + j) / 2; if (nums[mid] == target) { return mid; } if (nums[0] \u0026lt;= nums[mid]) { if (nums[0] \u0026lt;= target \u0026amp;\u0026amp; target \u0026lt; nums[mid]) { j = mid - 1; } else { i = mid + 1; } } else { if (nums[mid] \u0026lt; target \u0026amp;\u0026amp; target \u0026lt;= nums[len - 1]) { i = mid + 1; } else { j = mid - 1; } } } return -1; } } // 34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½® class Solution { public int[] searchRange(int[] nums, int target) { int leftIdx = binarySearch(nums, target, true); int rightIdx = binarySearch(nums, target, false) - 1; if (leftIdx \u0026lt;= rightIdx \u0026amp;\u0026amp; rightIdx \u0026lt; nums.length \u0026amp;\u0026amp; nums[leftIdx] == target \u0026amp;\u0026amp; nums[rightIdx] == target) { return new int[]{leftIdx, rightIdx}; } return new int[]{-1, -1}; } public int binarySearch(int[] nums, int target, boolean lower) { int left = 0, right = nums.length - 1, ans = nums.length; while (left \u0026lt;= right) { int mid = (left + right) / 2; if (nums[mid] \u0026gt; target || (lower \u0026amp;\u0026amp; nums[mid] \u0026gt;= target)) { right = mid - 1; ans = mid; } else { left = mid + 1; } } return ans; } } BFSï¼šLeetCode127ã€139ã€130ã€529ã€815 // 127. å•è¯æ¥é¾™ // 139. å•è¯æ‹†åˆ† class Solution { public boolean wordBreak(String s, List\u0026lt;String\u0026gt; wordDict) { Set\u0026lt;String\u0026gt; dict = new HashSet\u0026lt;\u0026gt;(wordDict); // dp[i]è¡¨ç¤ºå‰iä¸ªå­—æ¯æ˜¯å¦èƒ½è¢«åˆ†å‰² boolean[] dp = new boolean[s.length() + 1]; dp[0] = true; for (int i = 1; i \u0026lt;= s.length(); i++) { for (int j = 0; j \u0026lt; i; j++) { if (dp[j] \u0026amp;\u0026amp; dict.contains(s.substring(j, i))) { dp[i] = true; break; } } } return dp[s.length()]; } } // 130. è¢«å›´ç»•çš„åŒºåŸŸ // é‡ç‚¹æ˜¯æ€è·¯ï¼š ä»è¾¹ç¼˜dfså¤„ç† class Solution { int n, m; public void solve(char[][] board) { n = board.length; if (n == 0) { return; } m = board[0].length; for (int i = 0; i \u0026lt; n; i++) { dfs(board, i, 0); dfs(board, i, m - 1); } for (int i = 1; i \u0026lt; m - 1; i++) { dfs(board, 0, i); dfs(board, n - 1, i); } for (int i = 0; i \u0026lt; n; i++) { for (int j = 0; j \u0026lt; m; j++) { if (board[i][j] == \u0026#39;A\u0026#39;) { board[i][j] = \u0026#39;O\u0026#39;; } else if (board[i][j] == \u0026#39;O\u0026#39;) { board[i][j] = \u0026#39;X\u0026#39;; } } } } public void dfs(char[][] board, int x, int y) { if (x \u0026lt; 0 || x \u0026gt;= n || y \u0026lt; 0 || y \u0026gt;= m || board[x][y] != \u0026#39;O\u0026#39;) { return; } board[x][y] = \u0026#39;A\u0026#39;; dfs(board, x + 1, y); dfs(board, x - 1, y); dfs(board, x, y + 1); dfs(board, x, y - 1); } } // 529. æ‰«é›·æ¸¸æˆ // dfs æ¨¡æ‹Ÿ // 815. å…¬äº¤è·¯çº¿ï¼ˆå›°éš¾ï¼‰ //ä¼˜åŒ–å»ºå›¾ + å¹¿åº¦ä¼˜å…ˆæœç´¢ DFS\u0026amp;å›æº¯ï¼šï¼šLeetCode934ã€1102ã€531ã€533ã€113ã€332ã€337 // 934. æœ€çŸ­çš„æ¡¥ // https://leetcode.cn/problems/shortest-bridge/solutions/1922327/-by-muse-77-j7w5/ class Solution { Queue\u0026lt;int[]\u0026gt; queue; int[][] direct = { { 0, 1 }, { 0, -1 }, { -1, 0 }, { 1, 0 } }; public int shortestBridge(int[][] grid) { this.queue = new LinkedList\u0026lt;\u0026gt;(); boolean find = false; for (int i = 0; i \u0026lt; grid.length; i++) { for (int j = 0; j \u0026lt; grid[0].length; j++) { if (grid[i][j] == 1) { find = true; dfs(grid, i, j); break; } } if (find) { break; } } int result = 0; while (!this.queue.isEmpty()) { result++; int size = this.queue.size(); for (int i = 0; i \u0026lt; size; i++) { int[] edge = this.queue.poll(); for (int[] d : direct) { int nex = edge[0] + d[0], ney = edge[1] + d[1]; if (judge(nex, ney, grid) \u0026amp;\u0026amp; grid[nex][ney] == 0) { this.queue.offer(new int[] { nex, ney }); grid[nex][ney] = 2; } else if (judge(nex, ney, grid) \u0026amp;\u0026amp; grid[nex][ney] == 1) { return result; } } } } return result; } public void dfs(int[][] grid, int x, int y) { if (!judge(x, y, grid) || grid[x][y] == 2) return; if (grid[x][y] == 0) { grid[x][y] = 2; this.queue.offer(new int[] { x, y }); return; } grid[x][y] = 2; dfs(grid, x + 1, y); dfs(grid, x - 1, y); dfs(grid, x, y + 1); dfs(grid, x, y - 1); } public boolean judge(int x, int y, int[][] grid) { return x \u0026gt;= 0 \u0026amp;\u0026amp; x \u0026lt; grid.length \u0026amp;\u0026amp; y \u0026gt;= 0 \u0026amp;\u0026amp; y \u0026lt; grid[0].length; } } // 113. è·¯å¾„æ€»å’Œ II class Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; pathSum(TreeNode root, int targetSum) { List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); dfs(root, targetSum, new ArrayList\u0026lt;Integer\u0026gt;(), 0, res); return res; } public void dfs(TreeNode root, int targetSum, List\u0026lt;Integer\u0026gt; temp, int index, List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; res) { if (root == null) { return ; } temp.add(root.val); targetSum = targetSum - root.val; if (targetSum == 0 \u0026amp;\u0026amp; root.left == null \u0026amp;\u0026amp; root.right == null) { res.add(new ArrayList\u0026lt;\u0026gt;(temp)); temp.remove(index); return; } dfs(root.left, targetSum, temp, index + 1, res); dfs(root.right, targetSum, temp, index + 1, res); temp.remove(index); } } // 332. é‡æ–°å®‰æ’è¡Œç¨‹ï¼ˆhardï¼‰ // 337. æ‰“å®¶åŠ«èˆ III class Solution { public int rob(TreeNode root) { int[] res = dfs(root); return Math.max(res[0], res[1]); // æ ¹èŠ‚ç‚¹é€‰æˆ–ä¸é€‰çš„æœ€å¤§å€¼ } private int[] dfs(TreeNode node) { if (node == null) { // é€’å½’è¾¹ç•Œ return new int[]{0, 0}; // æ²¡æœ‰èŠ‚ç‚¹ï¼Œæ€ä¹ˆé€‰éƒ½æ˜¯ 0 } int[] left = dfs(node.left); // é€’å½’å·¦å­æ ‘ int[] right = dfs(node.right); // é€’å½’å³å­æ ‘ int rob = left[1] + right[1] + node.val; // é€‰ int notRob = Math.max(left[0], left[1]) + Math.max(right[0], right[1]); // ä¸é€‰ return new int[]{rob, notRob}; } } ä½œè€…ï¼šçµèŒ¶å±±è‰¾åºœ é“¾æ¥ï¼šhttps://leetcode.cn/problems/house-robber-iii/solutions/2282018/shi-pin-ru-he-si-kao-shu-xing-dppythonja-a7t1/ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ åŠ¨æ€è§„åˆ’ï¼šLeetCode213ã€123ã€62ã€63ã€361ã€1230 // 213. æ‰“å®¶åŠ«èˆ II class Solution { public int rob(int[] nums) { int len = nums.length; if (len == 1) { return nums[0]; } // dp1 å–0ï¼Œ ä¸å–len-1ï¼Œ dp2 å–n-1ï¼Œ ä¸å–0 int[] dp1 = new int[len]; int[] dp2 = new int[len]; dp1[0] = nums[0]; dp1[1] = Math.max(nums[0], nums[1]); dp2[1] = nums[1]; for (int i = 2; i \u0026lt; len; i++) { dp1[i] = Math.max(dp1[i - 1], dp1[i - 2] + nums[i]); dp2[i] = Math.max(dp2[i - 1], dp2[i - 2] + nums[i]); } return Math.max(dp1[len - 2], dp2[len - 1]); } } // 123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III class Solution { public int maxProfit(int[] prices) { int len = prices.length; // è¾¹ç•Œåˆ¤æ–­, é¢˜ç›®ä¸­ length \u0026gt;= 1, æ‰€ä»¥å¯çœå» if (prices.length == 0) return 0; /* * å®šä¹‰ 5 ç§çŠ¶æ€: * 0: æ²¡æœ‰æ“ä½œ, 1: ç¬¬ä¸€æ¬¡ä¹°å…¥, 2: ç¬¬ä¸€æ¬¡å–å‡º, 3: ç¬¬äºŒæ¬¡ä¹°å…¥, 4: ç¬¬äºŒæ¬¡å–å‡º */ int[][] dp = new int[len][5]; dp[0][1] = -prices[0]; // åˆå§‹åŒ–ç¬¬äºŒæ¬¡ä¹°å…¥çš„çŠ¶æ€æ˜¯ç¡®ä¿ æœ€åç»“æœæ˜¯æœ€å¤šä¸¤æ¬¡ä¹°å–çš„æœ€å¤§åˆ©æ¶¦ dp[0][3] = -prices[0]; for (int i = 1; i \u0026lt; len; i++) { dp[i][1] = Math.max(dp[i - 1][1], -prices[i]); dp[i][2] = Math.max(dp[i - 1][2], dp[i][1] + prices[i]); dp[i][3] = Math.max(dp[i - 1][3], dp[i][2] - prices[i]); dp[i][4] = Math.max(dp[i - 1][4], dp[i][3] + prices[i]); } return dp[len - 1][4]; } } // 62. ä¸åŒè·¯å¾„ class Solution { public int uniquePaths(int m, int n) { int[][] f = new int[m][n]; for (int i = 0; i \u0026lt; m; ++i) { f[i][0] = 1; } for (int j = 0; j \u0026lt; n; ++j) { f[0][j] = 1; } for (int i = 1; i \u0026lt; m; ++i) { for (int j = 1; j \u0026lt; n; ++j) { f[i][j] = f[i - 1][j] + f[i][j - 1]; } } return f[m - 1][n - 1]; } } // 63. ä¸åŒè·¯å¾„ II class Solution { public int uniquePathsWithObstacles(int[][] obstacleGrid) { // è·å–ç½‘æ ¼çš„è¡Œæ•°å’Œåˆ—æ•° int m = obstacleGrid.length; int n = obstacleGrid[0].length; // å¦‚æœèµ·ç‚¹æˆ–ç»ˆç‚¹æ˜¯éšœç¢ç‰©ï¼Œåˆ™è·¯å¾„æ•°é‡ä¸º0ï¼Œç›´æ¥è¿”å› if (obstacleGrid[0][0] == 1 || obstacleGrid[m - 1][n - 1] == 1) { return 0; } int[][] f = new int[m][n]; f[0][0] = 1; for (int i = 1; i \u0026lt; m; ++i) { if (obstacleGrid[i][0] == 0 \u0026amp;\u0026amp; f[i-1][0] == 1 ) { f[i][0] = 1; } else { f[i][0] = 0; } } for (int j = 1; j \u0026lt; n; ++j) { f[0][j] = 1; if (obstacleGrid[0][j] == 0 \u0026amp;\u0026amp; f[0][j-1] == 1) { f[0][j] = 1; } else { f[0][j] = 0; } } for (int i = 1; i \u0026lt; m; i++) { for (int j = 1; j \u0026lt; n; j++) { if (obstacleGrid[i][j] == 0) { f[i][j] = f[i - 1][j] + f[i][j - 1]; } else { f[i][j] = 0; } } } // è¿”å›ç»ˆç‚¹çš„è·¯å¾„æ•°é‡ return f[m - 1][n - 1]; } } è´ªå¿ƒç®—æ³•ï¼šLeetCode55ã€435ã€621ã€452 // 55. è·³è·ƒæ¸¸æˆ public class Solution { public boolean canJump(int[] nums) { int n = nums.length; int rightmost = 0; for (int i = 0; i \u0026lt; n; ++i) { if (i \u0026lt;= rightmost) { rightmost = Math.max(rightmost, i + nums[i]); if (rightmost \u0026gt;= n - 1) { return true; } } } return false; } } // 435. æ— é‡å åŒºé—´ // https://leetcode.cn/problems/non-overlapping-intervals/solutions/1263171/tan-xin-jie-fa-qi-shi-jiu-shi-yi-ceng-ch-i63h/ class Solution { public int eraseOverlapIntervals(int[][] intervals) { if (intervals.length == 0) { return 0; } Arrays.sort(intervals, new Comparator\u0026lt;int[]\u0026gt;() { public int compare(int[] interval1, int[] interval2) { return interval1[1] - interval2[1]; } }); int n = intervals.length; int right = intervals[0][1]; int ans = 1; for (int i = 1; i \u0026lt; n; ++i) { if (intervals[i][0] \u0026gt;= right) { ++ans; right = intervals[i][1]; } } return n - ans; } } // 621. ä»»åŠ¡è°ƒåº¦å™¨ // https://leetcode.cn/problems/task-scheduler/solutions/509866/jian-ming-yi-dong-de-javajie-da-by-lan-s-jfl9/ // 452. ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ // https://leetcode.cn/problems/minimum-number-of-arrows-to-burst-balloons/solutions/2539356/java-tan-xin-tu-jie-yi-dong-by-cao-yang-yjv4c/ class Solution { public int findMinArrowShots(int[][] points) { // è´ªå¿ƒ int n = points.length; if(n == 0) return 0; Arrays.sort(points, (a, b) -\u0026gt; Long.compare(a[1], b[1])); int result = 1; // ç¬¬ä¸€æ”¯ç®­ç›´æ¥å°„å‡º int arrow = points[0][1]; for(int i = 1; i \u0026lt; n; i++){ if(points[i][0] \u0026lt;= arrow){ // è¯¥åŒºé—´èƒ½è¢«å½“å‰ç®­rightç©¿è¿‡ continue; } arrow = points[i][1]; // ç»§ç»­å°„å‡ºç®­ result++; // ç®­æ•°åŠ 1 } return result; } } å­—å…¸æ ‘ï¼šLeetCode820ã€208ã€648 // 820. å•è¯çš„å‹ç¼©ç¼–ç  // https://leetcode.cn/problems/short-encoding-of-words/solutions/174404/99-java-trie-tu-xie-gong-lue-bao-jiao-bao-hui-by-s/ class Solution { public int minimumLengthEncoding(String[] words) { int len = 0; Trie trie = new Trie(); // å…ˆå¯¹å•è¯åˆ—è¡¨æ ¹æ®å•è¯é•¿åº¦ç”±é•¿åˆ°çŸ­æ’åº Arrays.sort(words, (s1, s2) -\u0026gt; s2.length() - s1.length()); // å•è¯æ’å…¥trieï¼Œè¿”å›è¯¥å•è¯å¢åŠ çš„ç¼–ç é•¿åº¦ for (String word: words) { len += trie.insert(word); } return len; } } // å®šä¹‰tire class Trie { TrieNode root; public Trie() { root = new TrieNode(); } public int insert(String word) { TrieNode cur = root; boolean isNew = false; // å€’ç€æ’å…¥å•è¯ for (int i = word.length() - 1; i \u0026gt;= 0; i--) { int c = word.charAt(i) - \u0026#39;a\u0026#39;; if (cur.children[c] == null) { isNew = true; // æ˜¯æ–°å•è¯ cur.children[c] = new TrieNode(); } cur = cur.children[c]; } // å¦‚æœæ˜¯æ–°å•è¯çš„è¯ç¼–ç é•¿åº¦å¢åŠ æ–°å•è¯çš„é•¿åº¦+1ï¼Œå¦åˆ™ä¸å˜ã€‚ return isNew? word.length() + 1: 0; } } class TrieNode { char val; TrieNode[] children = new TrieNode[26]; public TrieNode() {} } // 208. å®ç° Trie (å‰ç¼€æ ‘) class Trie { private Node root; public Trie() { this.root = new Node(); } public void insert(String word) { Node cur = root; for (int i = 0; i \u0026lt; word.length(); i++) { int c = word.charAt(i) - \u0026#39;a\u0026#39;; if (cur.children[c] == null) { cur.children[c] = new Node(); } cur = cur.children[c]; } cur.isEnd = true; } public boolean search(String word) { Node node = searchPrefix(word); return node != null \u0026amp;\u0026amp; node.isEnd == true; } public boolean startsWith(String prefix) { Node node = searchPrefix(prefix); return node != null; } private Node searchPrefix(String word) { Node cur = root; for (int i = 0; i \u0026lt; word.length(); i++) { int index = word.charAt(i) - \u0026#39;a\u0026#39;; if (cur.children[index] == null) { return null; } cur = cur.children[index]; } return cur; } } class Node { Node[] children; boolean isEnd; public Node() { children = new Node[26]; isEnd = false; } } /** * Your Trie object will be instantiated and called as such: * Trie obj = new Trie(); * obj.insert(word); * boolean param_2 = obj.search(word); * boolean param_3 = obj.startsWith(prefix); */ // 648. å•è¯æ›¿æ¢ class Solution { public String replaceWords(List\u0026lt;String\u0026gt; dictionary, String sentence) { Trie trie = new Trie(); for (String word: dictionary) { trie.insert(word); } String[] words = sentence.split(\u0026#34; \u0026#34;); StringBuilder result = new StringBuilder(); for (String w: words) { result.append(trie.search(w)).append(\u0026#34; \u0026#34;); } return result.substring(0, result.length() - 1); } } class Trie { private Node root; public Trie() { this.root = new Node(); } public void insert(String word) { Node cur = root; for (int i = 0; i \u0026lt; word.length(); i++) { int c = word.charAt(i) - \u0026#39;a\u0026#39;; if (cur.children[c] == null) { cur.children[c] = new Node(); } cur = cur.children[c]; } cur.isEnd = true; } public String search(String word) { Node cur = root; for (int i = 0; i \u0026lt; word.length(); i++) { int index = word.charAt(i) - \u0026#39;a\u0026#39;; if (cur.children[index] == null) { break; } if (cur.children[index].isEnd) { return word.substring(0, i + 1); } cur = cur.children[index]; } return word; } } class Node { Node[] children; boolean isEnd; public Node() { children = new Node[26]; isEnd = false; } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/huawei-algorithm/","summary":"æ»‘åŠ¨çª—å£ ç››æœ€å¤šæ°´çš„å®¹å™¨ https://leetcode.cn/problems/container-with-most-water/ class Solution { public int maxArea(int[] height) { int l = 0, r = height.length - 1; int res = 0; while (l \u0026lt; r) { int area = Math.min(height[l], height[r]) * (r - l); res = Math.max(res, area); if (height[l] \u0026lt;= height[r]) { l++; } else { r--; } } return res; } } æ¥é›¨æ°´ dp æ¯ä¸€ä¸ªiçš„æœ€å¤šæ¥çš„é›¨æ°´ï¼Œ maxï¼ˆleftMax(i), rightMax(i)) -height(i) åŒæŒ‡é’ˆ class Solution { public int trap(int[] height) { int len = height.","title":"Huawei Algorithm"},{"content":"é“¾è¡¨/æ•°ç»„ é“¾è¡¨ reverse ç›´æ¥æ”¹å˜ç®­å¤´æ–¹å‘\npre, cur, next\npublic void reverse() // åè½¬ä»¥ a ä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨ ListNode reverse(ListNode a) { ListNode pre, cur, nxt; pre = null; cur = a; nxt = a; while (cur != null) { nxt = cur.next; // é€ä¸ªç»“ç‚¹åè½¬ cur.next = pre; // æ›´æ–°æŒ‡é’ˆä½ç½® pre = cur; cur = nxt; } // è¿”å›åè½¬åçš„å¤´ç»“ç‚¹ return pre; } æ»‘åŠ¨çª—å£ int left = 0, right = 0; while (right \u0026lt; s.size()) { // å¢å¤§çª—å£ window.add(s[right]); right++; while (window needs shrink) { // ç¼©å°çª—å£ window.remove(s[left]); left++; } } äºŒåˆ† int binarySearch(int[] nums, int target) { int left = 0, right = ...; while(...) { int mid = left + (right - left) / 2; if (nums[mid] == target) { ... } else if (nums[mid] \u0026lt; target) { left = ... } else if (nums[mid] \u0026gt; target) { right = ... } } return ...; } å›æº¯ ä¾‹é¢˜ https://leetcode.cn/problems/combination-sum/\nè§£å†³ä¸€ä¸ªå›æº¯é—®é¢˜ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå†³ç­–æ ‘çš„éå†è¿‡ç¨‹ï¼Œä½ åªéœ€è¦æ€è€ƒ 3 ä¸ªé—®é¢˜ã€‚\nè·¯å¾„ï¼šä¹Ÿå°±æ˜¯å·²ç»åšå‡ºçš„é€‰æ‹©ã€‚ é€‰æ‹©åˆ—è¡¨ï¼šä¹Ÿå°±æ˜¯ä½ å½“å‰å¯ä»¥åšçš„é€‰æ‹©ã€‚ ç»“æŸæ¡ä»¶ï¼šä¹Ÿå°±æ˜¯åˆ°è¾¾å†³ç­–æ ‘åº•å±‚ï¼Œæ— æ³•å†åšé€‰æ‹©çš„æ¡ä»¶ã€‚ result = [] def backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨): if æ»¡è¶³ç»“æŸæ¡ä»¶: result.add(è·¯å¾„) return for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨: åšé€‰æ‹© backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨) æ’¤é”€é€‰æ‹© åŠ¨æ€è§„åˆ’è§£é¢˜å¥—è·¯æ¡†æ¶ æ˜¯ä»€ä¹ˆï¼š åŠ¨æ€è§„åˆ’é—®é¢˜çš„ä¸€èˆ¬å½¢å¼å°±æ˜¯æ±‚æœ€å€¼ã€‚åŠ¨æ€è§„åˆ’å…¶å®æ˜¯è¿ç­¹å­¦çš„ä¸€ç§æœ€ä¼˜åŒ–æ–¹æ³•ã€‚ æ ¸å¿ƒé—®é¢˜ æ±‚è§£åŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒé—®é¢˜æ˜¯ç©·ä¸¾ã€‚\næ€è€ƒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ æ˜ç¡® base case -\u0026gt; æ˜ç¡®ã€ŒçŠ¶æ€ã€-\u0026gt; æ˜ç¡®ã€Œé€‰æ‹©ã€ -\u0026gt; å®šä¹‰ dp æ•°ç»„/å‡½æ•°çš„å«ä¹‰ã€‚\n# è‡ªé¡¶å‘ä¸‹é€’å½’çš„åŠ¨æ€è§„åˆ’ def dp(çŠ¶æ€1, çŠ¶æ€2, ...): for é€‰æ‹© in æ‰€æœ‰å¯èƒ½çš„é€‰æ‹©: # æ­¤æ—¶çš„çŠ¶æ€å·²ç»å› ä¸ºåšäº†é€‰æ‹©è€Œæ”¹å˜ result = æ±‚æœ€å€¼(result, dp(çŠ¶æ€1, çŠ¶æ€2, ...)) return result # è‡ªåº•å‘ä¸Šè¿­ä»£çš„åŠ¨æ€è§„åˆ’ # åˆå§‹åŒ– base case dp[0][0][...] = base case # è¿›è¡ŒçŠ¶æ€è½¬ç§» for çŠ¶æ€1 in çŠ¶æ€1çš„æ‰€æœ‰å–å€¼ï¼š for çŠ¶æ€2 in çŠ¶æ€2çš„æ‰€æœ‰å–å€¼ï¼š for ... dp[çŠ¶æ€1][çŠ¶æ€2][...] = æ±‚æœ€å€¼(é€‰æ‹©1ï¼Œé€‰æ‹©2...) æ»‘åŠ¨çª—å£ /* æ»‘åŠ¨çª—å£ç®—æ³•æ¡†æ¶ */ void slidingWindow(string s) { unordered_map\u0026lt;char, int\u0026gt; window; int left = 0, right = 0; while (right \u0026lt; s.size()) { // c æ˜¯å°†ç§»å…¥çª—å£çš„å­—ç¬¦ char c = s[right]; // å¢å¤§çª—å£ right++; // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–° ... /*** debug è¾“å‡ºçš„ä½ç½® ***/ // æ³¨æ„åœ¨æœ€ç»ˆçš„è§£æ³•ä»£ç ä¸­ä¸è¦ print // å› ä¸º IO æ“ä½œå¾ˆè€—æ—¶ï¼Œå¯èƒ½å¯¼è‡´è¶…æ—¶ printf(\u0026#34;window: [%d, %d)\\n\u0026#34;, left, right); /********************/ // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼© while (window needs shrink) { // d æ˜¯å°†ç§»å‡ºçª—å£çš„å­—ç¬¦ char d = s[left]; // ç¼©å°çª—å£ left++; // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–° ... } } } ä¹°å–è‚¡ç¥¨ è¿™ä¸ªé—®é¢˜çš„ã€ŒçŠ¶æ€ã€æœ‰ä¸‰ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤©æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯å…è®¸äº¤æ˜“çš„æœ€å¤§æ¬¡æ•°ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å½“å‰çš„æŒæœ‰çŠ¶æ€ï¼ˆå³ä¹‹å‰è¯´çš„ rest çš„çŠ¶æ€ï¼Œæˆ‘ä»¬ä¸å¦¨ç”¨ 1 è¡¨ç¤ºæŒæœ‰ï¼Œ0 è¡¨ç¤ºæ²¡æœ‰æŒæœ‰ dp[-1][...][0] = 0 è§£é‡Šï¼šå› ä¸º i æ˜¯ä» 0 å¼€å§‹çš„ï¼Œæ‰€ä»¥ i = -1 æ„å‘³ç€è¿˜æ²¡æœ‰å¼€å§‹ï¼Œè¿™æ—¶å€™çš„åˆ©æ¶¦å½“ç„¶æ˜¯ 0ã€‚ dp[-1][...][1] = -infinity è§£é‡Šï¼šè¿˜æ²¡å¼€å§‹çš„æ—¶å€™ï¼Œæ˜¯ä¸å¯èƒ½æŒæœ‰è‚¡ç¥¨çš„ã€‚ å› ä¸ºæˆ‘ä»¬çš„ç®—æ³•è¦æ±‚ä¸€ä¸ªæœ€å¤§å€¼ï¼Œæ‰€ä»¥åˆå§‹å€¼è®¾ä¸ºä¸€ä¸ªæœ€å°å€¼ï¼Œæ–¹ä¾¿å–æœ€å¤§å€¼ã€‚ dp[...][0][0] = 0 è§£é‡Šï¼šå› ä¸º k æ˜¯ä» 1 å¼€å§‹çš„ï¼Œæ‰€ä»¥ k = 0 æ„å‘³ç€æ ¹æœ¬ä¸å…è®¸äº¤æ˜“ï¼Œè¿™æ—¶å€™åˆ©æ¶¦å½“ç„¶æ˜¯ 0ã€‚ dp[...][0][1] = -infinity è§£é‡Šï¼šä¸å…è®¸äº¤æ˜“çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸å¯èƒ½æŒæœ‰è‚¡ç¥¨çš„ã€‚ å› ä¸ºæˆ‘ä»¬çš„ç®—æ³•è¦æ±‚ä¸€ä¸ªæœ€å¤§å€¼ï¼Œæ‰€ä»¥åˆå§‹å€¼è®¾ä¸ºä¸€ä¸ªæœ€å°å€¼ï¼Œæ–¹ä¾¿å–æœ€å¤§å€¼ã€‚ base caseï¼š dp[-1][...][0] = dp[...][0][0] = 0 dp[-1][...][1] = dp[...][0][1] = -infinity çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i]) dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i]) ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95-%E7%AE%97%E6%B3%95%E6%A1%86%E6%9E%B6/","summary":"é“¾è¡¨/æ•°ç»„ é“¾è¡¨ reverse ç›´æ¥æ”¹å˜ç®­å¤´æ–¹å‘\npre, cur, next\npublic void reverse() // åè½¬ä»¥ a ä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨ ListNode reverse(ListNode a) { ListNode pre, cur, nxt; pre = null; cur = a; nxt = a; while (cur != null) { nxt = cur.next; // é€ä¸ªç»“ç‚¹åè½¬ cur.next = pre; // æ›´æ–°æŒ‡é’ˆä½ç½® pre = cur; cur = nxt; } // è¿”å›åè½¬åçš„å¤´ç»“ç‚¹ return pre; } æ»‘åŠ¨çª—å£ int left = 0, right = 0; while (right \u0026lt; s.size()) { // å¢å¤§çª—å£ window.","title":"å¸¸è§ç®—æ³•-ç®—æ³•æ¡†æ¶"},{"content":"æœ€è¿‘å‡ å¤©å¼€å§‹é‡åˆ·ç®—æ³•é¢˜ï¼Œç¡®å®æœ‰ç‚¹æ¯ç‡¥ï¼Œè€Œä¸”æœ‰ç‚¹ä¹±ã€‚å­¦ä¹ éœ€è¦æ­£ç¡®çš„æ–¹æ³•ï¼Œè¿™æ ·å­æ‰èƒ½äº‹åŠåŠŸå€ã€‚\nç°åœ¨ç®—é¢˜çš„ç­–ç•¥æ˜¯æ— è§„åˆ™æŒ‰ç…§çƒ­åº¦åˆ·é¢˜ åœ°å€ ï¼Œä¸€ä¼šå„¿é“¾è¡¨ã€äºŒå‰æ ‘ã€DPã€BFS/DFSï¼Œè¿‡ä¸€ä¼šæœ‰é‡å¤å›æ¥ã€‚ ğŸ§  è„‘å£³éƒ½æ˜¯ä¹±çš„ï¼Œè€Œä¸”æ˜¯é«˜å¼ºåº¦åˆ·é¢˜ï¼Œä¸‰å››å¤©åˆ·äº†å¿« 60 é“é¢˜äº†ï¼Œä½†æ˜¯æ„Ÿè§‰æœ‰ç‚¹ä¹±ã€‚\nå¾ˆå¤šæ—¶å€™æˆ‘ä»¬åšå¾ˆå¤šäº‹æƒ…ï¼Œéƒ½éœ€è¦åšé¢˜ã€æ€»ç»“ã€æŠ½è±¡ã€åæ€ã€‚é‡å¤ä¸€ç³»åˆ—ç¯èŠ‚ï¼Œæ‰ä¼šæœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚\nä»Šå¤©å¶ç„¶é—´å‘ç°ï¼Œä¸€ä¸ªç‰›äººæ€»ç»“çš„ç®—æ³•åœ°å€ ã€‚ ä¾é ä»–çš„æ€»ç»“ï¼Œæ„Ÿè§‰ä¼šäº‹åŠåŠŸå€ã€‚\nç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ ç®—æ³•çš„æœ¬è´¨å°±æ˜¯ã€Œç©·ä¸¾ã€ã€‚ç©·ä¸¾æœ‰ä¸¤ä¸ªå…³é”®éš¾ç‚¹ï¼šæ— é—æ¼ã€æ— å†—ä½™ ã€‚\nå¦‚ä½•ç©·ä¸¾ï¼Ÿå³æ— é—æ¼åœ°ç©·ä¸¾æ‰€æœ‰å¯èƒ½è§£ã€‚ å¦‚ä½•èªæ˜åœ°ç©·ä¸¾ï¼Ÿå³é¿å…æ‰€æœ‰å†—ä½™çš„è®¡ç®—ï¼Œæ¶ˆè€—å°½å¯èƒ½å°‘çš„èµ„æºæ±‚å‡ºç­”æ¡ˆã€‚ ç®—æ³•çš„ç±»å‹é¢˜ æ•°ç»„/å•é“¾è¡¨ç³»åˆ—ç®—æ³• å•é“¾è¡¨ å¸¸è€ƒçš„æŠ€å·§å°±æ˜¯åŒæŒ‡é’ˆã€‚ æ•°ç»„\näºŒåˆ†æœç´¢æŠ€å·§ æ»‘åŠ¨çª—å£ç®—æ³•æŠ€å·§ã€‚ ä¸»è¦ç”¨äºè§£å†³å­ä¸²é—®é¢˜ã€‚ æ»‘åŠ¨çª—å£ä¹Ÿæ˜¯æœ‰å…¶é™åˆ¶çš„ï¼Œå°±æ˜¯ä½ å¿…é¡»æ˜ç¡®çš„çŸ¥é“ä»€ä¹ˆæ—¶å€™åº”è¯¥æ‰©å¤§çª—å£ï¼Œä»€ä¹ˆæ—¶å€™è¯¥æ”¶ç¼©çª—å£ å›æ–‡ä¸²ç›¸å…³æŠ€å·§ åˆ¤æ–­ä¸€ä¸ªä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸² ï¼Œä½¿ç”¨åŒæŒ‡é’ˆä»ä¸¤ç«¯å‘ä¸­å¿ƒæ£€æŸ¥ã€‚ å¯»æ‰¾å›æ–‡å­ä¸²ï¼Œ å°±ä»ä¸­å¿ƒå‘ä¸¤ç«¯æ‰©æ•£ã€‚ å‰ç¼€å’ŒæŠ€å·§ å’Œ å·®åˆ†æ•°ç»„æŠ€å·§ å‰ç¼€å’ŒæŠ€å·§é¢„è®¡ç®—ä¸€ä¸ª preSum æ•°ç»„ï¼Œå°±å¯ä»¥é¿å…å¾ªç¯ å·®åˆ†æ•°ç»„æŠ€å·§ç»´æŠ¤ä¸€ä¸ª diff æ•°ç»„ï¼Œä¹Ÿå¯ä»¥é¿å…å¾ªç¯ äºŒå‰æ ‘ç³»åˆ—ç®—æ³• è§£è¿™ç±»å‹çš„æ–¹æ³•åˆ†ä¸¤ç§æ€è·¯ã€‚\néå†ä¸€éäºŒå‰æ ‘å¾—å‡ºç­”æ¡ˆã€‚ \u0026ndash; å›æº¯ç®—æ³•æ ¸å¿ƒæ¡†æ¶ é€šè¿‡åˆ†è§£é—®é¢˜è®¡ç®—å‡ºç­”æ¡ˆã€‚ \u0026ndash; åŠ¨æ€è§„åˆ’æ ¸å¿ƒæ¡†æ¶ åŠ¨å½’ã€å›æº¯ï¼ˆDFSï¼‰ã€åˆ†æ²»ã€BFS\nç®—æ³•æ¡†æ¶ è§å•ç‹¬æ–‡ç« \nç§¯æå‘ä¸Š è™½ç„¶åšäº†ä¸å°‘é¢˜ï¼Œå¿ƒæ€è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œé¢è¯•æ›´å¤šçš„è¦è€ƒè™‘å¿ƒæ€ã€‚ç»™è‡ªå·±è¶³å¤Ÿçš„ä¿¡å¿ƒï¼ï¼ï¼\n","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95%E9%87%8D%E6%96%B0%E6%A2%B3%E7%90%86/","summary":"æœ€è¿‘å‡ å¤©å¼€å§‹é‡åˆ·ç®—æ³•é¢˜ï¼Œç¡®å®æœ‰ç‚¹æ¯ç‡¥ï¼Œè€Œä¸”æœ‰ç‚¹ä¹±ã€‚å­¦ä¹ éœ€è¦æ­£ç¡®çš„æ–¹æ³•ï¼Œè¿™æ ·å­æ‰èƒ½äº‹åŠåŠŸå€ã€‚\nç°åœ¨ç®—é¢˜çš„ç­–ç•¥æ˜¯æ— è§„åˆ™æŒ‰ç…§çƒ­åº¦åˆ·é¢˜ åœ°å€ ï¼Œä¸€ä¼šå„¿é“¾è¡¨ã€äºŒå‰æ ‘ã€DPã€BFS/DFSï¼Œè¿‡ä¸€ä¼šæœ‰é‡å¤å›æ¥ã€‚ ğŸ§  è„‘å£³éƒ½æ˜¯ä¹±çš„ï¼Œè€Œä¸”æ˜¯é«˜å¼ºåº¦åˆ·é¢˜ï¼Œä¸‰å››å¤©åˆ·äº†å¿« 60 é“é¢˜äº†ï¼Œä½†æ˜¯æ„Ÿè§‰æœ‰ç‚¹ä¹±ã€‚\nå¾ˆå¤šæ—¶å€™æˆ‘ä»¬åšå¾ˆå¤šäº‹æƒ…ï¼Œéƒ½éœ€è¦åšé¢˜ã€æ€»ç»“ã€æŠ½è±¡ã€åæ€ã€‚é‡å¤ä¸€ç³»åˆ—ç¯èŠ‚ï¼Œæ‰ä¼šæœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚\nä»Šå¤©å¶ç„¶é—´å‘ç°ï¼Œä¸€ä¸ªç‰›äººæ€»ç»“çš„ç®—æ³•åœ°å€ ã€‚ ä¾é ä»–çš„æ€»ç»“ï¼Œæ„Ÿè§‰ä¼šäº‹åŠåŠŸå€ã€‚\nç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ ç®—æ³•çš„æœ¬è´¨å°±æ˜¯ã€Œç©·ä¸¾ã€ã€‚ç©·ä¸¾æœ‰ä¸¤ä¸ªå…³é”®éš¾ç‚¹ï¼šæ— é—æ¼ã€æ— å†—ä½™ ã€‚\nå¦‚ä½•ç©·ä¸¾ï¼Ÿå³æ— é—æ¼åœ°ç©·ä¸¾æ‰€æœ‰å¯èƒ½è§£ã€‚ å¦‚ä½•èªæ˜åœ°ç©·ä¸¾ï¼Ÿå³é¿å…æ‰€æœ‰å†—ä½™çš„è®¡ç®—ï¼Œæ¶ˆè€—å°½å¯èƒ½å°‘çš„èµ„æºæ±‚å‡ºç­”æ¡ˆã€‚ ç®—æ³•çš„ç±»å‹é¢˜ æ•°ç»„/å•é“¾è¡¨ç³»åˆ—ç®—æ³• å•é“¾è¡¨ å¸¸è€ƒçš„æŠ€å·§å°±æ˜¯åŒæŒ‡é’ˆã€‚ æ•°ç»„\näºŒåˆ†æœç´¢æŠ€å·§ æ»‘åŠ¨çª—å£ç®—æ³•æŠ€å·§ã€‚ ä¸»è¦ç”¨äºè§£å†³å­ä¸²é—®é¢˜ã€‚ æ»‘åŠ¨çª—å£ä¹Ÿæ˜¯æœ‰å…¶é™åˆ¶çš„ï¼Œå°±æ˜¯ä½ å¿…é¡»æ˜ç¡®çš„çŸ¥é“ä»€ä¹ˆæ—¶å€™åº”è¯¥æ‰©å¤§çª—å£ï¼Œä»€ä¹ˆæ—¶å€™è¯¥æ”¶ç¼©çª—å£ å›æ–‡ä¸²ç›¸å…³æŠ€å·§ åˆ¤æ–­ä¸€ä¸ªä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸² ï¼Œä½¿ç”¨åŒæŒ‡é’ˆä»ä¸¤ç«¯å‘ä¸­å¿ƒæ£€æŸ¥ã€‚ å¯»æ‰¾å›æ–‡å­ä¸²ï¼Œ å°±ä»ä¸­å¿ƒå‘ä¸¤ç«¯æ‰©æ•£ã€‚ å‰ç¼€å’ŒæŠ€å·§ å’Œ å·®åˆ†æ•°ç»„æŠ€å·§ å‰ç¼€å’ŒæŠ€å·§é¢„è®¡ç®—ä¸€ä¸ª preSum æ•°ç»„ï¼Œå°±å¯ä»¥é¿å…å¾ªç¯ å·®åˆ†æ•°ç»„æŠ€å·§ç»´æŠ¤ä¸€ä¸ª diff æ•°ç»„ï¼Œä¹Ÿå¯ä»¥é¿å…å¾ªç¯ äºŒå‰æ ‘ç³»åˆ—ç®—æ³• è§£è¿™ç±»å‹çš„æ–¹æ³•åˆ†ä¸¤ç§æ€è·¯ã€‚\néå†ä¸€éäºŒå‰æ ‘å¾—å‡ºç­”æ¡ˆã€‚ \u0026ndash; å›æº¯ç®—æ³•æ ¸å¿ƒæ¡†æ¶ é€šè¿‡åˆ†è§£é—®é¢˜è®¡ç®—å‡ºç­”æ¡ˆã€‚ \u0026ndash; åŠ¨æ€è§„åˆ’æ ¸å¿ƒæ¡†æ¶ åŠ¨å½’ã€å›æº¯ï¼ˆDFSï¼‰ã€åˆ†æ²»ã€BFS\nç®—æ³•æ¡†æ¶ è§å•ç‹¬æ–‡ç« \nç§¯æå‘ä¸Š è™½ç„¶åšäº†ä¸å°‘é¢˜ï¼Œå¿ƒæ€è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œé¢è¯•æ›´å¤šçš„è¦è€ƒè™‘å¿ƒæ€ã€‚ç»™è‡ªå·±è¶³å¤Ÿçš„ä¿¡å¿ƒï¼ï¼ï¼","title":"ç®—æ³•é‡æ–°æ¢³ç†"},{"content":"25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ ç›¸å¯¹æ¯”è¾ƒç®€å•çš„\nè®¡ç®—å¾ªç¯ä½“çš„ä¸ªæ•° c = n/k; c == 0 ç›´æ¥è¿”å›; c \u0026gt; 0 æ¯ä¸ªå­å¾ªç¯å¤„ç†ï¼› å­å¾ªç¯å¤„ç†ï¼Œ é‡ç‚¹åœ¨äºè®°å½•æ¯ä¸ªå­å¾ªç¯çš„èµ·ç‚¹å’Œç»ˆç‚¹ ä»¥åŠ å½“å‰çš„ç»ˆç‚¹ï¼›ç”¨äºæ¯ä¸ªå­å¾ªç¯çš„é“¾æ¥ class Solution { public ListNode reverseKGroup(ListNode head, int k) { int n = 0 ; ListNode tempNode = head; while (tempNode != null) { tempNode = tempNode.next; n = n + 1; } int c = n / k; if (c == 0) { return head; } else { ListNode result = null; ListNode temp = null; ListNode lastNode = null; while (c-- \u0026gt; 0) { int nk = k; ListNode start = null; ListNode end = null; while (nk-- \u0026gt; 0) { if (end == null) { end = head; } temp = head.next; head.next = start; start = head; head = temp; } if (result == null) { result = start; } if (lastNode != null) { lastNode.next = start; } lastNode = end; } if (head != null) { lastNode.next = head; } return result; } } } class Solution { public ListNode reverseKGroup(ListNode head, int k) { ListNode hair = new ListNode(0); hair.next = head; ListNode pre = hair; while (head != null) { ListNode tail = pre; // æŸ¥çœ‹å‰©ä½™éƒ¨åˆ†é•¿åº¦æ˜¯å¦å¤§äºç­‰äº k for (int i = 0; i \u0026lt; k; ++i) { tail = tail.next; if (tail == null) { return hair.next; } } ListNode nex = tail.next; ListNode[] reverse = myReverse(head, tail); head = reverse[0]; tail = reverse[1]; // æŠŠå­é“¾è¡¨é‡æ–°æ¥å›åŸé“¾è¡¨ pre.next = head; tail.next = nex; pre = tail; head = tail.next; } return hair.next; } public ListNode[] myReverse(ListNode head, ListNode tail) { ListNode prev = tail.next; ListNode p = head; while (prev != tail) { ListNode nex = p.next; p.next = prev; prev = p; p = nex; } return new ListNode[]{tail, head}; } } 160. ç›¸äº¤é“¾è¡¨ æ€è·¯\nset è®°å½• æ—¶é—´ O(N+M) ç©ºé—´ O(1) åŒæŒ‡é’ˆ pAèµ°è¿‡çš„è·¯å¾„ä¸ºAé“¾+Bé“¾ pBèµ°è¿‡çš„è·¯å¾„ä¸ºBé“¾+Aé“¾ pAå’ŒpBèµ°è¿‡çš„é•¿åº¦éƒ½ç›¸åŒï¼Œéƒ½æ˜¯Aé“¾å’ŒBé“¾çš„é•¿åº¦ä¹‹å’Œï¼Œç›¸å½“äºå°†ä¸¤æ¡é“¾ä»å°¾ç«¯å¯¹é½ï¼Œå¦‚æœç›¸äº¤ï¼Œåˆ™ä¼šæå‰åœ¨ç›¸äº¤ç‚¹ç›¸é‡ï¼Œå¦‚æœæ²¡æœ‰ç›¸äº¤ç‚¹ï¼Œåˆ™ä¼šåœ¨æœ€åç›¸é‡ã€‚ public class Solution { public ListNode getIntersectionNode(ListNode headA, ListNode headB) { if (headA == null || headB == null) { return null; } ListNode pA = headA, pB = headB; while (pA != pB) { pA = pA == null ? headB : pA.next; pB = pB == null ? headA : pB.next; } return pA; } } 23. åˆå¹¶ K ä¸ªå‡åºé“¾è¡¨ æ€è·¯ åˆ©ç”¨ä¼˜å…ˆé˜Ÿåˆ—å°†æ¯ä¸€ä¸ªè¡¨å¤´ add å…¥ï¼Œä¾æ¬¡ poll\nclass Solution { public ListNode mergeKLists(ListNode[] lists) { if (lists == null || lists.length == 0) { return null; } PriorityQueue\u0026lt;ListNode\u0026gt; queue = new PriorityQueue\u0026lt;\u0026gt;(lists.length, new Comparator\u0026lt;ListNode\u0026gt;() { public int compare(ListNode o1, ListNode o2) { return o1.val - o2.val; } } ); ListNode dummy = new ListNode(0); for (int i=0; i\u0026lt;lists.length; i++) { if (lists[i] != null) { queue.add(lists[i]); } } ListNode tmp = dummy; while (!queue.isEmpty()) { ListNode node = queue.poll(); if (node.next != null) { queue.add(node.next); } tmp.next = node; tmp = node; } return dummy.next; } } 143. é‡æ’é“¾è¡¨ æ€è·¯\nå­˜å‚¨èŠ‚ç‚¹å¤„ç† å¯»æ‰¾é“¾è¡¨ä¸­ç‚¹ + é“¾è¡¨é€†åº + åˆå¹¶é“¾è¡¨ class Solution { public void reorderList(ListNode head) { ListNode middle = middle(head); ListNode l1 = head; ListNode l2 = middle.next; middle.next = null; l2 = reverse(l2); merge(l1, l2); } private ListNode middle(ListNode head) { ListNode slow = head, quick = head; while (quick.next != null \u0026amp;\u0026amp; quick.next.next != null) { slow = slow.next; quick = quick.next.next; } return slow; } private ListNode reverse(ListNode head) { ListNode lastNode = null; ListNode tempNode = null; while (head != null) { tempNode = head.next; head.next = lastNode; lastNode = head; head = tempNode; } return lastNode; } private void merge(ListNode l1, ListNode l2) { ListNode tmp1, tmp2; while (l1 != null \u0026amp;\u0026amp; l2 != null) { tmp1 = l1.next; tmp2 = l2.next; l1.next = l2; l1 = tmp1; l2.next = l1; l2 = tmp2; } } } 21. åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ æ€è·¯\né€’å½’åˆå¹¶ éå†åˆå¹¶ class Solution { public ListNode mergeTwoLists(ListNode list1, ListNode list2) { ListNode res = new ListNode(-1); ListNode preNode = res; while (list1 != null \u0026amp;\u0026amp; list2 != null) { if (list1.val \u0026lt; list2.val) { preNode.next = list1; list1 = list1.next; } else { preNode.next = list2; list2 = list2.next; } preNode = preNode.next; } if (list1 != null) { preNode.next = list1; } if (list2 != null) { preNode.next = list2; } return res.next; } } [é“¾è¡¨ä¸­å€’æ•°ç¬¬ k ä¸ª] class Solution { public ListNode getKthFromEnd(ListNode head, int k) { ListNode fast = head; ListNode slow = head; while (fast != null \u0026amp;\u0026amp; k \u0026gt; 0) { fast = fast.next; k--; } while (fast != null) { fast = fast.next; slow = slow.next; } return slow; } } 142. ç¯å½¢é“¾è¡¨ II å•æŒ‡é’ˆï¼Œ SET å­˜å‚¨ ä¸‰æŒ‡é’ˆï¼Œ slow, quick, ptr slow = quick public class Solution { public ListNode detectCycle(ListNode head) { if (head == null) { return null; } ListNode slow = head, quick = head; while (quick != null) { slow = slow.next; if (quick.next != null) { quick = quick.next.next; } else { return null; } if (slow == quick) { ListNode ptr = head; while (ptr != slow) { ptr = ptr.next; slow = slow.next; } return ptr; } } return null; } } 92. åè½¬é“¾è¡¨ II æ€è·¯\nè½¬æ¢ä¸º 3 èŠ‚ï¼Œç¬¬äºŒèŠ‚ reverse. å¤´æ’æ³•ã€‚ - pre ä¸å˜ - cur ä¸å˜ class Solution { public ListNode reverseBetween(ListNode head, int left, int right) { ListNode dummyNode = new ListNode(0); dummyNode.next = head; ListNode pre = dummyNode; for (int i=0; i\u0026lt;left-1; i++) { pre = pre.next; } ListNode cur = pre.next, next; for (int i=0; i\u0026lt;right-left; i++) { next = cur.next; cur.next = next.next; next.next = pre.next; pre.next = next; } return dummyNode.next; } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E9%93%BE%E8%A1%A8/","summary":"25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ ç›¸å¯¹æ¯”è¾ƒç®€å•çš„\nè®¡ç®—å¾ªç¯ä½“çš„ä¸ªæ•° c = n/k; c == 0 ç›´æ¥è¿”å›; c \u0026gt; 0 æ¯ä¸ªå­å¾ªç¯å¤„ç†ï¼› å­å¾ªç¯å¤„ç†ï¼Œ é‡ç‚¹åœ¨äºè®°å½•æ¯ä¸ªå­å¾ªç¯çš„èµ·ç‚¹å’Œç»ˆç‚¹ ä»¥åŠ å½“å‰çš„ç»ˆç‚¹ï¼›ç”¨äºæ¯ä¸ªå­å¾ªç¯çš„é“¾æ¥ class Solution { public ListNode reverseKGroup(ListNode head, int k) { int n = 0 ; ListNode tempNode = head; while (tempNode != null) { tempNode = tempNode.next; n = n + 1; } int c = n / k; if (c == 0) { return head; } else { ListNode result = null; ListNode temp = null; ListNode lastNode = null; while (c-- \u0026gt; 0) { int nk = k; ListNode start = null; ListNode end = null; while (nk-- \u0026gt; 0) { if (end == null) { end = head; } temp = head.","title":"ç±»å‹é¢˜-é“¾è¡¨"},{"content":"200. å²›å±¿æ•°é‡ æ€è·¯\nå›¾éå†ï¼Œdfs å¯¹äºéå†è¿‡çš„èŠ‚ç‚¹ï¼Œ è®¾ç½®'2' class Solution { public int numIslands(char[][] grid) { int result = 0; for (int i=0; i\u0026lt;grid.length; i++) { for (int j=0; j\u0026lt;grid[0].length; j++) { if (grid[i][j] == \u0026#39;1\u0026#39;) { dfs(grid, i, j); result ++; } } } return result; } public void dfs(char[][] grid, int i, int j) { if (i\u0026lt;0 || i\u0026gt;=grid.length || j\u0026lt;0 || j\u0026gt;=grid[0].length || grid[i][j]!=\u0026#39;1\u0026#39;) { return; } grid[i][j] = \u0026#39;2\u0026#39;; dfs(grid, i-1, j); dfs(grid, i+1, j); dfs(grid, i, j+1); dfs(grid, i, j-1); } } 46. å…¨æ’åˆ— æ€è·¯ å›æº¯æ³•ï¼Œéå†æ‰€æœ‰å¯èƒ½ã€‚\nclass Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; permute(int[] nums) { int len = nums.length; List\u0026lt;Integer\u0026gt; output = new ArrayList\u0026lt;\u0026gt;(); for (int i=0; i\u0026lt;len; i++) { output.add(nums[i]); } List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result = new ArrayList\u0026lt;\u0026gt;(); backtrace(len, output, result, 0); return result; } private void backtrace(int n, List\u0026lt;Integer\u0026gt; output, List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result, int first) { if (first == n) { result.add(new ArrayList\u0026lt;\u0026gt;(output)); } for (int i=first; i\u0026lt;n; i++) { Collections.swap(output, first, i); backtrace(n, output, result, first + 1); Collections.swap(output, first, i); } } } 79. å•è¯æœç´¢ dfs\nclass Solution { public boolean exist(char[][] board, String word) { int h = board.length, w = board[0].length; boolean[][] visited = new boolean[h][w]; for (int i = 0; i \u0026lt; h; i++) { for (int j = 0; j \u0026lt; w; j++) { boolean flag = check(board, visited, i, j, word, 0); if (flag) { return true; } } } return false; } public boolean check(char[][] board, boolean[][] visited, int i, int j, String s, int k) { if (board[i][j] != s.charAt(k)) { return false; } else if (k == s.length() - 1) { return true; } visited[i][j] = true; int[][] directions = {{0, 1}, {0, -1}, {1, 0}, {-1, 0}}; boolean result = false; for (int[] dir : directions) { int newi = i + dir[0], newj = j + dir[1]; if (newi \u0026gt;= 0 \u0026amp;\u0026amp; newi \u0026lt; board.length \u0026amp;\u0026amp; newj \u0026gt;= 0 \u0026amp;\u0026amp; newj \u0026lt; board[0].length) { if (!visited[newi][newj]) { boolean flag = check(board, visited, newi, newj, s, k + 1); if (flag) { result = true; break; } } } } visited[i][j] = false; return result; } } 695. å²›å±¿çš„æœ€å¤§é¢ç§¯ class Solution { public int maxAreaOfIsland(int[][] grid) { int n = grid.length; int m = grid[0].length; int ans = 0; for (int i=0; i\u0026lt;n; i++) { for (int j=0; j\u0026lt;m; j++) { ans = Math.max(ans, dfs(grid, i, j)); } } return ans; } public int dfs(int[][] grid, int i, int j) { if (i \u0026lt; 0 || i \u0026gt;= grid.length || j \u0026lt; 0 || j\u0026gt;=grid[0].length || grid[i][j] == 0) { return 0; } grid[i][j] = 0; int ans = 1; int[] ai = {0, 0, 1, -1}; int[] aj = {1, -1, 0, 0}; for (int k=0; k\u0026lt;4; k++) { ans += dfs(grid, i+ai[k], j+aj[k]); } return ans; } } 322. é›¶é’±å…‘æ¢ è®°å¿†åŒ–æœç´¢\nclass Solution { public int coinChange(int[] coins, int amount) { return coinChange(coins, amount, new int[amount]); } private int coinChange(int[] coins, int amount, int[] count) { if (amount \u0026lt; 0) { return -1; } if (amount == 0) { return 0; } if (count[amount - 1] != 0) { return count[amount - 1]; } int min = Integer.MAX_VALUE; for (int coin: coins) { int res = coinChange(coins, amount - coin, count); if (res \u0026gt;= 0 \u0026amp;\u0026amp; res \u0026lt; min) { min = res + 1; } } count[amount - 1] = min == Integer.MAX_VALUE ? -1 : min; return count[amount - 1]; } } 93. å¤åŸ IP åœ°å€ å›æº¯ + å‰ªæ\nclass Solution { public List\u0026lt;String\u0026gt; restoreIpAddresses(String s) { int len = s.length(); List\u0026lt;String\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); if (len \u0026lt; 4 || len \u0026gt; 12) { return res; } Deque\u0026lt;String\u0026gt; tmp = new LinkedList\u0026lt;\u0026gt;(); dfs(s, len, 0, 4, tmp, res); return res; } private void dfs(String s, int len, int start, int left, Deque\u0026lt;String\u0026gt; path, List\u0026lt;String\u0026gt; res) { if (start == len) { if (left == 0) { res.add(String.join(\u0026#34;.\u0026#34;, path)); } return; } for (int i=start; i\u0026lt;start + 3; i++) { if (i \u0026gt;= len) { break; } if (left * 3 \u0026lt; len - i) { continue; } String sub = s.substring(start, i+1); if (judge(sub)) { path.addLast(sub); dfs(s, len, i + 1, left - 1, path, res); path.removeLast(); } } } private boolean judge(String s) { int len = s.length(); if (len \u0026gt; 1 \u0026amp;\u0026amp; s.charAt(0) == \u0026#39;0\u0026#39;) { return false; } int t = Integer.valueOf(s); return t \u0026gt;= 0 \u0026amp;\u0026amp; t \u0026lt;= 255; } } 113. è·¯å¾„æ€»å’Œ II class Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; pathSum(TreeNode root, int targetSum) { List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); dfs(root, targetSum, new ArrayList\u0026lt;Integer\u0026gt;(), 0, res); return res; } public void dfs(TreeNode root, int targetSum, List\u0026lt;Integer\u0026gt; temp, int index, List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; res) { if (root == null) { return ; } temp.add(root.val); targetSum = targetSum - root.val; if (targetSum == 0 \u0026amp;\u0026amp; root.left == null \u0026amp;\u0026amp; root.right == null) { res.add(new ArrayList\u0026lt;\u0026gt;(temp)); temp.remove(index); return; } dfs(root.left, targetSum, temp, index + 1, res); dfs(root.right, targetSum, temp, index + 1, res); temp.remove(index); } } 105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ æ€è·¯ é€’å½’ åˆ©ç”¨å‰åºéå†ã€ä¸­åºéå†çš„ç‰¹ç‚¹\nclass Solution { private Map\u0026lt;Integer, Integer\u0026gt; indexMap = new HashMap\u0026lt;\u0026gt;(); public TreeNode buildTree(int[] preorder, int[] inorder) { int n = preorder.length; for (int i=0; i\u0026lt;n; i++) { indexMap.put(inorder[i], i); } return build(preorder, inorder, 0, n-1, 0, n-1); } private TreeNode build(int[] preorder, int[] inorder, int preLeft, int preRight, int inLeft, int inRight) { if (preLeft \u0026gt; preRight) { return null; } int root = preorder[preLeft]; int rootIndex = indexMap.get(root); int leftTreeSize = rootIndex - inLeft; TreeNode rootNode = new TreeNode(root); rootNode.left = build(preorder, inorder, preLeft + 1, preLeft + leftTreeSize, inLeft, rootIndex -1); rootNode.right = build(preorder, inorder, preLeft + leftTreeSize + 1, preRight, rootIndex + 1, inRight); return rootNode; } } 22. æ‹¬å·ç”Ÿæˆ æ€è·¯ è¿™ä¸€ç±»é—®é¢˜æ˜¯åœ¨ä¸€æ£µéšå¼çš„æ ‘ä¸Šæ±‚è§£ï¼Œå¯ä»¥ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼Œä¹Ÿå¯ä»¥ç”¨å¹¿åº¦ä¼˜å…ˆéå†ã€‚ ä¸€èˆ¬ç”¨æ·±åº¦ä¼˜å…ˆéå†ã€‚åŸå› æ˜¯ï¼š\nä»£ç å¥½å†™ï¼Œä½¿ç”¨é€’å½’çš„æ–¹æ³•ï¼Œç›´æ¥å€ŸåŠ©ç³»ç»Ÿæ ˆå®ŒæˆçŠ¶æ€çš„è½¬ç§»ï¼› å¹¿åº¦ä¼˜å…ˆéå†å¾—è‡ªå·±ç¼–å†™ç»“ç‚¹ç±»å’Œå€ŸåŠ©é˜Ÿåˆ—ã€‚\ndfs(å›æº¯+å‰ªæ”¯)/bfs\nclass Solution { public List\u0026lt;String\u0026gt; generateParenthesis(int n) { List\u0026lt;String\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); if (n == 0) { return res; } dfs(\u0026#34;\u0026#34;, 0, 0, n, res); return res; } public void dfs(String curStr, int left, int right, int n, List\u0026lt;String\u0026gt; res) { if (left == n \u0026amp;\u0026amp; right == n) { res.add(curStr); return ; } if (left \u0026lt; right) { return ; } if (left \u0026lt; n) { dfs(curStr + \u0026#34;(\u0026#34;, left + 1, right, n, res); } if (right \u0026lt; n) { dfs(curStr + \u0026#34;)\u0026#34;, left, right + 1, n, res); } } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E5%9B%9E%E6%BA%AF%E6%90%9C%E7%B4%A2/","summary":"200. å²›å±¿æ•°é‡ æ€è·¯\nå›¾éå†ï¼Œdfs å¯¹äºéå†è¿‡çš„èŠ‚ç‚¹ï¼Œ è®¾ç½®'2' class Solution { public int numIslands(char[][] grid) { int result = 0; for (int i=0; i\u0026lt;grid.length; i++) { for (int j=0; j\u0026lt;grid[0].length; j++) { if (grid[i][j] == \u0026#39;1\u0026#39;) { dfs(grid, i, j); result ++; } } } return result; } public void dfs(char[][] grid, int i, int j) { if (i\u0026lt;0 || i\u0026gt;=grid.length || j\u0026lt;0 || j\u0026gt;=grid[0].length || grid[i][j]!=\u0026#39;1\u0026#39;) { return; } grid[i][j] = \u0026#39;2\u0026#39;; dfs(grid, i-1, j); dfs(grid, i+1, j); dfs(grid, i, j+1); dfs(grid, i, j-1); } } 46.","title":"ç±»å‹é¢˜-å›æº¯æœç´¢"},{"content":"33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ æ€è·¯ äºŒåˆ†æŸ¥æ‰¾ã€‚ æ¯ä¸€ä¸ªå±‚çº§çš„éå†ï¼Œåˆ¤æ–­å“ªä¸€ä¾§æ˜¯é¡ºåºçš„ã€‚ nums[0] \u0026lt; nums[mid] , åˆ™å·¦ä¾§æœ‰åºã€‚ nums[0] \u0026gt; nums[mid] åˆ™å³ä¾§æœ‰åºã€‚\nclass Solution { public int search(int[] nums, int target) { int len = nums.length; if (len == 0) { return -1; } int i = 0, j = len -1; while (i \u0026lt;= j) { int mid = (i + j) / 2; if (nums[mid] == target) { return mid; } if (nums[0] \u0026lt;= nums[mid]) { if (nums[0] \u0026lt;= target \u0026amp;\u0026amp; target \u0026lt; nums[mid]) { j = mid - 1; } else { i = mid + 1; } } else { if (nums[mid] \u0026lt; target \u0026amp;\u0026amp; target \u0026lt;= nums[len - 1]) { i = mid + 1; } else { j = mid - 1; } } } return -1; } } 4. å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•° class Solution { public double findMedianSortedArrays(int[] nums1, int[] nums2) { int n1 = nums1.length; int n2 = nums2.length; int len = n1 + n2; boolean flag = ((n1 + n2) \u0026amp; 1) == 1; int left = -1, right = -1; int p1=0, p2=0; for (int i=0; i\u0026lt;=len/2; i++) { left = right; if (p1 \u0026lt; n1 \u0026amp;\u0026amp; (p2 \u0026gt;= n2 || nums1[p1]\u0026lt;nums2[p2])) { right = nums1[p1 ++]; } else { right = nums2[p2 ++]; } } if (flag) { return right; } else { return (left + right) * 1.0 / 2; } } } 69. x çš„å¹³æ–¹æ ¹ æ€è·¯\näºŒåˆ†ã€‚ æ³¨æ„è¾¹ç•Œï¼Œ è¶…è¿‡ int æœ€å¤§å€¼ class Solution { public int mySqrt(int x) { int l = 0, r = x, ans =-1; while (l \u0026lt;= r) { int m = l + (r - l)/2; if ((long)m*m \u0026lt;= x) { ans = m; l = m + 1; } else { r = m -1; } } return ans; } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E4%BA%8C%E5%88%86/","summary":"33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ æ€è·¯ äºŒåˆ†æŸ¥æ‰¾ã€‚ æ¯ä¸€ä¸ªå±‚çº§çš„éå†ï¼Œåˆ¤æ–­å“ªä¸€ä¾§æ˜¯é¡ºåºçš„ã€‚ nums[0] \u0026lt; nums[mid] , åˆ™å·¦ä¾§æœ‰åºã€‚ nums[0] \u0026gt; nums[mid] åˆ™å³ä¾§æœ‰åºã€‚\nclass Solution { public int search(int[] nums, int target) { int len = nums.length; if (len == 0) { return -1; } int i = 0, j = len -1; while (i \u0026lt;= j) { int mid = (i + j) / 2; if (nums[mid] == target) { return mid; } if (nums[0] \u0026lt;= nums[mid]) { if (nums[0] \u0026lt;= target \u0026amp;\u0026amp; target \u0026lt; nums[mid]) { j = mid - 1; } else { i = mid + 1; } } else { if (nums[mid] \u0026lt; target \u0026amp;\u0026amp; target \u0026lt;= nums[len - 1]) { i = mid + 1; } else { j = mid - 1; } } } return -1; } } 4.","title":"ç±»å‹é¢˜-äºŒåˆ†"},{"content":"103. äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå† offer/add; poll/remove; peek/element; ç¬¬ä¸€åˆ—å±äºæ£€æŸ¥ï¼Œç¬¬äºŒåˆ—å¦‚æœé˜Ÿåˆ—ä¸ºç©ºåˆ™æŠ›å‡ºé”™è¯¯ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦: O(n)\nclass Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; zigzagLevelOrder(TreeNode root) { List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result = new ArrayList\u0026lt;\u0026gt;(); if (root == null) { return result; } Queue\u0026lt;TreeNode\u0026gt; queue = new LinkedList\u0026lt;\u0026gt;(); queue.offer(root); boolean even = false; while (!queue.isEmpty()) { int n = queue.size(); List\u0026lt;Integer\u0026gt; items = new ArrayList\u0026lt;\u0026gt;(); while (n -- \u0026gt; 0) { TreeNode node = queue.poll(); items.add(node.val); if (node.left != null) queue.add(node.left); if (node.right != null) queue.add(node.right); } if (even) { Collections.reverse(items); } even = !even; result.add(items); } return result; } } 236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ æ€è·¯ å…¬å…±ç¥–å…ˆå­˜åœ¨ä¸¤ç§æƒ…å†µã€‚\nroot, q,p åˆ†å±ä¸¤ä¾§ï¼› root ä¸º q , p åœ¨å·¦ä¾§; root ä¸º p, q åœ¨å³ä¾§. class Solution { public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) { if (root == null || root == p || root == q) { return root; } TreeNode left = lowestCommonAncestor(root.left, p, q); TreeNode right = lowestCommonAncestor(root.right, p, q); if (left == null) { return right; } if (right == null) { return left; } return root; } } 199. äºŒå‰æ ‘çš„å³è§†å›¾ æ€è·¯ å±‚åºéå†\n124. äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ æ€è·¯\né€’å½’ å…·ä½“ï¼š é€’å½’æ–¹æ³• maxValue ç»è¿‡è¯¥ root æœ€å¤§è·¯å¾„å€¼ = max(0, maxValue(node.left)) + node.value + max(0, maxValue(node.right)) è¯¥èŠ‚ç‚¹çš„æœ€å¤§è´¡çŒ®å€¼ = node.val + max(left, right) class Solution { private int result = Integer.MIN_VALUE; public int maxPathSum(TreeNode root) { maxValue(root); return result; } public int maxValue(TreeNode root) { if (root == null) { return 0; } int left = Math.max(0, maxValue(root.left)); int right = Math.max(0, maxValue(root.right)); int newPathValue = root.val + left + right; result = Math.max(result, newPathValue); return root.val + Math.max(left, right); } } 129. æ±‚æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹æ•°å­—ä¹‹å’Œ BFS / DFS\n// BFS class Solution { public int sumNumbers(TreeNode root) { int res = 0; Queue\u0026lt;TreeNode\u0026gt; queue = new LinkedList\u0026lt;\u0026gt;(); Queue\u0026lt;Integer\u0026gt; nums = new LinkedList\u0026lt;\u0026gt;(); queue.add(root); nums.add(root.val); while (!queue.isEmpty()) { TreeNode node = queue.poll(); Integer itemNum = nums.poll(); if (node.left == null \u0026amp;\u0026amp; node.right == null) { res = res + itemNum; } else { if (node.left != null) { queue.add(node.left); nums.add(itemNum * 10 + node.left.val); } if (node.right != null) { queue.add(node.right); nums.add(itemNum * 10 + node.right.val); } } } return res; } } // dfs class Solution { public int sumNumbers(TreeNode root) { return dfs(root, 0); } public int dfs(TreeNode root, int preSum) { if (root == null) { return 0; } int sum = preSum * 10 + root.val; if (root.left == null \u0026amp;\u0026amp; root.right == null) { return sum; } else { return dfs(root.left, sum) + dfs(root.right, sum); } } } 101. å¯¹ç§°äºŒå‰æ ‘ æ€è·¯ é€’å½’\nclass Solution { public boolean isSymmetric(TreeNode root) { return check(root, root); } private boolean check(TreeNode p, TreeNode q) { if (p == null \u0026amp;\u0026amp; q == null) { return true; } if (p == null || q == null) { return false; } return p.val == q.val \u0026amp;\u0026amp; check(p.left, q.right) \u0026amp;\u0026amp; check(p.right, q.left); } } 114. äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨ class Solution { public void flatten(TreeNode root) { List\u0026lt;TreeNode\u0026gt; list = new ArrayList\u0026lt;TreeNode\u0026gt;(); preorderTraversal(root, list); int size = list.size(); for (int i = 1; i \u0026lt; size; i++) { TreeNode prev = list.get(i - 1), curr = list.get(i); prev.left = null; prev.right = curr; } } public void preorderTraversal(TreeNode root, List\u0026lt;TreeNode\u0026gt; list) { if (root != null) { list.add(root); preorderTraversal(root.left, list); preorderTraversal(root.right, list); } } } 230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬ K å°çš„å…ƒç´  ä¸­åºéå†\nclass Solution { int k, ans; public int kthSmallest(TreeNode root, int _k) { k = _k; dfs(root); return ans; } void dfs(TreeNode root) { if (root == null || k \u0026lt;= 0) return ; dfs(root.left); if (--k == 0) ans = root.val; dfs(root.right); } } class Solution { public int kthSmallest(TreeNode root, int k) { Deque\u0026lt;TreeNode\u0026gt; d = new ArrayDeque\u0026lt;\u0026gt;(); while (root != null || !d.isEmpty()) { while (root != null) { d.addLast(root); root = root.left; } root = d.pollLast(); if (--k == 0) return root.val; root = root.right; } return -1; // never } } 226. ç¿»è½¬äºŒå‰æ ‘ class Solution { public TreeNode invertTree(TreeNode root) { if (root == null) { return null; } TreeNode left = invertTree(root.left); TreeNode right = invertTree(root.right); root.left = right; root.right = left; return root; } } 297. äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– public class Codec { public String serialize(TreeNode root) { return rserialize(root, \u0026#34;\u0026#34;); } public TreeNode deserialize(String data) { String[] dataArray = data.split(\u0026#34;,\u0026#34;); List\u0026lt;String\u0026gt; dataList = new LinkedList\u0026lt;String\u0026gt;(Arrays.asList(dataArray)); return rdeserialize(dataList); } public String rserialize(TreeNode root, String str) { if (root == null) { str += \u0026#34;None,\u0026#34;; } else { str += str.valueOf(root.val) + \u0026#34;,\u0026#34;; str = rserialize(root.left, str); str = rserialize(root.right, str); } return str; } public TreeNode rdeserialize(List\u0026lt;String\u0026gt; dataList) { if (dataList.get(0).equals(\u0026#34;None\u0026#34;)) { dataList.remove(0); return null; } TreeNode root = new TreeNode(Integer.valueOf(dataList.get(0))); dataList.remove(0); root.left = rdeserialize(dataList); root.right = rdeserialize(dataList); return root; } } å‰‘æŒ‡ Offer 26. æ ‘çš„å­ç»“æ„ class Solution { public boolean isSubStructure(TreeNode A, TreeNode B) { return (A != null \u0026amp;\u0026amp; B != null) \u0026amp;\u0026amp; (recur(A, B) || isSubStructure(A.left, B) || isSubStructure(A.right, B)); } boolean recur(TreeNode A, TreeNode B) { if(B == null) return true; if(A == null || A.val != B.val) return false; return recur(A.left, B.left) \u0026amp;\u0026amp; recur(A.right, B.right); } } 104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ class Solution { public int maxDepth(TreeNode root) { if (root == null) { return 0; } else { int leftHeight = maxDepth(root.left); int rightHeight = maxDepth(root.right); return Math.max(leftHeight, rightHeight) + 1; } } } 110. å¹³è¡¡äºŒå‰æ ‘ class Solution { public boolean isBalanced(TreeNode root) { if (root == null) { return true; } else { return Math.abs(height(root.left) - height(root.right)) \u0026lt;= 1 \u0026amp;\u0026amp; isBalanced(root.left) \u0026amp;\u0026amp; isBalanced(root.right); } } public int height(TreeNode root) { if (root == null) { return 0; } else { return Math.max(height(root.left), height(root.right)) + 1; } } } 958. äºŒå‰æ ‘çš„å®Œå…¨æ€§æ£€éªŒ class Solution { public boolean isCompleteTree(TreeNode root) { List\u0026lt;ANode\u0026gt; nodes = new ArrayList(); nodes.add(new ANode(root, 1)); int i = 0; while (i \u0026lt; nodes.size()) { ANode anode = nodes.get(i++); if (anode.node != null) { nodes.add(new ANode(anode.node.left, anode.code * 2)); nodes.add(new ANode(anode.node.right, anode.code * 2 + 1)); } } return nodes.get(i-1).code == nodes.size(); } } class ANode { // Annotated Node TreeNode node; int code; ANode(TreeNode node, int code) { this.node = node; this.code = code; } } äºŒå‰æ ‘çš„ç›´å¾„ class Solution { int max = 1; public int diameterOfBinaryTree(TreeNode root) { dfs(root); return max -1; } public int dfs(TreeNode root) { if (root == null) { return 0; } int left = dfs(root.left); int right = dfs(root.right); max = Math.max(left + right + 1, max); return Math.max(left, right) + 1; } } 662. äºŒå‰æ ‘æœ€å¤§å®½åº¦ class Solution { Map\u0026lt;Integer, Integer\u0026gt; min = new HashMap\u0026lt;\u0026gt;(); public int widthOfBinaryTree(TreeNode root) { return dfs(root, 1, 1); } public int dfs(TreeNode node, int depth, int index) { if (node == null) { return 0; } min.putIfAbsent(depth, index); return Math.max(index - min.get(depth) + 1, Math.max(dfs(node.left, depth + 1, index * 2), dfs(node.right, depth + 1, index * 2 + 1))); } } ä¸­åºéå† class Solution { public List\u0026lt;Integer\u0026gt; inorderTraversal(TreeNode root) { List\u0026lt;Integer\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); Deque\u0026lt;TreeNode\u0026gt; q = new LinkedList\u0026lt;\u0026gt;(); while (root != null || !q.isEmpty()) { while (root != null) { q.push(root); root = root.left; } root = q.pop(); res.add(root.val); root = root.right; } return res; } } class Solution { public List\u0026lt;Integer\u0026gt; inorderTraversal(TreeNode root) { List\u0026lt;Integer\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); inorder(root, res); return res; } public void inorder(TreeNode node, List\u0026lt;Integer\u0026gt; res) { if (node == null) { return ; } inorder(node.left, res); res.add(node.val); inorder(node.right, res); } } 112. è·¯å¾„æ€»å’Œ æ€è·¯\nbfs é€’å½’ class Solution { public boolean hasPathSum(TreeNode root, int targetSum) { if (root == null) { return false; } if (root.left == null \u0026amp;\u0026amp; root.right == null) { return root.val == targetSum; } return hasPathSum(root.left, targetSum - root.val) || hasPathSum(root.right, targetSum - root.val); } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E4%BA%8C%E5%8F%89%E6%A0%91/","summary":"103. äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå† offer/add; poll/remove; peek/element; ç¬¬ä¸€åˆ—å±äºæ£€æŸ¥ï¼Œç¬¬äºŒåˆ—å¦‚æœé˜Ÿåˆ—ä¸ºç©ºåˆ™æŠ›å‡ºé”™è¯¯ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦: O(n)\nclass Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; zigzagLevelOrder(TreeNode root) { List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result = new ArrayList\u0026lt;\u0026gt;(); if (root == null) { return result; } Queue\u0026lt;TreeNode\u0026gt; queue = new LinkedList\u0026lt;\u0026gt;(); queue.offer(root); boolean even = false; while (!queue.isEmpty()) { int n = queue.size(); List\u0026lt;Integer\u0026gt; items = new ArrayList\u0026lt;\u0026gt;(); while (n -- \u0026gt; 0) { TreeNode node = queue.poll(); items.add(node.val); if (node.left != null) queue.add(node.left); if (node.right !","title":"ç±»å‹é¢˜-äºŒå‰æ ‘"},{"content":"20. æœ‰æ•ˆçš„æ‹¬å· æ€è·¯ ä½¿ç”¨æ ˆç»“æ„æ¥å¤„ç†\n394. å­—ç¬¦ä¸²è§£ç  æ ˆ é€’å½’ class Solution { int ptr; String src ; public String decodeString(String s) { this.src = s; ptr = 0; LinkedList\u0026lt;String\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); while (ptr \u0026lt; s.length()) { Character c = s.charAt(ptr); if (Character.isDigit(c)) { String digits = getDigits(); stack.addLast(digits); } else if (Character.isLetter(c) || c == \u0026#39;[\u0026#39;) { stack.addLast(String.valueOf(c)); ptr ++; } else { System.out.println(stack); ptr ++; LinkedList\u0026lt;String\u0026gt; l = new LinkedList\u0026lt;\u0026gt;(); while (!stack.getLast().equals( \u0026#34;[\u0026#34;)) { l.add(stack.removeLast()); } Collections.reverse(l); stack.removeLast(); int repeatTime = Integer.valueOf(stack.removeLast()); String sub = getString(l); String r = \u0026#34;\u0026#34;; while (repeatTime -- \u0026gt; 0) { r += sub; } stack.addLast(r); } } return getString(stack); } String getString(List\u0026lt;String\u0026gt; s) { StringBuilder ret = new StringBuilder(); for (String t : s) { if (Character.isDigit(t.charAt(0))) { continue; } ret.append(t); } return ret.toString(); } private String getDigits() { StringBuilder s = new StringBuilder(); while (ptr \u0026lt; src.length() \u0026amp;\u0026amp; Character.isDigit(src.charAt(ptr))) { s.append(src.charAt(ptr)); ptr ++; } return s.toString(); } private String getString() { StringBuilder s = new StringBuilder(); while (Character.isLetter(src.charAt(ptr))) { s.append(src.charAt(ptr)); ptr ++; } return s.toString(); } } 32. æœ€é•¿æœ‰æ•ˆæ‹¬å· DP æ ˆ class Solution { public int longestValidParentheses(String s) { int res = 0; int len = s.length(); Deque\u0026lt;Integer\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); stack.push(-1); for (int i=0; i\u0026lt;len; i++) { if (s.charAt(i) == \u0026#39;(\u0026#39;) { stack.push(i); } else { stack.pop(); if (stack.isEmpty()) { stack.push(i); } else { res = Math.max(res, i - stack.peek()); } } } return res; } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E6%A0%88/","summary":"20. æœ‰æ•ˆçš„æ‹¬å· æ€è·¯ ä½¿ç”¨æ ˆç»“æ„æ¥å¤„ç†\n394. å­—ç¬¦ä¸²è§£ç  æ ˆ é€’å½’ class Solution { int ptr; String src ; public String decodeString(String s) { this.src = s; ptr = 0; LinkedList\u0026lt;String\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); while (ptr \u0026lt; s.length()) { Character c = s.charAt(ptr); if (Character.isDigit(c)) { String digits = getDigits(); stack.addLast(digits); } else if (Character.isLetter(c) || c == \u0026#39;[\u0026#39;) { stack.addLast(String.valueOf(c)); ptr ++; } else { System.out.println(stack); ptr ++; LinkedList\u0026lt;String\u0026gt; l = new LinkedList\u0026lt;\u0026gt;(); while (!","title":"ç±»å‹é¢˜-æ ˆ"},{"content":"121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº æ€è·¯\næš´åŠ›æ‰€æœ‰æƒ…å†µï¼Œå–æœ€å¤§å€¼ï¼› éå†ä¸€æ¬¡ O(N) class Solution { public int maxProfit(int[] prices) { int price = Integer.MAX_VALUE; int profit = 0; for (int i=0; i\u0026lt;prices.length; i++) { if (prices[i] \u0026lt; price) { price = prices[i]; } else { profit = Math.max(prices[i] - price, profit); } } return profit; } } 53. æœ€å¤§å­æ•°ç»„å’Œ æ€è·¯ åŠ¨æ€è§„åˆ’ dp[i] = max(dp[i-1]+nums[i], nums[i]); dp[i] ä¸º ä»¥ i ç»“å°¾çš„æœ€å¤§æ•°ç»„å’Œ\nclass Solution { public int maxSubArray(int[] nums) { int[] dp = new int[nums.length]; dp[0] = nums[0]; for (int i=1; i\u0026lt;nums.length; i++) { if (dp[i-1] \u0026gt; 0) { dp[i] = dp[i-1] + nums[i]; } else { dp[i] = nums[i]; } } int res = dp[0]; for (int i=1; i\u0026lt;dp.length; i++) { res = Math.max(res, dp[i]); } return res; } // ç”±äºdp[]ä½¿ç”¨äº†ä¸´æ—¶æ•°ç»„ï¼Œå¯ä»¥åœ¨éå†çš„æ—¶å€™è®¡ç®— public int maxSubArray(int[] nums) { int res = nums[0], pre = nums[0]; for (int i=1; i\u0026lt;nums.length; i++) { pre = Math.max(nums[i], pre + nums[i]); res = Math.max(pre, res); } return res; } } 5. æœ€é•¿å›æ–‡å­ä¸² æ€è·¯\nä¸­å¿ƒæ‰©æ•£ åŠ¨æ€è§„åˆ’ è¿›å…¥æ­£é¢˜ï¼ŒåŠ¨æ€è§„åˆ’å…³é”®æ˜¯æ‰¾åˆ°åˆå§‹çŠ¶æ€å’ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚ åˆå§‹çŠ¶æ€ï¼Œl=r æ—¶ï¼Œæ­¤æ—¶ dp[l][r]=trueã€‚ çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œdp[l][r]=true å¹¶ä¸”(l-1)å’Œï¼ˆr+1)ä¸¤ä¸ªä½ç½®ä¸ºç›¸åŒçš„å­—ç¬¦ï¼Œæ­¤æ—¶ dp[l-1][r+1]=trueã€‚\nclass Solution { public String longestPalindrome(String s) { if (s == null || s.length() \u0026lt; 1) { return \u0026#34;\u0026#34;; } int start = 0, end = 0; for (int i = 0; i \u0026lt; s.length(); i++) { int len1 = expandAroundCenter(s, i, i); int len2 = expandAroundCenter(s, i, i + 1); int len = Math.max(len1, len2); if (len \u0026gt; end - start) { start = i - (len - 1) / 2; end = i + len / 2; } } return s.substring(start, end + 1); } public int expandAroundCenter(String s, int left, int right) { while (left \u0026gt;= 0 \u0026amp;\u0026amp; right \u0026lt; s.length() \u0026amp;\u0026amp; s.charAt(left) == s.charAt(right)) { --left; ++right; } return right - left - 1; } } class Solution { public String longestPalindrome(String s) { if (s == null || s.length() == 1) { return s; } int len = s.length(); int maxLeft = 0; int maxRight = 0; int maxLen = 0; boolean dp[][] = new boolean[len][len]; for (int r = 1; r\u0026lt;len; r++) { for (int l=0; l\u0026lt;r; l++) { if (s.charAt(l) == s.charAt(r) \u0026amp;\u0026amp; (r-l \u0026lt;=2 || dp[l+1][r-1])) { dp[l][r] = true; if (r - l + 1 \u0026gt; maxLen) { maxLen = r - l + 1; maxLeft = l; maxRight = r; } } } } return s.substring(maxLeft, maxRight + 1); } } 300. æœ€é•¿é€’å¢å­åºåˆ— æ€è·¯ è·¯å¾„äºŒä½æ•°ç»„. Map\u0026lt;Integer, List\u0026gt; è®°å½•ä¸Šä¸€ä¸ª\nåŠ¨æ€è§„åˆ’ O(n2) çŠ¶æ€å®šä¹‰ï¼šdp[i] åˆ° i æœ€é•¿çš„é€’å¢å­åºåˆ—ã€‚ è½¬ç§»æ–¹ç¨‹ï¼š dp[i] = max(dp[i], dp[j] + 1) j\u0026lt;i class Solution { public int lengthOfLIS(int[] nums) { int len = nums.length; int[] dp = new int[len]; int res = 0; for (int i=0; i\u0026lt;len; i++) { dp[i] = 1; for (int j=0; j\u0026lt;i; j++) { if (nums[i] \u0026gt; nums[j]) { dp[i] = Math.max(dp[i], dp[j] + 1); } } res = Math.max(res, dp[i]); } return res; } } åŠ¨æ€è§„åˆ’ + äºŒåˆ†æŸ¥æ‰¾ (OnlnN) çŠ¶æ€å®šä¹‰: tails[k] çš„å€¼ä»£è¡¨ é•¿åº¦ä¸º k+1 å­åºåˆ— çš„å°¾éƒ¨å…ƒç´ å€¼ã€‚ class Solution { public int lengthOfLIS(int[] nums) { int len = nums.length; int[] dp = new int[len]; int res = 0; for (int num : nums) { int i=0, j=res; while (i \u0026lt; j) { int m = (i + j) / 2; if (dp[m] \u0026lt; num) i = m + 1; else j = m - 1; } dp[i] = num; if (j == res) { res ++; } } return res; } } 135. åˆ†å‘ç³–æœ dp\nclass Solution { public int candy(int[] ratings) { int n = ratings.length; int[] left = new int[n]; for (int i = 0; i \u0026lt; n; i++) { if (i \u0026gt; 0 \u0026amp;\u0026amp; ratings[i] \u0026gt; ratings[i - 1]) { left[i] = left[i - 1] + 1; } else { left[i] = 1; } } int right = 0, ret = 0; for (int i = n - 1; i \u0026gt;= 0; i--) { if (i \u0026lt; n - 1 \u0026amp;\u0026amp; ratings[i] \u0026gt; ratings[i + 1]) { right++; } else { right = 1; } ret += Math.max(left[i], right); } return ret; } } 152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„ dp\nclass Solution { public int maxProduct(int[] nums) { int length = nums.length; int[] maxF = new int[length]; int[] minF = new int[length]; System.arraycopy(nums, 0, maxF, 0, length); System.arraycopy(nums, 0, minF, 0, length); for (int i = 1; i \u0026lt; length; ++i) { maxF[i] = Math.max(maxF[i - 1] * nums[i], Math.max(nums[i], minF[i - 1] * nums[i])); minF[i] = Math.min(minF[i - 1] * nums[i], Math.min(nums[i], maxF[i - 1] * nums[i])); } int ans = maxF[0]; for (int i = 1; i \u0026lt; length; ++i) { ans = Math.max(ans, maxF[i]); } return ans; } } 62. ä¸åŒè·¯å¾„ class Solution { public int uniquePaths(int m, int n) { int[][] f = new int[m][n]; for (int i = 0; i \u0026lt; m; ++i) { f[i][0] = 1; } for (int j = 0; j \u0026lt; n; ++j) { f[0][j] = 1; } for (int i = 1; i \u0026lt; m; ++i) { for (int j = 1; j \u0026lt; n; ++j) { f[i][j] = f[i - 1][j] + f[i][j - 1]; } } return f[m - 1][n - 1]; } } 128. æœ€é•¿è¿ç»­åºåˆ— https://leetcode.cn/problems/longest-consecutive-sequence/solution/xiao-bai-lang-ha-xi-ji-he-ha-xi-biao-don-j5a2/\nclass Solution { public int longestConsecutive(int[] nums) { Set\u0026lt;Integer\u0026gt; num_set = new HashSet\u0026lt;Integer\u0026gt;(); for (int num : nums) { num_set.add(num); } int longestStreak = 0; for (int num : num_set) { if (!num_set.contains(num - 1)) { int currentNum = num; int currentStreak = 1; while (num_set.contains(currentNum + 1)) { currentNum += 1; currentStreak += 1; } longestStreak = Math.max(longestStreak, currentStreak); } } return longestStreak; } } class Solution { public int longestConsecutive(int[] nums) { // keyè¡¨ç¤ºnumï¼Œvalueè¡¨ç¤ºnumæ‰€åœ¨è¿ç»­åŒºé—´çš„é•¿åº¦ Map\u0026lt;Integer, Integer\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); int ans = 0; for (int num : nums) { // å½“mapä¸­ä¸åŒ…å«numï¼Œä¹Ÿå°±æ˜¯numç¬¬ä¸€æ¬¡å‡ºç° if (!map.containsKey(num)) { // leftä¸ºnum-1æ‰€åœ¨è¿ç»­åŒºé—´çš„é•¿åº¦ï¼Œæ›´è¿›ä¸€æ­¥ç†è§£ä¸ºï¼šå·¦è¿ç»­åŒºé—´çš„é•¿åº¦ int left = map.getOrDefault(num - 1, 0); // rightä¸ºnum+1æ‰€åœ¨è¿ç»­åŒºé—´çš„é•¿åº¦ï¼Œæ›´è¿›ä¸€æ­¥ç†è§£ä¸ºï¼šå³è¿ç»­åŒºé—´çš„é•¿åº¦ int right = map.getOrDefault(num + 1, 0); // å½“å‰è¿ç»­åŒºé—´çš„æ€»é•¿åº¦ int curLen = left + right + 1; ans = Math.max(ans, curLen); // å°†numåŠ å…¥mapä¸­ï¼Œè¡¨ç¤ºå·²ç»éå†è¿‡è¯¥å€¼ã€‚å…¶å¯¹åº”çš„valueå¯ä»¥ä¸ºä»»æ„å€¼ã€‚ map.put(num, -1); // æ›´æ–°å½“å‰è¿ç»­åŒºé—´å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œå¯¹åº”çš„åŒºé—´é•¿åº¦ map.put(num - left, curLen); map.put(num + right, curLen); } } return ans; } } 198. æ‰“å®¶åŠ«èˆ dp[i] = max(dp[i-2] + nums[i], dp[i-1])\nclass Solution { public int rob(int[] nums) { if (nums == null || nums.length == 0) { return 0; } int length = nums.length; if (length == 1) { return nums[0]; } int[] dp = new int[length]; dp[0] = nums[0]; dp[1] = Math.max(nums[0], nums[1]); for (int i = 2; i \u0026lt; length; i++) { dp[i] = Math.max(dp[i - 2] + nums[i], dp[i - 1]); } return dp[length - 1]; } } å•è¯æ‹†åˆ† æˆ‘ä»¬å®šä¹‰ dp[i] è¡¨ç¤ºå­—ç¬¦ä¸² s , å‰ i ä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸² s[0.. i-1] s[0..iâˆ’1] æ˜¯å¦èƒ½è¢«ç©ºæ ¼æ‹†åˆ†æˆè‹¥å¹²ä¸ªå­—å…¸ä¸­å‡ºç°çš„å•è¯ã€‚\nclass Solution { public boolean wordBreak(String s, List\u0026lt;String\u0026gt; wordDict) { Set\u0026lt;String\u0026gt; wordDictSet = new HashSet\u0026lt;\u0026gt;(wordDict); boolean[] dp = new boolean[s.length() + 1]; dp[0] = true; for (int i=1; i\u0026lt;= s.length(); i++) { for (int j=0; j\u0026lt;i; j++) { if (dp[j] \u0026amp;\u0026amp; wordDictSet.contains(s.substring(j, i))) { dp[i] = true; break; } } } return dp[s.length()]; } } 64. æœ€å°è·¯å¾„å’Œ dp è®°å½•è·¯å¾„ path[rows*colums][2]\nindex = x*raws + y https://leetcode.cn/problems/minimum-path-sum/solution/by-nice-nightingalerg2-nzdj/\nclass Solution { public int minPathSum(int[][] grid) { int n = grid.length; int m = grid[0].length; int[][] dp = new int[n][m]; dp[0][0] = grid[0][0]; for (int i=1; i\u0026lt;m; i++) { dp[0][i] = dp[0][i-1] + grid[0][i]; } for (int i=1; i\u0026lt;n; i++) { dp[i][0] = dp[i-1][0] + grid[i][0]; } for (int i=1; i\u0026lt;n; i++) { for (int j=1; j\u0026lt;m; j++) { dp[i][j] = Math.min(dp[i-1][j], dp[i][j-1]) + grid[i][j]; } } return dp[n-1][m-1]; } // æ‰“å°è·¯å¾„ï¼Œ å¢åŠ pathè®°å½•å½“å‰èŠ‚ç‚¹æœ€å°çš„è·¯å¾„çš„ä¸Šä¸€ä¸ªåæ ‡ public int minPathSumPrintPath(int[][] grid) { int[][] dp = new int[grid.length][grid[0].length]; int[][] path = new int[grid.length * grid[0].length][2]; dp[0][0] = grid[0][0]; for (int row = 1; row \u0026lt; grid.length; row++) { dp[row][0] = grid[row][0] + dp[row - 1][0]; savePath(path, row, 0, grid[0].length, row - 1, 0); } for (int col = 1; col \u0026lt; grid[0].length; col++) { dp[0][col] = grid[0][col] + dp[0][col - 1]; savePath(path, 0, col, grid[0].length, 0, col - 1); } for (int row = 1; row \u0026lt; grid.length; row++) { for (int col = 1; col \u0026lt; grid[0].length; col++) { if (dp[row - 1][col] \u0026lt; dp[row][col - 1]) { dp[row][col] = dp[row - 1][col] + grid[row][col]; savePath(path, row, col, grid[0].length, row - 1, col); } else { dp[row][col] = dp[row][col - 1] + grid[row][col]; savePath(path, row, col, grid[0].length, row, col - 1); } } } StringBuilder sb = new StringBuilder(); int x = grid.length - 1, y = grid[0].length - 1; sb.append(\u0026#34;(\u0026#34;).append(x).append(\u0026#34;,\u0026#34;).append(y).append(\u0026#34;)\u0026#34;); while (x != 0 || y != 0) { int index = x * grid[0].length + y; x = path[index][0]; y = path[index][1]; sb.append(\u0026#34;-\u0026gt;\u0026#34;).append(\u0026#34;(\u0026#34;).append(x).append(\u0026#34;,\u0026#34;).append(y).append(\u0026#34;)\u0026#34;); } System.out.println(sb.toString()); return dp[grid.length - 1][grid[0].length - 1]; } public void savePath(int[][] path, int row, int col, int colLen, int x, int y) { int index = row * colLen + col; path[index][0] = x; path[index][1] = y; } } 1143. æœ€é•¿å…¬å…±å­åºåˆ— dp dp[i][j] = dp[i-1][j-1] + 1 ; c1 = c2 dp[i][j] = max(dp[i-1][j], dp[i][j-1]; c1!=c2\nclass Solution { public int longestCommonSubsequence(String text1, String text2) { int n = text1.length(), m = text2.length(); int[][] dp = new int[n + 1][m + 1]; for (int i=1; i\u0026lt;=n; i++) { char c1 = text1.charAt(i-1); for (int j=1; j\u0026lt;=m; j++) { char c2 = text2.charAt(j-1); if (c1 == c2) { dp[i][j] = dp[i-1][j-1] + 1; } else { dp[i][j] = Math.max(dp[i-1][j], dp[i][j-1]); } } } return dp[n][m]; } } 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II dp dp[i][j][k] i å¤© k äº¤æ˜“çš„æ¬¡æ•° k ä¸ºæœ‰æ— æŒæœ‰ã€‚\nclass Solution { public int maxProfit(int[] prices) { int n = prices.length; int dp[][] = new int[n][2]; for (int i=0; i\u0026lt;n; i++) { if (i==0) { dp[i][0] = 0; dp[i][1] = -prices[i]; } else { dp[i][0] = Math.max(dp[i-1][0], dp[i-1][1] + prices[i]); dp[i][1] = Math.max(dp[i-1][1], dp[i-1][0] - prices[i]); } } return dp[n-1][0]; } } 42. æ¥é›¨æ°´ dp åŒæŒ‡é’ˆ class Solution { public int trap(int[] height) { int n = height.length; if (n == 0) { return 0; } int[] leftMax = new int[n]; int[] rightMax = new int[n]; leftMax[0] = height[0]; for (int i=1; i\u0026lt;n; i++) { leftMax[i] = Math.max(leftMax[i-1], height[i]); } rightMax[n-1] = height[n-1]; for (int i=n-2; i\u0026gt;=0; i--) { rightMax[i] = Math.max(rightMax[i+1], height[i]); } int res = 0; for (int i=0; i\u0026lt;n; i++) { res += Math.min(leftMax[i], rightMax[i]) - height[i]; } return res; } } class Solution { public int trap(int[] height) { int ans = 0; int left = 0, right = height.length - 1; int leftMax = 0, rightMax = 0; while (left \u0026lt; right) { leftMax = Math.max(leftMax, height[left]); rightMax = Math.max(rightMax, height[right]); if (height[left] \u0026lt; height[right]) { ans += leftMax - height[left]; ++left; } else { ans += rightMax - height[right]; --right; } } return ans; } } 72. ç¼–è¾‘è·ç¦» æ€è·¯ dp[i][j] ä»£è¡¨ word1 åˆ° i ä½ç½®è½¬æ¢æˆ word2 åˆ° j ä½ç½®éœ€è¦æœ€å°‘æ­¥æ•°\næ‰€ä»¥ï¼Œ\nå½“ word1[i] == word2[j]ï¼Œdp[i][j] = dp[i-1][j-1]ï¼› å½“ word1[i] != word2[j]ï¼Œdp[i][j] = min(dp[i-1][j-1], dp[i-1][j], dp[i][j-1]) + 1\nå…¶ä¸­ï¼Œdp[i-1][j-1] è¡¨ç¤ºæ›¿æ¢æ“ä½œï¼Œdp[i-1][j] è¡¨ç¤ºåˆ é™¤æ“ä½œï¼Œdp[i][j-1] è¡¨ç¤ºæ’å…¥æ“ä½œã€‚\nclass Solution { public int minDistance(String word1, String word2) { int n1 = word1.length(); int n2 = word2.length(); int[][] dp = new int[n1+1][n2+1]; for (int i=1; i\u0026lt;=n1; i++) { dp[i][0] = dp[i-1][0] + 1; } for (int j=1; j\u0026lt;=n2; j++) { dp[0][j] = dp[0][j-1] + 1; } for (int i=1; i\u0026lt;=n1; i++) { for (int j=1; j\u0026lt;=n2; j++) { if (word1.charAt(i-1) == word2.charAt(j-1)) { dp[i][j] = dp[i-1][j-1]; } else { dp[i][j] = Math.min(dp[i-1][j-1], Math.min(dp[i-1][j], dp[i][j-1])) + 1; } } } return dp[n1][n2]; } } 221. æœ€å¤§æ­£æ–¹å½¢ æ€è·¯\næš´åŠ› dp dp[i][j] ä¸ºä»¥ i,j ä¸ºå³ä¸‹è„šï¼Œæœ€å¤§çš„æ­£æ–¹ä½“å¤šå¤§ã€‚ dp[i][j] = min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1]) + 1 class Solution { public int maximalSquare(char[][] matrix) { int rows = matrix.length, columns = matrix[0].length; int[][] dp = new int[rows][columns]; int maxlen = 0; for (int i=0; i\u0026lt;rows; i++) { for (int j=0; j\u0026lt;columns; j++) { if (matrix[i][j] == \u0026#39;1\u0026#39;) { if (i == 0 || j == 0) { dp[i][j] = 1; } else { dp[i][j] = Math.min(dp[i-1][j], Math.min(dp[i][j-1], dp[i-1][j-1])) + 1; } maxlen = Math.max(maxlen, dp[i][j]); } } } return maxlen * maxlen; } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","summary":"121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº æ€è·¯\næš´åŠ›æ‰€æœ‰æƒ…å†µï¼Œå–æœ€å¤§å€¼ï¼› éå†ä¸€æ¬¡ O(N) class Solution { public int maxProfit(int[] prices) { int price = Integer.MAX_VALUE; int profit = 0; for (int i=0; i\u0026lt;prices.length; i++) { if (prices[i] \u0026lt; price) { price = prices[i]; } else { profit = Math.max(prices[i] - price, profit); } } return profit; } } 53. æœ€å¤§å­æ•°ç»„å’Œ æ€è·¯ åŠ¨æ€è§„åˆ’ dp[i] = max(dp[i-1]+nums[i], nums[i]); dp[i] ä¸º ä»¥ i ç»“å°¾çš„æœ€å¤§æ•°ç»„å’Œ\nclass Solution { public int maxSubArray(int[] nums) { int[] dp = new int[nums.","title":"ç±»å‹é¢˜-åŠ¨æ€è§„åˆ’"},{"content":"402. ç§»æ‰ K ä½æ•°å­— è´ªå¿ƒ + å•è°ƒæ ˆ\nclass Solution { public String removeKdigits(String num, int k) { Deque\u0026lt;Character\u0026gt; deque = new LinkedList\u0026lt;\u0026gt;(); int length = num.length(); for (int i=0; i\u0026lt;length; i++) { while (!deque.isEmpty() \u0026amp;\u0026amp; k\u0026gt;0 \u0026amp;\u0026amp; deque.getLast() \u0026gt; num.charAt(i)) { deque.removeLast(); k --; } deque.addLast(num.charAt(i)); } for (int i=0; i\u0026lt;k; i++) { deque.removeLast(); } StringBuilder res = new StringBuilder(); boolean zero = true; while (!deque.isEmpty()) { char digit = deque.removeFirst(); if (digit == \u0026#39;0\u0026#39; \u0026amp;\u0026amp; zero) { continue; } zero = false; res.append(digit); } return res.toString().length() == 0 ? \u0026#34;0\u0026#34; : res.toString(); } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E5%8D%95%E8%B0%83%E6%A0%88/","summary":"402. ç§»æ‰ K ä½æ•°å­— è´ªå¿ƒ + å•è°ƒæ ˆ\nclass Solution { public String removeKdigits(String num, int k) { Deque\u0026lt;Character\u0026gt; deque = new LinkedList\u0026lt;\u0026gt;(); int length = num.length(); for (int i=0; i\u0026lt;length; i++) { while (!deque.isEmpty() \u0026amp;\u0026amp; k\u0026gt;0 \u0026amp;\u0026amp; deque.getLast() \u0026gt; num.charAt(i)) { deque.removeLast(); k --; } deque.addLast(num.charAt(i)); } for (int i=0; i\u0026lt;k; i++) { deque.removeLast(); } StringBuilder res = new StringBuilder(); boolean zero = true; while (!deque.isEmpty()) { char digit = deque.","title":"ç±»å‹é¢˜-å•è°ƒæ ˆ"},{"content":"é¢†åŸŸé©±åŠ¨è®¾è®¡( DDD ) æ˜¯ä¸€ç§ä¸»è¦çš„è½¯ä»¶è®¾è®¡æ–¹æ³•ï¼Œä¾§é‡äºæ ¹æ®é¢†åŸŸä¸“å®¶çš„è¾“å…¥å¯¹è½¯ä»¶è¿›è¡Œå»ºæ¨¡ä»¥åŒ¹é…è¯¥é¢†åŸŸã€‚åœ¨é¢†åŸŸé©±åŠ¨è®¾è®¡ä¸‹ï¼Œè½¯ä»¶ä»£ç çš„ç»“æ„å’Œè¯­è¨€ï¼ˆç±»åã€ç±»æ–¹æ³•ã€ç±»å˜é‡ï¼‰è¦ä¸ä¸šåŠ¡é¢†åŸŸç›¸åŒ¹é…ã€‚\né¢†åŸŸé©±åŠ¨è®¾è®¡åŸºäºä»¥ä¸‹ç›®æ ‡ï¼š\nå°†é¡¹ç›®çš„ä¸»è¦é‡ç‚¹æ”¾åœ¨æ ¸å¿ƒé¢†åŸŸå’Œé¢†åŸŸé€»è¾‘ä¸Šï¼› åŸºäºåŸŸæ¨¡å‹çš„å¤æ‚è®¾è®¡ï¼› åœ¨æŠ€ â€‹â€‹ æœ¯ä¸“å®¶å’Œé¢†åŸŸä¸“å®¶ä¹‹é—´å‘èµ·åˆ›é€ æ€§åä½œï¼Œä»¥è¿­ä»£æ–¹å¼å®Œå–„è§£å†³ç‰¹å®šé¢†åŸŸé—®é¢˜çš„æ¦‚å¿µæ¨¡å‹ã€‚ ç‰¹ç‚¹ è§’è‰²å¤æ‚æ€§ã€‚ è§£å†³è½¯ä»¶ç³»ç»Ÿå¤æ‚åº¦çš„ä¸€ç§å»ºæ¨¡å·¥å…·ã€‚ ä¸šåŠ¡æœ¬èº«å¤æ‚ï¼Œæ–°åŒå­¦å­¦ä¹ å’Œç†è§£æˆæœ¬é«˜ã€‚ æ”¯æ’‘å¤šä¸šåŠ¡ï¼Œå¤šä¸šåŠ¡çš„æ”¯æ’‘éœ€è¦å¹³è¡¡å…±æ€§å’Œå·®å¼‚æ€§çš„éš¾é¢˜ï¼Œå¾ˆå®¹æ˜“é€ æˆç›¸ä¼¼ä»£ç åˆ°å¤„æ‹·è´ã€‚ æ¨¡å‹è®¾è®¡å’Œå®ç°èƒ½ç›´æ¥è¡¨ç°ä¸šåŠ¡è¯­ä¹‰ çœŸæ­£æ‹¥æŠ±é¢å‘å¯¹è±¡çš„æ€æƒ³ å¸‚åœºä¸Šçš„åº”ç”¨æ¶æ„ ä¼ ç»Ÿ MVC ä¸‰å±‚æ¶æ„ æ´‹è‘±æ¶æ„ åŒå¿ƒåœ†ä»£è¡¨è½¯ä»¶çš„ä¸åŒéƒ¨åˆ†ï¼Œä»é‡Œå‘å¤–ä¾æ¬¡æ˜¯é¢†åŸŸæ¨¡å‹ï¼Œé¢†åŸŸæœåŠ¡ï¼Œåº”ç”¨æœåŠ¡å’Œå¤–å±‚çš„åŸºç¡€è®¾æ–½å’Œç”¨æˆ·ç»ˆç«¯ã€‚\næ´‹è‘±æ¶æ„æ ¹æ®ä¾èµ–åŸåˆ™ï¼Œå®šä¹‰äº†å„å±‚çš„ä¾èµ–å…³ç³»ï¼Œè¶Šå¾€é‡Œä¾èµ–ç¨‹åº¦è¶Šä½ï¼Œä»£ç çº§åˆ«è¶Šé«˜ï¼Œè¶Šæ˜¯æ ¸å¿ƒèƒ½åŠ›ã€‚å¤–åœ†ä»£ç ä¾èµ–åªèƒ½æŒ‡å‘å†…åœ†ï¼Œå†…åœ†ä¸éœ€è¦çŸ¥é“å¤–åœ†çš„æƒ…å†µï¼Œæ´‹è‘±æ¶æ„ä¹Ÿæ˜¯å…¸å‹çš„åˆ†å±‚æ¶æ„ï¼Œå’Œ DDD åˆ†å±‚æ¶æ„ä¸€æ ·ï¼Œéƒ½ä½“ç°äº†é«˜å†…èšï¼Œä½è€¦åˆçš„è®¾è®¡ç‰¹æ€§ã€‚\nCQRS æ¶æ„ CQRS æ˜¯â€œå‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»â€ï¼ˆCommand Query Responsibility Segregationï¼‰çš„ç¼©å†™ã€‚ åœ¨åŸºäº CQRS çš„ç³»ç»Ÿä¸­ï¼Œå‘½ä»¤(å†™æ“ä½œ)å’ŒæŸ¥è¯¢(è¯»æ“ä½œ)æ‰€ä½¿ç”¨çš„æ•°æ®æ¨¡å‹æ˜¯æœ‰åŒºåˆ«çš„ã€‚ ä¸ºä»€ä¹ˆå°†æŸ¥è¯¢å’Œå‘½ä»¤åŒºéš”å¼€å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆå°†æŸ¥è¯¢å’Œå‘½ä»¤åŒºéš”å¼€å‘¢ï¼Œæ˜¯å› ä¸ºåœ¨å®ç°å„ç§å„æ ·çš„æŸ¥è¯¢æ“ä½œæ—¶ï¼Œå¾€å¾€è¦æ±‚éå¸¸çµæ´»ï¼Œå¤šä¸ªé¢†åŸŸå¯¹è±¡çš„å…³è”æŸ¥è¯¢ã€åˆ†é¡µæŸ¥è¯¢ï¼Œå¾€å¾€æ˜¯æ¯ä¸ªå¯¹è±¡å–å‡ ä¸ªå­—æ®µç»„æˆä¸€ä¸ªè§†å›¾æ¨¡å‹ï¼Œä¸é¢†åŸŸçŸ¥è¯†å…³ç³»æ²¡æœ‰å¤ªç´§å¯†çš„å…³ç³»ã€‚\nåº”ç”¨æ¶æ„ åº”ç”¨æ¶æ„çš„æ„ä¹‰ å®šä¹‰ä¸€å¥—è‰¯å¥½çš„ç»“æ„ï¼› æ²»ç†åº”ç”¨å¤æ‚åº¦ï¼Œé™ä½ç³»ç»Ÿç†µå€¼ï¼› ä»éšå¿ƒæ‰€æ¬²çš„æ··ä¹±çŠ¶æ€ï¼Œèµ°å‘äº•äº•æœ‰æ¡çš„æœ‰åºçŠ¶æ€ã€‚ åº”ç”¨æ¶æ„åœ¨ä¸åŒçš„åœ°æ–¹æœ‰ä¸åŒçš„ç†è§£ï¼Œä¸åŒçš„ä¸šåŠ¡å¯èƒ½ä¹Ÿä¼šæœ‰æ‰€åŒºåˆ«ã€‚ èƒ½å®ç°ç›®çš„æ„ä¹‰çš„ç»“æ„å°±æ˜¯ä¸€ç§å¥½çš„æ¶æ„ã€‚\nåº”ç”¨æ¶æ„æœ‰å¾ˆå¤šæ¨¡å¼\nCOLA \u0026hellip; ä¸€ç§åº”ç”¨æ¶æ„æ¨¡å¼ æˆ‘ä»¬åˆ†äº† APIã€Presentationã€Applicationã€Domainã€Adapterã€Infrastructure 6 å¤§æ¨¡å—ã€‚ä¸Šé¢ç®­å¤´æ–¹å‘ä¸æ˜¯æ§åˆ¶æµï¼Œè€Œæ˜¯æ¨¡å—ä¾èµ–æ–¹å‘ã€‚ç”±äºä¾èµ–å¯ä»¥ä¼ é€’ï¼Œæ‰€ä»¥ Api æ¨¡å—ä¹Ÿå°±è¢«ä¼ é€’åˆ° Presentation ä¾èµ–ï¼ŒDomain å±‚ä¹Ÿå°±è¢«ä¼ é€’åˆ° Infrastructure ä¾èµ–ã€‚\nAPI ä¸»è¦æ˜¯å¯¹å¤–æä¾›çš„è¿œç¨‹ RPC æ¥å£ï¼ŒåŒ…å«äº†æ¥å£ã€å‚æ•°å’Œè¿”å›å€¼çš„å®šä¹‰ã€‚API æ¨¡å—ä¸ä¾èµ–ä»»ä½•æœ¬é¡¹ç›®çš„å…¶ä»–æ¨¡å—ï¼Œåªä¾èµ–åŸºç¡€å¹³å°æä¾›çš„åŸºç¡€å…¬å…±åŒ… ihr-platform-commonï¼ˆä¸»è¦æ˜¯æä¾›è¿”å›å€¼ wrapper,é¢†åŸŸå±‚çš„åŸºç¡€é¢†åŸŸæ¥å£ï¼‰ï¼Œä¸ä¾èµ–å…¶ä»–ä»»ä½•åŒ…ï¼Œä¿æŒå¹²å‡€ï¼Œä¸ä¸ºä¾èµ–åº”ç”¨å¼•å…¥åŒ…ç‰ˆæœ¬å†²çªé—®é¢˜ã€‚ æŸ¥è¯¢å‚æ•°å‘½åä»¥ä¸º Query ç»“å°¾ï¼Œå‘½ä»¤å‚æ•°ä»¥ Command ç»“å°¾ï¼Œè¿”å›ç»“æœä»¥ DTO ç»“å°¾ã€‚æ–¹æ³•è¿”å›å€¼éœ€ä½¿ç”¨ Result å°è£…ã€‚å› ä¸ºæ˜¯å¯¹å¤–æä¾›çš„ APIï¼Œæ‰€ä»¥è¦æœ‰å®Œå¤‡çš„ javadoc æ³¨é‡Šã€‚\nPresentationï¼ˆå¯¹å¤–æ¥å£è¡¨ç°å±‚ï¼‰ åŒ…å« http æ¥å£ï¼ˆwebï¼‰ï¼Œhsf æ¥å£å®ç°ï¼ˆproviderï¼‰ï¼Œå®šæ—¶è°ƒåº¦ï¼ˆjobï¼‰ï¼Œæ¶ˆæ¯è®¢é˜…ï¼ˆmqconsumerï¼‰ã€‚æ˜¯æˆ‘ä»¬å¯¹å¤–æä¾›æ•°æ®æœåŠ¡çš„èµ·ç‚¹ã€‚æœ¬å±‚ä¸å®šä¹‰å‚æ•°å’Œæ•°æ®è½¬æ¢å¯¹è±¡ï¼ˆDTOï¼‰ã€‚ä»æ´‹è‘±æ¶æ„å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒPresentation ä½œä¸ºæœ€å¤–å±‚æ¨¡å—ä¹‹ä¸€ï¼Œä¸è¢«åº”ç”¨å…¶ä»–æ¨¡å—ä¾èµ–ã€‚å…¶åªä¾èµ– Application æ¨¡å—ã€‚åŒæ—¶å…¶å®ç° Api ä¸­çš„è¿œç¨‹æ¥å£ï¼Œå¯¹ Api æ¨¡å—çš„ä¾èµ–é€šè¿‡ Application ä¼ é€’ã€‚\nApplicationï¼ˆä¸šåŠ¡åœºæ™¯é€»è¾‘ç¼–æ’å±‚ï¼‰ ä¸»è¦å¤„ç†ä¸šåŠ¡é€»è¾‘çš„ç¼–æ’ï¼ŒCQRS åœ¨è¿™ä¸€å±‚è¿›è¡Œé¦–å…ˆä½“ç°ï¼Œåˆ† command åŒ…ï¼ˆå¤„ç†å‘½ä»¤é€»è¾‘ï¼‰ï¼Œquery åŒ…ï¼ˆå¤„ç†æŸ¥è¯¢é€»è¾‘ï¼‰ã€‚ command åŒ…ä¸‹çš„ CommandService åªä¼šè°ƒç”¨ domain å±‚ä¸‹çš„é¢†åŸŸæˆ–è€…ä»“å‚¨æœåŠ¡å¤„ç†å¯¹è±¡çš„å¢åˆ æ”¹é€»è¾‘ã€‚ query åŒ…ä¸‹çš„ QueryService é¦–å…ˆè°ƒç”¨ querytunnel æ¥å£ï¼ˆæ•°æ®æŸ¥è¯¢é€šé“ï¼‰è·å–è§†å›¾æ•°æ®ï¼Œquerytunnel çš„å®ç°æœ‰åŸºç¡€è®¾æ–½å±‚å®Œæˆã€‚QueryService ä¹Ÿå¯å¯¹æŸ¥è¯¢é€»è¾‘è¿›è¡Œç¼–æ’ï¼Œæ¯”å¦‚å…¶å¾ˆå¯èƒ½æ˜¯ä» querytunnel ä¸­è·å–çš„ä¸€éƒ¨åˆ†æ•°æ®å’Œä» Adapter ä¸­è·å–çš„å¦ä¸€éƒ¨åˆ†è¿›è¡Œç»„è£…æˆä¸€ä¸ªè§†å›¾ DTO è¿”å›ã€‚ æœ¬å±‚çš„ä¸šåŠ¡å¤„ç†å¦‚æœæ˜¯ä¸ºäº†å“åº” Api ä¸­çš„è¿œç¨‹ hsf æ¥å£ï¼Œåˆ™å…¶å‚æ•°ï¼ˆCommandã€Queryï¼‰ï¼Œè¿”å›ç»“æœï¼ˆDTOï¼‰ç›´æ¥é‡‡ç”¨ Api ä¸­å®šä¹‰çš„ã€‚å¦‚æœæ˜¯ä¸ºå“åº” web æ¥å£ï¼Œåˆ™å…¶å‚æ•°å’Œç»“æœéœ€è¦åœ¨ Application å±‚å®šä¹‰ã€‚å¯ä»¥å‚ç…§ä¸Šå›¾ä¾‹å­ã€‚\nDomainï¼ˆé¢†åŸŸå±‚ï¼‰ ä¸»è¦é¢†åŸŸæ¨¡å‹å’Œèšåˆä»“å‚¨æœåŠ¡çš„å®šä¹‰ï¼Œè¿™ä¸€å±‚åŸºæœ¬æ˜¯æŒ‰ç…§ DDD çš„æ€æƒ³ç»„ç»‡ä»£ç é€»è¾‘ï¼Œå½“ç„¶å¤§å®¶å¯ä»¥æ ¹æ®ä¸šåŠ¡åŸŸçš„é¢†åŸŸçŸ¥è¯†å¤æ‚åº¦å†³å®šæ˜¯é‡‡ç”¨è´«è¡€è¿˜æ˜¯å……è¡€æ¨¡å¼ï¼Œæ¯”å¦‚ï¼Œå¦‚æœæ˜¯ç®€å•çš„å·¥å…·ç±»åº”ç”¨ï¼Œå®Œå…¨ä¸å¿…é‡‡ç”¨å……è¡€æ¨¡å¼ã€‚è¿™ä¸€å±‚åªä¾èµ– Adapterï¼ˆé˜²è…å±‚ï¼‰ã€‚è®°ä½ä¸€ä¸ªèšåˆåªèƒ½æœ‰ä¸€ä¸ª Repositoryã€‚\nAdapterï¼ˆé˜²è…å±‚ï¼‰ ä¸»è¦æ˜¯å¯¹è¿œç¨‹æœåŠ¡å’Œä¸­é—´ä»¶æœåŠ¡çš„é˜²è…ï¼Œè¿™ä¸€å±‚å®šä¹‰çš„æ¥å£å¯ä»¥ä¸ç”¨å¸¦ä¸­é—´ä»¶çš„è¯­æ„ã€‚æ¯”å¦‚ç¼“å­˜ä¸­é—´ä»¶ä½¿ç”¨çš„æ˜¯ Redisï¼Œè¿™é‡Œå®šä¹‰çš„ç¼“å­˜æ¥å£å¯ä»¥æ˜¯ CacheClient,ã€‚åŒæ—¶è¿”å›çš„å¯¹è±¡æ˜¯å€¼å¯¹è±¡ï¼ˆValue Objectï¼‰ï¼Œä¸ç”¨å¸¦ä»»ä½•ç±»å‹çš„ O ç»“å°¾ã€‚è¿œç¨‹æœåŠ¡ä¹Ÿä¸€æ ·çš„é€»è¾‘ã€‚ç”±äºè¿™ä¸€å±‚æä¾›çš„èƒ½åŠ›å¯ä»¥è¢«é¢†åŸŸå±‚ç”¨åˆ°ï¼Œæ‰€ä»¥åªè¢«é¢†åŸŸå±‚ä¾èµ–ã€‚\nInfrastructureï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰ è¿™ä¸€å±‚ä¸»è¦æ˜¯æä¾›å¯¹ä»¥ä¸Šå±‚æ¥å£çš„å®ç°ï¼Œæ¯”å¦‚ä»“å‚¨æ¥å£ï¼ˆRepositoryï¼‰ï¼ŒæŸ¥è¯¢æ•°æ®é€šé“æ¥å£ï¼ˆQueryTunnelï¼‰ï¼Œè¿œç¨‹æœåŠ¡æ¥å£ï¼ˆXxAdapterï¼‰ï¼Œä¸­é—´ä»¶æ¥å£ï¼ˆXxClientï¼‰ç­‰ç­‰ã€‚ä¸‹é¢ç›®å‰åˆ†ä¸¤ä¸ªåŒ… dalï¼ˆæ•°æ®è®¿é—®ï¼‰adapterï¼ˆé˜²è…ï¼‰ã€‚dal åŒ…ä¸‹æ˜¯ Repository å’Œ QueryTunnel çš„å®ç°ï¼Œadapter åŒ…ä¸‹æ˜¯è¿œç¨‹æœåŠ¡å’Œä¸­é—´ä»¶çš„å®ç°ã€‚å¤–éƒ¨è¿”å›çš„æ•°æ®æ¨¡å‹é€šè¿‡ converter è½¬æ¢æˆé¢†åŸŸæ¨¡å‹ï¼Œæˆ–è€… QueryTunnel çš„ DTO è¿”å›ç»™è¢«ä¾èµ–å±‚ã€‚ Infrastructure å±‚åªä¾èµ– Application å±‚ï¼Œå…¶å’Œ Presentation éƒ½å±äºæœ€å¤–å±‚çš„æ¨¡å—ï¼Œä¸è¢«å…¶ä»–ä»»ä½•æ¨¡å—ä¾èµ–ã€‚åˆå› ä¸º Application ä¾èµ–äº†å…¶ä»–æ¨¡å—ï¼Œæ‰€ä»¥å…¶ä»–æ¨¡å—çš„ä¾èµ–éƒ½å¯ä»¥ä¼ é€’åˆ° Infrastructure å±‚ã€‚\nå‚è€ƒ https://github.com/alibaba/COLA\n","permalink":"http://blog.chalme.top/posts/think/ddd/","summary":"é¢†åŸŸé©±åŠ¨è®¾è®¡( DDD ) æ˜¯ä¸€ç§ä¸»è¦çš„è½¯ä»¶è®¾è®¡æ–¹æ³•ï¼Œä¾§é‡äºæ ¹æ®é¢†åŸŸä¸“å®¶çš„è¾“å…¥å¯¹è½¯ä»¶è¿›è¡Œå»ºæ¨¡ä»¥åŒ¹é…è¯¥é¢†åŸŸã€‚åœ¨é¢†åŸŸé©±åŠ¨è®¾è®¡ä¸‹ï¼Œè½¯ä»¶ä»£ç çš„ç»“æ„å’Œè¯­è¨€ï¼ˆç±»åã€ç±»æ–¹æ³•ã€ç±»å˜é‡ï¼‰è¦ä¸ä¸šåŠ¡é¢†åŸŸç›¸åŒ¹é…ã€‚\né¢†åŸŸé©±åŠ¨è®¾è®¡åŸºäºä»¥ä¸‹ç›®æ ‡ï¼š\nå°†é¡¹ç›®çš„ä¸»è¦é‡ç‚¹æ”¾åœ¨æ ¸å¿ƒé¢†åŸŸå’Œé¢†åŸŸé€»è¾‘ä¸Šï¼› åŸºäºåŸŸæ¨¡å‹çš„å¤æ‚è®¾è®¡ï¼› åœ¨æŠ€ â€‹â€‹ æœ¯ä¸“å®¶å’Œé¢†åŸŸä¸“å®¶ä¹‹é—´å‘èµ·åˆ›é€ æ€§åä½œï¼Œä»¥è¿­ä»£æ–¹å¼å®Œå–„è§£å†³ç‰¹å®šé¢†åŸŸé—®é¢˜çš„æ¦‚å¿µæ¨¡å‹ã€‚ ç‰¹ç‚¹ è§’è‰²å¤æ‚æ€§ã€‚ è§£å†³è½¯ä»¶ç³»ç»Ÿå¤æ‚åº¦çš„ä¸€ç§å»ºæ¨¡å·¥å…·ã€‚ ä¸šåŠ¡æœ¬èº«å¤æ‚ï¼Œæ–°åŒå­¦å­¦ä¹ å’Œç†è§£æˆæœ¬é«˜ã€‚ æ”¯æ’‘å¤šä¸šåŠ¡ï¼Œå¤šä¸šåŠ¡çš„æ”¯æ’‘éœ€è¦å¹³è¡¡å…±æ€§å’Œå·®å¼‚æ€§çš„éš¾é¢˜ï¼Œå¾ˆå®¹æ˜“é€ æˆç›¸ä¼¼ä»£ç åˆ°å¤„æ‹·è´ã€‚ æ¨¡å‹è®¾è®¡å’Œå®ç°èƒ½ç›´æ¥è¡¨ç°ä¸šåŠ¡è¯­ä¹‰ çœŸæ­£æ‹¥æŠ±é¢å‘å¯¹è±¡çš„æ€æƒ³ å¸‚åœºä¸Šçš„åº”ç”¨æ¶æ„ ä¼ ç»Ÿ MVC ä¸‰å±‚æ¶æ„ æ´‹è‘±æ¶æ„ åŒå¿ƒåœ†ä»£è¡¨è½¯ä»¶çš„ä¸åŒéƒ¨åˆ†ï¼Œä»é‡Œå‘å¤–ä¾æ¬¡æ˜¯é¢†åŸŸæ¨¡å‹ï¼Œé¢†åŸŸæœåŠ¡ï¼Œåº”ç”¨æœåŠ¡å’Œå¤–å±‚çš„åŸºç¡€è®¾æ–½å’Œç”¨æˆ·ç»ˆç«¯ã€‚\næ´‹è‘±æ¶æ„æ ¹æ®ä¾èµ–åŸåˆ™ï¼Œå®šä¹‰äº†å„å±‚çš„ä¾èµ–å…³ç³»ï¼Œè¶Šå¾€é‡Œä¾èµ–ç¨‹åº¦è¶Šä½ï¼Œä»£ç çº§åˆ«è¶Šé«˜ï¼Œè¶Šæ˜¯æ ¸å¿ƒèƒ½åŠ›ã€‚å¤–åœ†ä»£ç ä¾èµ–åªèƒ½æŒ‡å‘å†…åœ†ï¼Œå†…åœ†ä¸éœ€è¦çŸ¥é“å¤–åœ†çš„æƒ…å†µï¼Œæ´‹è‘±æ¶æ„ä¹Ÿæ˜¯å…¸å‹çš„åˆ†å±‚æ¶æ„ï¼Œå’Œ DDD åˆ†å±‚æ¶æ„ä¸€æ ·ï¼Œéƒ½ä½“ç°äº†é«˜å†…èšï¼Œä½è€¦åˆçš„è®¾è®¡ç‰¹æ€§ã€‚\nCQRS æ¶æ„ CQRS æ˜¯â€œå‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»â€ï¼ˆCommand Query Responsibility Segregationï¼‰çš„ç¼©å†™ã€‚ åœ¨åŸºäº CQRS çš„ç³»ç»Ÿä¸­ï¼Œå‘½ä»¤(å†™æ“ä½œ)å’ŒæŸ¥è¯¢(è¯»æ“ä½œ)æ‰€ä½¿ç”¨çš„æ•°æ®æ¨¡å‹æ˜¯æœ‰åŒºåˆ«çš„ã€‚ ä¸ºä»€ä¹ˆå°†æŸ¥è¯¢å’Œå‘½ä»¤åŒºéš”å¼€å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆå°†æŸ¥è¯¢å’Œå‘½ä»¤åŒºéš”å¼€å‘¢ï¼Œæ˜¯å› ä¸ºåœ¨å®ç°å„ç§å„æ ·çš„æŸ¥è¯¢æ“ä½œæ—¶ï¼Œå¾€å¾€è¦æ±‚éå¸¸çµæ´»ï¼Œå¤šä¸ªé¢†åŸŸå¯¹è±¡çš„å…³è”æŸ¥è¯¢ã€åˆ†é¡µæŸ¥è¯¢ï¼Œå¾€å¾€æ˜¯æ¯ä¸ªå¯¹è±¡å–å‡ ä¸ªå­—æ®µç»„æˆä¸€ä¸ªè§†å›¾æ¨¡å‹ï¼Œä¸é¢†åŸŸçŸ¥è¯†å…³ç³»æ²¡æœ‰å¤ªç´§å¯†çš„å…³ç³»ã€‚\nåº”ç”¨æ¶æ„ åº”ç”¨æ¶æ„çš„æ„ä¹‰ å®šä¹‰ä¸€å¥—è‰¯å¥½çš„ç»“æ„ï¼› æ²»ç†åº”ç”¨å¤æ‚åº¦ï¼Œé™ä½ç³»ç»Ÿç†µå€¼ï¼› ä»éšå¿ƒæ‰€æ¬²çš„æ··ä¹±çŠ¶æ€ï¼Œèµ°å‘äº•äº•æœ‰æ¡çš„æœ‰åºçŠ¶æ€ã€‚ åº”ç”¨æ¶æ„åœ¨ä¸åŒçš„åœ°æ–¹æœ‰ä¸åŒçš„ç†è§£ï¼Œä¸åŒçš„ä¸šåŠ¡å¯èƒ½ä¹Ÿä¼šæœ‰æ‰€åŒºåˆ«ã€‚ èƒ½å®ç°ç›®çš„æ„ä¹‰çš„ç»“æ„å°±æ˜¯ä¸€ç§å¥½çš„æ¶æ„ã€‚\nåº”ç”¨æ¶æ„æœ‰å¾ˆå¤šæ¨¡å¼\nCOLA \u0026hellip; ä¸€ç§åº”ç”¨æ¶æ„æ¨¡å¼ æˆ‘ä»¬åˆ†äº† APIã€Presentationã€Applicationã€Domainã€Adapterã€Infrastructure 6 å¤§æ¨¡å—ã€‚ä¸Šé¢ç®­å¤´æ–¹å‘ä¸æ˜¯æ§åˆ¶æµï¼Œè€Œæ˜¯æ¨¡å—ä¾èµ–æ–¹å‘ã€‚ç”±äºä¾èµ–å¯ä»¥ä¼ é€’ï¼Œæ‰€ä»¥ Api æ¨¡å—ä¹Ÿå°±è¢«ä¼ é€’åˆ° Presentation ä¾èµ–ï¼ŒDomain å±‚ä¹Ÿå°±è¢«ä¼ é€’åˆ° Infrastructure ä¾èµ–ã€‚\nAPI ä¸»è¦æ˜¯å¯¹å¤–æä¾›çš„è¿œç¨‹ RPC æ¥å£ï¼ŒåŒ…å«äº†æ¥å£ã€å‚æ•°å’Œè¿”å›å€¼çš„å®šä¹‰ã€‚API æ¨¡å—ä¸ä¾èµ–ä»»ä½•æœ¬é¡¹ç›®çš„å…¶ä»–æ¨¡å—ï¼Œåªä¾èµ–åŸºç¡€å¹³å°æä¾›çš„åŸºç¡€å…¬å…±åŒ… ihr-platform-commonï¼ˆä¸»è¦æ˜¯æä¾›è¿”å›å€¼ wrapper,é¢†åŸŸå±‚çš„åŸºç¡€é¢†åŸŸæ¥å£ï¼‰ï¼Œä¸ä¾èµ–å…¶ä»–ä»»ä½•åŒ…ï¼Œä¿æŒå¹²å‡€ï¼Œä¸ä¸ºä¾èµ–åº”ç”¨å¼•å…¥åŒ…ç‰ˆæœ¬å†²çªé—®é¢˜ã€‚ æŸ¥è¯¢å‚æ•°å‘½åä»¥ä¸º Query ç»“å°¾ï¼Œå‘½ä»¤å‚æ•°ä»¥ Command ç»“å°¾ï¼Œè¿”å›ç»“æœä»¥ DTO ç»“å°¾ã€‚æ–¹æ³•è¿”å›å€¼éœ€ä½¿ç”¨ Result å°è£…ã€‚å› ä¸ºæ˜¯å¯¹å¤–æä¾›çš„ APIï¼Œæ‰€ä»¥è¦æœ‰å®Œå¤‡çš„ javadoc æ³¨é‡Šã€‚","title":"DDD"},{"content":" æŠ€æœ¯å…³æ³¨ç‚¹æ— å¤–ä¹ç¨³å®šæ€§ã€æˆæœ¬ã€ä½“éªŒã€åˆè§„ã€æ•ˆç‡ã€‚ ï¼ˆå…¬å¸ï¼‰\nä¸€ä¸ªä¼˜ç§€å·¥ç¨‹å¸ˆå’Œä¸€ä¸ªå¹³åº¸å·¥ç¨‹å¸ˆçš„æœ€å¤§åŒºåˆ«å°±æ˜¯ï¼Œè°æœ‰ç«çœ¼é‡‘ç›åŠæ—¶è¯†åˆ«åˆ°é—®é¢˜åœ¨å“ªé‡Œï¼Œå±æœºåœ¨å“ªé‡Œï¼ŒåŠæ—¶æå‰å‡†å¤‡è§£å†³è¿™äº›å±æœºï¼Œè€Œä¸æ˜¯åœ¨é—®é¢˜å‘ç”Ÿåï¼Œä¸çŸ¥æ‰€æªï¼Œä¸¤çœ¼ä¸€æŠ¹é»‘ï¼Œè‡ªä¹±é˜µè„šï¼Œæ¯«æ— è§£å†³æ€è·¯ã€‚[èƒ¡ä¿Šé”‹(å´®å¾·)]\nç¨³å®šæ€§ ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯é¡¹ç›®å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚\nèº«åœ¨å•†å“éƒ¨é—¨ï¼Œåœ¨å•†å“å‘å¸ƒè¿™ä¸€ä¾§ç»å¸¸ä¼šå‡ºç°å‘å¸ƒä¸å¯ç”¨çš„æˆ–æˆåŠŸç‡æš´è·Œçš„æƒ…å†µã€‚\nä»æˆ‘ä¸ªäººçš„è§’åº¦ï¼Œè°ˆè°ˆå¯¹ç¨³å®šæ€§æ•´ä½“çš„ç†è§£ã€‚ æ ¹æœ¬ä¸Šè®²ï¼Œæ˜¯å±äºç ”å‘è§„èŒƒçš„èŒƒç•´ã€‚ è¿™è¾¹ä¼šä»ä¸‰ä¸ªç»´åº¦æ¥è¯´æ˜ï¼Œå‘ç”Ÿäº‹æ•…å‰ã€å‘ç”Ÿäº‹æ•…æ—¶ã€å‘ç”Ÿäº‹æ•…åã€‚\nå‘ç”Ÿäº‹æ•…å‰ è¿™ä¸ªé˜¶æ®µå®é™…ä¸Šå±äºç ”å‘è§„èŒƒçš„èŒƒç•´ï¼Œä¸ªäººç†è§£ï¼Œå¦‚æœæŒ‰ç…§ç ”å‘è§„èŒƒæ¥å¼€å‘ç³»ç»Ÿï¼Œå®é™…ä¸Šç»å¤§å¤šæ•°é—®é¢˜éƒ½å¯ä»¥é¿å…ã€‚\næ¯ä¸€ä¸ªç¯èŠ‚å®é™…ä¸Šç»†èŠ‚è¿˜æŒºå¤šçš„ã€‚ å½“ç„¶æ¯ä¸€ä¸ªç¯èŠ‚ï¼Œå¯ä»¥ç»†åŒ–å¦‚ä½•åšï¼Œæœ‰äº›æ˜¯å¿…é¡»è¦æ±‚ï¼Œæœ‰äº›æ˜¯å¯é€‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†çº§æŒ‡æ˜ã€‚\næ¯”å¦‚ï¼š è®¾è®¡é˜¶æ®µï¼Œæ¯”å¦‚å®Œæ•´çš„å¤§éœ€æ±‚ï¼Œåœ¨è®¾è®¡æ–¹é¢è¦æ±‚å…¨é¢ï¼ŒèƒŒæ™¯ã€æ¦‚å¿µå›¾ã€è®¾è®¡å›¾ç­‰éƒ½éœ€è¦å®Œæ•´ï¼›é¢å¯¹ä¸€äº›å°éœ€æ±‚ï¼Œå¯ä»¥æŒ‰éœ€é€‰æ‹©ã€‚\nå‘ç”Ÿäº‹æ•…æ—¶ ä¸€èˆ¬æ¥è®²ï¼Œç³»ç»Ÿæœ‰å®Œå–„çš„ç›‘æ§ï¼Œåˆ¶è®¢ç›¸åº”çš„æ ‡å‡†ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åœ¨ç¬¬ä¸€æ—¶é—´æ”¶åˆ°å“åº”çš„å¼‚å¸¸ä¿¡æ¯ã€‚è¿›è€Œæ ¹æ®ä¸€äº›é¡¹ç›®ç›¸å…³ä¿¡æ¯åŠé¢„æ¡ˆï¼Œæ¥å¿«é€Ÿæ¢å¤ç³»ç»Ÿã€‚\nå‘ç”Ÿäº‹æ•…å é€šå¸¸éœ€è¦åæ€å›é¡¾ï¼Œä¸»è¦ç›®çš„æ˜¯é˜²æ­¢äº‹æ•…å†æ¬¡å‘ç”Ÿï¼ŒåŒæ—¶ä¹Ÿç»™å…¶ä»–åŒäº‹æé†’ã€‚\næä¾›ä¸€ä¸ªæ¨¡ç‰ˆã€‚\näº‹ä»¶æ¦‚è¿°ï¼šï¼ˆç°çŠ¶æè¿°ï¼šè°å‘ç°é—®é¢˜å½±å“åˆ°ä»€ä¹ˆï¼‰ äº‹ä»¶å½±å“ï¼šå½±å“ç°çŠ¶æè¿° äº‹ä»¶èŒƒå›´ï¼šå½±å“èŒƒå›´ äº‹ä»¶åŸå› ï¼šåˆæ­¥åŸå› å’Œç»“è®ºåŸå›  äº‹ä»¶è¿›åº¦ï¼šæè¿°è¿›å±• äº‹ä»¶ç»“æœï¼šå¤„ç†ç»“æœ äº‹ä»¶æ–¹æ¡ˆï¼šå¦‚ä½•å¤„ç†å’Œåç»­æ”¹è¿› æˆæœ¬ ç›®çš„ï¼š ä¸€æ–¹é¢ å¯ä»¥å‡å°‘ æˆæœ¬çš„æ”¯å‡ºï¼Œ å¦ä¸€ä¸ªæ–¹é¢ å¢åŠ å¼€å‘ owner å¯¹é¡¹ç›®çš„äº†è§£ç¨‹åº¦ã€‚\nä¸€èˆ¬å¼€å‘æˆæœ¬æœ‰ä»¥ä¸‹éƒ¨åˆ†ï¼š\nDBï¼š mysql, redis, mq, opensearch , maxcomputeï¼Œ hbashï¼Œæ—¥å¿—å±±äº‘ SLS æœºå™¨èµ„æºï¼š cpuï¼Œ å†…å­˜ï¼Œ ç£ç›˜ï¼Œ ç½‘ç»œå¸¦å®½ ä¸­é—´ä»¶ï¼š blinkï¼ˆå®æ—¶æ•°æ®å¤„ç†ï¼‰ï¼Œç²¾å«ï¼Œ ç›‘æ§ sunfireï¼ˆæ—¥å¿—æ”¶é›†å­˜å‚¨ï¼Œï¼‰ äººå‘˜æˆæœ¬ï¼š å¼€å‘/æµ‹è¯•/äº§å“/leader æˆæœ¬æ§åˆ¶ä½œä¸ºå·¥ç¨‹å¸ˆçš„é‡è¦ç´ å…»ä¹‹ä¸€ï¼Œå¤§åˆ°ç³»ç»Ÿæ¶æ„ã€æŠ€æœ¯é€‰å‹ï¼Œå°åˆ°ä¸€ä¸ªå‡½æ•°æ–¹æ³•çš„æ‰§è¡Œæ€§èƒ½ï¼Œéƒ½ä¼šæ¶‰åŠåˆ°æˆæœ¬ã€‚ä»¥å‰æˆæœ¬å¼ºè°ƒçš„ä¸å¤šï¼Œå¯èƒ½ä¼šæ—¶å¸¸å‡ºç°æ–¹æ¡ˆè®¾è®¡æœªè€ƒè™‘æˆæœ¬ã€ç”³è¯·èµ„æºç›¸å¯¹éšæ„æµªè´¹ç­‰æƒ…å†µï¼Œå¦‚ä»Šå¯¹å¤§å®¶ä¹Ÿéƒ½æå‡ºäº†æ›´é«˜çš„è¦æ±‚ã€‚ä½†æˆæœ¬åˆä¸æ˜¯æˆ‘ä»¬é¢ä¸´çš„å”¯ä¸€å› ç´ ï¼Œå¦‚ä½•åœ¨æ”¯æŒä¸šåŠ¡é«˜é€Ÿå‘å±•ã€ä¿éšœç³»ç»Ÿç¨³å®šçš„æƒ…å†µä¸‹é«˜æ•ˆåœ°åšè¿™ä»¶äº‹ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦é•¿æœŸä¿®ç‚¼çš„è¯¾é¢˜ï¼Œä¹Ÿç›¸ä¿¡æœªæ¥å¤§å®¶éƒ½ä¼šè¶Šåšè¶Šå¥½~\næ•ˆç‡ æ•ˆç‡ä¸ä»…ä»…ä¸å·¥ç¨‹å¸ˆç´ è´¨æœ‰ç´§å¯†è”ç³»ï¼Œä¸å…¬å¸åˆ¶åº¦ã€æ–‡åŒ–ä¹Ÿæœ‰å¾ˆå¤§å…³ç³»ã€‚\næ•ˆç‡å¯ä»¥ä»å„æ–¹é¢æ¥åšï¼Œç®€å•çš„\nç†Ÿç»ƒæŒæ¡å·¥å…·ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œå¼€å‘ IDEAï¼ŒVIï¼›åŠå…¬ï¼šæˆªå›¾ï¼Œå…¨å±€å‰ªè´´æ¿ï¼›ç­‰ç­‰ ç†Ÿç»ƒæŒæ¡å¸¸ç”¨ API çš„ä½¿ç”¨ã€‚ æ¯”å¦‚ï¼Œguava, apache-common; å‘½ä»¤è¡Œå·¥å…·ï¼›æºç çš„ä½¿ç”¨ï¼› ç†Ÿæ‚‰ä½“ç³»ç»“æ„ã€‚ å¯¹æ•´ä½“æœ‰äº†è§£ï¼ŒçŸ¥é“ä»€ä¹ˆåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œæœ‰ä»€ä¹ˆä½œç”¨ã€‚ ç†Ÿæ‚‰åº•å±‚åŸç†ã€‚ å¯¹äºç–‘éš¾æ‚ç—‡çš„å¤„ç†æ–¹å¼ã€‚ æµç¨‹å±‚é¢ï¼š\nä¸»å¹²å¼€å‘ï¼Œä¸»å¹²å‘å¸ƒï¼Œè‡ªåŠ¨é›†æˆã€‚è¿™ä¸ªç¡®å®å¾ˆéš¾ï¼Œéœ€è¦æœ‰å®Œå–„çš„å·¥å…·ï¼Œä¼˜ç§€çš„å·¥ç¨‹å¸ˆã€‚ æŠ½è±¡å±‚æ¬¡ï¼Œå¤ç”¨ã€‚ä¸ç®¡æ˜¯ä»£ç å±‚é¢ã€ç³»ç»Ÿè§’åº¦ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚ ç†è®ºä½“ç³»ï¼š\nDDD çš„è½¯ä»¶ç»“æ„ã€‚ å£°æ˜å¼è®¾è®¡ã€‚éº»çƒ¦ç•™ç»™è‡ªå·±ï¼Œç®€å•ç•™ç»™åˆ«äººã€‚ æ²Ÿé€š:\nå¼€ä¼šæ¨¡å¼ã€‚å¼€ä¼šä¸»è¦æ˜¯å¯¹ææ¡ˆåšé€‰æ‹©ã€‚ è¡¨è¾¾æ–¹å¼ã€‚ å›¾æ ‡è¡¨è¾¾ï¼Œç»“æ„åŒ–è¡¨è¾¾ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©å¯¹æ–¹æ›´å¿«æ›´å¥½çš„ç†è§£ã€‚ åˆè§„ ä¸»è¦æ˜¯æ³•å¾‹æ„è¯†ã€‚å°¤å…¶åœ¨å¢ƒå¤–ï¼Œä¸åŒå›½å®¶æ³•å¾‹è¦æ±‚ä¸åŒï¼Œæˆ‘ä»¬å¯¹äºè¿™äº›éœ€è¦æœ‰ä¸€äº›ç›¸åº”çš„æŠ€æœ¯è°ƒæ•´ã€‚\nä½“éªŒ ä¸ºç”¨æˆ·åšçš„ç³»ç»Ÿï¼Œå¿…ç„¶åœ¨å®¢æˆ·/ç”¨æˆ·çš„è§’åº¦æ€è€ƒï¼Œå¦‚æœåšæ‰èƒ½è®©ç”¨æˆ·ä½¿ç”¨æ–¹ä¾¿ã€‚ä¸ªäººæ„Ÿè§‰ï¼Œè®¾è®¡å’ŒåŠŸèƒ½éƒ½å¾ˆé‡è¦ã€‚\nå°ç»“ å…¶å®åœ¨å¾ˆå¤šç‚¹æ–¹é¢ï¼Œéƒ½æœ‰å¾ˆå¤šç»†èŠ‚å¯ä»¥è®²ã€‚æœ¬æ–‡ä¸»è¦ä»æ¦‚å¿µçš„è§’åº¦ï¼Œä»å…¨å±€çœ‹ä¸€ä¸ªé¡¹ç›®æœ‰å“ªäº›æ–¹é¢ï¼Œéœ€è¦æ³¨æ„ã€‚\n","permalink":"http://blog.chalme.top/posts/think/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/","summary":"æŠ€æœ¯å…³æ³¨ç‚¹æ— å¤–ä¹ç¨³å®šæ€§ã€æˆæœ¬ã€ä½“éªŒã€åˆè§„ã€æ•ˆç‡ã€‚ ï¼ˆå…¬å¸ï¼‰\nä¸€ä¸ªä¼˜ç§€å·¥ç¨‹å¸ˆå’Œä¸€ä¸ªå¹³åº¸å·¥ç¨‹å¸ˆçš„æœ€å¤§åŒºåˆ«å°±æ˜¯ï¼Œè°æœ‰ç«çœ¼é‡‘ç›åŠæ—¶è¯†åˆ«åˆ°é—®é¢˜åœ¨å“ªé‡Œï¼Œå±æœºåœ¨å“ªé‡Œï¼ŒåŠæ—¶æå‰å‡†å¤‡è§£å†³è¿™äº›å±æœºï¼Œè€Œä¸æ˜¯åœ¨é—®é¢˜å‘ç”Ÿåï¼Œä¸çŸ¥æ‰€æªï¼Œä¸¤çœ¼ä¸€æŠ¹é»‘ï¼Œè‡ªä¹±é˜µè„šï¼Œæ¯«æ— è§£å†³æ€è·¯ã€‚[èƒ¡ä¿Šé”‹(å´®å¾·)]\nç¨³å®šæ€§ ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯é¡¹ç›®å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚\nèº«åœ¨å•†å“éƒ¨é—¨ï¼Œåœ¨å•†å“å‘å¸ƒè¿™ä¸€ä¾§ç»å¸¸ä¼šå‡ºç°å‘å¸ƒä¸å¯ç”¨çš„æˆ–æˆåŠŸç‡æš´è·Œçš„æƒ…å†µã€‚\nä»æˆ‘ä¸ªäººçš„è§’åº¦ï¼Œè°ˆè°ˆå¯¹ç¨³å®šæ€§æ•´ä½“çš„ç†è§£ã€‚ æ ¹æœ¬ä¸Šè®²ï¼Œæ˜¯å±äºç ”å‘è§„èŒƒçš„èŒƒç•´ã€‚ è¿™è¾¹ä¼šä»ä¸‰ä¸ªç»´åº¦æ¥è¯´æ˜ï¼Œå‘ç”Ÿäº‹æ•…å‰ã€å‘ç”Ÿäº‹æ•…æ—¶ã€å‘ç”Ÿäº‹æ•…åã€‚\nå‘ç”Ÿäº‹æ•…å‰ è¿™ä¸ªé˜¶æ®µå®é™…ä¸Šå±äºç ”å‘è§„èŒƒçš„èŒƒç•´ï¼Œä¸ªäººç†è§£ï¼Œå¦‚æœæŒ‰ç…§ç ”å‘è§„èŒƒæ¥å¼€å‘ç³»ç»Ÿï¼Œå®é™…ä¸Šç»å¤§å¤šæ•°é—®é¢˜éƒ½å¯ä»¥é¿å…ã€‚\næ¯ä¸€ä¸ªç¯èŠ‚å®é™…ä¸Šç»†èŠ‚è¿˜æŒºå¤šçš„ã€‚ å½“ç„¶æ¯ä¸€ä¸ªç¯èŠ‚ï¼Œå¯ä»¥ç»†åŒ–å¦‚ä½•åšï¼Œæœ‰äº›æ˜¯å¿…é¡»è¦æ±‚ï¼Œæœ‰äº›æ˜¯å¯é€‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†çº§æŒ‡æ˜ã€‚\næ¯”å¦‚ï¼š è®¾è®¡é˜¶æ®µï¼Œæ¯”å¦‚å®Œæ•´çš„å¤§éœ€æ±‚ï¼Œåœ¨è®¾è®¡æ–¹é¢è¦æ±‚å…¨é¢ï¼ŒèƒŒæ™¯ã€æ¦‚å¿µå›¾ã€è®¾è®¡å›¾ç­‰éƒ½éœ€è¦å®Œæ•´ï¼›é¢å¯¹ä¸€äº›å°éœ€æ±‚ï¼Œå¯ä»¥æŒ‰éœ€é€‰æ‹©ã€‚\nå‘ç”Ÿäº‹æ•…æ—¶ ä¸€èˆ¬æ¥è®²ï¼Œç³»ç»Ÿæœ‰å®Œå–„çš„ç›‘æ§ï¼Œåˆ¶è®¢ç›¸åº”çš„æ ‡å‡†ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åœ¨ç¬¬ä¸€æ—¶é—´æ”¶åˆ°å“åº”çš„å¼‚å¸¸ä¿¡æ¯ã€‚è¿›è€Œæ ¹æ®ä¸€äº›é¡¹ç›®ç›¸å…³ä¿¡æ¯åŠé¢„æ¡ˆï¼Œæ¥å¿«é€Ÿæ¢å¤ç³»ç»Ÿã€‚\nå‘ç”Ÿäº‹æ•…å é€šå¸¸éœ€è¦åæ€å›é¡¾ï¼Œä¸»è¦ç›®çš„æ˜¯é˜²æ­¢äº‹æ•…å†æ¬¡å‘ç”Ÿï¼ŒåŒæ—¶ä¹Ÿç»™å…¶ä»–åŒäº‹æé†’ã€‚\næä¾›ä¸€ä¸ªæ¨¡ç‰ˆã€‚\näº‹ä»¶æ¦‚è¿°ï¼šï¼ˆç°çŠ¶æè¿°ï¼šè°å‘ç°é—®é¢˜å½±å“åˆ°ä»€ä¹ˆï¼‰ äº‹ä»¶å½±å“ï¼šå½±å“ç°çŠ¶æè¿° äº‹ä»¶èŒƒå›´ï¼šå½±å“èŒƒå›´ äº‹ä»¶åŸå› ï¼šåˆæ­¥åŸå› å’Œç»“è®ºåŸå›  äº‹ä»¶è¿›åº¦ï¼šæè¿°è¿›å±• äº‹ä»¶ç»“æœï¼šå¤„ç†ç»“æœ äº‹ä»¶æ–¹æ¡ˆï¼šå¦‚ä½•å¤„ç†å’Œåç»­æ”¹è¿› æˆæœ¬ ç›®çš„ï¼š ä¸€æ–¹é¢ å¯ä»¥å‡å°‘ æˆæœ¬çš„æ”¯å‡ºï¼Œ å¦ä¸€ä¸ªæ–¹é¢ å¢åŠ å¼€å‘ owner å¯¹é¡¹ç›®çš„äº†è§£ç¨‹åº¦ã€‚\nä¸€èˆ¬å¼€å‘æˆæœ¬æœ‰ä»¥ä¸‹éƒ¨åˆ†ï¼š\nDBï¼š mysql, redis, mq, opensearch , maxcomputeï¼Œ hbashï¼Œæ—¥å¿—å±±äº‘ SLS æœºå™¨èµ„æºï¼š cpuï¼Œ å†…å­˜ï¼Œ ç£ç›˜ï¼Œ ç½‘ç»œå¸¦å®½ ä¸­é—´ä»¶ï¼š blinkï¼ˆå®æ—¶æ•°æ®å¤„ç†ï¼‰ï¼Œç²¾å«ï¼Œ ç›‘æ§ sunfireï¼ˆæ—¥å¿—æ”¶é›†å­˜å‚¨ï¼Œï¼‰ äººå‘˜æˆæœ¬ï¼š å¼€å‘/æµ‹è¯•/äº§å“/leader æˆæœ¬æ§åˆ¶ä½œä¸ºå·¥ç¨‹å¸ˆçš„é‡è¦ç´ å…»ä¹‹ä¸€ï¼Œå¤§åˆ°ç³»ç»Ÿæ¶æ„ã€æŠ€æœ¯é€‰å‹ï¼Œå°åˆ°ä¸€ä¸ªå‡½æ•°æ–¹æ³•çš„æ‰§è¡Œæ€§èƒ½ï¼Œéƒ½ä¼šæ¶‰åŠåˆ°æˆæœ¬ã€‚ä»¥å‰æˆæœ¬å¼ºè°ƒçš„ä¸å¤šï¼Œå¯èƒ½ä¼šæ—¶å¸¸å‡ºç°æ–¹æ¡ˆè®¾è®¡æœªè€ƒè™‘æˆæœ¬ã€ç”³è¯·èµ„æºç›¸å¯¹éšæ„æµªè´¹ç­‰æƒ…å†µï¼Œå¦‚ä»Šå¯¹å¤§å®¶ä¹Ÿéƒ½æå‡ºäº†æ›´é«˜çš„è¦æ±‚ã€‚ä½†æˆæœ¬åˆä¸æ˜¯æˆ‘ä»¬é¢ä¸´çš„å”¯ä¸€å› ç´ ï¼Œå¦‚ä½•åœ¨æ”¯æŒä¸šåŠ¡é«˜é€Ÿå‘å±•ã€ä¿éšœç³»ç»Ÿç¨³å®šçš„æƒ…å†µä¸‹é«˜æ•ˆåœ°åšè¿™ä»¶äº‹ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦é•¿æœŸä¿®ç‚¼çš„è¯¾é¢˜ï¼Œä¹Ÿç›¸ä¿¡æœªæ¥å¤§å®¶éƒ½ä¼šè¶Šåšè¶Šå¥½~\næ•ˆç‡ æ•ˆç‡ä¸ä»…ä»…ä¸å·¥ç¨‹å¸ˆç´ è´¨æœ‰ç´§å¯†è”ç³»ï¼Œä¸å…¬å¸åˆ¶åº¦ã€æ–‡åŒ–ä¹Ÿæœ‰å¾ˆå¤§å…³ç³»ã€‚\næ•ˆç‡å¯ä»¥ä»å„æ–¹é¢æ¥åšï¼Œç®€å•çš„\nç†Ÿç»ƒæŒæ¡å·¥å…·ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œå¼€å‘ IDEAï¼ŒVIï¼›åŠå…¬ï¼šæˆªå›¾ï¼Œå…¨å±€å‰ªè´´æ¿ï¼›ç­‰ç­‰ ç†Ÿç»ƒæŒæ¡å¸¸ç”¨ API çš„ä½¿ç”¨ã€‚ æ¯”å¦‚ï¼Œguava, apache-common; å‘½ä»¤è¡Œå·¥å…·ï¼›æºç çš„ä½¿ç”¨ï¼› ç†Ÿæ‚‰ä½“ç³»ç»“æ„ã€‚ å¯¹æ•´ä½“æœ‰äº†è§£ï¼ŒçŸ¥é“ä»€ä¹ˆåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œæœ‰ä»€ä¹ˆä½œç”¨ã€‚ ç†Ÿæ‚‰åº•å±‚åŸç†ã€‚ å¯¹äºç–‘éš¾æ‚ç—‡çš„å¤„ç†æ–¹å¼ã€‚ æµç¨‹å±‚é¢ï¼š","title":"é¡¹ç›®ç®¡ç†"},{"content":" ä¸–ç•Œä¸Šçš„äººåˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯â€œæ€è¾¨è€…â€ï¼Œè€Œå¦ä¸€ç§å°±æ˜¯â€œåƒç“œç¾¤ä¼—â€ã€‚\nè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£ä¸”æ·±åˆ»çš„é—®é¢˜ã€‚ä½œä¸ºä¸€ä¸ªå¼€å‘è€…ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½ä¸“äºç ”å‘æ–¹é¢ï¼Œåœ¨æ•´ä½“æ–¹é¢æ€è€ƒçš„æ¯”è¾ƒå°‘ã€‚ä½œä¸ºäººï¼Œæˆ‘ä¸ªäººè®¤ä¸ºéƒ½éœ€è¦è¿›è¡Œå‘å±•ã€‚\nchatGPTçš„ä¸€ç§ç­”æ¡ˆ é€šç”¨èƒ½åŠ›æ˜¯æŒ‡ä¸€ä¸ªäººå…·æœ‰çš„å¹¿æ³›çš„ã€ç»¼åˆçš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\nè¯­è¨€èƒ½åŠ›ï¼šèƒ½å¤Ÿæ¸…æ™°ã€æµç•…åœ°è¡¨è¾¾æ€æƒ³ã€‚ æ•°å­¦èƒ½åŠ›ï¼šå¯¹æ•°å­¦çŸ¥è¯†çš„ç†è§£å’Œè¿ç”¨èƒ½åŠ›ã€‚ é€»è¾‘æ€ç»´èƒ½åŠ›ï¼šèƒ½å¤Ÿç³»ç»Ÿåœ°åˆ†æå’Œè§£å†³é—®é¢˜ã€‚ åˆ›é€ åŠ›ï¼šå…·æœ‰åˆ›é€ æ€§æ€ç»´å’Œåˆ›æ–°æ„è¯†ã€‚ å­¦ä¹ èƒ½åŠ›ï¼šå…·æœ‰è‡ªä¸»å­¦ä¹ çš„èƒ½åŠ›ã€‚ ç¤¾äº¤èƒ½åŠ›ï¼šèƒ½å¤Ÿä¸ä»–äººè¿›è¡Œæœ‰æ•ˆçš„æ²Ÿé€šå’Œåˆä½œã€‚ æƒ…ç»ªç®¡ç†ï¼šèƒ½å¤Ÿç§¯æé¢å¯¹æŒ‘æˆ˜ï¼Œå¹¶ä¿æŒè‰¯å¥½çš„æƒ…ç»ªçŠ¶æ€ã€‚ è‡ªæˆ‘è°ƒèŠ‚ï¼šå…·æœ‰è‡ªæˆ‘è§„åˆ’å’Œè‡ªæˆ‘è°ƒèŠ‚çš„èƒ½åŠ›ã€‚ å…¨é¢å‘å±•ï¼šå…³æ³¨èº«ä½“ã€å¿ƒç†ã€ç²¾ç¥å’Œç¤¾ä¼šç­‰æ–¹é¢çš„å…¨é¢å‘å±•ã€‚ é€šç”¨èƒ½åŠ›æ˜¯æ¯ä¸ªäººéƒ½åº”è¯¥å…·å¤‡çš„èƒ½åŠ›ï¼Œå®ƒä¸ä»…æ˜¯ä¸€ä¸ªäººçš„ä¸ªäººå‘å±•çš„é‡è¦æŒ‡æ ‡ï¼Œä¹Ÿæ˜¯ä»–çš„ç¤¾ä¼šä»·å€¼çš„ä½“ç°ã€‚\nä¸ªäººè®¤çŸ¥ chatGPTçš„ç­”æ¡ˆåœ¨å„ä¸ªè§’åº¦éƒ½æœ‰æ¶‰åŠï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„å›ç­”ã€‚ é€šè¿‡å®ƒçš„å›ç­”ï¼Œå¯¹åº”åˆ°è‡ªå·±ï¼Œç¡®å®åœ¨æŸäº›æ–¹é¢è¿˜æ˜¯æœ‰æ¯”è¾ƒå¤šçš„ä¸è¶³ã€‚\næœ€è¿‘åœ¨çœ‹ä¸€æœ¬ä¹¦ ã€Šéº¦è‚¯é”¡ç»“æ„åŒ–æˆ˜ç•¥æ€ç»´ã€‹ï¼Œå¯¹äºä¸ªäººæ¥è®²ï¼Œç»“æ„åŒ–æˆ˜æ—…æ€ç»´æœ‰äº†å…·è±¡çš„äº†è§£ï¼Œä¸è¿‡ï¼Œè¿˜éœ€å¤šè¯»å‡ æ¬¡ã€‚\næ–‡ä¸­æœ‰ä¸€å¥è¯è®°å¾—æ¯”è¾ƒæ·±åˆ»ï¼Œâ€œç„¦è™‘â€å¾ˆå¤§ç¨‹åº¦ä¸Šæºäºå¯¹æœªæ¥çš„ä¸ç¡®å®šã€‚...æˆ‘ä»¬éœ€è¦åœ¨æ€ç»´å±‚é¢çªç ´èˆ’é€‚åŒºçš„æŸç¼šå’Œäººè„‘å¿«é€Ÿæ€è€ƒçš„æƒ¯æ€§ï¼Œå…»æˆç†æ€§æ€è¾¨çš„ä¹ æƒ¯ã€‚...\nç¡®å®æˆ‘ä»¬ç„¦è™‘ä¸»è¦æ˜¯æ¥æºäºå¯¹æœªæ¥çš„ä¸ç¡®å®šã€‚æˆ‘ä»¬éœ€è¦å…»æˆç†æ€§æ€è¾¨çš„ä¹ æƒ¯ã€‚\n","permalink":"http://blog.chalme.top/posts/think/%E4%BA%BA%E7%9A%84%E9%80%9A%E7%94%A8%E8%83%BD%E5%8A%9B/","summary":"ä¸–ç•Œä¸Šçš„äººåˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯â€œæ€è¾¨è€…â€ï¼Œè€Œå¦ä¸€ç§å°±æ˜¯â€œåƒç“œç¾¤ä¼—â€ã€‚\nè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£ä¸”æ·±åˆ»çš„é—®é¢˜ã€‚ä½œä¸ºä¸€ä¸ªå¼€å‘è€…ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½ä¸“äºç ”å‘æ–¹é¢ï¼Œåœ¨æ•´ä½“æ–¹é¢æ€è€ƒçš„æ¯”è¾ƒå°‘ã€‚ä½œä¸ºäººï¼Œæˆ‘ä¸ªäººè®¤ä¸ºéƒ½éœ€è¦è¿›è¡Œå‘å±•ã€‚\nchatGPTçš„ä¸€ç§ç­”æ¡ˆ é€šç”¨èƒ½åŠ›æ˜¯æŒ‡ä¸€ä¸ªäººå…·æœ‰çš„å¹¿æ³›çš„ã€ç»¼åˆçš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\nè¯­è¨€èƒ½åŠ›ï¼šèƒ½å¤Ÿæ¸…æ™°ã€æµç•…åœ°è¡¨è¾¾æ€æƒ³ã€‚ æ•°å­¦èƒ½åŠ›ï¼šå¯¹æ•°å­¦çŸ¥è¯†çš„ç†è§£å’Œè¿ç”¨èƒ½åŠ›ã€‚ é€»è¾‘æ€ç»´èƒ½åŠ›ï¼šèƒ½å¤Ÿç³»ç»Ÿåœ°åˆ†æå’Œè§£å†³é—®é¢˜ã€‚ åˆ›é€ åŠ›ï¼šå…·æœ‰åˆ›é€ æ€§æ€ç»´å’Œåˆ›æ–°æ„è¯†ã€‚ å­¦ä¹ èƒ½åŠ›ï¼šå…·æœ‰è‡ªä¸»å­¦ä¹ çš„èƒ½åŠ›ã€‚ ç¤¾äº¤èƒ½åŠ›ï¼šèƒ½å¤Ÿä¸ä»–äººè¿›è¡Œæœ‰æ•ˆçš„æ²Ÿé€šå’Œåˆä½œã€‚ æƒ…ç»ªç®¡ç†ï¼šèƒ½å¤Ÿç§¯æé¢å¯¹æŒ‘æˆ˜ï¼Œå¹¶ä¿æŒè‰¯å¥½çš„æƒ…ç»ªçŠ¶æ€ã€‚ è‡ªæˆ‘è°ƒèŠ‚ï¼šå…·æœ‰è‡ªæˆ‘è§„åˆ’å’Œè‡ªæˆ‘è°ƒèŠ‚çš„èƒ½åŠ›ã€‚ å…¨é¢å‘å±•ï¼šå…³æ³¨èº«ä½“ã€å¿ƒç†ã€ç²¾ç¥å’Œç¤¾ä¼šç­‰æ–¹é¢çš„å…¨é¢å‘å±•ã€‚ é€šç”¨èƒ½åŠ›æ˜¯æ¯ä¸ªäººéƒ½åº”è¯¥å…·å¤‡çš„èƒ½åŠ›ï¼Œå®ƒä¸ä»…æ˜¯ä¸€ä¸ªäººçš„ä¸ªäººå‘å±•çš„é‡è¦æŒ‡æ ‡ï¼Œä¹Ÿæ˜¯ä»–çš„ç¤¾ä¼šä»·å€¼çš„ä½“ç°ã€‚\nä¸ªäººè®¤çŸ¥ chatGPTçš„ç­”æ¡ˆåœ¨å„ä¸ªè§’åº¦éƒ½æœ‰æ¶‰åŠï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„å›ç­”ã€‚ é€šè¿‡å®ƒçš„å›ç­”ï¼Œå¯¹åº”åˆ°è‡ªå·±ï¼Œç¡®å®åœ¨æŸäº›æ–¹é¢è¿˜æ˜¯æœ‰æ¯”è¾ƒå¤šçš„ä¸è¶³ã€‚\næœ€è¿‘åœ¨çœ‹ä¸€æœ¬ä¹¦ ã€Šéº¦è‚¯é”¡ç»“æ„åŒ–æˆ˜ç•¥æ€ç»´ã€‹ï¼Œå¯¹äºä¸ªäººæ¥è®²ï¼Œç»“æ„åŒ–æˆ˜æ—…æ€ç»´æœ‰äº†å…·è±¡çš„äº†è§£ï¼Œä¸è¿‡ï¼Œè¿˜éœ€å¤šè¯»å‡ æ¬¡ã€‚\næ–‡ä¸­æœ‰ä¸€å¥è¯è®°å¾—æ¯”è¾ƒæ·±åˆ»ï¼Œâ€œç„¦è™‘â€å¾ˆå¤§ç¨‹åº¦ä¸Šæºäºå¯¹æœªæ¥çš„ä¸ç¡®å®šã€‚...æˆ‘ä»¬éœ€è¦åœ¨æ€ç»´å±‚é¢çªç ´èˆ’é€‚åŒºçš„æŸç¼šå’Œäººè„‘å¿«é€Ÿæ€è€ƒçš„æƒ¯æ€§ï¼Œå…»æˆç†æ€§æ€è¾¨çš„ä¹ æƒ¯ã€‚...\nç¡®å®æˆ‘ä»¬ç„¦è™‘ä¸»è¦æ˜¯æ¥æºäºå¯¹æœªæ¥çš„ä¸ç¡®å®šã€‚æˆ‘ä»¬éœ€è¦å…»æˆç†æ€§æ€è¾¨çš„ä¹ æƒ¯ã€‚","title":"äººçš„é€šç”¨èƒ½åŠ›"},{"content":" æœ¬æ–‡ä¸»è¦æ˜¯ä»æå®¢æ—¶é—´è¯¾ç¨‹ä¸­è®°å½•çš„ç†è®ºç¬”è®°åŠä¸ªäººç»ƒé¢˜çš„è®°å½•ã€‚\næ€»ä½“ç»“æ„ æ—¶é—´åŠç©ºé—´å¤æ‚åº¦ ä¸»å®šç† ç›¸å…³èµ„æ–™\nBig-O Complexity Chart å¸¸è§æ•°æ®ç»“æ„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦\nleetcodeä¹ é¢˜ æ•°ç»„/é“¾è¡¨ åè½¬é“¾è¡¨ /** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode(int x) { val = x; } * } */ class Solution { public ListNode reverseList(ListNode head) { ListNode resNode = null; ListNode tempNode = null; while(head != null) { tempNode = head.next; head.next = resNode; resNode = head; head = tempNode; } return resNode; } } 24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ 141. ç¯å½¢é“¾è¡¨ /** * Definition for singly-linked list. * class ListNode { * int val; * ListNode next; * ListNode(int x) { * val = x; * next = null; * } * } */ public class Solution { public boolean hasCycle(ListNode head) { if (head == null || head.next == null) { return false; } ListNode slow=head, quick = head; while (slow != null \u0026amp;\u0026amp; quick != null) { slow = slow.next; if (quick.next == null) { return false; } else { quick = quick.next.next; } if (slow == quick) { return true; } } return false; } } å †æ ˆ Stack push pop peek Queue offer poll peek\n844. æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸² æ ˆå¤„ç†æ•°æ®åï¼Œå†å¯¹æ¯” é€†åºå¯¹æ¯”ï¼ˆå·§å¦™ï¼‰ 225. ç”¨é˜Ÿåˆ—å®ç°æ ˆ ä¸¤ä¸ªé˜Ÿåˆ—ï¼š å°†ä¸€ä¸ªé˜Ÿåˆ—æ•°æ® offer åˆ°å¦ä¸€ä¸ª 232. ç”¨æ ˆå®ç°é˜Ÿåˆ— ä¸¤ä¸ªå †æ ˆ 20. æœ‰æ•ˆçš„æ‹¬å· å †æ ˆå¤„ç† class Solution { public boolean isValid(String s) { if (s == null) { return false; } Stack\u0026lt;Character\u0026gt; stack = new Stack\u0026lt;\u0026gt;(); Map\u0026lt;Character, Character\u0026gt; base = new HashMap\u0026lt;\u0026gt;(); base.put(\u0026#39;(\u0026#39;, \u0026#39;)\u0026#39;); base.put(\u0026#39;[\u0026#39;, \u0026#39;]\u0026#39;); base.put(\u0026#39;{\u0026#39;, \u0026#39;}\u0026#39;); for (int i=0; i\u0026lt;s.length(); i++) { Character c = s.charAt(i); if (base.containsKey(c)) { stack.push(c); } else { if (!stack.isEmpty() \u0026amp;\u0026amp; base.get(stack.pop()) == c) { } else { return false; } } } return stack.isEmpty(); } } ä¼˜å…ˆé˜Ÿåˆ— å®ç°æœºåˆ¶ï¼š\nå † (Strict Fibonacci) äºŒå‰æœç´¢æ ‘ 703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´  æœ€å°å † O(n*logk) class KthLargest { private PriorityQueue\u0026lt;Integer\u0026gt; priorityQueue; private int k; public KthLargest(int k, int[] nums) { this.k = k; this.priorityQueue = new PriorityQueue\u0026lt;\u0026gt;(k); for (int n: nums) { add(n); } } public int add(int val) { if (priorityQueue.size() \u0026lt; k) { priorityQueue.offer(val); } else if (priorityQueue.peek() \u0026lt; val) { priorityQueue.poll(); priorityQueue.offer(val); } return priorityQueue.peek(); } } /** * Your KthLargest object will be instantiated and called as such: * KthLargest obj = new KthLargest(k, nums); * int param_1 = obj.add(val); */ MAP \u0026amp; SET Hash function ç¢°æ’ 1. ä¸¤æ•°ä¹‹å’Œ Map (key, value) æŸ¥æ‰¾ map o(n) map(value, key) class Solution { public int[] twoSum(int[] nums, int target) { Map\u0026lt;Integer, Integer\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); for (int i=0; i\u0026lt;nums.length; i++) { if (map.get(target - nums[i]) != null) { return new int[]{map.get(target - nums[i]), i}; } else { map.put(nums[i], i); } } return new int[]{}; } } 15. ä¸‰æ•°ä¹‹å’Œ æ’åº\u0026amp;åŒæŒ‡é’ˆ â€”æ³¨æ„è¾¹ç•Œï¼Œåˆ¤æ–­é‡å¤ O(n^2) class Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; threeSum(int[] nums) { int length = nums.length; List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result = new ArrayList\u0026lt;\u0026gt;(); Arrays.sort(nums); for (int i=0; i\u0026lt;length; i++) { if (i != 0 \u0026amp;\u0026amp; nums[i] == nums[i-1]){ continue; } int l = i + 1, r = length -1; while (l \u0026lt; r) { int three = -(nums[i] + nums[l]); while (nums[r] \u0026gt; three \u0026amp;\u0026amp; r-1 \u0026gt; l) { r --; } if (nums[r] == three) { List\u0026lt;Integer\u0026gt; item = new ArrayList\u0026lt;\u0026gt;(); item.add(nums[i]); item.add(nums[l]); item.add(nums[r]); result.add(item); while (l \u0026lt; r-1 \u0026amp;\u0026amp; nums[r] == nums[r-1]) { r = r-1; } while (l+1 \u0026lt; r \u0026amp;\u0026amp; nums[l+1] == nums[l]){ l = l+1; } } l = l+1; } } return result; } } æ ‘ äºŒå‰æ ‘ äºŒå‰æœç´¢æ ‘ 98. éªŒè¯äºŒå‰æœç´¢æ ‘ ä¸­åº array ç”Ÿåºã€‚ o(n) é€’å½’ å·¦å­æ ‘æœ€å¤§å€¼ï¼›å³å­æ ‘æœ€å°å€¼. o(n) /** * ä¸­åºéå† */ private boolean stack(TreeNode root) { Integer tmp = null; Deque\u0026lt;TreeNode\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); while(root != null || !stack.isEmpty()) { while (root != null) { stack.push(root); root = root.left; } root = stack.pop(); if (tmp == null) { tmp = root.val; } else { if (root.val \u0026lt;= tmp) { return false; } else { tmp = root.val; } } root = root.right; } return true; } 235. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ åˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„æ’åºçš„ç‰¹ç‚¹ /** * Definition for a binary tree node. * public class TreeNode { * int val; * TreeNode left; * TreeNode right; * TreeNode(int x) { val = x; } * } */ class Solution { public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) { while (root != null) { if (p.val \u0026lt; root.val \u0026amp;\u0026amp; q.val \u0026lt; root.val) { root = root.left; } else if (p.val \u0026gt; root.val \u0026amp;\u0026amp; q.val \u0026gt; root.val) { root = root.right; } else { return root; } } return root; } } 236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ é€’å½’ findPorQ(root, P, Q). O(n) /** * Definition for a binary tree node. * public class TreeNode { * int val; * TreeNode left; * TreeNode right; * TreeNode(int x) { val = x; } * } */ class Solution { public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) { if (root == null || root == p || root == q) { return root; } TreeNode left = lowestCommonAncestor(root.left, p, q); TreeNode right = lowestCommonAncestor(root.right, p, q); if (left == null) { return right; } else if (right == null) { return left; } else { return root; } } } é€’å½’ã€åˆ†æ²» 50. Pow(x, n) Pow æš´åŠ› å¿«é€Ÿå¹‚ + é€’å½’ å¿«é€Ÿå¹‚ + è¿­ä»£ class Solution { // public double myPow(double x, int n) { // if (n == 0) { // return 1.0; // } else { // return n \u0026gt; 0 ? quickPow(x, n) : 1.0 / quickPow(x, n); // } // } public double myPow(double x,int n) { long t = n; if (t \u0026lt; 0) { t = -t; x = 1/x; } double pow = 1.0; while (t \u0026gt; 0) { if ((t\u0026amp;1) == 1) { pow *= x; } t \u0026gt;\u0026gt;= 1; x = x*x; } return pow; } private double quickPow(double x, int n) { if (n == 0) { return 1.0; } double y = quickPow(x, n/2); return n % 2 == 0 ? y*y : y*y*x; } } 169. å¤šæ•°å…ƒç´  å“ˆå¸Œè¡¨ æ’åº æŠ•ç¥¨ class Solution { /** * 1. hash O(n)/O(n) * 2. æ’åº O(nlgn)/O(nlogn) * 3. æŠ•ç¥¨ O(n)/O(n) */ public int majorityElement(int[] nums) { Integer candidate = null; int count = 0; for (int num : nums) { if (count == 0) { candidate = num; } count += (candidate == num) ? 1 : -1; } return candidate; } } è´ªå¿ƒç®—æ³• greedy é€‚ç”¨ Greedy çš„åœºæ™¯\nç®€å•åœ°è¯´ï¼Œé—®é¢˜èƒ½å¤Ÿåˆ†è§£æˆå­é—®é¢˜æ¥è§£å†³ï¼Œå­é—®é¢˜çš„æœ€ä¼˜è§£èƒ½é€’æ¨åˆ°æœ€ç»ˆé—®é¢˜ çš„æœ€ä¼˜è§£ã€‚è¿™ç§å­é—®é¢˜æœ€ä¼˜è§£æˆä¸ºæœ€ä¼˜å­ç»“æ„ã€‚ è´ªå¿ƒç®—æ³•ä¸åŠ¨æ€è§„åˆ’çš„ä¸åŒåœ¨äºå®ƒå¯¹æ¯ä¸ªå­é—®é¢˜çš„è§£å†³æ–¹æ¡ˆéƒ½åšå‡ºé€‰æ‹©ï¼Œä¸èƒ½ å›é€€ã€‚åŠ¨æ€è§„åˆ’åˆ™ä¼šä¿å­˜ä»¥å‰çš„è¿ç®—ç»“æœï¼Œå¹¶æ ¹æ®ä»¥å‰çš„ç»“æœå¯¹å½“å‰è¿›è¡Œé€‰æ‹© æœ‰å›é€€åŠŸèƒ½ã€‚ æœç´¢ # å¹¿åº¦ä¼˜å…ˆ ï¼ˆé˜Ÿåˆ—\u0026amp;visited set) def BFS(graph. start, end) queue = [] quaue.append([start]) visited.add(start) while queue; node = queue.pop() visited.add (node) process(node) nodes = generate_related_nodes(node) queue.push (nodes) # æ·±åº¦ä¼˜å…ˆ (stack \u0026amp; visited set) visited = set() def dfs(node ,visited)ï¼š visited.add(node) # process current node here. ... for next_node in node. chilgren(): if not next node in visited: dfs(next_node, visited) 102. äºŒå‰æ ‘çš„å±‚åºéå† BFSã€‚o(n) DFS. /** * Definition for a binary tree node. * public class TreeNode { * int val; * TreeNode left; * TreeNode right; * TreeNode() {} * TreeNode(int val) { this.val = val; } * TreeNode(int val, TreeNode left, TreeNode right) { * this.val = val; * this.left = left; * this.right = right; * } * } */ class Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; levelOrder(TreeNode root) { List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); if (root == null) { return res; } Queue\u0026lt;TreeNode\u0026gt; queue = new LinkedList\u0026lt;\u0026gt;(); queue.offer(root); while (!queue.isEmpty()) { List\u0026lt;Integer\u0026gt; item = new ArrayList\u0026lt;\u0026gt;(); int size = queue.size(); for (int i=0; i\u0026lt;size; i++) { TreeNode node = queue.poll(); if (node.left != null) { queue.offer(node.left); } if (node.right != null) { queue.offer(node.right); } item.add(node.val); } res.add(item); } return res; } } 104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ /** * Definition for a binary tree node. * public class TreeNode { * int val; * TreeNode left; * TreeNode right; * TreeNode() {} * TreeNode(int val) { this.val = val; } * TreeNode(int val, TreeNode left, TreeNode right) { * this.val = val; * this.left = left; * this.right = right; * } * } */ class Solution { /** * 1. BFS. O(n) * 2. DFS. O(n) */ public int maxDepth(TreeNode root) { if (root == null) { return 0; } Queue\u0026lt;TreeNode\u0026gt; queue = new LinkedList\u0026lt;\u0026gt;(); queue.offer(root); int ans = 0; while (!queue.isEmpty()) { int size = queue.size(); for (int i=0; i\u0026lt;size; i++) { TreeNode node = queue.poll(); if (node.left != null) { queue.offer(node.left); } if (node.right != null) { queue.offer(node.right); } } ans ++; } return ans; } } class Solution { /** * 1. BFS. O(n) * 2. DFS. O(n) */ public int maxDepth(TreeNode root) { if (root == null) { return 0; } // DFS int leftHeight = maxDepth(root.left); int rightHeight = maxDepth(root.right); return Math.max(leftHeight, rightHeight) + 1; } } 22. æ‹¬å·ç”Ÿæˆ é€’å½’-å‰ªå€¼ class Solution { public List\u0026lt;String\u0026gt; generateParenthesis(int n) { List\u0026lt;String\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); generateParenthesis(\u0026#34;\u0026#34;, res, n, n); return res; } private void generateParenthesis(String sub, List\u0026lt;String\u0026gt; res, int left, int right) { if (left == 0 \u0026amp;\u0026amp; right == 0) { res.add(sub); return; } if (left \u0026gt; 0) { generateParenthesis(sub + \u0026#34;(\u0026#34;, res, left - 1, right); } if (right \u0026gt; left) { generateParenthesis(sub + \u0026#34;)\u0026#34;, res, left, right -1); } } } 51. N çš‡å class Solution { public List\u0026lt;List\u0026lt;String\u0026gt;\u0026gt; solveNQueens(int n) { List\u0026lt;List\u0026lt;String\u0026gt;\u0026gt; res = new ArrayList\u0026lt;\u0026gt;(); int[] queens = new int[n]; Arrays.fill(queens, -1); Set\u0026lt;Integer\u0026gt; cols = new HashSet\u0026lt;\u0026gt;(); Set\u0026lt;Integer\u0026gt; pie = new HashSet\u0026lt;\u0026gt;(); Set\u0026lt;Integer\u0026gt; na = new HashSet\u0026lt;\u0026gt;(); backtrack(res, queens, n, 0, cols, pie, na); return res; } public void backtrack(List\u0026lt;List\u0026lt;String\u0026gt;\u0026gt; res, int[] queens, int n, int row, Set\u0026lt;Integer\u0026gt; cols, Set\u0026lt;Integer\u0026gt; pie, Set\u0026lt;Integer\u0026gt; na) { if (row == n) { res.add(generateBoard(queens, n)); return; } else { for (int i=0; i\u0026lt;n; i++) { if (cols.contains(i)) { continue; } int pi = row - i; if (pie.contains(pi)) { continue; } int ni = row + i; if (na.contains(ni)) { continue; } queens[row] = i; cols.add(i); pie.add(pi); na.add(ni); backtrack(res, queens, n, row+1, cols, pie, na); queens[row] = -1; cols.remove(i); pie.remove(pi); na.remove(ni); } } } public List\u0026lt;String\u0026gt; generateBoard(int[] queens, int n) { List\u0026lt;String\u0026gt; res = new ArrayList\u0026lt;String\u0026gt;(); for (int i=0; i\u0026lt;n; i++) { char[] item = new char[n]; Arrays.fill(item, \u0026#39;.\u0026#39;); item[queens[i]] = \u0026#39;Q\u0026#39;; res.add(new String(item)); } return res; } } 36. æœ‰æ•ˆçš„æ•°ç‹¬ 37. è§£æ•°ç‹¬\nå›æº¯ line[9], col[9], block[3][3] çŠ¶æ€å‹ç¼© class Solution { /** * å›æº¯\u0026amp;çŠ¶æ€å‹ç¼©ï¼ˆä½è¿ç®—ï¼‰ */ private int[] row = new int[9]; private int[] column = new int[9]; private int[][] block = new int[3][3]; private List\u0026lt;int[]\u0026gt; spaces = new ArrayList\u0026lt;\u0026gt;(); private boolean valid = false; public void solveSudoku(char[][] board) { for (int i=0; i\u0026lt;9; i++) { for (int j=0; j\u0026lt;9; j++) { if (board[i][j] == \u0026#39;.\u0026#39;) { spaces.add(new int[]{i, j}); } else { int digit = board[i][j] - \u0026#39;0\u0026#39; - 1; flip(i, j, digit); } } } dfs(board, 0); } public void dfs(char[][] board, int pos) { if (pos == spaces.size()) { valid = true; return ; } int[] space = spaces.get(pos); int i = space[0], j = space[1]; // è·å–å¯å¡«å†™çš„æ•°å­— int mask = ~(row[i] | column[j] | block[i/3][j/3]) \u0026amp; 0x1ff; for (; mask!=0 \u0026amp;\u0026amp; !valid; mask \u0026amp;= (mask-1)) { // æœ€ä½ä¸€ä½ int maskDigit = mask \u0026amp; (-mask); int digit = Integer.bitCount(maskDigit - 1); flip(i, j, digit); board[i][j] = (char)(\u0026#39;0\u0026#39; + digit + 1); dfs(board, pos + 1); flip(i, j, digit); } } public void flip(int i, int j, int digit) { row[i] ^= 1\u0026lt;\u0026lt;digit; column[j] ^= 1\u0026lt;\u0026lt;digit; block[i/3][j/3] ^= 1\u0026lt;\u0026lt;digit; } } äºŒåˆ†æŸ¥æ‰¾ sorted bounded accessible by index 69. x çš„å¹³æ–¹æ ¹\u0026mdash;ï¼ˆæµ®ç‚¹æ•°ï¼Œç²¾åº¦ï¼‰ äºŒåˆ† ç‰›é¡¿è¿­ä»£ public class BSearch { static double sqrt2 = 1.4142135624; static double delta = 0.0000000001; public static void main(String[] args) { double l = 1.0; double r = 2.0; int cnt = 0; while (l \u0026lt; r) { double mid = (l + r) / 2; if (Math.abs(l - sqrt2) \u0026lt; delta) { break; } if (mid * mid \u0026gt; 2.0) { r = mid; } else { l = mid; } cnt++; } System.out.println(\u0026#34;ç»è¿‡\u0026#34; + cnt + \u0026#34;æ¬¡è¿­ä»£åå¾—\u0026#34; + l); } } class Solution { public int mySqrt(int x) { int l = 0, r = x, ans = -1; while (l \u0026lt;= r) { int mid = l + (r - l) / 2; if ((long) mid * mid \u0026lt;= x) { ans = mid; l = mid + 1; } else { r = mid - 1; } } return ans; } } class Solution { public int mySqrt(int x) { if (x == 0) { return 0; } double C = x, x0 = x; while (true) { double xi = 0.5 * (x0 + C / x0); if (Math.abs(x0 - xi) \u0026lt; 1e-7) { break; } x0 = xi; } return (int) x0; } } trie å­—å…¸æ ‘ wikipedia\n208. å®ç° Trie (å‰ç¼€æ ‘) class Trie { private Trie[] children; private boolean isEnd; /** Initialize your data structure here. */ public Trie() { children = new Trie[26]; isEnd = false; } /** Inserts a word into the trie. */ public void insert(String word) { Trie root = this; for (int i = 0; i \u0026lt; word.length(); i++) { char c = word.charAt(i); int index = c - \u0026#39;a\u0026#39;; if (root.children[index] == null) { root.children[index] = new Trie(); } root = root.children[index]; } root.isEnd = true; } /** Returns if the word is in the trie. */ public boolean search(String word) { Trie root = this; for (int i = 0; i \u0026lt; word.length(); i++) { char c = word.charAt(i); if (root.children[c - \u0026#39;a\u0026#39;] == null) { return false; } root = root.children[c - \u0026#39;a\u0026#39;]; } return root.isEnd; } /** Returns if there is any word in the trie that starts with the given prefix. */ public boolean startsWith(String prefix) { Trie root = this; for (int i = 0; i \u0026lt; prefix.length(); i++) { char c = prefix.charAt(i); if (root.children[c - \u0026#39;a\u0026#39;] == null) { return false; } root = root.children[c - \u0026#39;a\u0026#39;]; } return true; } } /** * Your Trie object will be instantiated and called as such: * Trie obj = new Trie(); * obj.insert(word); * boolean param_2 = obj.search(word); * boolean param_3 = obj.startsWith(prefix); */ 212. å•è¯æœç´¢ II DFS trie ä½è¿ç®— 191. ä½ 1 çš„ä¸ªæ•° public class Solution { // you need to treat n as an unsigned value public int hammingWeight(int n) { int cnt = 0; while (n != 0) { cnt ++; n \u0026amp;= (n-1); } return cnt; } } 231. 2 çš„å¹‚ class Solution { public boolean isPowerOfTwo(int n) { return n \u0026gt; 0 \u0026amp;\u0026amp; (n \u0026amp; (n-1)) == 0; } } 338. æ¯”ç‰¹ä½è®¡æ•° class Solution { /** * bit[i] = bit[i\u0026amp;(i-1)] + 1 */ public int[] countBits(int n) { int[] bits = new int[n+1]; for (int i = 1; i \u0026lt;= n; i++) { bits[i] = bits[i \u0026amp; (i-1)] + 1; } return bits; } } åŠ¨æ€è§„åˆ’ï¼ˆDP dynamic programming | Echo â€¦ï¼‰ é€’å½’+è®°å¿†åŒ– ä¸€ï¼é€’æ¨ çŠ¶æ€çš„å®šä¹‰ï¼šoptinj, dpinj, fibin] çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼šoptin] = best_of(optin-11, optin-2], .. æœ€ä¼˜å­ç»“æ„ è´ªå¿ƒ ä¸€ æ°¸è¿œå±€éƒ¨æœ€ä¼˜ DP ä¸€ è®°å½•å±€éƒ¨æœ€ä¼˜å­ç»“æ„ / å¤šç§è®°å½•å€¼\nå¹¶æŸ¥é›† wikipedia\nå²›å±¿çš„æ•°é‡ å¹¶æŸ¥é›† bfs class Solution { public int numIslands(char[][] grid) { if (grid == null || grid.length == 0) { return 0; } int nr = grid.length; int nc = grid[0].length; int num_islands = 0; for (int r = 0; r \u0026lt; nr; ++r) { for (int c = 0; c \u0026lt; nc; ++c) { if (grid[r][c] == \u0026#39;1\u0026#39;) { ++num_islands; grid[r][c] = \u0026#39;0\u0026#39;; Queue\u0026lt;Integer\u0026gt; neighbors = new LinkedList\u0026lt;\u0026gt;(); neighbors.add(r * nc + c); while (!neighbors.isEmpty()) { int id = neighbors.remove(); int row = id / nc; int col = id % nc; if (row - 1 \u0026gt;= 0 \u0026amp;\u0026amp; grid[row-1][col] == \u0026#39;1\u0026#39;) { neighbors.add((row-1) * nc + col); grid[row-1][col] = \u0026#39;0\u0026#39;; } if (row + 1 \u0026lt; nr \u0026amp;\u0026amp; grid[row+1][col] == \u0026#39;1\u0026#39;) { neighbors.add((row+1) * nc + col); grid[row+1][col] = \u0026#39;0\u0026#39;; } if (col - 1 \u0026gt;= 0 \u0026amp;\u0026amp; grid[row][col-1] == \u0026#39;1\u0026#39;) { neighbors.add(row * nc + col-1); grid[row][col-1] = \u0026#39;0\u0026#39;; } if (col + 1 \u0026lt; nc \u0026amp;\u0026amp; grid[row][col+1] == \u0026#39;1\u0026#39;) { neighbors.add(row * nc + col+1); grid[row][col+1] = \u0026#39;0\u0026#39;; } } } } } return num_islands; } } // å¹¶æŸ¥é›† class Solution { class UnionFind { int count; int[] parent; int[] rank; public UnionFind(char[][] grid) { count = 0; int m = grid.length; int n = grid[0].length; parent = new int[m * n]; rank = new int[m * n]; for (int i = 0; i \u0026lt; m; ++i) { for (int j = 0; j \u0026lt; n; ++j) { if (grid[i][j] == \u0026#39;1\u0026#39;) { parent[i * n + j] = i * n + j; ++count; } rank[i * n + j] = 0; } } } public int find(int i) { if (parent[i] != i) parent[i] = find(parent[i]); return parent[i]; } public void union(int x, int y) { int rootx = find(x); int rooty = find(y); if (rootx != rooty) { if (rank[rootx] \u0026gt; rank[rooty]) { parent[rooty] = rootx; } else if (rank[rootx] \u0026lt; rank[rooty]) { parent[rootx] = rooty; } else { parent[rooty] = rootx; rank[rootx] += 1; } --count; } } public int getCount() { return count; } } public int numIslands(char[][] grid) { if (grid == null || grid.length == 0) { return 0; } int nr = grid.length; int nc = grid[0].length; int num_islands = 0; UnionFind uf = new UnionFind(grid); for (int r = 0; r \u0026lt; nr; ++r) { for (int c = 0; c \u0026lt; nc; ++c) { if (grid[r][c] == \u0026#39;1\u0026#39;) { grid[r][c] = \u0026#39;0\u0026#39;; if (r - 1 \u0026gt;= 0 \u0026amp;\u0026amp; grid[r-1][c] == \u0026#39;1\u0026#39;) { uf.union(r * nc + c, (r-1) * nc + c); } if (r + 1 \u0026lt; nr \u0026amp;\u0026amp; grid[r+1][c] == \u0026#39;1\u0026#39;) { uf.union(r * nc + c, (r+1) * nc + c); } if (c - 1 \u0026gt;= 0 \u0026amp;\u0026amp; grid[r][c-1] == \u0026#39;1\u0026#39;) { uf.union(r * nc + c, r * nc + c - 1); } if (c + 1 \u0026lt; nc \u0026amp;\u0026amp; grid[r][c+1] == \u0026#39;1\u0026#39;) { uf.union(r * nc + c, r * nc + c + 1); } } } } return uf.getCount(); } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","summary":"æœ¬æ–‡ä¸»è¦æ˜¯ä»æå®¢æ—¶é—´è¯¾ç¨‹ä¸­è®°å½•çš„ç†è®ºç¬”è®°åŠä¸ªäººç»ƒé¢˜çš„è®°å½•ã€‚\næ€»ä½“ç»“æ„ æ—¶é—´åŠç©ºé—´å¤æ‚åº¦ ä¸»å®šç† ç›¸å…³èµ„æ–™\nBig-O Complexity Chart å¸¸è§æ•°æ®ç»“æ„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦\nleetcodeä¹ é¢˜ æ•°ç»„/é“¾è¡¨ åè½¬é“¾è¡¨ /** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode(int x) { val = x; } * } */ class Solution { public ListNode reverseList(ListNode head) { ListNode resNode = null; ListNode tempNode = null; while(head != null) { tempNode = head.next; head.next = resNode; resNode = head; head = tempNode; } return resNode; } } 24.","title":"ç®—æ³•ä¸æ•°æ®ç»“æ„"},{"content":"ç¼“å­˜ åŸºæœ¬ä¸Šæ¥è¯´ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ€è€—æ€§èƒ½çš„åœ°æ–¹å°±æ˜¯æœ€åç«¯çš„æ•°æ®åº“äº†ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œåªè¦å°å¿ƒç»´æŠ¤å¥½ï¼Œæ•°æ®åº“å››ç§æ“ä½œï¼ˆselectã€updateã€insert å’Œ deleteï¼‰ä¸­çš„ä¸‰ä¸ªå†™æ“ä½œ insertã€update å’Œ delete ä¸å¤ªä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼ˆinsert ä¸€èˆ¬ä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œupdate å’Œ delete ä¸€èˆ¬ä¼šæœ‰ä¸»é”®ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå¤ªæ…¢ï¼‰ã€‚é™¤éç´¢å¼•å»ºå¾—å¤ªå¤šï¼Œè€Œæ•°æ®åº“é‡Œçš„æ•°æ®åˆå¤ªå¤šï¼Œè¿™ä¸‰ä¸ªæ“ä½œæ‰ä¼šå˜æ…¢ã€‚ ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œselect æ˜¯å‡ºç°æ€§èƒ½é—®é¢˜æœ€å¤§çš„åœ°æ–¹ã€‚ä¸€æ–¹é¢ï¼Œselect ä¼šæœ‰å¾ˆå¤šåƒ joinã€groupã€orderã€like ç­‰è¿™æ ·ä¸°å¯Œçš„è¯­ä¹‰ï¼Œè€Œè¿™äº›è¯­ä¹‰æ˜¯éå¸¸è€—æ€§èƒ½çš„ï¼›å¦ä¸€æ–¹é¢ï¼Œå¤§å¤šæ•°åº”ç”¨éƒ½æ˜¯è¯»å¤šå†™å°‘ï¼Œæ‰€ä»¥åŠ å‰§äº†æ…¢æŸ¥è¯¢çš„é—®é¢˜ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿œç¨‹è°ƒç”¨ä¹Ÿä¼šæ¶ˆè€—å¾ˆå¤šèµ„æºï¼Œå› ä¸ºç½‘ç»œå¼€é”€ä¼šå¯¼è‡´æ•´ä½“çš„å“åº”æ—¶é—´ä¸‹é™ã€‚ä¸ºäº†æŒ½æ•‘è¿™æ ·çš„æ€§èƒ½å¼€é”€ï¼Œåœ¨ä¸šåŠ¡å…è®¸çš„æƒ…å†µï¼ˆä¸éœ€è¦å¤ªå®æ—¶çš„æ•°æ®ï¼‰ä¸‹ï¼Œä½¿ç”¨ç¼“å­˜æ˜¯éå¸¸å¿…è¦çš„äº‹æƒ…ã€‚ è®¾è®¡çš„é‡ç‚¹ï¼š\nåœ¨åˆ†å¸ƒå¼æ¶æ„ä¸‹ï¼Œä¸€èˆ¬éƒ½éœ€è¦ä¸€ä¸ªå¤–éƒ¨çš„ç¼“å­˜é›†ç¾¤ã€‚å…³äºè¿™ä¸ªç¼“å­˜é›†ç¾¤ï¼Œä½ éœ€è¦ä¿è¯çš„æ˜¯å†…å­˜è¦è¶³å¤Ÿå¤§ï¼Œç½‘ç»œå¸¦å®½ä¹Ÿè¦å¥½ï¼Œå› ä¸ºç¼“å­˜æœ¬è´¨ä¸Šæ˜¯ä¸ªå†…å­˜å’Œ IO å¯†é›†å‹çš„åº”ç”¨ã€‚ ç¼“å­˜çš„å¥½åè¦çœ‹å‘½ä¸­ç‡ã€‚ç¼“å­˜çš„å‘½ä¸­ç‡é«˜è¯´æ˜ç¼“å­˜æœ‰æ•ˆï¼Œä¸€èˆ¬æ¥è¯´å‘½ä¸­ç‡åˆ° 80% ä»¥ä¸Šå°±ç®—å¾ˆé«˜äº†ã€‚å½“ç„¶ï¼Œæœ‰çš„ç½‘ç»œä¸ºäº†è¿½æ±‚æ›´é«˜çš„æ€§èƒ½ï¼Œè¦åšåˆ° 95% ä»¥ä¸Šï¼Œç”šè‡³å¯èƒ½ä¼šæŠŠæ•°æ®åº“é‡Œçš„æ•°æ®å‡ ä¹å…¨éƒ¨è£…è¿›ç¼“å­˜ä¸­ã€‚ ç¼“å­˜æ˜¯é€šè¿‡ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥æé«˜æ€§èƒ½çš„ï¼Œè¿™ä¸–ä¸Šä»»ä½•äº‹æƒ…éƒ½ä¸æ˜¯å…è´¹çš„ ç¼“å­˜æ•°æ®çš„æ—¶é—´å‘¨æœŸä¹Ÿéœ€è¦å¥½å¥½è®¾è®¡ ä½¿ç”¨ç¼“å­˜çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ LRU ç­–ç•¥ ç¼“å­˜æ˜¯æé«˜æ€§èƒ½æœ€å¥½çš„æ–¹å¼ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜æœ‰ä»¥ä¸‹ä¸‰ç§æ¨¡å¼ã€‚\nCache Aside æ›´æ–°æ¨¡å¼ å¤±æ•ˆï¼šåº”ç”¨ç¨‹åºå…ˆä» Cache å–æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å¾—åˆ°ï¼Œåˆ™ä»æ•°æ®åº“ä¸­å–æ•°æ®ï¼ŒæˆåŠŸåï¼Œæ”¾åˆ°ç¼“å­˜ä¸­ã€‚ å‘½ä¸­ï¼šåº”ç”¨ç¨‹åºä» Cache ä¸­å–æ•°æ®ï¼Œå–åˆ°åè¿”å›ã€‚ æ›´æ–°ï¼šå…ˆæŠŠæ•°æ®å­˜åˆ°æ•°æ®åº“ä¸­ï¼ŒæˆåŠŸåï¼Œå†è®©ç¼“å­˜å¤±æ•ˆã€‚\nå½“ç„¶ï¼Œæœ€å¥½è¿˜æ˜¯ä¸ºç¼“å­˜è®¾ç½®å¥½è¿‡æœŸæ—¶é—´ã€‚\nä¸ºä»€ä¹ˆä¸å»ç›´æ¥æ›´æ–°ï¼Ÿ ä¸»è¦æ˜¯æ€•ä¸¤ä¸ªå¹¶å‘çš„å†™æ“ä½œå¯¼è‡´è„æ•°æ®ã€‚\nCache Aside å°±ä¸ä¼šæœ‰å¹¶å‘é—®é¢˜äº†ï¼Ÿ æ¯”å¦‚ï¼Œä¸€ä¸ªæ˜¯è¯»æ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œå°±ä¼šåˆ°æ•°æ®åº“ä¸­å–æ•°æ®ã€‚è€Œæ­¤æ—¶æ¥äº†ä¸€ä¸ªå†™æ“ä½œï¼Œå†™å®Œæ•°æ®åº“åï¼Œè®©ç¼“å­˜å¤±æ•ˆï¼Œç„¶åä¹‹å‰çš„é‚£ä¸ªè¯»æ“ä½œå†æŠŠè€çš„æ•°æ®æ”¾è¿›å»ï¼Œæ‰€ä»¥ä¼šé€ æˆè„æ•°æ®ã€‚\nRead/Write Through æ›´æ–°æ¨¡å¼ ç¼“å­˜ç”±æ•°æ®åº“ä»£ç†ã€‚ ç¼“å­˜å’Œæ•°æ®åº“ä¸ºä¸€ä½“ã€‚\nwirte æ›´æ–°æ¨¡å¼ ç›´æ¥å†™æ•°æ®åº“ï¼Œ é€šè¿‡ä¸­é—´ä»¶ï¼ˆç²¾å«ï¼‰å†™å…¥ç¼“å­˜ã€‚\nå¼‚æ­¥å¤„ç† å¼‚æ­¥é€šè®¯çš„è®¾è®¡æ¨¡å¼ ï¼š æé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå®¹é”™èƒ½åŠ›ã€‚ å¢åŠ æ•´ä¸ªç³»ç»Ÿçš„ååé‡ï¼Œä»è€Œå¯ä»¥é¢å¯¹æ›´é«˜çš„å¹¶å‘ï¼Œå¹¶å¯ä»¥ä»å®¹åœ°åˆ©ç”¨å¥½ç°æœ‰çš„ç³»ç»Ÿèµ„æºã€‚\nå½“ä½ åœ¨åšä¸€ä»¶äº‹çš„æ—¶å€™ï¼Œå¦‚æœæœ‰åˆ«äººæ¥æ‰¾ä½ åšå…¶å®ƒäº‹ï¼Œä½ å°±ä¼šè¢«æ‰“æ–­è€Œè¦å»å¹²åˆ«çš„äº‹ã€‚è€Œå¦‚æœä½ å¯ä»¥ç»Ÿç­¹å®‰æ’è¿™äº›äº‹æƒ…ï¼Œæœ¬æ¥äº”ä»¶äº‹åªéœ€è¦ 2 ä¸ªå°æ—¶ï¼Œå¦‚æœä¸èƒ½ï¼Œæˆ–è€…è€è¢«åˆ«äººæ‰“ä¹±æ€è·¯ï¼Œé‚£ä½ å¯èƒ½å°±è¦èŠ± 5 ä¸ªå°æ—¶ã€‚å¼‚æ­¥å¤„ç†ä»»åŠ¡å¯ä»¥è®©ä½ æ›´å¥½åœ°åˆ©ç”¨å¥½æ—¶é—´å’Œèµ„æºã€‚åˆ©ç”¨å¥½äº†æ—¶é—´å’Œèµ„æºï¼Œæ€§èƒ½è‡ªç„¶å°±ä¼šæå‡ä¸Šæ¥ã€‚\nè¿™å°±å¥½åƒé‚®é€’ä¸šåŠ¡ä¸€æ ·ï¼Œä½ å¯„ä¸œè¥¿çš„æ—¶å€™ï¼Œé‚®é€’å…¬å¸ä¼šæŠŠå¤§é‡çš„å»å¾€åŒä¸€ä¸ªæ–¹å‘çš„è®¢å•åˆå¹¶å¤„ç†ï¼Œå¹¶ç»Ÿä¸€åœ°è°ƒé…ç‰©æµäº¤é€šå·¥å…·ï¼Œä»è€Œåœ¨æ•´ä½“ä¸Šæ›´ä¸ºèŠ‚çœèµ„æºå’Œæ—¶é—´ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œmerge æ˜¯æŠŠç›¸åŒçš„æ“ä½œåˆå¹¶ï¼Œç›¸åŒçš„è¯»æ“ä½œåªè¯»ä¸€æ¬¡ï¼Œç›¸åŒçš„å†™æ“ä½œï¼Œåªå†™æœ€åä¸€æ¬¡ï¼Œè€Œ sort æ˜¯æŠŠä¸åŒçš„æ“ä½œæ’ä¸ªåºï¼Œè¿™æ ·å¯ä»¥è®©ç¡¬ç›˜å‘ä¸€ä¸ªæ–¹å‘è½¬ä¸€æ¬¡å°±å¯ä»¥æŠŠæ‰€æœ‰çš„æ•°æ®è¯»å‡ºæ¥ï¼Œè€Œä¸æ˜¯æ¥æ¥å›å›åœ°è½¬ã€‚è¿™æ ·å¯ä»¥æå¤§åœ°æé«˜ç¡¬ç›˜çš„ååç‡ã€‚ å¤šè¯´ä¸€å¥ï¼Œå°±ç®—æ˜¯æœ‰å»¶æ—¶ï¼Œå¼‚æ­¥å¤„ç†åœ¨ç”¨æˆ·ä½“éªŒä¸Šä¹Ÿå¯ä»¥ç»™ç”¨æˆ·å¸¦æ¥ä¸€ä¸ªä¸é”™çš„ç”¨æˆ·ä½“éªŒï¼Œé‚£å°±æ˜¯ç”¨æˆ·å¯ä»¥æœ‰æœºä¼šåæ‚”ä¹‹å‰çš„æ“ä½œã€‚ è¿™å°±æ˜¯å¼‚æ­¥ç³»ç»Ÿæ‰€å¸¦æ¥çš„å¥½å¤„â€”â€”è®©æˆ‘ä»¬çš„ç³»ç»Ÿå¯ä»¥ç»Ÿä¸€è°ƒåº¦ã€‚\nè®¾è®¡ï¼š é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‰å°ç³»ç»Ÿï¼ŒæŠŠç”¨æˆ·å‘æ¥çš„è¯·æ±‚ä¸€ä¸€è®°å½•ä¸‹æ¥ï¼Œæœ‰ç‚¹åƒè¯·æ±‚æ—¥å¿—ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„æ“ä½œåœ¨æ•°æ®åº“æˆ–æ˜¯å­˜å‚¨ä¸Šåªä¼šæœ‰è¿½åŠ çš„æ“ä½œï¼Œæ€§èƒ½ä¼šå¾ˆé«˜ã€‚æˆ‘ä»¬æ”¶åˆ°è¯·æ±‚åï¼Œç»™å®¢æˆ·ç«¯è¿”å›â€œæ”¶åˆ°è¯·æ±‚ï¼Œæ­£åœ¨å¤„ç†ä¸­â€ã€‚\nç„¶åï¼Œæˆ‘ä»¬æœ‰ä¸ªä»»åŠ¡å¤„ç†ç³»ç»Ÿæ¥çœŸæ­£åœ°å¤„ç†æ”¶åˆ°çš„è¿™äº›è¯·æ±‚ã€‚ä¸ºäº†è§£è€¦ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä»»åŠ¡æ´¾å‘å™¨ï¼Œè¿™é‡Œå°±ä¼šå‡ºæ¥ä¸¤ä¸ªäº‹ï¼Œä¸€ä¸ªæ˜¯æ¨æ¨¡å‹ Pushï¼Œä¸€ä¸ªæ˜¯æ‹‰æ¨¡å‹ Pullã€‚\nå¼‚æ­¥å¤„ç†çš„è®¾è®¡è¦ç‚¹ï¼š å¼‚æ­¥å¤„ç†ä¸­çš„äº‹ä»¶é©±åŠ¨å’Œäº‹ä»¶æº¯æºæ˜¯ä¸¤ä¸ªæ¯”è¾ƒå…³é”®çš„æŠ€æœ¯ã€‚ å¼‚æ­¥å¤„ç†å¯èƒ½ä¼šå› ä¸ºä¸€äº›æ•…éšœå¯¼è‡´æˆ‘ä»¬çš„ä¸€äº›ä»»åŠ¡æ²¡æœ‰è¢«å¤„ç†ï¼Œæ¯”å¦‚æ¶ˆæ¯ä¸¢å¤±ï¼Œæ²¡æœ‰é€šçŸ¥åˆ°ï¼Œæˆ–é€šçŸ¥åˆ°äº†ï¼Œæ²¡æœ‰å¤„ç†ã€‚æœ‰è¿™ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œå¼‚æ­¥é€šçŸ¥çš„æ–¹å¼éœ€è¦ä»»åŠ¡å¤„ç†æ–¹å¤„ç†å®Œæˆåï¼Œç»™ä»»åŠ¡å‘èµ·æ–¹å›ä¼ çŠ¶æ€ï¼Œè¿™æ ·ç¡®ä¿ä¸ä¼šæœ‰æ¼æ‰çš„ã€‚ å‘èµ·æ–¹ä¹Ÿéœ€è¦æœ‰ä¸ªå®šæ—¶ä»»åŠ¡ï¼ŒæŠŠä¸€äº›è¶…æ—¶æ²¡æœ‰å›ä¼ çŠ¶æ€çš„ä»»åŠ¡å†é‡æ–°åšä¸€éï¼Œä½ å¯ä»¥è®¤ä¸ºè¿™æ˜¯å¼‚æ­¥ç³»ç»Ÿä¸­çš„ \u0026quot; å¯¹è´¦ \u0026quot; åŠŸèƒ½ã€‚å½“ç„¶ï¼Œå¦‚æœè¦é‡åšçš„è¯ï¼Œå°±éœ€è¦å¤„ç†æ–¹æ”¯æŒå¹‚ç­‰æ€§å¤„ç†ã€‚ å¼‚æ­¥å¤„ç†çš„æ•´ä½“ä¸šåŠ¡äº‹åŠ¡é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¼‚æ­¥å¤„ç†åœ¨å¤„ç†ä»»åŠ¡çš„æ—¶å€™ï¼Œå¹¶ä¸çŸ¥é“èƒ½å¦å¤„ç†æˆåŠŸï¼Œäºæ˜¯å°±ä¼šä¸€æ­¥ä¸€æ­¥åœ°å¤„ç†ï¼Œå¦‚æœåˆ°æœ€åä¸€æ­¥ä¸èƒ½æˆåŠŸï¼Œé‚£ä¹ˆä½ å°±éœ€è¦å›æ»šã€‚è¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦èµ°æˆ‘ä»¬åœ¨å¼¹åŠ›è®¾è®¡ä¸­è¯´çš„è¡¥å¿äº‹åŠ¡çš„æµç¨‹ã€‚\nå¼‚æ­¥å¤„ç†ç³»ç»Ÿçš„æœ¬è´¨æ˜¯æŠŠè¢«åŠ¨çš„ä»»åŠ¡å¤„ç†å˜æˆä¸»åŠ¨çš„ä»»åŠ¡å¤„ç†ï¼Œå…¶æœ¬è´¨æ˜¯åœ¨å¯¹ä»»åŠ¡è¿›è¡Œè°ƒåº¦å’Œç»Ÿç­¹ç®¡ç†ã€‚\näº‹ä»¶æº¯æº ä¸»è¦æƒ³è§£å†³çš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®åº“ä¸­çš„ä¸€ä¸ªæ•°æ®çš„å€¼ï¼ˆçŠ¶æ€ï¼‰ï¼Œä½†æˆ‘ä»¬å®Œå…¨ä¸çŸ¥é“è¿™ä¸ªå€¼æ˜¯æ€ä¹ˆå¾—å‡ºæ¥çš„ã€‚å°±åƒé“¶è¡Œçš„å­˜æŠ˜ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é“¶è¡Œçš„å­˜æŠ˜çœ‹åˆ°æˆ‘ä»¬æ”¶æ”¯çš„æ‰€æœ‰è®°å½•ï¼Œä¹Ÿèƒ½çœ‹å¾—åˆ°æ¯ä¸€ç¬”è®°å½•åçš„ä½™é¢ã€‚\nå½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰äº†æ‰€æœ‰çš„æ”¶æ”¯æµæ°´è´¦çš„è®°å½•ï¼Œæˆ‘ä»¬å®Œå…¨ä¸éœ€è¦ä¿å­˜ä½™é¢ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦å›æ”¾ä¸€ä¸‹æ‰€æœ‰çš„æ”¶æ”¯äº‹ä»¶ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„æ•°æ®çŠ¶æ€ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå°±ä¼šå˜å¾—éå¸¸ç®€å•ï¼Œåªéœ€è¦è¿½åŠ ä¸å¯ä¿®æ”¹çš„æ•°æ®æ“ä½œäº‹ä»¶ï¼Œè€Œä¸æ˜¯ä¿å­˜æœ€ç»ˆçŠ¶æ€ã€‚é™¤äº†å¯ä»¥æé«˜æ€§èƒ½å’Œå“åº”æ—¶é—´ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æä¾›äº‹åŠ¡æ•°æ®ä¸€è‡´æ€§ï¼Œå¹¶ä¿ç•™äº†å¯ä»¥å¯ç”¨è¡¥å¿æ“ä½œçš„å®Œæ•´è®°å½•å’Œå†å²è®°å½•ã€‚ è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å¦‚æœæˆ‘ä»¬çš„ä»£ç é‡Œæœ‰äº† bugï¼Œåœ¨è®°å½•çŠ¶æ€çš„ç³»ç»Ÿé‡Œï¼Œæˆ‘ä»¬ä¿®æ”¹ bug åè¿˜éœ€è¦åšæ•°æ®ä¿®æ­£ã€‚ç„¶è€Œï¼Œåœ¨ Event Sourcing çš„ç³»ç»Ÿé‡Œï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ‰€æœ‰äº‹ä»¶é‡æ–°æ’­æ”¾ä¸€éå°±å¥½äº†ï¼Œå› ä¸ºæ•´ä¸ªç³»ç»Ÿæ²¡æœ‰çŠ¶æ€äº†ã€‚\näº‹ä»¶ä¸å¯å˜ï¼Œå¹¶ä¸”å¯ä½¿ç”¨åªè¿½åŠ æ“ä½œè¿›è¡Œå­˜å‚¨ã€‚ ç”¨æˆ·ç•Œé¢ã€å·¥ä½œæµæˆ–å¯åŠ¨äº‹ä»¶çš„è¿›ç¨‹å¯ç»§ç»­ï¼Œå¤„ç†äº‹ä»¶çš„ä»»åŠ¡å¯åœ¨åå°å¼‚æ­¥è¿è¡Œã€‚ æ­¤å¤–ï¼Œå¤„ç†äº‹åŠ¡æœŸé—´ä¸å­˜åœ¨äº‰ç”¨ï¼Œè¿™ä¸¤ç‚¹å¯æå¤§æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§ã€‚\næœ€é‡è¦çš„æ˜¯ï¼Œå¼‚æ­¥å¤„ç† + äº‹ä»¶æº¯æºçš„æ–¹å¼ï¼Œå¯ä»¥å¾ˆå¥½åœ°è®©æˆ‘ä»¬çš„æ•´ä¸ªç³»ç»Ÿè¿›è¡Œä»»åŠ¡çš„ç»Ÿç­¹å®‰æ’ã€æ‰¹é‡å¤„ç†ï¼Œå¯ä»¥è®©æ•´ä½“å¤„ç†è¿‡ç¨‹è¾¾åˆ°æ€§èƒ½å’Œèµ„æºçš„æœ€å¤§åŒ–åˆ©ç”¨ã€‚\næ•°æ®åº“æ‰©å±• è¯»å†™åˆ†ç¦» CQRS è¿™æ ·çš„æ–¹æ³•å¥½å¤„æ˜¯ï¼š\næ¯”è¾ƒå®¹æ˜“å®ç°ã€‚æ•°æ®åº“çš„ master-slave çš„é…ç½®å’ŒæœåŠ¡æ¡†æ¶é‡Œçš„è¯»å†™åˆ†ç¦»éƒ½æ¯”è¾ƒæˆç†Ÿï¼Œåº”ç”¨èµ·æ¥ä¹Ÿå¾ˆå¿«ã€‚ å¯ä»¥å¾ˆå¥½åœ°æŠŠå„ä¸ªä¸šåŠ¡éš”ç¦»å¼€æ¥ã€‚ä¸ä¼šå› ä¸ºä¸€ä¸ªä¸šåŠ¡æŠŠæ•°æ®åº“æ‹–æ­»è€Œå¯¼è‡´æ‰€æœ‰çš„ä¸šåŠ¡éƒ½æ­»æ‰ã€‚ å¯ä»¥å¾ˆå¥½åœ°åˆ†æ‹…æ•°æ®åº“çš„è¯»è´Ÿè½½ï¼Œæ¯•ç«Ÿè¯»æ“ä½œæ˜¯æœ€è€—æ•°æ®åº“ CPU çš„æ“ä½œã€‚ CQRS å…¨ç§° Command and Query Responsibility Segregationï¼Œä¹Ÿå°±æ˜¯å‘½ä»¤ä¸æŸ¥è¯¢èŒè´£åˆ†ç¦»ã€‚å…¶åŸç†æ˜¯ï¼Œç”¨æˆ·å¯¹äºä¸€ä¸ªåº”ç”¨çš„æ“ä½œå¯ä»¥åˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯ Command ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„å†™æ“ä½œï¼ˆå¢ï¼Œåˆ ï¼Œæ”¹ï¼‰ï¼Œå¦ä¸€ç§æ˜¯ Query æ“ä½œï¼ˆæŸ¥ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯»æ“ä½œã€‚Query æ“ä½œåŸºæœ¬ä¸Šæ˜¯åœ¨åšæ•°æ®æ•´åˆæ˜¾ç°ï¼Œè€Œ Command æ“ä½œè¿™è¾¹ä¼šæœ‰æ›´é‡çš„ä¸šåŠ¡é€»è¾‘ã€‚åˆ†ç¦»å¼€è¿™ä¸¤ç§æ“ä½œå¯ä»¥åœ¨è¯­ä¹‰ä¸Šåšå¥½åŒºåˆ†ã€‚\nåˆ†åº“åˆ†è¡¨ Sharding å½±å“æ•°æ®åº“æœ€å¤§çš„æ€§èƒ½é—®é¢˜æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œä¸€ä¸ªæ˜¯æ•°æ®åº“ä¸­æ•°æ®çš„å¤§å°ã€‚\nå¯¹äºå‰è€…ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸šåŠ¡ä¸Šæ¥ä¼˜åŒ–ã€‚ä¸€æ–¹é¢ï¼Œç®€åŒ–ä¸šåŠ¡ï¼Œä¸è¦åœ¨æ•°æ®åº“ä¸Šåšå¤ªå¤šçš„å…³è”æŸ¥è¯¢ï¼Œè€Œå¯¹äºä¸€äº›æ›´ä¸ºå¤æ‚çš„ç”¨äºåšæŠ¥è¡¨æˆ–æ˜¯æœç´¢çš„æ•°æ®åº“æ“ä½œï¼Œåº”è¯¥æŠŠå…¶ç§»åˆ°æ›´é€‚åˆçš„åœ°æ–¹ã€‚æ¯”å¦‚ï¼Œç”¨ ElasticSearch æ¥åšæŸ¥è¯¢ï¼Œç”¨ Hadoop æˆ–åˆ«çš„æ•°æ®åˆ†æè½¯ä»¶æ¥åšæŠ¥è¡¨åˆ†æã€‚ å¯¹äºåè€…ï¼Œå¦‚æœæ•°æ®åº“é‡Œçš„æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œé‚£ä¹ˆä¹Ÿä¼šå½±å“æˆ‘ä»¬çš„æ•°æ®æ“ä½œã€‚è€Œä¸”ï¼Œå¯¹äºæˆ‘ä»¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¥è¯´ï¼Œåç«¯æœåŠ¡éƒ½å¯ä»¥åšæˆåˆ†å¸ƒå¼çš„ï¼Œè€Œæ•°æ®åº“æœ€å¥½ä¹Ÿæ˜¯å¯ä»¥æ‹†å¼€æˆåˆ†å¸ƒå¼çš„ã€‚è¯»å†™åˆ†ç¦»ä¹Ÿå› ä¸ºæ•°æ®åº“é‡Œçš„æ•°æ®å¤ªå¤šè€Œå˜æ…¢ï¼Œäºæ˜¯ï¼Œåˆ†åº“åˆ†è¡¨å°±æˆäº†æˆ‘ä»¬å¿…é¡»ç”¨çš„æ‰‹æ®µã€‚ å¸¦æ¥çš„é—®é¢˜ï¼š\nMax/Min/Count è¿™æ ·çš„æ“ä½œã€‚ åˆå¹¶è¿”å› join äº‹åŠ¡ åˆ†åº“åˆ†ç‰‡ç­–ç•¥ï¼š\nç§Ÿæˆ· ID æŒ‰æ•°æ®çš„ç§ç±»æ¥åˆ† é€šè¿‡èŒƒå›´æ¥åˆ† é€šè¿‡å“ˆå¸Œæ•£åˆ—ç®—æ³•æ¥åˆ†ï¼ˆæ¯”å¦‚ï¼šä¸»é”® id % 3 ä¹‹ç±»çš„ç®—æ³•ã€‚ï¼‰æ­¤ç­–ç•¥çš„ç›®çš„æ˜¯é™ä½å½¢æˆçƒ­ç‚¹çš„å¯èƒ½æ€§ï¼ˆæ¥æ”¶ä¸æˆæ¯”ä¾‹çš„è´Ÿè½½çš„åˆ†ç‰‡ï¼‰ã€‚ åˆ†ç‰‡æ¨¡å¼é€‰æ‹©ï¼š\næ•°æ®åº“åˆ†ç‰‡å¿…é¡»è€ƒè™‘ä¸šåŠ¡ï¼Œä»ä¸šåŠ¡çš„è§’åº¦å…¥æ‰‹ï¼Œè€Œä¸æ˜¯ä»æŠ€æœ¯çš„è§’åº¦å…¥æ‰‹ï¼Œå¦‚æœä½ ä¸æ¸…æ¥šä¸šåŠ¡ï¼Œé‚£ä¹ˆæ— æ³•åšå‡ºå¥½çš„åˆ†ç‰‡ç­–ç•¥ã€‚ è¯·åªè€ƒè™‘ä¸šåŠ¡åˆ†ç‰‡ã€‚è¯·ä¸è¦èµ°å“ˆå¸Œæ•£åˆ—çš„åˆ†ç‰‡æ–¹å¼ï¼Œé™¤éæœ‰ä¸ªäººæ‹¿ç€åˆ€æŠŠä½ é€¼åˆ°å¢™è§’ï¼Œä½ é©¬ä¸Šå°±æœ‰ç”Ÿå‘½å±é™©ï¼Œä½ æ‰èƒ½èµ°å“ˆå¸Œæ•£åˆ—çš„åˆ†ç‰‡æ–¹å¼ã€‚ è®¾è®¡é‡ç‚¹ï¼š åœ¨ä¸€ä¸ªå•ä½“çš„åº“ä¸Šåšè¯»å†™åˆ†ç¦»æˆ–æ˜¯åšåˆ†ç‰‡éƒ½æ˜¯ä¸€ä»¶æ²»æ ‡ä¸æ²»æœ¬çš„äº‹ï¼ŒçœŸæ­£æ²»æœ¬çš„æ–¹æ³•å°±æ˜¯**è¦å’ŒæœåŠ¡ä¸€èµ·æ‹†è§£ã€‚**æœ‰ä¸¤ç§åˆ†ç‰‡æ¨¡å¼ï¼Œä¸€ç§æ˜¯æ°´å¹³åˆ†ç‰‡ï¼Œä¸€ç§æ˜¯å‚ç›´åˆ†ç‰‡ã€‚\næ°´å¹³åˆ†ç‰‡éœ€è¦æœ‰ä»¥ä¸‹ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š\néšç€æ•°æ®åº“ä¸­æ•°æ®çš„å˜åŒ–ï¼Œæˆ‘ä»¬æœ‰å¯èƒ½éœ€è¦å®šæœŸé‡æ–°å¹³è¡¡åˆ†ç‰‡ï¼Œä»¥ä¿è¯å‡åŒ€åˆ†å¸ƒå¹¶é™ä½å½¢æˆçƒ­ç‚¹çš„å¯èƒ½æ€§ã€‚ å‡å°‘å¹³è¡¡çš„æ¬¡æ•°ã€‚ å¿«é€Ÿé‡æ–°å¹³è¡¡åˆ†ç‰‡çš„å·¥å…·å’Œè„šæœ¬ã€‚ åˆ†ç‰‡æ˜¯é™æ€çš„ï¼Œè€Œæ•°æ®çš„è®¿é—®åˆ™æ˜¯ä¸å¯é¢„æœŸçš„ï¼Œå¯èƒ½éœ€è¦ç»å¸¸æ€§åœ°è°ƒæ•´æˆ‘ä»¬çš„åˆ†ç‰‡ï¼Œè¿™æ ·ä¸€æ¥æˆæœ¬å¤ªé«˜ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ€å¥½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•è¡¨çš„æ–¹å¼æ¥è¿›è¡Œåˆ†ç‰‡ã€‚ æ•°æ®åˆ†ç‰‡åï¼Œæˆ‘ä»¬å¾ˆéš¾åœ¨åˆ†ç‰‡ä¹‹é—´ä¿æŒå¼•ç”¨å®Œæ•´æ€§å’Œä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„è·¨åˆ†ç‰‡çš„äº‹åŠ¡ï¼Œå› æ­¤åº”å°½é‡å‡å°‘ä¼šå½±å“å¤šä¸ªåˆ†ç‰‡ä¸­çš„æ•°æ®çš„æ“ä½œã€‚å¦‚æœåº”ç”¨ç¨‹åºå¿…é¡»è·¨åˆ†ç‰‡ä¿®æ”¹æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è¯„ä¼°ä¸€è‡´æ€§ä»¥åŠè¯„ä¼°æ˜¯å¦é‡‡ç”¨ä¸¤é˜¶æ®µæäº¤çš„æ–¹å¼ã€‚ é…ç½®å’Œç®¡ç†å¤§é‡åˆ†ç‰‡å¯èƒ½æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚åœ¨åšç›¸åº”çš„å˜æ›´æ—¶ï¼Œä¸€å®šè¦å…ˆä»ç”Ÿäº§çº¿ä¸Šæ‹‰å‡ºæ•°æ®ï¼Œç„¶åæ ¹æ®æ•°æ®è®¡åˆ’å¥½æ–°çš„åˆ†ç‰‡æ–¹å¼ï¼Œå¹¶åšå¥½ç›¸å½“çš„æµ‹è¯•å·¥ä½œã€‚å¦åˆ™ï¼Œè¿™ä¸ªäº‹å‡ºäº†é—®é¢˜ä¼šæ˜¯ä¸€ä¸ªç¾éš¾æ€§çš„é—®é¢˜ã€‚ ç§’æ€ åœºæ™¯ï¼š â€œç§’æ€â€å…¶å®æ˜¯å•†å®¶ä¸ºäº†ä¿ƒé”€ï¼Œä½¿ç”¨éå¸¸ä½çš„ä»·æ ¼é”€å”®å•†å“ï¼Œæ¯”å¦‚ï¼Œ1 å…ƒå– iPhoneï¼Œ100 å°ï¼Œäºæ˜¯æ¥äº†ä¸€ç™¾ä¸‡äººæŠ¢è´­ã€‚\nç”¨æˆ·æˆ–äº§å“çš„è§’åº¦ï¼š\né¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä¸ªç§’æ€çš„ landing pageï¼Œåœ¨è¿™ä¸ªç§’æ€é¡µä¸Šæœ‰ä¸€ä¸ªå€’è®¡æ—¶çš„æŒ‰é’®ã€‚ ä¸€æ—¦è¿™ä¸ªå€’è®¡æ—¶çš„æ—¶é—´åˆ°äº†ï¼ŒæŒ‰é’®å°±è¢«ç‚¹äº®ï¼Œè®©ä½ å¯ä»¥ç‚¹å‡»æŒ‰é’®ä¸‹å•ã€‚ ä¸€èˆ¬æ¥è¯´ä¸‹å•æ—¶éœ€è¦ä½ å¡«å†™ä¸€ä¸ªæ ¡éªŒç ï¼Œä»¥é˜²æ­¢æ˜¯æœºå™¨æ¥æŠ¢ã€‚ ç»†èŠ‚ï¼š å€’è®¡æ—¶æ—¶é—´éœ€è¦æ ¡å‡†ï¼› éœ€è¦å‘åç«¯å‘é€æœ‰æ²¡æœ‰å¼€å§‹ï¼Œ å¦‚æœå¼€å§‹ï¼Œ è¿”å›å‰ç«¯ä¸€ä¸ª URLã€‚\næŠ€æœ¯æŒ‘æˆ˜ï¼š\n100 ä¸‡çš„åŒæ—¶å¹¶å‘ä¼šå¯¼è‡´æˆ‘ä»¬çš„ç½‘ç«™ç¬é—´å°±å´©æºƒäº†ã€‚ ç½‘ç»œå¸¦å®½ã€100w çš„ TPS éœ€è¦éå¸¸å¤šçš„æœºå™¨ã€‚ æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šé›†ä¸­åœ¨åŒä¸€æ¡æ•°æ®åº“è®°å½•ä¸Šï¼Œæ— è®ºæ˜¯æ€ä¹ˆåˆ†åº“åˆ†è¡¨ï¼Œè¿˜æ˜¯ä½¿ç”¨äº†åˆ†å¸ƒå¼æ•°æ®åº“éƒ½æ— æµäºäº‹ï¼Œå› ä¸ºä½ é¢å¯¹çš„æ˜¯å•æ¡çš„çƒ­ç‚¹æ•°æ®ã€‚ æŠ€æœ¯æ–¹æ¡ˆï¼š\n**CDNã€‚**ä¸Šç™¾ä¸ª CDN çš„è¾¹ç¼˜ç»“ç‚¹ï¼Œäºæ˜¯å°±èƒ½å¤Ÿæ‰›å¾—ä½ã€‚ æˆ‘ä»¬éœ€è¦æŠŠå°æœåŠ¡éƒ¨ç½²åˆ° CDN ç»“ç‚¹ä¸Šå»ã€‚å½“å‰ç«¯é¡µé¢æ¥é—®å¼€æ²¡å¼€å§‹æ—¶ï¼Œè¿™ä¸ªå°æœåŠ¡é™¤äº†å‘Šè¯‰å‰ç«¯å¼€æ²¡å¼€å§‹å¤–ï¼Œå®ƒè¿˜å¯ä»¥ç»Ÿè®¡ä¸‹æœ‰å¤šå°‘äººåœ¨çº¿ã€‚ å‡è®¾ï¼Œæˆ‘ä»¬çŸ¥é“æœ‰å¤§çº¦ 100 ä¸‡çš„äººåœ¨çº¿ç­‰ç€æŠ¢ï¼Œé‚£ä¹ˆï¼Œåœ¨æˆ‘ä»¬å¿«è¦å¼€å§‹çš„æ—¶å€™ï¼Œç”±æ•°æ®ä¸­å¿ƒå‘å„ä¸ªéƒ¨ç½²åœ¨ CDN ç»“ç‚¹ä¸Šçš„å°æœåŠ¡ä¸Šä¼ é€’ä¸€ä¸ªæ¦‚ç‡å€¼ï¼Œæ¯”å¦‚è¯´æ˜¯ 0.02%ã€‚ è¿‡æ»¤ç”¨æˆ·è¯·æ±‚ã€‚ å…¶ä»–å®ä¾‹ï¼š 12306 æŠ¢ç¥¨ åœºæ™¯ï¼š ä»–ä»¬å®Œå…¨ä¸çŸ¥é“ç”¨æˆ·æ¥æ˜¯è¦ä¹°å“ªå¼ ç«è½¦ç¥¨çš„ã€‚ä¸çŸ¥é“è¿™ä¸ªä¿¡æ¯ï¼Œå¾ˆä¸å¥½è¿‡æ»¤ç”¨æˆ·ï¼Œè€Œä¸”ç”¨æˆ·åœ¨ä¹°ç¥¨å‰éœ€è¦æœ‰å¾ˆå¤šæŸ¥è¯¢æ“ä½œï¼Œç„¶ååœ¨æŸ¥è¯¢ä¸­é€‰æ‹©è‡ªå·±çš„è½¦ç¥¨ã€‚\næ–¹æ¡ˆï¼š\n12306 æœ€å¥½çš„åº”å¯¹æ–¹å¼ï¼Œé™¤äº†ä¸è¦ä¸€æ¬¡æŠŠæ‰€æœ‰çš„ç¥¨æ”¾å‡ºæ¥ï¼Œè€Œæ˜¯åˆ†æ‰¹åœ¨ä¸åŒçš„æ—¶é—´æ®µæŠŠç¥¨æ”¾å‡ºæ¥ï¼Œè¿™æ ·å¯ä»¥è®©äººä»¬ä¸è¦é›†ä¸­åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹æ¥æŠ¢ç¥¨ï¼Œåšåˆ°äººè‚‰åˆ†æµï¼Œå¯ä»¥é™ä½ä¸€äº›å¹¶å‘åº¦ã€‚ 12306 æœ€å¥½æ˜¯ç”¨é¢„å”®çš„æ–¹å¼ï¼Œè®©å¤§å®¶æŠŠè‡ªå·±çš„è´­ç¥¨å…ˆè¾“å…¥åˆ°ç³»ç»Ÿä¸­ã€‚ç³»ç»Ÿå¹¶ä¸çœŸæ­£æ”¾ç¥¨ï¼Œè€Œæ˜¯æŠŠå¤§å®¶çš„éœ€æ±‚éƒ½æ”¶é›†å¥½ï¼Œç„¶ååšæ•´ä½“ç»Ÿç­¹å®‰æ’ï¼Œè¯¥å¢åŠ è½¦æ¬¡çš„å¢åŠ è½¦æ¬¡ï¼Œè¯¥åŠ è½¦å¢çš„åŠ è½¦å¢ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿å¤§å®¶éƒ½èƒ½èµ°ã€‚å®åœ¨ä¸è¡Œï¼Œé‚£å°±æŠ½ç­¾äº†ã€‚ æ›´å¤šçš„æ€è€ƒ åœºæ™¯ï¼š åŒ 11 é‚£æ ·ï¼Œæƒ³å°½å¯èƒ½å¤šåœ°å–å‡ºå•†å“ï¼Œé‚£ä¹ˆå°±ä¸åƒç§’æ€äº†ã€‚è¿™æ˜¯è¦å°½å¯èƒ½å¤šåœ°æ”¶è®¢å•ï¼Œä½†åˆä¸èƒ½è¶…è¿‡åº“å­˜ï¼Œå…¶ä¸­è¿˜æœ‰å¤§é‡çš„é“¶è¡Œæ”¯ä»˜ï¼Œå„å¤§ä»“åº“çš„åº“å­˜æŸ¥è¯¢å’Œåˆ†é…ï¼Œè¿™äº›éƒ½æ˜¯éå¸¸æ…¢çš„æ“ä½œã€‚ä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œè¿˜è¦èƒ½å¤Ÿæ‰›å¾—ä½åƒåŒ 11 è¿™æ ·çš„å¤§è§„æ¨¡å¹¶å‘è®¿é—®ï¼Œé‚£ä¹ˆï¼Œåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ\næ–¹æ¡ˆï¼š è¿™ä¸ªæ—¶å€™å°±éœ€è¦è®¤è®¤çœŸçœŸåœ°åšé«˜å¹¶å‘çš„æ¶æ„å’Œæµ‹è¯•äº†ï¼Œéœ€è¦å„ä¸ªç³»ç»ŸæŠŠè‡ªå·±çš„æ€§èƒ½è°ƒæ•´ä¸Šå»ï¼Œè¿˜è¦å°å¿ƒåœ°åšæ€§èƒ½è§„åˆ’ï¼Œæ›´è¦æŠŠåˆ†å¸ƒå¼çš„å¼¹åŠ›è®¾è®¡åšå¥½ï¼Œæœ€åæ˜¯è¦ä¸åœåœ°åšæ€§èƒ½æµ‹è¯•ï¼Œæ‰¾åˆ°æ•´ä¸ªæ¶æ„çš„ç³»ç»Ÿç“¶é¢ˆï¼Œç„¶åä¸æ–­åœ°åšæ°´å¹³æ‰©å±•ï¼Œä»¥è§£å†³å¤§è§„æ¨¡çš„å¹¶å‘ã€‚\nå°ç»“ åƒæˆ‘ä»¬ç”¨è¾¹ç¼˜ç»“ç‚¹æ¥è§£å†³ç§’æ€è¿™æ ·çš„åœºæ™¯çš„ç©æ³•ï¼Œæ˜¯å¦ä¹Ÿæœ‰ä¸€å®šçš„æ™®é€‚æ€§ï¼Ÿè¿™é‡Œï¼Œæˆ‘æƒ³è¯´ï¼Œä¸€å®šæ˜¯æœ‰çš„ã€‚ æ›´å¥½çš„æ€§èƒ½ï¼Œæˆæœ¬ã€‚\nè¾¹ç¼˜è®¡ç®— æ‰€è°“è¾¹ç¼˜è®¡ç®—ï¼Œ å®ƒæ˜¯ç›¸å¯¹äºæ•°æ®ä¸­å¿ƒè€Œè¨€ã€‚æ•°æ®ä¸­å¿ƒå–œæ¬¢æŠŠæ‰€æœ‰çš„æœåŠ¡æ”¾åœ¨ä¸€ä¸ªæœºæˆ¿é‡Œé›†ä¸­å¤„ç†ç”¨æˆ·çš„æ•°æ®å’Œè¯·æ±‚ï¼Œé›†ä¸­å¼éƒ¨ç½²ä¸€æ–¹é¢ä¾¿äºç®¡ç†å’Œè¿ç»´ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¾¿äºæœåŠ¡é—´çš„é€šè®¯æœ‰ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ç½‘ç»œä¿éšœã€‚çš„ç¡®æ²¡é”™ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦åƒCDN è¿™æ ·çš„è¾¹ç¼˜å¼çš„å†…å®¹å‘å¸ƒç½‘ç»œï¼ŒæŠŠæˆ‘ä»¬çš„é™æ€å†…å®¹æ¨åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹ï¼Œç„¶åè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚\nä¸ºä»€ä¹ˆè¦æœ‰è¾¹ç¼˜è®¡ç®— ä»è¶‹åŠ¿ä¸Šï¼š æ•´ä¸ªè®¡ç®—æœºå‘å±•çš„æœ¬è´¨å°±æ˜¯æˆ‘ä»¬äººç±»ç”Ÿæ´»ä¿¡æ¯åŒ–å»ºè®¾çš„è¿‡ç¨‹ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè®¡ç®—æœºç¡¬ä»¶çš„å‘å±•ä¹Ÿæ˜¯éå¸¸è¿…çŒ›çš„ã€‚CPU çš„å¤„ç†é€Ÿåº¦ï¼Œç¡¬ç›˜çš„å¤§å°å’Œé€Ÿåº¦ï¼Œç½‘ç»œçš„å¸¦å®½å’Œé€Ÿåº¦éƒ½åœ¨æ‹¼å‘½åœ°å‡çº§å’Œé™ä»·ã€‚æˆ‘ä»¬ç”¨è¶Šæ¥è¶Šä½çš„æˆæœ¬ï¼Œè·å¾—è¶Šæ¥è¶Šå¿«çš„é€Ÿåº¦ã€è¶Šæ¥è¶Šå¤§çš„å¸¦å®½ã€è¶Šæ¥è¶Šå¿«çš„å­˜å‚¨â€¦â€¦ æ‰€æœ‰çš„è¿™ä¸€åˆ‡ï¼Œå…¶å®éƒ½æ˜¯å’Œä¿¡æ¯è¿˜æœ‰æ•°æ®æœ‰å…³ã€‚æˆ‘ä»¬çš„ä¿¡æ¯å’Œæ•°æ®è¶Šæ¥è¶Šå¤šï¼Œè¶Šæ¥è¶Šå¤§ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¥½ã€æ›´å¿«ã€æ›´ä¾¿å®œçš„ç¡¬ä»¶å’ŒåŸºç¡€è®¾æ–½ã€‚è¿™ä¸ªæ¼”åŒ–è¿‡ç¨‹ä¸­ï¼Œåœ¨æˆ‘å‚åŠ å·¥ä½œè¿™ 20 å¹´æ¥å°±æ²¡æœ‰åœæ­¢è¿‡ï¼Œè€Œä¸”ï¼Œæˆ‘ä¹Ÿä¸è®¤ä¸ºæœªæ¥ä¼šåœä¸‹æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹åªä¼šè¶Šæ¥è¶Šå¿«ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•°é‡è¶Šæ¥è¶Šå¤§ï¼Œåˆ†æç»“æœçš„é€Ÿåº¦éœ€è¦è¶Šæ¥è¶Šå¿«ï¼Œè¿™ä¸¤ä¸ªéœ€æ±‚ï¼Œåªä¼šæŠŠæˆ‘ä»¬é€¼åˆ°è¾¹ç¼˜è®¡ç®—ä¸Šå»ã€‚ å¦‚æœä½ è¿˜æ˜¯åœ¨æ•°æ®ä¸­å¿ƒå¤„ç†ï¼Œä½ ä¼šå‘ç°ä½ çš„æˆæœ¬åªä¼šè¶Šæ¥è¶Šé«˜ï¼Œåˆ°ä¸€å®šæ—¶å€™å°±å®Œå…¨ç©ä¸ä¸‹å»äº†ã€‚\nä»æˆæœ¬ï¼š æ ¹æ®æˆ‘è¿‡å»æœåŠ¡è¿‡çš„ 40 å¤šå®¶å…¬å¸çš„ç»éªŒï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æŠ•å…¥ï¼š\nå‡ åä¸‡ç”¨æˆ·çš„å…¬å¸ï¼Œåªéœ€è¦å¤„ç†ç™¾çº§ QPS çš„é‡ï¼Œåªéœ€è¦ 10 å°å·¦å³çš„æœåŠ¡å™¨ï¼› ä¸Šç™¾ä¸‡ç”¨æˆ·çš„å…¬å¸ï¼Œåªéœ€è¦å¤„ç†åƒçº§ QPS çš„é‡ï¼Œéœ€è¦æœ‰ 50 å°å·¦å³çš„æœåŠ¡å™¨ï¼› ä¸Šåƒä¸‡ç”¨æˆ·çš„å…¬å¸ï¼Œéœ€è¦å¤„ç†ä¸‡çº§åˆ°åä¸‡çº§ QPS çš„é‡ï¼Œéœ€è¦ 700 å°å·¦å³çš„æœåŠ¡å™¨ï¼› ä¸Šäº¿ç”¨æˆ·çš„å…¬å¸ï¼Œå…¶éœ€è¦å¤„ç†ç™¾ä¸‡çº§ QPS çš„é‡ï¼Œéœ€è¦ä¸Šä¸‡å°çš„æœåŠ¡å™¨ã€‚ è¾¹ç¼˜è®¡ç®—çš„ä¸šåŠ¡åœºæ™¯ å¤„ç†ä¸€äº›å®æ—¶å“åº”çš„ä¸šåŠ¡ã€‚å®ƒå’Œç”¨æˆ·é å¾—å¾ˆè¿‘ï¼Œæ‰€ä»¥å¯ä»¥å®æ—¶å“åº”ç”¨æˆ·çš„ä¸€äº›æœ¬åœ°è¯·æ±‚ï¼Œæ¯”å¦‚ï¼ŒæŸå…¬å¸çš„äººè„¸é—¨ç¦ç³»ç»Ÿã€å…±äº«å•è½¦çš„å¼€é”ã€‚ å¤„ç†ä¸€äº›ç®€å•çš„ä¸šåŠ¡é€»è¾‘ã€‚æ¯”å¦‚åƒç§’æ€ã€æŠ¢çº¢åŒ…è¿™æ ·çš„ä¸šåŠ¡åœºæ™¯ã€‚ æ”¶é›†å¹¶ç»“æ„åŒ–æ•°æ®ã€‚æ¯”å¦‚ï¼ŒæŠŠè§†é¢‘ä¸­çš„è½¦ç‰Œä¿¡æ¯æŠ å‡ºæ¥ï¼Œè½¬æˆæ–‡å­—ï¼Œä¼ å›æ•°æ®ä¸­å¿ƒã€‚ å®æ—¶è®¾å¤‡ç›‘æ§ã€‚ä¸»è¦æ˜¯çº¿ä¸‹è®¾å¤‡çš„æ•°æ®é‡‡é›†å’Œç›‘æ§ã€‚ ã€‚ã€‚ã€‚\nå…³é”®æŠ€æœ¯ API Gateway Serverless/FaaSã€‚å°±æ˜¯æœåŠ¡å‡½æ•°åŒ–ï¼Œè¿™ä¸ªæŠ€æœ¯å°±åƒæ˜¯ AWS Lambda æœåŠ¡ä¸€æ ·ï¼Œä½ å†™å¥½ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åä¸ç”¨å…³å¿ƒè¿™ä¸ªå‡½æ•°è¿è¡Œåœ¨å“ªé‡Œï¼Œç›´æ¥å‘å¸ƒå°±å¥½äº†ã€‚ç„¶åå°±å¯ä»¥ç”¨äº†ã€‚ ","permalink":"http://blog.chalme.top/posts/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E8%AE%BE%E8%AE%A1-%E6%80%A7%E8%83%BD%E8%AE%BE%E8%AE%A1/","summary":"ç¼“å­˜ åŸºæœ¬ä¸Šæ¥è¯´ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ€è€—æ€§èƒ½çš„åœ°æ–¹å°±æ˜¯æœ€åç«¯çš„æ•°æ®åº“äº†ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œåªè¦å°å¿ƒç»´æŠ¤å¥½ï¼Œæ•°æ®åº“å››ç§æ“ä½œï¼ˆselectã€updateã€insert å’Œ deleteï¼‰ä¸­çš„ä¸‰ä¸ªå†™æ“ä½œ insertã€update å’Œ delete ä¸å¤ªä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼ˆinsert ä¸€èˆ¬ä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œupdate å’Œ delete ä¸€èˆ¬ä¼šæœ‰ä¸»é”®ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå¤ªæ…¢ï¼‰ã€‚é™¤éç´¢å¼•å»ºå¾—å¤ªå¤šï¼Œè€Œæ•°æ®åº“é‡Œçš„æ•°æ®åˆå¤ªå¤šï¼Œè¿™ä¸‰ä¸ªæ“ä½œæ‰ä¼šå˜æ…¢ã€‚ ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œselect æ˜¯å‡ºç°æ€§èƒ½é—®é¢˜æœ€å¤§çš„åœ°æ–¹ã€‚ä¸€æ–¹é¢ï¼Œselect ä¼šæœ‰å¾ˆå¤šåƒ joinã€groupã€orderã€like ç­‰è¿™æ ·ä¸°å¯Œçš„è¯­ä¹‰ï¼Œè€Œè¿™äº›è¯­ä¹‰æ˜¯éå¸¸è€—æ€§èƒ½çš„ï¼›å¦ä¸€æ–¹é¢ï¼Œå¤§å¤šæ•°åº”ç”¨éƒ½æ˜¯è¯»å¤šå†™å°‘ï¼Œæ‰€ä»¥åŠ å‰§äº†æ…¢æŸ¥è¯¢çš„é—®é¢˜ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿œç¨‹è°ƒç”¨ä¹Ÿä¼šæ¶ˆè€—å¾ˆå¤šèµ„æºï¼Œå› ä¸ºç½‘ç»œå¼€é”€ä¼šå¯¼è‡´æ•´ä½“çš„å“åº”æ—¶é—´ä¸‹é™ã€‚ä¸ºäº†æŒ½æ•‘è¿™æ ·çš„æ€§èƒ½å¼€é”€ï¼Œåœ¨ä¸šåŠ¡å…è®¸çš„æƒ…å†µï¼ˆä¸éœ€è¦å¤ªå®æ—¶çš„æ•°æ®ï¼‰ä¸‹ï¼Œä½¿ç”¨ç¼“å­˜æ˜¯éå¸¸å¿…è¦çš„äº‹æƒ…ã€‚ è®¾è®¡çš„é‡ç‚¹ï¼š\nåœ¨åˆ†å¸ƒå¼æ¶æ„ä¸‹ï¼Œä¸€èˆ¬éƒ½éœ€è¦ä¸€ä¸ªå¤–éƒ¨çš„ç¼“å­˜é›†ç¾¤ã€‚å…³äºè¿™ä¸ªç¼“å­˜é›†ç¾¤ï¼Œä½ éœ€è¦ä¿è¯çš„æ˜¯å†…å­˜è¦è¶³å¤Ÿå¤§ï¼Œç½‘ç»œå¸¦å®½ä¹Ÿè¦å¥½ï¼Œå› ä¸ºç¼“å­˜æœ¬è´¨ä¸Šæ˜¯ä¸ªå†…å­˜å’Œ IO å¯†é›†å‹çš„åº”ç”¨ã€‚ ç¼“å­˜çš„å¥½åè¦çœ‹å‘½ä¸­ç‡ã€‚ç¼“å­˜çš„å‘½ä¸­ç‡é«˜è¯´æ˜ç¼“å­˜æœ‰æ•ˆï¼Œä¸€èˆ¬æ¥è¯´å‘½ä¸­ç‡åˆ° 80% ä»¥ä¸Šå°±ç®—å¾ˆé«˜äº†ã€‚å½“ç„¶ï¼Œæœ‰çš„ç½‘ç»œä¸ºäº†è¿½æ±‚æ›´é«˜çš„æ€§èƒ½ï¼Œè¦åšåˆ° 95% ä»¥ä¸Šï¼Œç”šè‡³å¯èƒ½ä¼šæŠŠæ•°æ®åº“é‡Œçš„æ•°æ®å‡ ä¹å…¨éƒ¨è£…è¿›ç¼“å­˜ä¸­ã€‚ ç¼“å­˜æ˜¯é€šè¿‡ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥æé«˜æ€§èƒ½çš„ï¼Œè¿™ä¸–ä¸Šä»»ä½•äº‹æƒ…éƒ½ä¸æ˜¯å…è´¹çš„ ç¼“å­˜æ•°æ®çš„æ—¶é—´å‘¨æœŸä¹Ÿéœ€è¦å¥½å¥½è®¾è®¡ ä½¿ç”¨ç¼“å­˜çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ LRU ç­–ç•¥ ç¼“å­˜æ˜¯æé«˜æ€§èƒ½æœ€å¥½çš„æ–¹å¼ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜æœ‰ä»¥ä¸‹ä¸‰ç§æ¨¡å¼ã€‚\nCache Aside æ›´æ–°æ¨¡å¼ å¤±æ•ˆï¼šåº”ç”¨ç¨‹åºå…ˆä» Cache å–æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å¾—åˆ°ï¼Œåˆ™ä»æ•°æ®åº“ä¸­å–æ•°æ®ï¼ŒæˆåŠŸåï¼Œæ”¾åˆ°ç¼“å­˜ä¸­ã€‚ å‘½ä¸­ï¼šåº”ç”¨ç¨‹åºä» Cache ä¸­å–æ•°æ®ï¼Œå–åˆ°åè¿”å›ã€‚ æ›´æ–°ï¼šå…ˆæŠŠæ•°æ®å­˜åˆ°æ•°æ®åº“ä¸­ï¼ŒæˆåŠŸåï¼Œå†è®©ç¼“å­˜å¤±æ•ˆã€‚\nå½“ç„¶ï¼Œæœ€å¥½è¿˜æ˜¯ä¸ºç¼“å­˜è®¾ç½®å¥½è¿‡æœŸæ—¶é—´ã€‚\nä¸ºä»€ä¹ˆä¸å»ç›´æ¥æ›´æ–°ï¼Ÿ ä¸»è¦æ˜¯æ€•ä¸¤ä¸ªå¹¶å‘çš„å†™æ“ä½œå¯¼è‡´è„æ•°æ®ã€‚\nCache Aside å°±ä¸ä¼šæœ‰å¹¶å‘é—®é¢˜äº†ï¼Ÿ æ¯”å¦‚ï¼Œä¸€ä¸ªæ˜¯è¯»æ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œå°±ä¼šåˆ°æ•°æ®åº“ä¸­å–æ•°æ®ã€‚è€Œæ­¤æ—¶æ¥äº†ä¸€ä¸ªå†™æ“ä½œï¼Œå†™å®Œæ•°æ®åº“åï¼Œè®©ç¼“å­˜å¤±æ•ˆï¼Œç„¶åä¹‹å‰çš„é‚£ä¸ªè¯»æ“ä½œå†æŠŠè€çš„æ•°æ®æ”¾è¿›å»ï¼Œæ‰€ä»¥ä¼šé€ æˆè„æ•°æ®ã€‚\nRead/Write Through æ›´æ–°æ¨¡å¼ ç¼“å­˜ç”±æ•°æ®åº“ä»£ç†ã€‚ ç¼“å­˜å’Œæ•°æ®åº“ä¸ºä¸€ä½“ã€‚\nwirte æ›´æ–°æ¨¡å¼ ç›´æ¥å†™æ•°æ®åº“ï¼Œ é€šè¿‡ä¸­é—´ä»¶ï¼ˆç²¾å«ï¼‰å†™å…¥ç¼“å­˜ã€‚\nå¼‚æ­¥å¤„ç† å¼‚æ­¥é€šè®¯çš„è®¾è®¡æ¨¡å¼ ï¼š æé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå®¹é”™èƒ½åŠ›ã€‚ å¢åŠ æ•´ä¸ªç³»ç»Ÿçš„ååé‡ï¼Œä»è€Œå¯ä»¥é¢å¯¹æ›´é«˜çš„å¹¶å‘ï¼Œå¹¶å¯ä»¥ä»å®¹åœ°åˆ©ç”¨å¥½ç°æœ‰çš„ç³»ç»Ÿèµ„æºã€‚\nå½“ä½ åœ¨åšä¸€ä»¶äº‹çš„æ—¶å€™ï¼Œå¦‚æœæœ‰åˆ«äººæ¥æ‰¾ä½ åšå…¶å®ƒäº‹ï¼Œä½ å°±ä¼šè¢«æ‰“æ–­è€Œè¦å»å¹²åˆ«çš„äº‹ã€‚è€Œå¦‚æœä½ å¯ä»¥ç»Ÿç­¹å®‰æ’è¿™äº›äº‹æƒ…ï¼Œæœ¬æ¥äº”ä»¶äº‹åªéœ€è¦ 2 ä¸ªå°æ—¶ï¼Œå¦‚æœä¸èƒ½ï¼Œæˆ–è€…è€è¢«åˆ«äººæ‰“ä¹±æ€è·¯ï¼Œé‚£ä½ å¯èƒ½å°±è¦èŠ± 5 ä¸ªå°æ—¶ã€‚å¼‚æ­¥å¤„ç†ä»»åŠ¡å¯ä»¥è®©ä½ æ›´å¥½åœ°åˆ©ç”¨å¥½æ—¶é—´å’Œèµ„æºã€‚åˆ©ç”¨å¥½äº†æ—¶é—´å’Œèµ„æºï¼Œæ€§èƒ½è‡ªç„¶å°±ä¼šæå‡ä¸Šæ¥ã€‚","title":"åˆ†å¸ƒå¼å…³é”®è®¾è®¡ æ€§èƒ½è®¾è®¡"},{"content":"åˆ†å¸ƒå¼é” åœºæ™¯ï¼š æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹è®¿é—®ä¸€äº›å…±äº«èµ„æºéœ€è¦åŠ é”ï¼Œä¸ç„¶å°±ä¼šå‡ºç°æ•°æ®è¢«å†™ä¹±çš„é—®é¢˜ã€‚åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œ è¿™æ ·çš„é—®é¢˜ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚åªä¸è¿‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆ†å¸ƒå¼çš„é”æœåŠ¡ã€‚å¯¹äºåˆ†å¸ƒå¼çš„é”æœåŠ¡ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ•°æ®åº“ DBã€Redis å’Œ ZooKeeper ç­‰å®ç°ã€‚\nç‰¹ç‚¹ï¼š å®‰å…¨æ€§ï¼ˆSafetyï¼‰ï¼šåœ¨ä»»æ„æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è·å¾—é”ï¼ˆæ’ä»–æ€§ï¼‰ã€‚ é¿å…æ­»é”ï¼šå®¢æˆ·ç«¯æœ€ç»ˆä¸€å®šå¯ä»¥è·å¾—é”ï¼Œå³ä½¿é”ä½æŸä¸ªèµ„æºçš„å®¢æˆ·ç«¯åœ¨é‡Šæ”¾é”ä¹‹å‰å´©æºƒæˆ–è€…ç½‘ç»œä¸å¯è¾¾ã€‚ å®¹é”™æ€§ï¼šåªè¦é”æœåŠ¡é›†ç¾¤ä¸­çš„å¤§éƒ¨åˆ†èŠ‚ç‚¹å­˜æ´»ï¼ŒClient å°±å¯ä»¥è¿›è¡ŒåŠ é”è§£é”æ“ä½œã€‚\nè®¾è®¡ï¼š æˆ‘æ˜¯ç”¨æ¥ä¿®æ”¹æŸä¸ªå…±äº«æºçš„ï¼Œè¿˜æ˜¯ç”¨æ¥ä¸åŒè¿›ç¨‹é—´çš„åŒæ­¥æˆ–æ˜¯äº’æ–¥çš„ã€‚å¦‚æœä½¿ç”¨ CAS è¿™æ ·çš„æ–¹å¼ï¼ˆæ— é”æ–¹å¼ï¼‰æ¥æ›´æ–°æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æœåŠ¡çš„ï¼Œè€Œåè€…å¯èƒ½æ˜¯éœ€è¦çš„ã€‚ ä¸€èˆ¬å¯ä»¥ä½¿ç”¨æ•°æ®åº“ã€Redis æˆ– ZooKeeper æ¥åšåˆ†å¸ƒå¼é”æœåŠ¡ã€‚\néœ€è¦ç»™ä¸€ä¸ªé”è¢«é‡Šæ”¾çš„æ–¹å¼ï¼Œä»¥é¿å…è¯·æ±‚è€…ä¸æŠŠé”è¿˜å›æ¥ï¼Œå¯¼è‡´æ­»é”çš„é—®é¢˜ã€‚ è¶…æ—¶æ—¶é—´ã€‚ åˆ†å¸ƒå¼é”æœåŠ¡åº”è¯¥æ˜¯é«˜å¯ç”¨çš„ï¼Œè€Œä¸”æ˜¯éœ€è¦æŒä¹…åŒ–çš„ã€‚ è¦æä¾›éé˜»å¡æ–¹å¼çš„é”æœåŠ¡ã€‚ è¿˜è¦è€ƒè™‘é”çš„å¯é‡å…¥æ€§ã€‚ å…·ä½“å®ç° redisï¼š\nSET resource_name my_random_value NX PX 30000 if redis.call(\u0026#34;get\u0026#34;,KEYS[1]) == ARGV[1] then return redis.call(\u0026#34;del\u0026#34;,KEYS[1]) else return 0 end é—®é¢˜ï¼š è§£å†³æ–¹æ¡ˆï¼š ä¹è§‚é”ï¼Œç‰ˆæœ¬å·é€’å¢ï¼›\né”æœåŠ¡çš„æ—¶å€™ï¼Œå•è°ƒé€’å¢çš„ç‰ˆæœ¬å·ï¼› å†™æ•°æ®çš„æ—¶å€™ä¹Ÿéœ€è¦å¢åŠ ç‰ˆæœ¬å·ï¼› æ•°æ®åº“ä¿å­˜ç‰ˆæœ¬å·ï¼Œ å¯¹æƒ…å†µè¿›è¡Œæ ¡éªŒï¼› ä»ä¹è§‚é”åˆ° CAS æ•°æ®åº“ä¸­ä¹Ÿä¿ç•™ç€ç‰ˆæœ¬å· ï¼Œ å¯ä»¥ä½¿ç”¨ ä¹è§‚é”å¤„ç†(fence token)ï¼› UPDATE table_name SET xxx = #{xxx}, version=version+1 where version =#{version}; æ•°æ®åº“é‚£è¾¹ä¸€èˆ¬ä¼šç”¨ timestamp æ—¶é—´æˆªæ¥ç©ã€‚ä¹Ÿæ˜¯åœ¨æ›´æ–°æäº¤çš„æ—¶å€™æ£€æŸ¥å½“å‰æ•°æ®åº“ä¸­æ•°æ®çš„æ—¶é—´æˆ³å’Œè‡ªå·±æ›´æ–°å‰å–åˆ°çš„æ—¶é—´æˆ³è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´åˆ™ OKï¼Œå¦åˆ™å°±æ˜¯ç‰ˆæœ¬å†²çªã€‚\næœ‰æ—¶å€™éƒ½ä¸éœ€è¦å¢åŠ é¢å¤–çš„ç‰ˆæœ¬å­—æ®µæˆ–æ˜¯ fence tokenã€‚\nSELECT stock FROM tb_product where product_id=#{product_id}; UPDATE tb_product SET stock=stock-#{num} WHERE product_id=#{product_id} AND stock=#{stock}; æ— é”ç»“æ„ï¼š ä¹è§‚é” CAS ã€‚ cas çš„ ABA é—®é¢˜ï¼š double-CASï¼ˆåŒä¿é™©çš„ CASï¼‰ã€‚ æ— é”é˜Ÿåˆ—ï¼š 1ï¼‰æ— é”é˜Ÿåˆ—ä¸»è¦æ˜¯é€šè¿‡ CASã€FAA è¿™äº›åŸå­æ“ä½œï¼Œå’Œ Retry-Loop å®ç°ã€‚ 2ï¼‰å¯¹äº Retry-Loopï¼Œæˆ‘ä¸ªäººæ„Ÿè§‰å…¶å®å’Œé”ä»€ä¹ˆä»€ä¹ˆä¸¤æ ·ã€‚åªæ˜¯è¿™ç§â€œé”â€çš„ç²’åº¦å˜å°äº†ï¼Œä¸»è¦æ˜¯â€œé”â€HEAD å’Œ TAIL è¿™ä¸¤ä¸ªå…³é”®èµ„æºã€‚è€Œä¸æ˜¯æ•´ä¸ªæ•°æ®ç»“æ„ã€‚\ntrade-off æ‚²è§‚é”å› ä¸ºå¯¹è¯»å†™éƒ½åŠ é”ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½æ¯”è¾ƒä½ï¼Œå¯¹äºç°åœ¨äº’è”ç½‘æå€¡çš„ä¸‰é«˜(é«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€é«˜å¹¶å‘)æ¥è¯´ï¼Œæ‚²è§‚é”çš„å®ç°ç”¨çš„è¶Šæ¥è¶Šå°‘äº†ï¼Œä½†æ˜¯ä¸€èˆ¬å¤šè¯»çš„æƒ…å†µä¸‹è¿˜æ˜¯éœ€è¦ä½¿ç”¨æ‚²è§‚é”çš„ï¼Œå› ä¸ºè™½ç„¶åŠ é”çš„æ€§èƒ½æ¯”è¾ƒä½ï¼Œä½†æ˜¯ä¹Ÿé˜»æ­¢äº†åƒä¹è§‚é”ä¸€æ ·ï¼Œé‡åˆ°å†™ä¸ä¸€è‡´çš„æƒ…å†µä¸‹ä¸€ç›´é‡è¯•çš„æ—¶é—´ã€‚ ç›¸å¯¹è€Œè¨€ï¼Œä¹è§‚é”ç”¨äºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå³å¾ˆå°‘å‘ç”Ÿå†²çªçš„åœºæ™¯ï¼Œè¿™æ ·å¯ä»¥çœå»é”çš„å¼€é”€ï¼Œå¢åŠ ç³»ç»Ÿçš„ååé‡ã€‚\nç®¡ç†è®¾è®¡ æˆ‘ä»¬çŸ¥é“ï¼Œé™¤äº†ä»£ç ä¹‹å¤–ï¼Œè½¯ä»¶è¿˜æœ‰ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿˜æœ‰ä¸€äº›æˆ‘ä»¬ä¸æƒ³å†™æ­»åœ¨ä»£ç é‡Œçš„ä¸œè¥¿ï¼Œåƒçº¿ç¨‹æ± å¤§å°ã€é˜Ÿåˆ—é•¿åº¦ç­‰è¿è¡Œå‚æ•°ï¼Œä»¥åŠæ—¥å¿—çº§åˆ«ã€ç®—æ³•ç­–ç•¥ç­‰ï¼Œè¿˜æœ‰ä¸€äº›æ˜¯è½¯ä»¶è¿è¡Œç¯å¢ƒçš„å‚æ•°ï¼Œå¦‚ Java çš„å†…å­˜å¤§å°ï¼Œåº”ç”¨å¯åŠ¨çš„å‚æ•°ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿçš„ä¸€äº›å‚æ•°é…ç½®â€¦â€¦\né…ç½®ä¸­å¿ƒçš„è®¾è®¡ æŠŠè½¯ä»¶çš„é…ç½®åˆ†æˆé™æ€é…ç½®å’ŒåŠ¨æ€é…ç½®ã€‚æ“ä½œç³»ç»Ÿçš„ç½‘ç»œé…ç½®ï¼Œè½¯ä»¶è¿è¡Œæ—¶ Docker è¿›ç¨‹çš„é…ç½®ï¼Œè¿™äº›é…ç½®åœ¨è½¯ä»¶ç¯å¢ƒåˆå§‹åŒ–æ—¶å°±ç¡®å®šäº†ï¼Œæœªæ¥åŸºæœ¬ä¸ä¼šä¿®æ”¹äº†ã€‚è€Œæ‰€è°“åŠ¨æ€é…ç½®å…¶å®å°±æ˜¯è½¯ä»¶è¿è¡Œæ—¶çš„ä¸€äº›é…ç½®ï¼Œåœ¨è¿è¡Œæ—¶ä¼šè¢«ä¿®æ”¹ã€‚æ¯”å¦‚ï¼Œæ—¥å¿—çº§åˆ«ã€é™çº§å¼€å…³ã€æ´»åŠ¨å¼€å…³ã€‚ åŠ¨æ€é…ç½®çš„ç®¡ç†ï¼Œåšå¥½åŒºåˆ†ï¼Œ ä¸‰ä¸ªéƒ¨åˆ†ï¼š\næŒ‰è¿è¡Œç¯å¢ƒåˆ†ã€‚ å¼€å‘ï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ã€‚ æŒ‰ä¾èµ–åŒºåˆ†ã€‚ä¸€ç§æ˜¯ä¾èµ–é…ç½®ï¼Œä¸€ç§æ˜¯ä¸ä¾èµ–çš„å†…éƒ¨é…ç½®ã€‚æ¯”å¦‚ï¼Œå¤–éƒ¨ä¾èµ–çš„ MySQL æˆ– Redis çš„è¿æ¥é…ç½®ã€‚è¿˜æœ‰ä¸€ç§å®Œå…¨æ˜¯è‡ªå·±å†…éƒ¨çš„é…ç½®ã€‚ æŒ‰å±‚æ¬¡åˆ†ã€‚ åˆ†æˆ IaaSã€PaaSã€SaaS ä¸‰å±‚ã€‚åŸºç¡€å±‚çš„é…ç½®æ˜¯æ“ä½œç³»ç»Ÿçš„é…ç½®ï¼Œä¸­é—´å¹³å°å±‚çš„é…ç½®æ˜¯ä¸­é—´ä»¶çš„é…ç½®ï¼Œå¦‚ Tomcat çš„é…ç½®ï¼Œä¸Šå±‚è½¯ä»¶å±‚çš„é…ç½®æ˜¯åº”ç”¨è‡ªå·±çš„é…ç½®ã€‚ é…ç½®ä¸­å¿ƒçš„æ¨¡å‹ è½¯ä»¶é…ç½®åŸºæœ¬ä¸Šæ¥è¯´ï¼Œæ¯ä¸ªé…ç½®é¡¹å°±æ˜¯ key/value çš„æ¨¡å‹\né…ç½®ä¸­å¿ƒçš„æ¶æ„ åœ¨è¿™ä¸ªå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠé…ç½®å½•å…¥åï¼Œé…ç½®ä¸­å¿ƒå‘å‡ºå˜æ›´é€šçŸ¥ï¼Œé…ç½®å˜æ›´æ§åˆ¶å™¨ä¼šæ¥è¯»å–æœ€æ–°çš„é…ç½®ï¼Œç„¶ååº”ç”¨é…ç½®ã€‚ ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªå˜æ›´é€šçŸ¥çš„ç»„ä»¶ï¼Œè€Œä¸æ˜¯è®©é…ç½®ä¸­å¿ƒç›´æ¥æ¨é€ï¼Ÿ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼ŒæœåŠ¡å™¨å¤ªå¤šï¼Œæ¨é€ä¸å¤ªç°å®ï¼Œè€Œé‡‡ç”¨ä¸€ä¸ª Pub/Sub çš„é€šçŸ¥æœåŠ¡å¯ä»¥è®©æ•°æ®äº¤æ¢ç»æµä¸€äº›ã€‚\né…ç½®ä¸­å¿ƒçš„è®¾è®¡é‡ç‚¹ é…ç½®ä¸­å¿ƒä¸»è¦çš„ç”¨å¤„æ˜¯ç»Ÿä¸€å’Œè§„èŒƒåŒ–ç®¡ç†æ‰€æœ‰çš„æœåŠ¡é…ç½®ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§é…ç½®ä¸Šçš„æ²»ç†æ´»åŠ¨ã€‚æ‰€ä»¥ï¼Œé…ç½®ä¸­å¿ƒçš„è®¾è®¡é‡ç‚¹åº”è¯¥æ”¾åœ¨å¦‚ä½•ç»Ÿä¸€å’Œæ ‡å‡†åŒ–è½¯ä»¶çš„é…ç½®é¡¹ï¼Œå…¶è¿˜ä¼šæ¶‰åŠåˆ°è½¯ä»¶ç‰ˆæœ¬ã€è¿è¡Œç¯å¢ƒã€å¹³å°ã€ä¸­é—´ä»¶ç­‰ä¸€ç³»åˆ—çš„é…ç½®å‚æ•°ã€‚\né…ç½®çš„å®æ—¶ï¼š å†™å°‘è¯»å¤šçš„åœºæ™¯\nåŸºäºæ‹‰æ¨¡å‹çš„å®¢æˆ·ç«¯è½®è¯¢çš„æ–¹æ¡ˆ å¤§å¤šæ•°è½®è¯¢è¯·æ±‚éƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ .åŸºäºæ¨æ¨¡å‹çš„å®¢æˆ·ç«¯é•¿è½®è¯¢çš„æ–¹æ¡ˆ åŸºäº Http é•¿è½®è¯¢æ¨¡å‹ï¼Œå®ç°äº†è®©å®¢æˆ·ç«¯åœ¨æ²¡æœ‰å‘ç”ŸåŠ¨æ€é…ç½®å˜æ›´çš„æ—¶å€™å‡å°‘è½®è¯¢ã€‚è¿™æ ·å‡å°‘äº†æ— æ„ä¹‰çš„è½®è¯¢è¯·æ±‚é‡ï¼Œæé«˜äº†è½®è¯¢çš„æ•ˆç‡ï¼›ä¹Ÿé™ä½äº†ç³»ç»Ÿè´Ÿè½½ï¼Œæå‡äº†æ•´ä¸ªç³»ç»Ÿçš„èµ„æºåˆ©ç”¨ç‡ã€‚ è¿™ç§æ¨æ‹‰ç»“åˆçš„ç­–ç•¥ï¼Œåšåˆ°äº†åœ¨é•¿è¿æ¥å’ŒçŸ­è¿æ¥ä¹‹é—´çš„å¹³è¡¡ï¼Œå®ç°ä¸Šè®©æœåŠ¡ç«¯ä¸ç”¨å¤ªå…³æ³¨è¿æ¥çš„ç®¡ç†ï¼Œæ•ˆæœä¸Šåˆè·å¾—äº†ç±»ä¼¼ TCP é•¿è¿æ¥çš„ä¿¡æ¯æ¨é€çš„å®æ—¶æ€§ã€‚\nè¾¹è½¦æ¨¡å¼ ç¼–ç¨‹çš„æœ¬è´¨å°±æ˜¯å°†æ§åˆ¶å’Œé€»è¾‘åˆ†ç¦»å’Œè§£è€¦ï¼Œè€Œè¾¹è½¦æ¨¡å¼ä¹Ÿæ˜¯å¼‚æ›²åŒå·¥ï¼ŒåŒæ ·æ˜¯è®©æˆ‘ä»¬åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­åšåˆ°é€»è¾‘å’Œæ§åˆ¶åˆ†ç¦»ã€‚ æ‰€è°“çš„è¾¹è½¦æ¨¡å¼ï¼Œå¯¹åº”äºæˆ‘ä»¬ç”Ÿæ´»ä¸­ç†ŸçŸ¥çš„è¾¹ä¸‰è½®æ‘©æ‰˜è½¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™ä¸€ä¸ªæ‘©æ‰˜è½¦åŠ ä¸Šä¸€ä¸ªè¾¹è½¦çš„æ–¹å¼æ¥æ‰©å±•ç°æœ‰çš„æœåŠ¡å’ŒåŠŸèƒ½ã€‚è¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“åœ°åšåˆ° \u0026quot; æ§åˆ¶ \u0026quot; å’Œ \u0026quot; é€»è¾‘ \u0026quot; çš„åˆ†ç¦»ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æœåŠ¡ä¸­å®ç°æ§åˆ¶é¢ä¸Šçš„ä¸œè¥¿ï¼Œå¦‚ç›‘è§†ã€æ—¥å¿—è®°å½•ã€é™æµã€ç†”æ–­ã€æœåŠ¡æ³¨å†Œã€åè®®é€‚é…è½¬æ¢ç­‰è¿™äº›å±äºæ§åˆ¶é¢ä¸Šçš„ä¸œè¥¿ï¼Œè€Œåªéœ€è¦ä¸“æ³¨åœ°åšå¥½å’Œä¸šåŠ¡é€»è¾‘ç›¸å…³çš„ä»£ç ï¼Œç„¶åï¼Œç”±â€œè¾¹è½¦â€æ¥å®ç°è¿™äº›ä¸ä¸šåŠ¡é€»è¾‘æ²¡æœ‰å…³ç³»çš„æ§åˆ¶åŠŸèƒ½ã€‚\nå¯¹äºç›‘è§†ã€æ—¥å¿—ã€é™æµã€ç†”æ–­ã€æœåŠ¡æ³¨å†Œã€åè®®è½¬æ¢ç­‰ç­‰è¿™äº›åŠŸèƒ½ï¼Œå…¶å®éƒ½æ˜¯å¤§åŒå°å¼‚ï¼Œç”šè‡³æ˜¯å®Œå…¨å¯ä»¥åšæˆæ ‡å‡†åŒ–çš„ç»„ä»¶å’Œæ¨¡å—çš„ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼ã€‚ä¸€ç§æ˜¯é€šè¿‡ SDKã€Lib æˆ– Framework è½¯ä»¶åŒ…æ–¹å¼ï¼Œåœ¨å¼€å‘æ—¶ä¸çœŸå®çš„åº”ç”¨æœåŠ¡é›†æˆèµ·æ¥ã€‚ å¦ä¸€ç§æ˜¯é€šè¿‡åƒ Sidecar è¿™æ ·çš„æ–¹å¼ï¼Œåœ¨è¿ç»´æ—¶ä¸çœŸå®çš„åº”ç”¨æœåŠ¡é›†æˆèµ·æ¥ã€‚\né›†æˆåœ¨è½¯ä»¶ sidecar ä¼˜ç‚¹ ä»¥è½¯ä»¶åŒ…çš„æ–¹å¼å¯ä»¥å’Œåº”ç”¨å¯†åˆ‡é›†æˆï¼Œæœ‰åˆ©äºèµ„æºçš„åˆ©ç”¨å’Œåº”ç”¨çš„æ€§èƒ½ å¯¹åº”ç”¨æœåŠ¡æ²¡æœ‰ä¾µå…¥æ€§ï¼Œå¹¶ä¸”ä¸ç”¨å—åˆ°åº”ç”¨æœåŠ¡çš„è¯­è¨€å’ŒæŠ€æœ¯çš„é™åˆ¶ï¼Œè€Œä¸”å¯ä»¥åšåˆ°æ§åˆ¶å’Œé€»è¾‘çš„åˆ†å¼€å‡çº§å’Œéƒ¨ç½² ç¼ºç‚¹ å¯¹åº”ç”¨æœ‰ä¾µå…¥ï¼Œè€Œä¸”å—åº”ç”¨çš„ç¼–ç¨‹è¯­è¨€å’ŒæŠ€æœ¯é™åˆ¶ å¢åŠ äº†æ¯ä¸ªåº”ç”¨æœåŠ¡çš„ä¾èµ–æ€§ï¼Œä¹Ÿå¢åŠ äº†åº”ç”¨çš„å»¶è¿Ÿï¼Œå¹¶ä¸”ä¹Ÿä¼šå¤§å¤§å¢åŠ ç®¡ç†ã€æ‰˜ç®¡ã€éƒ¨ç½²çš„å¤æ‚åº¦ã€‚ Sidecar å¯ä»¥å¸®åŠ©æœåŠ¡æ³¨å†Œåˆ°ç›¸åº”çš„æœåŠ¡å‘ç°ç³»ç»Ÿï¼Œå¹¶å¯¹æœåŠ¡åšç›¸å…³çš„å¥åº·æ£€æŸ¥ã€‚ å½“åº”ç”¨æœåŠ¡è¦è°ƒç”¨å¤–éƒ¨æœåŠ¡æ—¶ï¼Œ Sidecar å¯ä»¥å¸®åŠ©ä»æœåŠ¡å‘ç°ä¸­æ‰¾åˆ°ç›¸åº”å¤–éƒ¨æœåŠ¡çš„åœ°å€ï¼Œç„¶ååšæœåŠ¡è·¯ç”±ã€‚ Sidecar æ¥ç®¡äº†è¿›å‡ºçš„æµé‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšç›¸åº”çš„æ—¥å¿—ç›‘è§†ã€è°ƒç”¨é“¾è·Ÿè¸ªã€æµæ§ç†”æ–­â€¦â€¦è¿™äº›éƒ½å¯ä»¥æ”¾åœ¨ Sidecar é‡Œå®ç°ã€‚ç„¶åï¼ŒæœåŠ¡æ§åˆ¶ç³»ç»Ÿå¯ä»¥é€šè¿‡æ§åˆ¶ Sidecar æ¥æ§åˆ¶åº”ç”¨æœåŠ¡ï¼Œå¦‚æµæ§ã€ä¸‹çº¿ç­‰ã€‚ |\nè¾¹è½¦è®¾è®¡çš„é‡ç‚¹ é‡ç‚¹è§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜\næ§åˆ¶å’Œé€»è¾‘çš„åˆ†ç¦»ã€‚ æœåŠ¡è°ƒç”¨ä¸­ä¸Šä¸‹æ–‡çš„é—®é¢˜ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œç†”æ–­ã€è·¯ç”±ã€æœåŠ¡å‘ç°ã€è®¡é‡ã€æµæ§ã€ç›‘è§†ã€é‡è¯•ã€å¹‚ç­‰ã€é‰´æƒç­‰æ§åˆ¶é¢ä¸Šçš„åŠŸèƒ½ï¼Œä»¥åŠå…¶ç›¸å…³çš„é…ç½®æ›´æ–°ï¼Œæœ¬è´¨æ¥ä¸Šæ¥è¯´ï¼Œå’ŒæœåŠ¡çš„å…³ç³»å¹¶ä¸å¤§ã€‚ä½†æ˜¯ä¼ ç»Ÿçš„å·¥ç¨‹åšæ³•æ˜¯åœ¨å¼€å‘å±‚é¢å®Œæˆè¿™äº›åŠŸèƒ½ï¼Œè¿™å°±ä¼šå¯¼è‡´å„ç§ç»´æŠ¤ä¸Šçš„é—®é¢˜ï¼Œè€Œä¸”è¿˜ä¼šå—åˆ°ç‰¹å®šè¯­è¨€å’Œç¼–ç¨‹æ¡†æ¶çš„çº¦æŸå’Œé™åˆ¶ã€‚\nè®¾è®¡çš„é‡ç‚¹ï¼š\nè¿›ç¨‹é—´é€šè®¯æœºåˆ¶æ˜¯è¿™ä¸ªè®¾è®¡æ¨¡å¼çš„é‡ç‚¹ æœåŠ¡åè®®æ–¹é¢ï¼Œä¹Ÿè¯·ä½¿ç”¨æ ‡å‡†ç»Ÿä¸€çš„æ–¹å¼ã€‚è¿™é‡Œæœ‰ä¸¤å±‚åè®®ï¼Œä¸€ä¸ªæ˜¯ Sidecar åˆ° service çš„å†…éƒ¨åè®®ï¼Œå¦ä¸€ä¸ªæ˜¯ Sidecar åˆ°è¿œç«¯ Sidecar æˆ– service çš„å¤–éƒ¨åè®®ã€‚ ä½¿ç”¨è¿™æ ·çš„æ¨¡å¼ï¼Œéœ€è¦åœ¨æœåŠ¡çš„æ•´ä½“æ‰“åŒ…ã€æ„å»ºã€éƒ¨ç½²ã€ç®¡æ§ã€è¿ç»´ä¸Šè®¾è®¡å¥½ã€‚ ç­‰ç­‰ é€‚ç”¨çš„åœºæ™¯ï¼š\næŠŠæ§åˆ¶å’Œé€»è¾‘åˆ†ç¦»ï¼Œæ ‡å‡†åŒ–æ§åˆ¶é¢ä¸Šçš„åŠ¨ä½œå’ŒæŠ€æœ¯ï¼Œä»è€Œæé«˜ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚ä¹Ÿæœ‰åˆ©äºåˆ†å·¥â€”â€”å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¨‹åºå‘˜éƒ½å¯ä»¥åšå¥½æ§åˆ¶é¢ä¸Šçš„å¼€å‘çš„ã€‚ ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„åœºæ™¯æ˜¯å¯¹è€åº”ç”¨ç³»ç»Ÿçš„æ”¹é€ å’Œæ‰©å±•ã€‚ ä¸é€‚ç”¨äºä»€ä¹ˆæ ·çš„åœºæ™¯ï¼š\næ¶æ„å¹¶ä¸å¤æ‚çš„æ—¶å€™ï¼Œä¸éœ€è¦ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ï¼Œç›´æ¥ä½¿ç”¨ API Gateway æˆ–è€… Nginx å’Œ HAProxy ç­‰å³å¯ã€‚ æœåŠ¡é—´çš„åè®®ä¸æ ‡å‡†ä¸”æ— æ³•è½¬æ¢ã€‚ ä¸éœ€è¦åˆ†å¸ƒå¼çš„æ¶æ„ã€‚ æœåŠ¡ç½‘æ ¼ Service Mesh è¿™ä¸ªæœåŠ¡ç½‘ç»œä¸“æ³¨äºå¤„ç†æœåŠ¡å’ŒæœåŠ¡é—´çš„é€šè®¯ã€‚å…¶ä¸»è¦è´Ÿè´£æ„é€ ä¸€ä¸ªç¨³å®šå¯é çš„æœåŠ¡é€šè®¯çš„åŸºç¡€è®¾æ–½ï¼Œå¹¶è®©æ•´ä¸ªæ¶æ„æ›´ä¸ºçš„å…ˆè¿›å’Œ Cloud Nativeã€‚åœ¨å·¥ç¨‹ä¸­ï¼ŒService Mesh åŸºæœ¬æ¥è¯´æ˜¯ä¸€ç»„è½»é‡çº§çš„æœåŠ¡ä»£ç†å’Œåº”ç”¨é€»è¾‘çš„æœåŠ¡åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”å¯¹äºåº”ç”¨æœåŠ¡æ˜¯é€æ˜çš„ã€‚\nService Mesh æ˜¯ä¸€ä¸ªåŸºç¡€è®¾æ–½ã€‚Service Mesh æ˜¯ä¸€ä¸ªè½»é‡çš„æœåŠ¡é€šè®¯çš„ç½‘ç»œä»£ç†ã€‚Service Mesh å¯¹äºåº”ç”¨æœåŠ¡æ¥è¯´æ˜¯é€æ˜æ— ä¾µå…¥çš„ã€‚Service Mesh ç”¨äºè§£è€¦å’Œåˆ†ç¦»åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­æ§åˆ¶å±‚é¢ä¸Šçš„ä¸œè¥¿ã€‚\nService Mesh å¼€æºè½¯ä»¶æ˜¯ Istio å’Œ Linkerdï¼Œå®ƒä»¬éƒ½å¯ä»¥åœ¨ Kubernetes ä¸­é›†æˆã€‚å½“ç„¶ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–°æˆå‘˜ Conduitï¼Œå®ƒæ˜¯ç”± Linkerd çš„ä½œè€…å‡ºæ¥è‡ªå·±æçš„ï¼Œç”± Rust å’Œ Go å†™æˆçš„ã€‚Rust è´Ÿè´£æ•°æ®å±‚é¢ï¼ŒGo è´Ÿè´£æ§åˆ¶é¢ã€‚å·ç§°å¸å–äº†å¾ˆå¤š Linkerd çš„ Scala çš„æ•™è®­ï¼Œæ¯” Linkerd æ›´å¿«ï¼Œè¿˜è½»ï¼Œæ›´ç®€å•ã€‚\né¦–å…ˆï¼Œè¾¹è½¦æ¨¡å¼è¿›åŒ–çš„ä¸‹ä¸€é˜¶æ®µï¼Œå°±æ˜¯æŠŠå®ƒçš„åŠŸèƒ½æ ‡å‡†åŒ–æˆä¸€ä¸ªé›†ç¾¤ï¼Œå…¶ç»“æœå°±æ˜¯æœåŠ¡ç½‘æ ¼ã€‚å®ƒåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åœ°ä½ï¼Œç±»ä¼¼äºä¸ƒå±‚ç½‘ç»œæ¨¡å‹ä¸­çš„ä¼ è¾“å±‚åè®®ï¼Œè€ŒæœåŠ¡æœ¬èº«åˆ™åªéœ€è¦å…³å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤ç±»ä¼¼äºåº”ç”¨å±‚åè®®ã€‚ç„¶åï¼Œæˆ‘ä»‹ç»äº†å‡ ä¸ªå®ç°äº†æœåŠ¡ç½‘æ ¼çš„å¼€æºè½¯ä»¶ã€‚\nç½‘å…³æ¨¡å¼ æˆ‘ä»¬è®²äº† Sidecar å’Œ Service Mesh è¿™ä¸¤ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨ä¸ä¾µå…¥ä¸šåŠ¡é€»è¾‘çš„æƒ…å†µä¸‹ï¼ŒæŠŠæ§åˆ¶é¢ï¼ˆcontrol planeï¼‰å’Œæ•°æ®é¢ï¼ˆdata planeï¼‰çš„å¤„ç†è§£è€¦åˆ†ç¦»ã€‚ä½†æ˜¯è¿™ä¸¤ç§æ¨¡å¼éƒ½è®©æˆ‘ä»¬çš„è¿ç»´æˆæœ¬å˜å¾—ç‰¹åˆ«å¤§ï¼Œå› ä¸ºæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦ä¸€ä¸ª Sidecarï¼Œè¿™è®©æœ¬æ¥å°±å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¶æ„å°±æ›´ä¸ºå¤æ‚å’Œéš¾ä»¥ç®¡ç†äº†ã€‚\nåœ¨è°ˆ Service Mesh çš„æ—¶å€™ï¼Œæˆ‘ä»¬æåˆ°äº† Gatewayã€‚æˆ‘ä¸ªäººè§‰å¾—å¹¶ä¸éœ€è¦ä¸ºæ¯ä¸ªæœåŠ¡çš„å®ä¾‹éƒ½é…ç½®ä¸Šä¸€ä¸ª Sidecarã€‚å…¶å®ï¼Œä¸€ä¸ªæœåŠ¡é›†ç¾¤é…ä¸Šä¸€ä¸ª Gateway å°±å¯ä»¥äº†ï¼Œæˆ–æ˜¯ä¸€ç»„ç±»ä¼¼çš„æœåŠ¡é…ç½®ä¸Šä¸€ä¸ª Gatewayã€‚ è¿™æ ·ä¸€æ¥ï¼ŒGateway æ–¹å¼ä¸‹çš„æ¶æ„ï¼Œå¯ä»¥ç»†åˆ°ä¸ºæ¯ä¸€ä¸ªæœåŠ¡çš„å®ä¾‹é…ç½®ä¸€ä¸ªè‡ªå·±çš„ Gatewayï¼Œä¹Ÿå¯ä»¥ç²—åˆ°ä¸ºä¸€ç»„æœåŠ¡é…ç½®ä¸€ä¸ªï¼Œç”šè‡³å¯ä»¥ç²—åˆ°ä¸ºæ•´ä¸ªæ¶æ„é…ç½®ä¸€ä¸ªæ¥å…¥çš„ Gatewayã€‚äºæ˜¯ï¼Œæ•´ä¸ªç³»ç»Ÿæ¶æ„çš„å¤æ‚åº¦å°±ä¼šå˜å¾—ç®€å•å¯æ§èµ·æ¥ã€‚ ç½‘å…³æ¨¡å¼è®¾è®¡ éå¸¸ç±»ä¼¼ é˜¿é‡Œ Aserver. åŠŸèƒ½ï¼š\nè¯·æ±‚è·¯ç”±ã€‚ æœåŠ¡æ³¨å†Œã€‚ è´Ÿè½½å‡è¡¡ã€‚ å¼¹åŠ›è®¾è®¡ã€‚ å®‰å…¨æ–¹é¢ã€‚SSL åŠ å¯†åŠè¯ä¹¦ç®¡ç†ã€Session éªŒè¯ã€æˆæƒã€æ•°æ®æ ¡éªŒï¼Œä»¥åŠå¯¹è¯·æ±‚æºè¿›è¡Œæ¶æ„æ”»å‡»çš„é˜²èŒƒã€‚ è®¾è®¡é‡ç‚¹:\né«˜æ€§èƒ½ é«˜å¯ç”¨ é›†ç¾¤åŒ–ã€‚ è‡ªå·±å¯ä»¥åŒæ­¥ä¿¡æ¯ã€‚ æœåŠ¡åŒ–ã€‚ç½‘å…³è¿˜éœ€è¦åšåˆ°åœ¨ä¸é—´æ–­çš„æƒ…å†µä¸‹ä¿®æ”¹é…ç½®ï¼Œä¸€ç§æ˜¯åƒ Nginx reload é…ç½®é‚£æ ·ï¼Œå¯ä»¥åšåˆ°ä¸åœæœåŠ¡ï¼Œå¦ä¸€ç§æ˜¯æœ€å¥½åšåˆ°æœåŠ¡åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¾—è¦æœ‰è‡ªå·±çš„ Admin API æ¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹è‡ªå·±çš„é…ç½®ã€‚ æŒç»­åŒ–ã€‚æ¯”å¦‚é‡å¯ï¼Œå°±æ˜¯åƒ Nginx é‚£æ ·ä¼˜é›…åœ°é‡å¯ã€‚æœ‰ä¸€ä¸ªä¸»ç®¡è¯·æ±‚åˆ†å‘çš„ä¸»è¿›ç¨‹ã€‚å½“æˆ‘ä»¬éœ€è¦é‡å¯æ—¶ï¼Œæ–°çš„è¯·æ±‚è¢«åˆ†é…åˆ°æ–°çš„è¿›ç¨‹ä¸­ï¼Œè€Œè€çš„è¿›ç¨‹å¤„ç†å®Œæ­£åœ¨å¤„ç†çš„è¯·æ±‚åå°±é€€å‡ºã€‚ é«˜æ‰©å±•ã€‚Nginx é‚£æ ·é€šè¿‡ Moduleï¼›åƒ AWS Lambda é‚£æ ·çš„æ–¹å¼ï¼› è¿ç»´æ–¹é¢ï¼š\nä¸šåŠ¡æ¾è€¦åˆï¼Œåè®®ç´§è€¦åˆã€‚ åº”ç”¨ç›‘è§†ï¼Œæä¾›åˆ†ææ•°æ®ã€‚ ç”¨å¼¹åŠ›è®¾è®¡ä¿æŠ¤åç«¯æœåŠ¡ã€‚ DevOps Gatewayã€Sidecar å’Œ Service Mesh Sidecar Service Mesh Gateway ç”¨é€” Sidecar çš„æ–¹å¼ä¸»è¦æ˜¯ç”¨æ¥æ”¹é€ å·²æœ‰æœåŠ¡ã€‚ Sidecar åœ¨æ¶æ„ä¸­è¶Šæ¥è¶Šå¤šæ—¶ï¼Œéœ€è¦æˆ‘ä»¬å¯¹ Sidecar è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚åƒä¸€ä¸ªæœåŠ¡çš„ PaaS å¹³å°ã€‚ Service Mesh çš„æ¶æ„å’Œéƒ¨ç½²å¤ªè¿‡äºå¤æ‚ï¼Œä¼šè®©æˆ‘ä»¬è¿ç»´å±‚é¢ä¸Šçš„å¤æ‚åº¦å˜å¤§ã€‚ ç®€æ˜“ æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘è§‰å¾— Gateway çš„æ–¹å¼æ¯” Sidecar å’Œ Service Mesh æ›´å¥½ã€‚å½“ç„¶ï¼Œå…·ä½“é—®é¢˜è¿˜è¦å…·ä½“åˆ†æã€‚\néƒ¨ç½²å‡çº§ç­–ç•¥ ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰å¦‚ä¸‹å‡ ç§ï¼š\nåœæœºéƒ¨ç½²ï¼ˆBig Bang / Recreateï¼‰ è“ç»¿éƒ¨ç½²ï¼ˆBlue/Green /Stageï¼‰ï¼šéƒ¨ç½²å¥½æ–°ç‰ˆæœ¬åï¼ŒæŠŠæµé‡ä»è€æœåŠ¡é‚£è¾¹åˆ‡è¿‡æ¥ã€‚ æ»šåŠ¨éƒ¨ç½²ï¼ˆRolling Update / Rampedï¼‰ï¼š ä¸€ç‚¹ä¸€ç‚¹åœ°å‡çº§ç°æœ‰çš„æœåŠ¡ã€‚ ç°åº¦éƒ¨ç½²ï¼ˆCanaryï¼‰ï¼šæŠŠä¸€éƒ¨åˆ†ç”¨æˆ·åˆ‡åˆ°æ–°ç‰ˆæœ¬ä¸Šæ¥ï¼Œç„¶åçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰é—®é¢˜ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜å°±ç»§ç»­æ‰©å¤§å‡çº§ï¼Œç›´åˆ°å…¨éƒ¨å‡çº§å®Œæˆã€‚ AB æµ‹è¯•ï¼ˆA/B Testingï¼‰ï¼šåŒæ—¶ä¸Šçº¿ä¸¤ä¸ªç‰ˆæœ¬ï¼Œç„¶ååšç›¸å…³çš„æ¯”è¾ƒã€‚ æ€»ç»“ï¼š éƒ¨ç½²åº”ç”¨æœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå®é™…é‡‡ç”¨å“ªç§æ–¹å¼å–å†³äºéœ€æ±‚å’Œé¢„ç®—ã€‚ å½“å‘å¸ƒåˆ°å¼€å‘æˆ–è€…æ¨¡æ‹Ÿç¯å¢ƒæ—¶ï¼Œåœæœºæˆ–è€…æ»šåŠ¨éƒ¨ç½²æ˜¯ä¸€ä¸ªå¥½é€‰æ‹©ï¼Œå› ä¸ºå¹²å‡€å’Œå¿«é€Ÿã€‚ å½“å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œæ»šåŠ¨éƒ¨ç½²æˆ–è€…è“ç»¿éƒ¨ç½²é€šå¸¸æ˜¯ä¸€ä¸ªå¥½é€‰æ‹©ï¼Œä½†æ–°å¹³å°çš„ä¸»æµç¨‹æµ‹è¯•æ˜¯å¿…é¡»çš„ã€‚\nè“ç»¿éƒ¨ç½²ä¹Ÿä¸é”™ï¼Œä½†éœ€è¦é¢å¤–çš„èµ„æºã€‚å¦‚æœåº”ç”¨ç¼ºä¹æµ‹è¯•æˆ–è€…å¯¹è½¯ä»¶çš„åŠŸèƒ½å’Œç¨³å®šæ€§å½±å“ç¼ºä¹ä¿¡å¿ƒï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨é‡‘ä¸é›€éƒ¨ç½²æˆ–è€… AB æµ‹è¯•å‘å¸ƒã€‚å¦‚æœä¸šåŠ¡éœ€è¦æ ¹æ®åœ°ç†ä½ç½®ã€è¯­è¨€ã€æ“ä½œç³»ç»Ÿæˆ–è€…æµè§ˆå™¨ç‰¹å¾ç­‰å‚æ•°æ¥ç»™ä¸€äº›ç‰¹å®šçš„ç”¨æˆ·æµ‹è¯•ï¼Œé‚£ä¹ˆå¯ä»¥é‡‡ç”¨ AB æµ‹è¯•æŠ€æœ¯ã€‚ ","permalink":"http://blog.chalme.top/posts/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E8%AE%BE%E8%AE%A1-%E7%AE%A1%E7%90%86%E8%AE%BE%E8%AE%A1/","summary":"åˆ†å¸ƒå¼é” åœºæ™¯ï¼š æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹è®¿é—®ä¸€äº›å…±äº«èµ„æºéœ€è¦åŠ é”ï¼Œä¸ç„¶å°±ä¼šå‡ºç°æ•°æ®è¢«å†™ä¹±çš„é—®é¢˜ã€‚åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œ è¿™æ ·çš„é—®é¢˜ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚åªä¸è¿‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆ†å¸ƒå¼çš„é”æœåŠ¡ã€‚å¯¹äºåˆ†å¸ƒå¼çš„é”æœåŠ¡ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ•°æ®åº“ DBã€Redis å’Œ ZooKeeper ç­‰å®ç°ã€‚\nç‰¹ç‚¹ï¼š å®‰å…¨æ€§ï¼ˆSafetyï¼‰ï¼šåœ¨ä»»æ„æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è·å¾—é”ï¼ˆæ’ä»–æ€§ï¼‰ã€‚ é¿å…æ­»é”ï¼šå®¢æˆ·ç«¯æœ€ç»ˆä¸€å®šå¯ä»¥è·å¾—é”ï¼Œå³ä½¿é”ä½æŸä¸ªèµ„æºçš„å®¢æˆ·ç«¯åœ¨é‡Šæ”¾é”ä¹‹å‰å´©æºƒæˆ–è€…ç½‘ç»œä¸å¯è¾¾ã€‚ å®¹é”™æ€§ï¼šåªè¦é”æœåŠ¡é›†ç¾¤ä¸­çš„å¤§éƒ¨åˆ†èŠ‚ç‚¹å­˜æ´»ï¼ŒClient å°±å¯ä»¥è¿›è¡ŒåŠ é”è§£é”æ“ä½œã€‚\nè®¾è®¡ï¼š æˆ‘æ˜¯ç”¨æ¥ä¿®æ”¹æŸä¸ªå…±äº«æºçš„ï¼Œè¿˜æ˜¯ç”¨æ¥ä¸åŒè¿›ç¨‹é—´çš„åŒæ­¥æˆ–æ˜¯äº’æ–¥çš„ã€‚å¦‚æœä½¿ç”¨ CAS è¿™æ ·çš„æ–¹å¼ï¼ˆæ— é”æ–¹å¼ï¼‰æ¥æ›´æ–°æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æœåŠ¡çš„ï¼Œè€Œåè€…å¯èƒ½æ˜¯éœ€è¦çš„ã€‚ ä¸€èˆ¬å¯ä»¥ä½¿ç”¨æ•°æ®åº“ã€Redis æˆ– ZooKeeper æ¥åšåˆ†å¸ƒå¼é”æœåŠ¡ã€‚\néœ€è¦ç»™ä¸€ä¸ªé”è¢«é‡Šæ”¾çš„æ–¹å¼ï¼Œä»¥é¿å…è¯·æ±‚è€…ä¸æŠŠé”è¿˜å›æ¥ï¼Œå¯¼è‡´æ­»é”çš„é—®é¢˜ã€‚ è¶…æ—¶æ—¶é—´ã€‚ åˆ†å¸ƒå¼é”æœåŠ¡åº”è¯¥æ˜¯é«˜å¯ç”¨çš„ï¼Œè€Œä¸”æ˜¯éœ€è¦æŒä¹…åŒ–çš„ã€‚ è¦æä¾›éé˜»å¡æ–¹å¼çš„é”æœåŠ¡ã€‚ è¿˜è¦è€ƒè™‘é”çš„å¯é‡å…¥æ€§ã€‚ å…·ä½“å®ç° redisï¼š\nSET resource_name my_random_value NX PX 30000 if redis.call(\u0026#34;get\u0026#34;,KEYS[1]) == ARGV[1] then return redis.call(\u0026#34;del\u0026#34;,KEYS[1]) else return 0 end é—®é¢˜ï¼š è§£å†³æ–¹æ¡ˆï¼š ä¹è§‚é”ï¼Œç‰ˆæœ¬å·é€’å¢ï¼›\né”æœåŠ¡çš„æ—¶å€™ï¼Œå•è°ƒé€’å¢çš„ç‰ˆæœ¬å·ï¼› å†™æ•°æ®çš„æ—¶å€™ä¹Ÿéœ€è¦å¢åŠ ç‰ˆæœ¬å·ï¼› æ•°æ®åº“ä¿å­˜ç‰ˆæœ¬å·ï¼Œ å¯¹æƒ…å†µè¿›è¡Œæ ¡éªŒï¼› ä»ä¹è§‚é”åˆ° CAS æ•°æ®åº“ä¸­ä¹Ÿä¿ç•™ç€ç‰ˆæœ¬å· ï¼Œ å¯ä»¥ä½¿ç”¨ ä¹è§‚é”å¤„ç†(fence token)ï¼› UPDATE table_name SET xxx = #{xxx}, version=version+1 where version =#{version}; æ•°æ®åº“é‚£è¾¹ä¸€èˆ¬ä¼šç”¨ timestamp æ—¶é—´æˆªæ¥ç©ã€‚ä¹Ÿæ˜¯åœ¨æ›´æ–°æäº¤çš„æ—¶å€™æ£€æŸ¥å½“å‰æ•°æ®åº“ä¸­æ•°æ®çš„æ—¶é—´æˆ³å’Œè‡ªå·±æ›´æ–°å‰å–åˆ°çš„æ—¶é—´æˆ³è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´åˆ™ OKï¼Œå¦åˆ™å°±æ˜¯ç‰ˆæœ¬å†²çªã€‚","title":"åˆ†å¸ƒå¼å…³é”®è®¾è®¡ ç®¡ç†è®¾è®¡"},{"content":"éš”ç¦»è®¾è®¡ æŒ‰æœåŠ¡çš„ç§ç±»æ¥åšåˆ†ç¦»ï¼š æ¯”å¦‚ï¼š æˆ‘ä»¬å°†ç³»ç»Ÿåˆ†æˆäº†ç”¨æˆ·ã€å•†å“ã€ç¤¾åŒºä¸‰ä¸ªæ¿å—ã€‚ ä¸å¥½ï¼š å¦‚æœæˆ‘ä»¬éœ€è¦åŒæ—¶è·å¾—å¤šä¸ªæ¿å—çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡ï¼Œè¿™ä¼šé™ä½æ€§èƒ½ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ€§èƒ½é™ä½æŒ‡çš„æ˜¯å“åº”æ—¶é—´ï¼Œè€Œä¸æ˜¯ååé‡ï¼ˆç›¸åï¼Œåœ¨è¿™ç§æ¶æ„ä¸‹ï¼Œååé‡å¯ä»¥å¾—åˆ°æé«˜ï¼‰ã€‚ ä¸€èˆ¬ï¼š å¾ˆå¤šï¼š è¿™æ ·çš„ç³»ç»Ÿé€šå¸¸ä¼šå¼•å…¥å¤§é‡çš„å¼‚æ­¥å¤„ç†æ¨¡å‹ã€‚\næŒ‰ç”¨æˆ·çš„è¯·æ±‚æ¥åšåˆ†ç¦» å¤šç§Ÿæˆ· ï¼š æˆ‘ä»¬å°†ç”¨æˆ·åˆ†æˆä¸åŒçš„ç»„ï¼Œå¹¶æŠŠåç«¯çš„åŒä¸€ä¸ªæœåŠ¡æ ¹æ®è¿™äº›ä¸åŒçš„ç»„åˆ†æˆä¸åŒçš„å®ä¾‹ã€‚ å®Œå…¨ç‹¬ç«‹çš„è®¾è®¡ã€‚æ¯ä¸ªç§Ÿæˆ·æœ‰è‡ªå·±å®Œå…¨ç‹¬ç«‹çš„æœåŠ¡å’Œæ•°æ®ã€‚ ç‹¬ç«‹çš„æ•°æ®åˆ†åŒºï¼Œå…±äº«çš„æœåŠ¡ã€‚å¤šç§Ÿæˆ·çš„æœåŠ¡æ˜¯å…±äº«çš„ï¼Œä½†æ•°æ®æ˜¯åˆ†å¼€éš”ç¦»çš„ã€‚ å…±äº«çš„æœåŠ¡ï¼Œå…±äº«çš„æ•°æ®åˆ†åŒºã€‚æ¯ä¸ªç§Ÿæˆ·çš„æ•°æ®å’ŒæœåŠ¡éƒ½æ˜¯å…±äº«çš„ã€‚ åˆ†æ å¦‚æœä½¿ç”¨å®Œå…¨ç‹¬ç«‹çš„æ–¹æ¡ˆï¼Œåœ¨å¼€å‘å®ç°ä¸Šå’Œèµ„æºéš”ç¦»åº¦æ–¹é¢ä¼šéå¸¸å¥½ï¼Œç„¶è€Œï¼Œæˆæœ¬ä¼šæ¯”è¾ƒé«˜ï¼Œè®¡ç®—èµ„æºä¹Ÿä¼šæœ‰ä¸€å®šçš„æµªè´¹ã€‚å¦‚æœä½¿ç”¨å®Œå…¨å…±äº«çš„æ–¹æ¡ˆï¼Œåœ¨èµ„æºåˆ©ç”¨å’Œæˆæœ¬ä¸Šä¼šéå¸¸å¥½ï¼Œç„¶è€Œï¼Œå¼€å‘éš¾åº¦éå¸¸å¤§ï¼Œè€Œä¸”æ•°æ®å’Œèµ„æºéš”ç¦»éå¸¸ä¸å¥½ã€‚\néš”ç¦»è®¾è®¡çš„é‡ç‚¹ æˆ‘ä»¬éœ€è¦å®šä¹‰å¥½éš”ç¦»ä¸šåŠ¡çš„å¤§å°å’Œç²’åº¦ï¼Œè¿‡å¤§å’Œè¿‡å°éƒ½ä¸å¥½ã€‚è¿™éœ€è¦è®¤çœŸåœ°åšä¸šåŠ¡ä¸Šçš„éœ€æ±‚å’Œç³»ç»Ÿåˆ†æã€‚ æ— è®ºæ˜¯åšç³»ç»Ÿæ¿å—è¿˜æ˜¯å¤šç§Ÿæˆ·çš„éš”ç¦»ï¼Œä½ éƒ½éœ€è¦è€ƒè™‘ç³»ç»Ÿçš„å¤æ‚åº¦ã€æˆæœ¬ã€æ€§èƒ½ã€èµ„æºä½¿ç”¨çš„é—®é¢˜ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„å‡è¡¡æ–¹æ¡ˆï¼Œæˆ–æ˜¯åˆ†å¸ƒå®æ–½çš„æ–¹æ¡ˆå°¤å…¶é‡è¦ï¼Œè¿™å…¶ä¸­éœ€è¦ä½ å®šä¹‰å¥½è¦ä»€ä¹ˆå’Œä¸è¦ä»€ä¹ˆã€‚å› ä¸ºï¼Œæˆ‘ä»¬ä¸å¯èƒ½åšå‡ºä¸€ä¸ªä»€ä¹ˆéƒ½èƒ½æ»¡è¶³çš„ç³»ç»Ÿã€‚ éš”ç¦»æ¨¡å¼éœ€è¦é…ç½®ä¸€äº›é«˜å¯ç”¨ã€é‡è¯•ã€å¼‚æ­¥ã€æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæµæ§ã€ç†”æ–­ç­‰è®¾è®¡æ¨¡å¼çš„æ–¹å¼é…å¥—ä½¿ç”¨ã€‚ ä¸è¦å¿˜è®°äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è¿ç»´çš„å¤æ‚åº¦çš„æå‡ï¼Œè¦èƒ½é©¾é©­å¾—å¥½çš„è¯ï¼Œè¿˜éœ€è¦å¾ˆå¤šè‡ªåŠ¨åŒ–è¿ç»´çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨åƒå®¹å™¨æˆ–æ˜¯è™šæ‹Ÿæœºè¿™æ ·çš„è™šæ‹ŸåŒ–æŠ€æœ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´æ–¹ä¾¿åœ°ç®¡ç†ï¼Œå’Œå¯¹æ¯”èµ„æºæ›´å¥½åœ°åˆ©ç”¨ã€‚å¦åˆ™åšå‡ºæ¥äº†ä¹Ÿç®¡ç†ä¸å¥½ã€‚ æœ€åï¼Œä½ éœ€è¦ä¸€ä¸ªéå¸¸å®Œæ•´çš„èƒ½å¤Ÿçœ‹å¾—åˆ°æ‰€æœ‰æœåŠ¡çš„ç›‘æ§ç³»ç»Ÿï¼Œè¿™ç‚¹éå¸¸é‡è¦ã€‚ å¼‚æ­¥é€šè®¯è®¾è®¡ åŒæ­¥è°ƒç”¨è™½ç„¶è®©ç³»ç»Ÿé—´åªè€¦åˆäºæ¥å£ï¼Œè€Œä¸”å®æ—¶æ€§ä¹Ÿä¼šæ¯”å¼‚æ­¥è°ƒç”¨è¦é«˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿéœ€è¦çŸ¥é“åŒæ­¥è°ƒç”¨ä¼šå¸¦æ¥å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ã€‚\nåŒæ­¥è°ƒç”¨éœ€è¦è¢«è°ƒç”¨æ–¹çš„ååä¸ä½äºè°ƒç”¨æ–¹çš„ååã€‚ åŒæ­¥è°ƒç”¨ä¼šå¯¼è‡´è°ƒç”¨æ–¹ä¸€ç›´åœ¨ç­‰å¾…è¢«è°ƒç”¨æ–¹å®Œæˆï¼Œå¦‚æœä¸€å±‚æ¥ä¸€å±‚åœ°åŒæ­¥è°ƒç”¨ä¸‹å»ï¼Œæ‰€æœ‰çš„å‚ä¸æ–¹ä¼šæœ‰ç›¸åŒçš„ç­‰å¾…æ—¶é—´ã€‚è¿™ä¼šéå¸¸æ¶ˆè€—è°ƒç”¨æ–¹çš„èµ„æºã€‚å› ä¸ºè°ƒç”¨æ–¹éœ€è¦ä¿å­˜ç°åœºï¼ˆContextï¼‰ç­‰å¾…è¿œç«¯è¿”å›ï¼Œæ‰€ä»¥å¯¹äºå¹¶å‘æ¯”è¾ƒé«˜çš„åœºæ™¯æ¥è¯´ï¼Œè¿™æ ·çš„ç­‰å¾…å¯èƒ½ä¼šæåº¦æ¶ˆè€—èµ„æºã€‚ åŒæ­¥è°ƒç”¨åªèƒ½æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå¾ˆéš¾åšåˆ°ä¸€å¯¹å¤šã€‚ åŒæ­¥è°ƒç”¨æœ€ä¸å¥½çš„æ˜¯ï¼Œå¦‚æœè¢«è°ƒç”¨æ–¹æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå…¶è°ƒç”¨æ–¹å°±ä¼šè·Ÿç€å‡ºé—®é¢˜ï¼Œäºæ˜¯ä¼šå‡ºç°å¤šç±³è¯ºéª¨ç‰Œæ•ˆåº”ï¼Œæ•…éšœä¸€ä¸‹å°±è”“å»¶å¼€æ¥ã€‚ å¼‚æ­¥é€šè®¯çš„ä¸‰ç§æ–¹å¼ è¯·æ±‚å“åº”å¼ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€æ–¹ï¼ˆsenderï¼‰ä¼šç›´æ¥è¯·æ±‚æ¥æ”¶æ–¹ï¼ˆreceiverï¼‰ï¼Œè¢«è¯·æ±‚æ–¹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œç›´æ¥è¿”å›â€”â€”æ”¶åˆ°è¯·æ±‚ï¼Œæ­£åœ¨å¤„ç†ã€‚å¯¹äºè¿”å›ç»“æœï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯å‘é€æ–¹æ—¶ä¸æ—¶åœ°å»è½®è¯¢ä¸€ä¸‹ï¼Œé—®ä¸€ä¸‹å¹²æ²¡å¹²å®Œã€‚å¦ä¸€ç§æ–¹å¼æ˜¯å‘é€æ–¹æ³¨å†Œä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶æ–¹å¤„ç†å®Œåå›è°ƒè¯·æ±‚æ–¹ã€‚ é€šè¿‡è®¢é˜…çš„æ–¹å¼ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œæ¥æ”¶æ–¹ï¼ˆreceiverï¼‰ä¼šæ¥è®¢é˜…å‘é€æ–¹ï¼ˆsenderï¼‰çš„æ¶ˆæ¯ï¼Œå‘é€æ–¹ä¼šæŠŠç›¸å…³çš„æ¶ˆæ¯æˆ–æ•°æ®æ”¾åˆ°æ¥æ”¶æ–¹æ‰€è®¢é˜…çš„é˜Ÿåˆ—ä¸­ï¼Œè€Œæ¥æ”¶æ–¹ä¼šä»é˜Ÿåˆ—ä¸­è·å–æ•°æ®ã€‚ é€šè¿‡ Broker çš„æœºåˆ¶ã€‚ æ‰€è°“ Brokerï¼Œå°±æ˜¯ä¸€ä¸ªä¸­é—´äººï¼Œå‘é€æ–¹ï¼ˆsenderï¼‰å’Œæ¥æ”¶æ–¹ï¼ˆreceiverï¼‰éƒ½äº’ç›¸çœ‹ä¸åˆ°å¯¹æ–¹ï¼Œå®ƒä»¬çœ‹å¾—åˆ°çš„æ˜¯ä¸€ä¸ª Brokerï¼Œå‘é€æ–¹å‘ Broker å‘é€æ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹å‘ Broker è®¢é˜…æ¶ˆæ¯ã€‚ äº‹ä»¶é©±åŠ¨è®¾è®¡ äº‹ä»¶é©±åŠ¨æœ€å¥½æ˜¯ä½¿ç”¨ Broker æ–¹å¼ï¼ŒæœåŠ¡é—´é€šè¿‡äº¤æ¢æ¶ˆæ¯æ¥å®Œæˆäº¤æµå’Œæ•´ä¸ªæµç¨‹çš„é©±åŠ¨ã€‚ äº‹ä»¶é©±åŠ¨æ–¹å¼çš„å¥½å¤„\næœåŠ¡é—´çš„ä¾èµ–æ²¡æœ‰äº†ï¼ŒæœåŠ¡é—´æ˜¯å¹³ç­‰çš„ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æ˜¯é«˜åº¦å¯é‡ç”¨å¹¶å¯è¢«æ›¿æ¢çš„ã€‚ æœåŠ¡çš„å¼€å‘ã€æµ‹è¯•ã€è¿ç»´ï¼Œä»¥åŠæ•…éšœå¤„ç†éƒ½æ˜¯é«˜åº¦éš”ç¦»çš„ã€‚ æœåŠ¡é—´é€šè¿‡äº‹ä»¶å…³è”ï¼Œæ‰€ä»¥æœåŠ¡é—´æ˜¯ä¸ä¼šç›¸äº’ block çš„ã€‚ åœ¨æœåŠ¡é—´å¢åŠ ä¸€äº› Adapterï¼ˆå¦‚æ—¥å¿—ã€è®¤è¯ã€ç‰ˆæœ¬ã€é™æµã€é™çº§ã€ç†”æ–­ç­‰ï¼‰ç›¸å½“å®¹æ˜“ã€‚ æœåŠ¡é—´çš„ååä¹Ÿè¢«è§£å¼€äº†ï¼Œå„ä¸ªæœåŠ¡å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å¤„ç†é€Ÿåº¦å¤„ç†ã€‚ åå¤„ï¼š\nä¸šåŠ¡æµç¨‹ä¸å†é‚£ä¹ˆæ˜æ˜¾å’Œå¥½ç®¡ç†ã€‚æ•´ä¸ªæ¶æ„å˜å¾—æ¯”è¾ƒå¤æ‚ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦æœ‰ä¸€äº›å¯è§†åŒ–çš„å·¥å…·æ¥å‘ˆç°æ•´ä½“ä¸šåŠ¡æµç¨‹ã€‚ äº‹ä»¶å¯èƒ½ä¼šä¹±åºã€‚è¿™ä¼šå¸¦æ¥éå¸¸ Bug çš„äº‹ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦å¾ˆå¥½åœ°ç®¡ç†ä¸€ä¸ªçŠ¶æ€æœºçš„æ§åˆ¶ã€‚ äº‹åŠ¡å¤„ç†å˜å¾—å¤æ‚ã€‚éœ€è¦ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤æ¥åšå¼ºä¸€è‡´æ€§ï¼Œæˆ–æ˜¯é€€ç¼©åˆ°æœ€ç»ˆä¸€è‡´æ€§ã€‚ å¹‚ç­‰æ€§è®¾è®¡ è®¢å•åˆ›å»ºæ¥å£ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨è¶…æ—¶äº†ï¼Œç„¶åè°ƒç”¨æ–¹é‡è¯•äº†ä¸€æ¬¡ã€‚æ˜¯å¦ä¼šå¤šåˆ›å»ºä¸€ç¬”è®¢å•ï¼Ÿ\nä¸¤ç§å¤„ç†æ–¹å¼ã€‚\nè¶…æ—¶ä¸‹æ¸¸ç³»ç»Ÿæä¾›ç›¸åº”çš„æŸ¥è¯¢æ¥å£ã€‚ é€šè¿‡å¹‚ç­‰æ€§çš„æ–¹å¼ã€‚ å¯¹äºç¬¬ä¸€ç§æ–¹å¼ï¼Œéœ€è¦å¯¹æ–¹æä¾›ä¸€ä¸ªæŸ¥è¯¢æ¥å£æ¥åšé…åˆã€‚è€Œç¬¬äºŒç§æ–¹å¼åˆ™éœ€è¦ä¸‹æ¸¸çš„ç³»ç»Ÿæä¾›æ”¯æŒå¹‚ç­‰æ€§çš„äº¤æ˜“æ¥å£ã€‚\nå”¯ä¸€ ID ç»ä¸€ä¸ª Twitter çš„å¼€æºé¡¹ç›® Snowflake å…·ä½“çš„æ–¹å¼ å¯¹äºå¹‚ç­‰æ€§çš„å¤„ç†æµç¨‹æ¥è¯´ï¼Œè¯´ç™½äº†å°±æ˜¯è¦è¿‡æ»¤ä¸€ä¸‹å·²ç»æ”¶åˆ°çš„äº¤æ˜“ã€‚è¦åšåˆ°è¿™ä¸ªäº‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå­˜å‚¨æ¥è®°å½•æ”¶åˆ°çš„äº¤æ˜“ã€‚\näºæ˜¯ï¼Œå½“æ”¶åˆ°äº¤æ˜“è¯·æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¼šåˆ°è¿™ä¸ªå­˜å‚¨ä¸­å»æŸ¥è¯¢ã€‚å¦‚æœæŸ¥æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå°±ä¸å†åšæŸ¥è¯¢äº†ï¼Œå¹¶æŠŠä¸Šæ¬¡åšçš„ç»“æœè¿”å›ã€‚å¦‚æœæ²¡æœ‰æŸ¥åˆ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®°å½•ä¸‹æ¥ã€‚\nä½†æ˜¯ï¼Œä¸Šé¢è¿™ä¸ªæµç¨‹æœ‰ä¸ªé—®é¢˜ã€‚å› ä¸ºç»å¤§å¤šæ•°è¯·æ±‚åº”è¯¥éƒ½ä¸ä¼šæ˜¯é‡æ–°å‘è¿‡æ¥çš„ï¼Œæ‰€ä»¥è®© 100% çš„è¯·æ±‚éƒ½åˆ°è¿™ä¸ªå­˜å‚¨é‡Œå»æŸ¥ä¸€ä¸‹ï¼Œè¿™ä¼šå¯¼è‡´å¤„ç†æµç¨‹å˜å¾—å¾ˆæ…¢ã€‚æ‰€ä»¥ï¼Œæœ€å¥½æ˜¯å½“è¿™ä¸ªå­˜å‚¨å‡ºç°å†²çªçš„æ—¶å€™ä¼šæŠ¥é”™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ”¶åˆ°äº¤æ˜“è¯·æ±‚åï¼Œç›´æ¥å»å­˜å‚¨é‡Œè®°å½•è¿™ä¸ª IDï¼ˆç›¸å¯¹äºæ•°æ®çš„ Insert æ“ä½œï¼‰ï¼Œå¦‚æœå‡ºç° ID å†²çªäº†çš„å¼‚å¸¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“è¿™ä¸ªä¹‹å‰å·²ç»æœ‰äººå‘è¿‡æ¥äº†ï¼Œæ‰€ä»¥å°±ä¸ç”¨å†åšäº†ã€‚æ¯”å¦‚ï¼Œæ•°æ®åº“ä¸­ä½ å¯ä»¥ä½¿ç”¨ insert into â€¦ values â€¦ on DUPLICATE KEY UPDATE â€¦ è¿™æ ·çš„æ“ä½œã€‚\nå¯¹äºæ›´æ–°çš„åœºæ™¯æ¥è¯´ï¼Œå¦‚æœåªæ˜¯çŠ¶æ€æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ã€‚å¦‚æœå‡ºé”™ï¼Œè¦ä¹ˆæ˜¯éæ³•æ“ä½œï¼Œè¦ä¹ˆæ˜¯å·²è¢«æ›´æ–°ï¼Œè¦ä¹ˆæ˜¯çŠ¶æ€ä¸å¯¹ï¼Œæ€»ä¹‹å¤šæ¬¡è°ƒç”¨æ˜¯ä¸ä¼šæœ‰å‰¯ä½œç”¨çš„ã€‚update table set status = â€œpaidâ€ where id = xxx and status = â€œunpaidâ€;\næœåŠ¡çŠ¶æ€ æ‰€è°“â€œçŠ¶æ€â€ï¼Œå°±æ˜¯ä¸ºäº†ä¿ç•™ç¨‹åºçš„ä¸€äº›æ•°æ®æˆ–æ˜¯ä¸Šä¸‹æ–‡ã€‚\nç¨‹åºè°ƒç”¨çš„ç»“æœã€‚ æœåŠ¡ç»„åˆä¸‹çš„ä¸Šä¸‹æ–‡ã€‚ æœåŠ¡çš„é…ç½®ã€‚\næ— çŠ¶æ€çš„æœåŠ¡ Stateless ä¸ºäº†åšå‡ºæ— çŠ¶æ€çš„æœåŠ¡ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æŠŠçŠ¶æ€ä¿å­˜åˆ°å…¶ä»–çš„åœ°æ–¹ã€‚ æ¯”å¦‚ï¼Œä¸å¤ªé‡è¦çš„æ•°æ®å¯ä»¥æ”¾åˆ° Redis ä¸­ï¼Œé‡è¦çš„æ•°æ®å¯ä»¥æ”¾åˆ° MySQL ä¸­ï¼Œæˆ–æ˜¯åƒ ZooKeeper/Etcd è¿™æ ·çš„é«˜å¯ç”¨çš„å¼ºä¸€è‡´æ€§çš„å­˜å‚¨ä¸­ï¼Œæˆ–æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬ä¸ºäº†åšæˆæ— çŠ¶æ€çš„æœåŠ¡ï¼Œä¼šå¯¼è‡´è¿™äº›æœåŠ¡éœ€è¦è€¦åˆç¬¬ä¸‰æ–¹æœ‰çŠ¶æ€çš„å­˜å‚¨æœåŠ¡ã€‚ä¸€æ–¹é¢æ˜¯æœ‰ä¾èµ–ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¢åŠ äº†ç½‘ç»œå¼€é”€ï¼Œå¯¼è‡´æœåŠ¡çš„å“åº”æ—¶é—´ä¹Ÿä¼šå˜æ…¢ã€‚æ‰€ä»¥ï¼Œç¬¬ä¸‰æ–¹çš„è¿™äº›å­˜å‚¨æœåŠ¡ä¹Ÿå¿…é¡»è¦åšæˆé«˜å¯ç”¨é«˜æ‰©å±•çš„æ–¹å¼ã€‚ è€Œä¸”ï¼Œä¸ºäº†å‡å°‘ç½‘ç»œå¼€é”€ï¼Œè¿˜éœ€è¦åœ¨æ— çŠ¶æ€çš„æœåŠ¡ä¸­å¢åŠ ç¼“å­˜æœºåˆ¶ã€‚ç„¶è€Œï¼Œä¸‹æ¬¡è¿™ä¸ªç”¨æˆ·çš„è¯·æ±‚å¹¶ä¸ä¸€å®šä¼šåœ¨åŒä¸€å°æœºå™¨ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªç¼“å­˜ä¼šåœ¨æ‰€æœ‰çš„æœºå™¨ä¸Šéƒ½åˆ›å»ºï¼Œä¹Ÿç®—æ˜¯ä¸€ç§æµªè´¹å§ã€‚\næœ‰çŠ¶æ€çš„æœåŠ¡ Stateful è¡¥å¿äº‹åŠ¡ åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é—®é¢˜å°±æ˜¯ï¼Œä¸€ä¸ªä¸šåŠ¡æµç¨‹éœ€è¦ç»„åˆä¸€ç»„æœåŠ¡ã€‚è¿™æ ·çš„äº‹æƒ…åœ¨å¾®æœåŠ¡ä¸‹å°±æ›´ä¸ºæ˜æ˜¾äº†ï¼Œå› ä¸ºè¿™éœ€è¦ä¸šåŠ¡ä¸Šä¸€è‡´æ€§çš„ä¿è¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªæ­¥éª¤å¤±è´¥äº†ï¼Œé‚£ä¹ˆè¦ä¹ˆå›æ»šåˆ°ä»¥å‰çš„æœåŠ¡è°ƒç”¨ï¼Œè¦ä¹ˆä¸æ–­é‡è¯•ä¿è¯æ‰€æœ‰çš„æ­¥éª¤éƒ½æˆåŠŸã€‚\nACID å’Œ BASE ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ç³»ç»Ÿçš„äº‹åŠ¡éƒ½æœ‰ ACID å±æ€§ï¼Œå³åŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼Œåˆç§°ç‹¬ç«‹æ€§ï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚ Basic Availabilityï¼šåŸºæœ¬å¯ç”¨ã€‚è¿™æ„å‘³ç€ï¼Œç³»ç»Ÿå¯ä»¥å‡ºç°æš‚æ—¶ä¸å¯ç”¨çš„çŠ¶æ€ï¼Œè€Œåé¢ä¼šå¿«é€Ÿæ¢å¤ã€‚Soft-stateï¼šè½¯çŠ¶æ€ã€‚å®ƒæ˜¯æˆ‘ä»¬å‰é¢çš„â€œæœ‰çŠ¶æ€â€å’Œâ€œæ— çŠ¶æ€â€çš„æœåŠ¡çš„ä¸€ç§ä¸­é—´çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è®©æœåŠ¡æš‚æ—¶ä¿å­˜ä¸€äº›çŠ¶æ€æˆ–æ•°æ®ï¼Œè¿™äº›çŠ¶æ€å’Œæ•°æ®ä¸æ˜¯å¼ºä¸€è‡´æ€§çš„ã€‚Eventual Consistencyï¼šæœ€ç»ˆä¸€è‡´æ€§ï¼Œç³»ç»Ÿåœ¨ä¸€ä¸ªçŸ­æš‚çš„æ—¶é—´æ®µå†…æ˜¯ä¸ä¸€è‡´çš„ï¼Œä½†æœ€ç»ˆæ•´ä¸ªç³»ç»Ÿçœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚\nBASE ç³»ç»Ÿæ˜¯å…è®¸æˆ–æ˜¯å®¹å¿ç³»ç»Ÿå‡ºç°æš‚æ—¶æ€§é—®é¢˜çš„ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå°±èƒ½æ›´æœ‰å¼¹åŠ›ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸–ç•Œé‡Œï¼Œæ•…éšœæ˜¯ä¸å¯é¿å…çš„ï¼Œæˆ‘ä»¬èƒ½åšçš„å°±æ˜¯æŠŠæ•…éšœå¤„ç†å½“æˆåŠŸèƒ½å†™å…¥ä»£ç ä¸­ï¼Œè¿™å°±æ˜¯ Design for Failureã€‚\nä¹°ä¹¦ï¼š ACID çš„ç©æ³•å°±æ˜¯ï¼Œå¤§å®¶åœ¨ä¹°åŒä¸€æœ¬ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·çš„è´­ä¹°è¯·æ±‚éƒ½éœ€è¦æŠŠåº“å­˜é”ä½ï¼Œç­‰å‡å®Œåº“å­˜åï¼ŒæŠŠé”é‡Šæ”¾å‡ºæ¥ï¼Œåç»­çš„äººæ‰èƒ½è¿›è¡Œè´­ä¹°ã€‚äºæ˜¯ï¼Œåœ¨ ACID çš„ç©æ³•ä¸‹ï¼Œæˆ‘ä»¬åœ¨åŒä¸€æ—¶é—´ä¸å¯èƒ½æœ‰å¤šä¸ªç”¨æˆ·ä¸‹å•ï¼Œæˆ‘ä»¬çš„è®¢å•æµç¨‹éœ€è¦æœ‰æ’é˜Ÿçš„æƒ…å†µï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±ä¸å¯èƒ½åšå‡ºæ€§èƒ½æ¯”è¾ƒé«˜çš„ç³»ç»Ÿæ¥ã€‚\nç”¨æˆ·åº“å­˜ï¼Œ çœŸå®åº“å­˜ ã€‚ äºšé©¬é€Šçš„æ–¹å¼ï¼Œ è¦æ ¹æ®ç”¨æˆ·çš„åœ°å€å»ä¸åŒçš„ä»“åº“æŸ¥çœ‹åº“å­˜ï¼Œå¾ˆè€—æ—¶ã€‚ å¼‚æ­¥é‚®ä»¶å‘é€ã€‚ ä¸šåŠ¡è¡¥å¿ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•åšåˆ°å¼ºä¸€è‡´çš„ ACID çš„ã€‚ç‰¹åˆ«æ˜¯æˆ‘ä»¬éœ€è¦è·¨å¤šä¸ªç³»ç»Ÿçš„æ—¶å€™ï¼Œè€Œä¸”è¿™äº›ç³»ç»Ÿè¿˜ä¸æ˜¯ç”±ä¸€ä¸ªå…¬å¸æ‰€æä¾›çš„ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œä¸šåŠ¡çš„äº‹åŠ¡è¡¥å¿éƒ½æ˜¯éœ€è¦ä¸€ä¸ªå·¥ä½œæµå¼•æ“çš„ã€‚äºšé©¬é€Šæ˜¯ä¸€ä¸ªè¶…çº§å–œæ¬¢å·¥ä½œæµå¼•æ“çš„å…¬å¸ï¼Œè¿™ä¸ªå·¥ä½œæµå¼•æ“æŠŠå„å¼å„æ ·çš„æœåŠ¡ç»™ä¸²è”åœ¨ä¸€èµ·ï¼Œå¹¶åœ¨å·¥ä½œæµä¸Šåšç›¸åº”çš„ä¸šåŠ¡è¡¥å¿ï¼Œæ•´ä¸ªè¿‡ç¨‹è®¾è®¡æˆä¸ºæœ€ç»ˆä¸€è‡´æ€§çš„ã€‚\nä¸€ä¸ªå¥½çš„ä¸šåŠ¡è¡¥å¿æœºåˆ¶éœ€è¦åšåˆ°ä¸‹é¢è¿™å‡ ç‚¹ã€‚\nè¦èƒ½æ¸…æ¥šåœ°æè¿°å‡ºè¦è¾¾åˆ°ä»€ä¹ˆæ ·çš„çŠ¶æ€ï¼ˆæ¯”å¦‚ï¼šè¯·å‡ã€æœºç¥¨ã€é…’åº—è¿™ä¸‰ä¸ªéƒ½å¿…é¡»æˆåŠŸï¼Œç§Ÿè½¦æ˜¯å¯é€‰çš„ï¼‰ï¼Œä»¥åŠå¦‚æœå…¶ä¸­çš„æ¡ä»¶ä¸æ»¡è¶³ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬è¦å›é€€åˆ°å“ªä¸€ä¸ªçŠ¶æ€ã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ•´ä¸ªä¸šåŠ¡çš„èµ·å§‹çŠ¶æ€å®šä¹‰ã€‚ å½“æ•´æ¡ä¸šåŠ¡è·‘èµ·æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸²è¡Œæˆ–å¹¶è¡Œåœ°åšè¿™äº›äº‹ã€‚å¯¹äºæ—…æ¸¸è®¢ç¥¨æ˜¯å¯ä»¥å¹¶è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºç½‘è´­æµç¨‹ï¼ˆä¸‹å•ã€æ”¯ä»˜ã€é€è´§ï¼‰æ˜¯ä¸èƒ½å¹¶è¡Œçš„ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿéœ€è¦åŠªåŠ›åœ°é€šè¿‡ä¸€ç³»åˆ—çš„æ“ä½œè¾¾åˆ°ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„çŠ¶æ€ã€‚å¦‚æœè¾¾ä¸åˆ°ï¼Œå°±éœ€è¦é€šè¿‡è¡¥å¿æœºåˆ¶å›æ»šåˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚è¿™å°±æ˜¯æ‰€è°“çš„çŠ¶æ€æ‹Ÿåˆã€‚ å¯¹äºå·²ç»å®Œæˆçš„äº‹åŠ¡è¿›è¡Œæ•´ä½“ä¿®æ”¹ï¼Œå¯ä»¥è€ƒè™‘æˆä¸€ä¸ªä¿®æ”¹äº‹åŠ¡ã€‚ ä¸šåŠ¡è¡¥å¿çš„è®¾è®¡é‡ç‚¹ ä¸šåŠ¡è¡¥å¿ä¸»è¦åšä¸¤ä»¶äº‹ã€‚\nåŠªåŠ›åœ°æŠŠä¸€ä¸ªä¸šåŠ¡æµç¨‹æ‰§è¡Œå®Œæˆã€‚ å¦‚æœæ‰§è¡Œä¸ä¸‹å»ï¼Œéœ€è¦å¯åŠ¨è¡¥å¿æœºåˆ¶ï¼Œå›æ»šä¸šåŠ¡æµç¨‹ã€‚ æŠŠä¸€ä¸ªä¸šåŠ¡æµç¨‹æ‰§è¡Œå®Œæˆï¼Œéœ€è¦è¿™ä¸ªæµç¨‹ä¸­æ‰€æ¶‰åŠçš„æœåŠ¡æ–¹æ”¯æŒå¹‚ç­‰æ€§ã€‚å¹¶ä¸”åœ¨ä¸Šæ¸¸æœ‰é‡è¯•æœºåˆ¶ã€‚ æˆ‘ä»¬éœ€è¦å°å¿ƒç»´æŠ¤å’Œç›‘æ§æ•´ä¸ªè¿‡ç¨‹çš„çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œåƒä¸‡ä¸è¦æŠŠè¿™äº›çŠ¶æ€æ”¾åˆ°ä¸åŒçš„ç»„ä»¶ä¸­ï¼Œæœ€å¥½æ˜¯ä¸€ä¸ªä¸šåŠ¡æµç¨‹çš„æ§åˆ¶æ–¹æ¥åšè¿™ä¸ªäº‹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå·¥ä½œæµå¼•æ“ã€‚ è¡¥å¿çš„ä¸šåŠ¡é€»è¾‘å’Œæµç¨‹ä¸ä¸€å®šéå¾—æ˜¯ä¸¥æ ¼åå‘æ“ä½œã€‚æœ‰æ—¶å€™å¯ä»¥å¹¶è¡Œï¼Œæœ‰æ—¶å€™å¯ä»¥ä¸²è¡Œï¼Œå¯èƒ½ä¼šæ›´ç®€å•ã€‚ ä¸šåŠ¡è¡¥å¿çš„ä¸šåŠ¡é€»è¾‘æ˜¯å¼ºä¸šåŠ¡ç›¸å…³çš„ï¼Œå¾ˆéš¾åšæˆé€šç”¨çš„ã€‚ é‡è¯• åœºæ™¯ â€œé‡è¯•â€çš„è¯­ä¹‰æ˜¯æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªæ•…éšœæ˜¯æš‚æ—¶çš„ï¼Œè€Œä¸æ˜¯æ°¸ä¹…çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼šå»é‡è¯•ã€‚ è®¾è®¡é‡è¯•æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å‡ºä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦é‡è¯•ï¼Œä¾‹å¦‚ï¼Œè°ƒç”¨è¶…æ—¶ã€è¢«è°ƒç”¨ç«¯è¿”å›äº†æŸç§å¯ä»¥é‡è¯•çš„é”™è¯¯ï¼ˆå¦‚ç¹å¿™ä¸­ã€æµæ§ä¸­ã€ç»´æŠ¤ä¸­ã€èµ„æºä¸è¶³ç­‰ï¼‰ã€‚ ä¸€äº›åˆ«çš„é”™è¯¯ï¼Œåˆ™æœ€å¥½ä¸è¦é‡è¯•ï¼Œæ¯”å¦‚ï¼šä¸šåŠ¡çº§çš„é”™è¯¯ï¼ˆå¦‚æ²¡æœ‰æƒé™ã€æˆ–æ˜¯éæ³•æ•°æ®ç­‰é”™è¯¯ï¼‰ï¼ŒæŠ€æœ¯ä¸Šçš„é”™è¯¯ï¼ˆå¦‚ï¼šHTTP çš„ 503 ç­‰ï¼Œè¿™ç§åŸå› å¯èƒ½æ˜¯è§¦å‘äº†ä»£ç çš„ bugï¼Œé‡è¯•ä¸‹å»æ²¡æœ‰æ„ä¹‰ï¼‰ã€‚\nç­–ç•¥ éƒ½éœ€è¦æœ‰ä¸ªé‡è¯•çš„æœ€å¤§å€¼ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´ä¸æ–­çš„é‡è¯•åï¼Œå°±æ²¡æœ‰å¿…è¦å†é‡è¯•äº†ï¼Œåº”è¯¥æŠ¥æ•…éšœäº†ã€‚ ï¼ŒExponential Backoff çš„ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œæŒ‡æ•°çº§é€€é¿â€ã€‚ï¼ˆTCP æ‹¥å¡æ§åˆ¶ï¼‰ Spring çš„é‡è¯•ç­–ç•¥ã€‚ä¸ªå•ç‹¬å®ç°é‡è¯•åŠŸèƒ½çš„é¡¹ç›® è®¾è®¡çš„é‡ç‚¹ è¦ç¡®å®šä»€ä¹ˆæ ·çš„é”™è¯¯ä¸‹éœ€è¦é‡è¯•ï¼› é‡è¯•çš„æ—¶é—´å’Œé‡è¯•çš„æ¬¡æ•°ã€‚ ä¸åŒåœºæ™¯å¯èƒ½éœ€è¦ä¸åŒçš„ç­–ç•¥ã€‚ ï¼ˆæ¯”å¦‚æµæ§ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨æŒ‡æ•°é€€é¿çš„æ–¹å¼ï¼Œä»¥é¿å…é€ æˆæ›´å¤šçš„æµé‡ã€‚ï¼‰ å¦‚æœè¶…è¿‡é‡è¯•æ¬¡æ•°ï¼Œæˆ–æ˜¯ä¸€æ®µæ—¶é—´ï¼Œé‚£ä¹ˆé‡è¯•å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚ é‡è¯•è¿˜éœ€è¦è€ƒè™‘è¢«è°ƒç”¨æ–¹æ˜¯å¦æœ‰å¹‚ç­‰çš„è®¾è®¡ã€‚ å¯¹äºæœ‰äº‹åŠ¡ç›¸å…³çš„æ“ä½œã€‚æˆ‘ä»¬å¯èƒ½ä¼šå¸Œæœ›èƒ½é‡è¯•æˆåŠŸï¼Œè€Œä¸è‡³äºèµ°ä¸šåŠ¡è¡¥å¿é‚£æ ·çš„å¤æ‚çš„å›é€€æµç¨‹ã€‚ è®°å½•è¯·æ±‚ã€‚ ç†”æ–­è®¾è®¡ ç†”æ–­æœºåˆ¶è¿™ä¸ªè¯å¯¹ä½ æ¥è¯´è‚¯å®šä¸é™Œç”Ÿï¼Œå®ƒçš„çµæ„Ÿæ¥æºäºæˆ‘ä»¬ç”µé—¸ä¸Šçš„â€œä¿é™©ä¸â€ã€‚ åœ¨æˆ‘ä»¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡ä¸­ï¼Œä¹Ÿåº”è¯¥æœ‰è¿™æ ·çš„æ–¹å¼ã€‚å‰é¢è¯´è¿‡é‡è¯•æœºåˆ¶ï¼Œå¦‚æœé”™è¯¯å¤ªå¤šï¼Œæˆ–æ˜¯åœ¨çŸ­æ—¶é—´å†…å¾—ä¸åˆ°ä¿®å¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬é‡è¯•ä¹Ÿæ²¡æœ‰æ„ä¹‰äº†ï¼Œæ­¤æ—¶åº”è¯¥å¼€å¯æˆ‘ä»¬çš„ç†”æ–­æ“ä½œï¼Œå°¤å…¶æ˜¯åç«¯å¤ªå¿™çš„æ—¶å€™ï¼Œä½¿ç”¨ç†”æ–­è®¾è®¡å¯ä»¥ä¿æŠ¤åç«¯ä¸ä¼šè¿‡è½½ã€‚ ç†”æ–­è®¾è®¡æ˜¯å—äº†ç”µè·¯è®¾è®¡ä¸­ä¿é™©ä¸çš„å¯å‘ï¼Œå…¶éœ€è¦å®ç°ä¸‰ä¸ªçŠ¶æ€ï¼šé—­åˆã€æ–­å¼€å’ŒåŠå¼€ï¼Œåˆ†åˆ«å¯¹åº”äºæ­£å¸¸ã€æ•…éšœå’Œæ•…éšœåæ£€æµ‹æ•…éšœæ˜¯å¦å·²è¢«ä¿®å¤çš„åœºæ™¯ï¼Œå¹¶ä»‹ç»äº† Netflix çš„ Hystrix å¯¹ç†”æ–­çš„å®ç°ã€‚\né™æµè®¾è®¡ ç›®çš„ï¼š ä¿æŠ¤ç³»ç»Ÿä¸ä¼šåœ¨è¿‡è½½çš„æƒ…å†µä¸‹å‡ºç°é—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦é™æµã€‚\né™æµç­–ç•¥ æ‹’ç»æœåŠ¡ã€‚æŠŠå¤šå‡ºæ¥çš„è¯·æ±‚æ‹’ç»æ‰ æœåŠ¡é™çº§ã€‚å…³é—­æˆ–æ˜¯æŠŠåç«¯æœåŠ¡åšé™çº§å¤„ç†ã€‚ ç‰¹æƒè¯·æ±‚ã€‚ vip å»¶æ—¶å¤„ç†ã€‚ çŸ­æš‚çš„å³°å€¼ã€‚ å¼¹æ€§ä¼¸ç¼©ã€‚ æ•°æ®åº“å‹åŠ›è¿‡å¤§ï¼Œæ²¡ç”¨ã€‚ é™æµçš„å®ç°æ–¹å¼ è®¡æ•°å™¨æ–¹å¼ï¼Œ\né˜Ÿåˆ—ç®—æ³•ï¼ˆä¼˜å…ˆçº§ï¼‰ï¼Œæ¼æ¡¶æ³•ï¼Œä»¤ç‰Œæ¡¶æ³•ã€‚ åŸºæœ¬åŸç†éƒ½æ˜¯ é˜Ÿåˆ—ç¼“å­˜ã€‚ å›ºå®šçª—å£ï¼Œæ»‘åŠ¨çª—å£ï¼š (sentinel) https://ata.alibaba-inc.com/articles/249558 ç¯å½¢æ•°ç»„ LeapArray æ¥ç»Ÿè®¡å®æ—¶çš„ç§’çº§æŒ‡æ ‡æ•°æ®. å†™å¤šäºè¯»çš„é«˜å¹¶å‘åœºæ™¯ã€‚ ç¯å½¢æ•°ç»„ï¼š\næ„å»º æ•°ç»„é•¿åº¦ï¼Œ æ•°æ®çš„æ—¶é—´ ã€‚ æ¯ä¸ªçª—å£æ—¶é—´ å®šä½ï¼š æ—¶é—´æˆ³/ çª—å£æ—¶é—´ % æ•°æ®é•¿åº¦ ã€‚ çª—å£å¼€å§‹ = æ—¶é—´æˆ³ - æ—¶é—´æˆ³%æ—¶é—´é—´éš” åˆ¤æ–­å½“å‰çª—å£ ï¼Ÿ ä¸ºç©ºï¼Œç›´æ¥åˆ›å»ºæ–°çš„çª—å£ï¼Œ cas ä¸ä¸ºç©ºï¼Œ old çª—å£æ—¶é—´èµ·å§‹æ—¶é—´ = å½“å‰ ï¼Œ ç›´æ¥è¿”å›ï¼› éƒ¨ä½ç©ºï¼Œ old çª—å£æ—¶é—´èµ·å§‹æ—¶é—´ ï¼= å½“å‰ï¼Œ reset å½“å‰çª—å£ã€‚ æ ¹æ®å“åº”æ—¶é—´è‡ªåŠ¨é™æµï¼š å°±æ˜¯éœ€è¦è®¾ç½®ä¸€ä¸ªç¡®å®šçš„é™æµå€¼ã€‚è¿™å°±è¦æ±‚æˆ‘ä»¬æ¯æ¬¡å‘å¸ƒæœåŠ¡æ—¶éƒ½åšç›¸åº”çš„æ€§èƒ½æµ‹è¯•ï¼Œæ‰¾åˆ°ç³»ç»Ÿæœ€å¤§çš„æ€§èƒ½å€¼ã€‚ å¾ˆå¤šæ—¶å€™ï¼Œ å¾ˆéš¾ç»™å‡ºä¸€ä¸ªåˆé€‚çš„å€¼ã€‚\nå®é™…æƒ…å†µä¸‹ï¼Œå¾ˆå¤šæœåŠ¡ä¼šä¾èµ–äºæ•°æ®åº“ã€‚ æ•°æ®ç±»å‹ï¼Œ æ•°æ®é‡ã€‚ æ‰€ä»¥ï¼Œä¸åŒçš„ç”¨æˆ·è¯·æ±‚ï¼Œä¼šå¯¹ä¸åŒçš„æ•°æ®é›†è¿›è¡Œæ“ä½œã€‚å°±ç®—æ˜¯ç›¸åŒçš„è¯·æ±‚ï¼Œå¯èƒ½æ•°æ®é›†ä¹Ÿä¸ä¸€æ ·ï¼Œæ¯”å¦‚ï¼Œç°åœ¨å¾ˆå¤šåº”ç”¨éƒ½ä¼šæœ‰ä¸€ä¸ªæ—¶é—´çº¿ Feed æµï¼Œä¸åŒçš„ç”¨æˆ·å…³å¿ƒçš„ä¸»é¢˜äººäººä¸ä¸€æ ·ï¼Œæ•°æ®ä¹Ÿä¸ä¸€æ ·ã€‚ ä¸åŒçš„ API æœ‰ä¸åŒçš„æ€§èƒ½ã€‚æˆ‘ä»¬è¦åœ¨çº¿ä¸Šä¸ºæ¯ä¸€ä¸ª API é…ç½®ä¸åŒçš„é™æµå€¼ï¼Œè¿™ç‚¹å¤ªéš¾é…ç½®ï¼Œä¹Ÿå¾ˆéš¾ç®¡ç†ã€‚ è€Œä¸”ï¼Œç°åœ¨çš„æœåŠ¡éƒ½æ˜¯èƒ½è‡ªåŠ¨åŒ–ä¼¸ç¼©çš„ï¼Œä¸åŒå¤§å°çš„é›†ç¾¤çš„æ€§èƒ½ä¹Ÿä¸ä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œåœ¨è‡ªåŠ¨åŒ–ä¼¸ç¼©çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦åŠ¨æ€åœ°è°ƒæ•´é™æµçš„é˜ˆå€¼ï¼Œè¿™ç‚¹å¤ªéš¾åšåˆ°äº†ã€‚ å¦‚ä½•è®¾è®¡ï¼Ÿ å¦‚ä½•åšï¼Ÿ ä¸å†è®¾å®šä¸€ä¸ªç‰¹å®šçš„æµæ§å€¼ï¼Œè€Œæ˜¯èƒ½å¤ŸåŠ¨æ€åœ°æ„ŸçŸ¥ç³»ç»Ÿçš„å‹åŠ›æ¥è‡ªåŠ¨åŒ–åœ°é™æµã€‚ å…¸èŒƒæ˜¯ TCP åè®®çš„æ‹¥å¡æ§åˆ¶çš„ç®—æ³•ã€‚ å…·ä½“ï¼š æˆ‘ä»¬è®°å½•ä¸‹æ¯æ¬¡è°ƒç”¨åç«¯è¯·æ±‚çš„å“åº”æ—¶é—´ï¼Œç„¶ååœ¨ä¸€ä¸ªæ—¶é—´åŒºé—´å†…ï¼ˆæ¯”å¦‚ï¼Œè¿‡å» 10 ç§’ï¼‰çš„è¯·æ±‚è®¡ç®—ä¸€ä¸ªå“åº”æ—¶é—´çš„ P90 æˆ– P99 å€¼ï¼Œä¹Ÿå°±æ˜¯æŠŠè¿‡å» 10 ç§’å†…çš„è¯·æ±‚çš„å“åº”æ—¶é—´æ’ä¸ªåºï¼Œç„¶åçœ‹ 90% æˆ– 99% çš„ä½ç½®æ˜¯å¤šå°‘ã€‚\nP90 æˆ– P99 å€¼ï¼š æ¶ˆè€—å†…å­˜å’Œ CPUã€‚ 1) é‡‡æ · ã€‚ åŠ¨æ€æµæ§éœ€è¦åƒ TCP é‚£æ ·ï¼Œä½ éœ€è¦è®°å½•ä¸€ä¸ªå½“å‰çš„ QPSã€‚å¦‚æœå‘ç°åç«¯çš„ P90/P99 å“åº”å¤ªæ…¢ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠè¿™ä¸ª QPS å‡åŠï¼Œç„¶ååƒ TCP ä¸€æ ·èµ°æ…¢å¯åŠ¨çš„æ–¹å¼ï¼Œç›´æ¥åˆ°åˆå¼€å§‹å˜æ…¢ï¼Œç„¶åå‡å» 1/4 çš„ QPSï¼Œå†æ…¢å¯åŠ¨ï¼Œç„¶åå†å‡å» 1/8 çš„ QPSã€‚\né™æµçš„è®¾è®¡è¦ç‚¹ ç›®çš„ï¼š\nä¸ºäº†å‘ç”¨æˆ·æ‰¿è¯º SLAã€‚ å¤šç§Ÿæˆ·çš„æƒ…å†µä¸‹ï¼ŒæŸä¸€ç”¨æˆ·æŠŠèµ„æºè€—å°½ã€‚ åº”å¯¹çªå‘çš„æµé‡ èŠ‚çº¦æˆæœ¬ã€‚æˆ‘ä»¬ä¸ä¼šä¸ºäº†ä¸€ä¸ªä¸å¸¸è§çš„å°–å³°æ¥æŠŠæˆ‘ä»¬çš„ç³»ç»Ÿæ‰©å®¹åˆ°æœ€å¤§çš„å°ºå¯¸ã€‚ è®¾è®¡ä¸Šï¼Œæˆ‘ä»¬è¿˜è¦æœ‰ä»¥ä¸‹çš„è€ƒé‡ã€‚\né™æµæ¨¡å—æ€§èƒ½å¿…é¡»å¥½ï¼Œè€Œä¸”å¯¹æµé‡çš„å˜åŒ–ä¹Ÿæ˜¯éå¸¸çµæ•çš„ï¼Œå¦åˆ™å¤ªè¿‡è¿Ÿé’çš„é™æµï¼Œç³»ç»Ÿæ—©å› ä¸ºè¿‡è½½è€ŒæŒ‚æ‰äº†ã€‚ é™æµåº”è¯¥æœ‰ä¸ªæ‰‹åŠ¨çš„å¼€å…³ï¼Œè¿™æ ·åœ¨åº”æ€¥çš„æ—¶å€™ï¼Œå¯ä»¥æ‰‹åŠ¨æ“ä½œã€‚ å½“é™æµå‘ç”Ÿæ—¶ï¼Œåº”è¯¥æœ‰ä¸ªç›‘æ§äº‹ä»¶é€šçŸ¥ã€‚ è¿ç»´è·Ÿè¿›ã€‚ è‡ªåŠ¨æ‰©å®¹ã€‚ å½“é™æµå‘ç”Ÿæ—¶ï¼Œå¯¹äºæ‹’æ‰çš„è¯·æ±‚ï¼Œæˆ‘ä»¬åº”è¯¥è¿”å›ä¸€ä¸ªç‰¹å®šçš„é™æµé”™è¯¯ç ã€‚ çœ‹åˆ°è¿™äº›é”™è¯¯ç ï¼Œ è°ƒæ•´å‘é€é€Ÿåº¦ï¼Œæˆ–èµ°é‡è¯•æœºåˆ¶ã€‚ é™æµåº”è¯¥è®©åç«¯çš„æœåŠ¡æ„ŸçŸ¥åˆ°ã€‚ æ¯”å¦‚ï¼š åœ¨åè®®å¤´ä¸­å¡è¿›ä¸€ä¸ªæ ‡è¯† ã€‚ çœ‹åˆ°æ ‡è¯†ï¼Œ å¯ä»¥é™çº§ã€‚ é™çº§ æ‰€è°“çš„é™çº§è®¾è®¡ï¼ˆDegradationï¼‰ï¼Œæœ¬è´¨æ˜¯ä¸ºäº†è§£å†³èµ„æºä¸è¶³å’Œè®¿é—®é‡è¿‡å¤§çš„é—®é¢˜ã€‚æš‚æ—¶ç‰ºç‰²æ‰ä¸€äº›ä¸œè¥¿ï¼Œä»¥ä¿éšœæ•´ä¸ªç³»ç»Ÿçš„å¹³ç¨³è¿è¡Œã€‚\nä¸€èˆ¬çš„é™çº§ï¼š\né™ä½ä¸€è‡´æ€§ã€‚ä»å¼ºä¸€è‡´æ€§å˜æˆæœ€ç»ˆä¸€è‡´æ€§ã€‚ åœæ­¢æ¬¡è¦åŠŸèƒ½ã€‚åœæ­¢è®¿é—®ä¸é‡è¦çš„åŠŸèƒ½ï¼Œä»è€Œé‡Šæ”¾å‡ºæ›´å¤šçš„èµ„æºã€‚ ç®€åŒ–åŠŸèƒ½ã€‚æŠŠä¸€äº›åŠŸèƒ½ç®€åŒ–æ‰ï¼Œæ¯”å¦‚ï¼Œç®€åŒ–ä¸šåŠ¡æµç¨‹ï¼Œæˆ–æ˜¯ä¸å†è¿”å›å…¨é‡æ•°æ®ï¼Œåªè¿”å›éƒ¨åˆ†æ•°æ®ã€‚ æˆ‘ä»¬ç°åœ¨çš„é™çº§åˆ†ä¸ºåŠŸèƒ½é™çº§å’ŒæœåŠ¡é™çº§ã€‚æˆ‘ä»¬ç›®å‰å°†é™çº§å¼€å…³æ”¾åˆ°é…ç½®ä¸­å¿ƒã€‚ ä¸€ã€åŠŸèƒ½é™çº§ 1ã€é€šè¿‡é™çº§å¼€å…³æ§åˆ¶åŠŸèƒ½å¯ç”¨ä¸å¯ç”¨ï¼Œä¸€èˆ¬ä¸ºé¡µé¢å’ŒæŒ‰é’® 2ã€ç®€åŒ–ä¸šåŠ¡æ“ä½œæµç¨‹ï¼Œå½“é™çº§åç®€åŒ–ä¸šåŠ¡æ“ä½œæ­¥éª¤ï¼Œå¿«é€Ÿå®Œæˆä¸šåŠ¡æ“ä½œ äºŒã€æœåŠ¡é™çº§ 1ã€è¯»é™çº§ï¼Œé™çº§å‰ä¼šè¯»ç¼“å­˜ï¼Œç¼“å­˜ä¸­ä¸å­˜åœ¨çš„è¯è¯»æ•°æ®åº“ï¼Œé™çº§åè¯»ç¼“å­˜ï¼Œç¼“å­˜ä¸­ä¸å­˜åœ¨çš„è¯ï¼Œè¿”å›é»˜è®¤å€¼ï¼Œä¸å†è¯»æ•°æ®åº“ 2ã€å†™é™çº§ï¼Œå°†ä¹‹å‰çš„åŒæ­¥å†™æ•°æ®åº“é™çº§ä¸ºå…ˆå†™ç¼“å­˜ï¼Œç„¶åå¼‚æ­¥å†™åº“ 3ã€æœåŠ¡è°ƒç”¨é™çº§ï¼Œä¹‹å‰ä¸¤ä¸ªç³»ç»Ÿæ¨¡å—é€šè¿‡ mq æ¥äº¤äº’ï¼Œå½“ mq æ¶ˆæ¯ç§¯å‹æˆ– mq å®•æœºå‡ºé—®é¢˜åï¼Œé™çº§ä¸ºæœåŠ¡ç›´æ¥è°ƒç”¨\næ€»ç»“ å¼¹åŠ›è®¾è®¡æ€»å›¾ æœåŠ¡ä¸æ˜¯å•ç‚¹ã€‚\nè´Ÿè½½å‡è¡¡ + æœåŠ¡å¥åº·æ£€æŸ¥ã€‚ ï¼ˆnginx æˆ– haproxy) æœåŠ¡å‘ç° + åŠ¨æ€è·¯ç”± + æœåŠ¡å¥åº·æ£€æŸ¥ã€‚ (zookeeper + consul) è‡ªåŠ¨åŒ–è¿ç»´ï¼ŒKubernetes æœåŠ¡è°ƒåº¦ã€ä¼¸ç¼©å’Œæ•…éšœè¿ç§». éš”ç¦»æˆ‘ä»¬çš„ä¸šåŠ¡ï¼Œè¦éš”ç¦»æˆ‘ä»¬çš„æœåŠ¡æˆ‘ä»¬å°±éœ€è¦å¯¹æœåŠ¡è¿›è¡Œè§£è€¦å’Œæ‹†åˆ†\nbulkheads æ¨¡å¼ï¼šä¸šåŠ¡åˆ†ç‰‡ ã€ç”¨æˆ·åˆ†ç‰‡ã€æ•°æ®åº“æ‹†åˆ†ã€‚ è‡ªåŒ…å«ç³»ç»Ÿï¼šæ‰€è°“è‡ªåŒ…å«çš„ç³»ç»Ÿæ˜¯ä»å•ä½“åˆ°å¾®æœåŠ¡çš„ä¸­é—´çŠ¶æ€ï¼Œå…¶æŠŠä¸€ç»„å¯†åˆ‡ç›¸å…³çš„å¾®æœåŠ¡ç»™æ‹†åˆ†å‡ºæ¥ï¼Œåªéœ€è¦åšåˆ°æ²¡æœ‰å¤–éƒ¨ä¾èµ–å°±è¡Œã€‚ å¼‚æ­¥é€šè®¯ï¼šæœåŠ¡å‘ç°ã€äº‹ä»¶é©±åŠ¨ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ä¸šåŠ¡å·¥ä½œæµã€‚ è‡ªåŠ¨åŒ–è¿ç»´ï¼šéœ€è¦ä¸€ä¸ªæœåŠ¡è°ƒç”¨é“¾å’Œæ€§èƒ½ç›‘æ§çš„ç›‘æ§ç³»ç»Ÿã€‚ æ¥å—å¤±è´¥çš„ç›¸å…³å¤„ç†è®¾è®¡ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å®¹é”™è®¾è®¡\né”™è¯¯æ–¹é¢ï¼šè°ƒç”¨é‡è¯• + ç†”æ–­ + æœåŠ¡çš„å¹‚ç­‰æ€§è®¾è®¡ã€‚ ä¸€è‡´æ€§æ–¹é¢ï¼šå¼ºä¸€è‡´æ€§ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤ã€æœ€ç»ˆä¸€è‡´æ€§ä½¿ç”¨å¼‚æ­¥é€šè®¯æ–¹å¼ã€‚ æµæ§æ–¹é¢ï¼šä½¿ç”¨é™æµ + é™çº§æŠ€æœ¯ã€‚ è‡ªåŠ¨åŒ–è¿ç»´æ–¹é¢ï¼šç½‘å…³æµé‡è°ƒåº¦ï¼ŒæœåŠ¡ç›‘æ§ã€‚ æœ‰ä¸‰å¤§å—çš„ä¸œè¥¿\nå†—ä½™æœåŠ¡ã€‚é€šè¿‡å†—ä½™æœåŠ¡çš„å¤æœ¬æ•°å¯ä»¥æ¶ˆé™¤å•ç‚¹æ•…éšœã€‚ æœåŠ¡è§£è€¦ã€‚é€šè¿‡è§£è€¦å¯ä»¥åšåˆ°æŠŠä¸šåŠ¡éš”ç¦»å¼€æ¥ï¼Œä¸è®©æœåŠ¡å—å½±å“ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ›´å¥½çš„ç¨³å®šæ€§ã€‚ æœåŠ¡å®¹é”™ã€‚æœåŠ¡å®¹é”™æ–¹é¢ï¼Œéœ€è¦æœ‰é‡è¯•æœºåˆ¶ï¼Œé‡è¯•æœºåˆ¶ä¼šå¸¦æ¥å¹‚ç­‰æ“ä½œï¼Œå¯¹äºæœåŠ¡ä¿æŠ¤æ¥è¯´ï¼Œç†”æ–­ï¼Œé™æµï¼Œé™çº§éƒ½æ˜¯ä¸ºäº†ä¿æŠ¤æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå¹¶åœ¨å¯ç”¨æ€§å’Œä¸€è‡´æ€§æ–¹é¢åœ¨å‡ºé”™çš„æƒ…å†µä¸‹åšä¸€éƒ¨åˆ†çš„å¦¥åã€‚ å½“ç„¶ï¼Œé™¤äº†è¿™ä¸€åˆ‡çš„æ¶æ„è®¾è®¡å¤–ï¼Œä½ è¿˜éœ€è¦ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªåŠ¨è¿ç»´çš„å·¥å…·ã€‚å¦åˆ™ï¼Œå¦‚æœæ˜¯äººè‚‰è¿ç»´çš„è¯ï¼Œé‚£ä¹ˆåœ¨æ•…éšœå‘ç”Ÿçš„æ—¶å€™ï¼Œä¸èƒ½åŠæ—¶åœ°åšå‡ºè¿ç»´å†³å®šï¼Œä¹Ÿå°±ç©ºæœ‰è¿™äº›å¼¹åŠ›è®¾è®¡äº†ã€‚æ¯”å¦‚ï¼šç›‘æ§åˆ°æœåŠ¡æ€§èƒ½ä¸å¤Ÿäº†ï¼Œå°±è‡ªåŠ¨æˆ–åŠè‡ªåŠ¨åœ°å¼€å§‹è¿›è¡Œé™æµæˆ–é™çº§ã€‚\n","permalink":"http://blog.chalme.top/posts/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E8%AE%BE%E8%AE%A1-%E5%BC%B9%E5%8A%9B%E8%AE%BE%E8%AE%A1/","summary":"éš”ç¦»è®¾è®¡ æŒ‰æœåŠ¡çš„ç§ç±»æ¥åšåˆ†ç¦»ï¼š æ¯”å¦‚ï¼š æˆ‘ä»¬å°†ç³»ç»Ÿåˆ†æˆäº†ç”¨æˆ·ã€å•†å“ã€ç¤¾åŒºä¸‰ä¸ªæ¿å—ã€‚ ä¸å¥½ï¼š å¦‚æœæˆ‘ä»¬éœ€è¦åŒæ—¶è·å¾—å¤šä¸ªæ¿å—çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡ï¼Œè¿™ä¼šé™ä½æ€§èƒ½ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ€§èƒ½é™ä½æŒ‡çš„æ˜¯å“åº”æ—¶é—´ï¼Œè€Œä¸æ˜¯ååé‡ï¼ˆç›¸åï¼Œåœ¨è¿™ç§æ¶æ„ä¸‹ï¼Œååé‡å¯ä»¥å¾—åˆ°æé«˜ï¼‰ã€‚ ä¸€èˆ¬ï¼š å¾ˆå¤šï¼š è¿™æ ·çš„ç³»ç»Ÿé€šå¸¸ä¼šå¼•å…¥å¤§é‡çš„å¼‚æ­¥å¤„ç†æ¨¡å‹ã€‚\næŒ‰ç”¨æˆ·çš„è¯·æ±‚æ¥åšåˆ†ç¦» å¤šç§Ÿæˆ· ï¼š æˆ‘ä»¬å°†ç”¨æˆ·åˆ†æˆä¸åŒçš„ç»„ï¼Œå¹¶æŠŠåç«¯çš„åŒä¸€ä¸ªæœåŠ¡æ ¹æ®è¿™äº›ä¸åŒçš„ç»„åˆ†æˆä¸åŒçš„å®ä¾‹ã€‚ å®Œå…¨ç‹¬ç«‹çš„è®¾è®¡ã€‚æ¯ä¸ªç§Ÿæˆ·æœ‰è‡ªå·±å®Œå…¨ç‹¬ç«‹çš„æœåŠ¡å’Œæ•°æ®ã€‚ ç‹¬ç«‹çš„æ•°æ®åˆ†åŒºï¼Œå…±äº«çš„æœåŠ¡ã€‚å¤šç§Ÿæˆ·çš„æœåŠ¡æ˜¯å…±äº«çš„ï¼Œä½†æ•°æ®æ˜¯åˆ†å¼€éš”ç¦»çš„ã€‚ å…±äº«çš„æœåŠ¡ï¼Œå…±äº«çš„æ•°æ®åˆ†åŒºã€‚æ¯ä¸ªç§Ÿæˆ·çš„æ•°æ®å’ŒæœåŠ¡éƒ½æ˜¯å…±äº«çš„ã€‚ åˆ†æ å¦‚æœä½¿ç”¨å®Œå…¨ç‹¬ç«‹çš„æ–¹æ¡ˆï¼Œåœ¨å¼€å‘å®ç°ä¸Šå’Œèµ„æºéš”ç¦»åº¦æ–¹é¢ä¼šéå¸¸å¥½ï¼Œç„¶è€Œï¼Œæˆæœ¬ä¼šæ¯”è¾ƒé«˜ï¼Œè®¡ç®—èµ„æºä¹Ÿä¼šæœ‰ä¸€å®šçš„æµªè´¹ã€‚å¦‚æœä½¿ç”¨å®Œå…¨å…±äº«çš„æ–¹æ¡ˆï¼Œåœ¨èµ„æºåˆ©ç”¨å’Œæˆæœ¬ä¸Šä¼šéå¸¸å¥½ï¼Œç„¶è€Œï¼Œå¼€å‘éš¾åº¦éå¸¸å¤§ï¼Œè€Œä¸”æ•°æ®å’Œèµ„æºéš”ç¦»éå¸¸ä¸å¥½ã€‚\néš”ç¦»è®¾è®¡çš„é‡ç‚¹ æˆ‘ä»¬éœ€è¦å®šä¹‰å¥½éš”ç¦»ä¸šåŠ¡çš„å¤§å°å’Œç²’åº¦ï¼Œè¿‡å¤§å’Œè¿‡å°éƒ½ä¸å¥½ã€‚è¿™éœ€è¦è®¤çœŸåœ°åšä¸šåŠ¡ä¸Šçš„éœ€æ±‚å’Œç³»ç»Ÿåˆ†æã€‚ æ— è®ºæ˜¯åšç³»ç»Ÿæ¿å—è¿˜æ˜¯å¤šç§Ÿæˆ·çš„éš”ç¦»ï¼Œä½ éƒ½éœ€è¦è€ƒè™‘ç³»ç»Ÿçš„å¤æ‚åº¦ã€æˆæœ¬ã€æ€§èƒ½ã€èµ„æºä½¿ç”¨çš„é—®é¢˜ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„å‡è¡¡æ–¹æ¡ˆï¼Œæˆ–æ˜¯åˆ†å¸ƒå®æ–½çš„æ–¹æ¡ˆå°¤å…¶é‡è¦ï¼Œè¿™å…¶ä¸­éœ€è¦ä½ å®šä¹‰å¥½è¦ä»€ä¹ˆå’Œä¸è¦ä»€ä¹ˆã€‚å› ä¸ºï¼Œæˆ‘ä»¬ä¸å¯èƒ½åšå‡ºä¸€ä¸ªä»€ä¹ˆéƒ½èƒ½æ»¡è¶³çš„ç³»ç»Ÿã€‚ éš”ç¦»æ¨¡å¼éœ€è¦é…ç½®ä¸€äº›é«˜å¯ç”¨ã€é‡è¯•ã€å¼‚æ­¥ã€æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæµæ§ã€ç†”æ–­ç­‰è®¾è®¡æ¨¡å¼çš„æ–¹å¼é…å¥—ä½¿ç”¨ã€‚ ä¸è¦å¿˜è®°äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è¿ç»´çš„å¤æ‚åº¦çš„æå‡ï¼Œè¦èƒ½é©¾é©­å¾—å¥½çš„è¯ï¼Œè¿˜éœ€è¦å¾ˆå¤šè‡ªåŠ¨åŒ–è¿ç»´çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨åƒå®¹å™¨æˆ–æ˜¯è™šæ‹Ÿæœºè¿™æ ·çš„è™šæ‹ŸåŒ–æŠ€æœ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´æ–¹ä¾¿åœ°ç®¡ç†ï¼Œå’Œå¯¹æ¯”èµ„æºæ›´å¥½åœ°åˆ©ç”¨ã€‚å¦åˆ™åšå‡ºæ¥äº†ä¹Ÿç®¡ç†ä¸å¥½ã€‚ æœ€åï¼Œä½ éœ€è¦ä¸€ä¸ªéå¸¸å®Œæ•´çš„èƒ½å¤Ÿçœ‹å¾—åˆ°æ‰€æœ‰æœåŠ¡çš„ç›‘æ§ç³»ç»Ÿï¼Œè¿™ç‚¹éå¸¸é‡è¦ã€‚ å¼‚æ­¥é€šè®¯è®¾è®¡ åŒæ­¥è°ƒç”¨è™½ç„¶è®©ç³»ç»Ÿé—´åªè€¦åˆäºæ¥å£ï¼Œè€Œä¸”å®æ—¶æ€§ä¹Ÿä¼šæ¯”å¼‚æ­¥è°ƒç”¨è¦é«˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿéœ€è¦çŸ¥é“åŒæ­¥è°ƒç”¨ä¼šå¸¦æ¥å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ã€‚\nåŒæ­¥è°ƒç”¨éœ€è¦è¢«è°ƒç”¨æ–¹çš„ååä¸ä½äºè°ƒç”¨æ–¹çš„ååã€‚ åŒæ­¥è°ƒç”¨ä¼šå¯¼è‡´è°ƒç”¨æ–¹ä¸€ç›´åœ¨ç­‰å¾…è¢«è°ƒç”¨æ–¹å®Œæˆï¼Œå¦‚æœä¸€å±‚æ¥ä¸€å±‚åœ°åŒæ­¥è°ƒç”¨ä¸‹å»ï¼Œæ‰€æœ‰çš„å‚ä¸æ–¹ä¼šæœ‰ç›¸åŒçš„ç­‰å¾…æ—¶é—´ã€‚è¿™ä¼šéå¸¸æ¶ˆè€—è°ƒç”¨æ–¹çš„èµ„æºã€‚å› ä¸ºè°ƒç”¨æ–¹éœ€è¦ä¿å­˜ç°åœºï¼ˆContextï¼‰ç­‰å¾…è¿œç«¯è¿”å›ï¼Œæ‰€ä»¥å¯¹äºå¹¶å‘æ¯”è¾ƒé«˜çš„åœºæ™¯æ¥è¯´ï¼Œè¿™æ ·çš„ç­‰å¾…å¯èƒ½ä¼šæåº¦æ¶ˆè€—èµ„æºã€‚ åŒæ­¥è°ƒç”¨åªèƒ½æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå¾ˆéš¾åšåˆ°ä¸€å¯¹å¤šã€‚ åŒæ­¥è°ƒç”¨æœ€ä¸å¥½çš„æ˜¯ï¼Œå¦‚æœè¢«è°ƒç”¨æ–¹æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå…¶è°ƒç”¨æ–¹å°±ä¼šè·Ÿç€å‡ºé—®é¢˜ï¼Œäºæ˜¯ä¼šå‡ºç°å¤šç±³è¯ºéª¨ç‰Œæ•ˆåº”ï¼Œæ•…éšœä¸€ä¸‹å°±è”“å»¶å¼€æ¥ã€‚ å¼‚æ­¥é€šè®¯çš„ä¸‰ç§æ–¹å¼ è¯·æ±‚å“åº”å¼ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€æ–¹ï¼ˆsenderï¼‰ä¼šç›´æ¥è¯·æ±‚æ¥æ”¶æ–¹ï¼ˆreceiverï¼‰ï¼Œè¢«è¯·æ±‚æ–¹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œç›´æ¥è¿”å›â€”â€”æ”¶åˆ°è¯·æ±‚ï¼Œæ­£åœ¨å¤„ç†ã€‚å¯¹äºè¿”å›ç»“æœï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯å‘é€æ–¹æ—¶ä¸æ—¶åœ°å»è½®è¯¢ä¸€ä¸‹ï¼Œé—®ä¸€ä¸‹å¹²æ²¡å¹²å®Œã€‚å¦ä¸€ç§æ–¹å¼æ˜¯å‘é€æ–¹æ³¨å†Œä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶æ–¹å¤„ç†å®Œåå›è°ƒè¯·æ±‚æ–¹ã€‚ é€šè¿‡è®¢é˜…çš„æ–¹å¼ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œæ¥æ”¶æ–¹ï¼ˆreceiverï¼‰ä¼šæ¥è®¢é˜…å‘é€æ–¹ï¼ˆsenderï¼‰çš„æ¶ˆæ¯ï¼Œå‘é€æ–¹ä¼šæŠŠç›¸å…³çš„æ¶ˆæ¯æˆ–æ•°æ®æ”¾åˆ°æ¥æ”¶æ–¹æ‰€è®¢é˜…çš„é˜Ÿåˆ—ä¸­ï¼Œè€Œæ¥æ”¶æ–¹ä¼šä»é˜Ÿåˆ—ä¸­è·å–æ•°æ®ã€‚ é€šè¿‡ Broker çš„æœºåˆ¶ã€‚ æ‰€è°“ Brokerï¼Œå°±æ˜¯ä¸€ä¸ªä¸­é—´äººï¼Œå‘é€æ–¹ï¼ˆsenderï¼‰å’Œæ¥æ”¶æ–¹ï¼ˆreceiverï¼‰éƒ½äº’ç›¸çœ‹ä¸åˆ°å¯¹æ–¹ï¼Œå®ƒä»¬çœ‹å¾—åˆ°çš„æ˜¯ä¸€ä¸ª Brokerï¼Œå‘é€æ–¹å‘ Broker å‘é€æ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹å‘ Broker è®¢é˜…æ¶ˆæ¯ã€‚ äº‹ä»¶é©±åŠ¨è®¾è®¡ äº‹ä»¶é©±åŠ¨æœ€å¥½æ˜¯ä½¿ç”¨ Broker æ–¹å¼ï¼ŒæœåŠ¡é—´é€šè¿‡äº¤æ¢æ¶ˆæ¯æ¥å®Œæˆäº¤æµå’Œæ•´ä¸ªæµç¨‹çš„é©±åŠ¨ã€‚ äº‹ä»¶é©±åŠ¨æ–¹å¼çš„å¥½å¤„\næœåŠ¡é—´çš„ä¾èµ–æ²¡æœ‰äº†ï¼ŒæœåŠ¡é—´æ˜¯å¹³ç­‰çš„ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æ˜¯é«˜åº¦å¯é‡ç”¨å¹¶å¯è¢«æ›¿æ¢çš„ã€‚ æœåŠ¡çš„å¼€å‘ã€æµ‹è¯•ã€è¿ç»´ï¼Œä»¥åŠæ•…éšœå¤„ç†éƒ½æ˜¯é«˜åº¦éš”ç¦»çš„ã€‚ æœåŠ¡é—´é€šè¿‡äº‹ä»¶å…³è”ï¼Œæ‰€ä»¥æœåŠ¡é—´æ˜¯ä¸ä¼šç›¸äº’ block çš„ã€‚ åœ¨æœåŠ¡é—´å¢åŠ ä¸€äº› Adapterï¼ˆå¦‚æ—¥å¿—ã€è®¤è¯ã€ç‰ˆæœ¬ã€é™æµã€é™çº§ã€ç†”æ–­ç­‰ï¼‰ç›¸å½“å®¹æ˜“ã€‚ æœåŠ¡é—´çš„ååä¹Ÿè¢«è§£å¼€äº†ï¼Œå„ä¸ªæœåŠ¡å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å¤„ç†é€Ÿåº¦å¤„ç†ã€‚ åå¤„ï¼š\nä¸šåŠ¡æµç¨‹ä¸å†é‚£ä¹ˆæ˜æ˜¾å’Œå¥½ç®¡ç†ã€‚æ•´ä¸ªæ¶æ„å˜å¾—æ¯”è¾ƒå¤æ‚ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦æœ‰ä¸€äº›å¯è§†åŒ–çš„å·¥å…·æ¥å‘ˆç°æ•´ä½“ä¸šåŠ¡æµç¨‹ã€‚ äº‹ä»¶å¯èƒ½ä¼šä¹±åºã€‚è¿™ä¼šå¸¦æ¥éå¸¸ Bug çš„äº‹ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦å¾ˆå¥½åœ°ç®¡ç†ä¸€ä¸ªçŠ¶æ€æœºçš„æ§åˆ¶ã€‚ äº‹åŠ¡å¤„ç†å˜å¾—å¤æ‚ã€‚éœ€è¦ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤æ¥åšå¼ºä¸€è‡´æ€§ï¼Œæˆ–æ˜¯é€€ç¼©åˆ°æœ€ç»ˆä¸€è‡´æ€§ã€‚ å¹‚ç­‰æ€§è®¾è®¡ è®¢å•åˆ›å»ºæ¥å£ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨è¶…æ—¶äº†ï¼Œç„¶åè°ƒç”¨æ–¹é‡è¯•äº†ä¸€æ¬¡ã€‚æ˜¯å¦ä¼šå¤šåˆ›å»ºä¸€ç¬”è®¢å•ï¼Ÿ\nä¸¤ç§å¤„ç†æ–¹å¼ã€‚\nè¶…æ—¶ä¸‹æ¸¸ç³»ç»Ÿæä¾›ç›¸åº”çš„æŸ¥è¯¢æ¥å£ã€‚ é€šè¿‡å¹‚ç­‰æ€§çš„æ–¹å¼ã€‚ å¯¹äºç¬¬ä¸€ç§æ–¹å¼ï¼Œéœ€è¦å¯¹æ–¹æä¾›ä¸€ä¸ªæŸ¥è¯¢æ¥å£æ¥åšé…åˆã€‚è€Œç¬¬äºŒç§æ–¹å¼åˆ™éœ€è¦ä¸‹æ¸¸çš„ç³»ç»Ÿæä¾›æ”¯æŒå¹‚ç­‰æ€§çš„äº¤æ˜“æ¥å£ã€‚","title":"åˆ†å¸ƒå¼å…³é”®è®¾è®¡ å¼¹åŠ›è®¾è®¡"},{"content":"åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€äº›æ¯”è¾ƒå…³é”®çš„è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­åŒ…æ‹¬å®¹é”™ã€æ€§èƒ½ã€ç®¡ç†ç­‰å‡ ä¸ªæ–¹é¢ã€‚\nå®¹é”™è®¾è®¡åˆå«å¼¹åŠ›è®¾è®¡ï¼Œå…¶ä¸­ç€çœ¼äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„å„ç§â€œå®¹å¿â€èƒ½åŠ›ï¼ŒåŒ…æ‹¬å®¹é”™èƒ½åŠ›ï¼ˆæœåŠ¡éš”ç¦»ã€å¼‚æ­¥è°ƒç”¨ã€è¯·æ±‚å¹‚ç­‰æ€§ï¼‰ã€å¯ä¼¸ç¼©æ€§ï¼ˆæœ‰ / æ— çŠ¶æ€çš„æœåŠ¡ï¼‰ã€ä¸€è‡´æ€§ï¼ˆè¡¥å¿äº‹åŠ¡ã€é‡è¯•ï¼‰ã€åº”å¯¹å¤§æµé‡çš„èƒ½åŠ›ï¼ˆç†”æ–­ã€é™çº§ï¼‰ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç¡®ä¿ç³»ç»Ÿæ­£ç¡®æ€§çš„å‰æä¸‹ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§æ˜¯å¼¹åŠ›è®¾è®¡ä¿éšœçš„é‡ç‚¹ã€‚ ç®¡ç†ç¯‡ä¼šè®²è¿°ä¸€äº›ç®¡ç†åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„çš„ä¸€äº›è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚ç½‘å…³æ–¹é¢çš„ï¼Œè¾¹è½¦æ¨¡å¼ï¼Œè¿˜æœ‰ä¸€äº›åˆšåˆšå¼€å§‹æµè¡Œçš„ï¼Œå¦‚ Service Mesh ç›¸å…³çš„è®¾è®¡æ¨¡å¼ã€‚ æ€§èƒ½è®¾è®¡ç¯‡ä¼šè®²è¿°ä¸€äº›ç¼“å­˜ã€CQRSã€ç´¢å¼•è¡¨ã€ä¼˜å…ˆçº§é˜Ÿåˆ—ã€ä¸šåŠ¡åˆ†ç‰‡ç­‰ç›¸å…³çš„æ¶æ„æ¨¡å¼ã€‚\næ•…éšœåŸå›  ç½‘ç»œé—®é¢˜ã€‚ç½‘ç»œé“¾æ¥å‡ºç°é—®é¢˜ï¼Œç½‘ç»œå¸¦å®½å‡ºç°æ‹¥å¡â€¦â€¦ æ€§èƒ½é—®é¢˜ã€‚æ•°æ®åº“æ…¢ SQLã€Java Full GCã€ç¡¬ç›˜ IO è¿‡å¤§ã€CPU é£™é«˜ã€å†…å­˜ä¸è¶³â€¦â€¦ å®‰å…¨é—®é¢˜ã€‚è¢«ç½‘ç»œæ”»å‡»ï¼Œå¦‚ DDoS ç­‰ã€‚ è¿ç»´é—®é¢˜ã€‚ç³»ç»Ÿæ€»æ˜¯åœ¨è¢«æ›´æ–°å’Œä¿®æ”¹ï¼Œæ¶æ„ä¹Ÿåœ¨ä¸æ–­åœ°è¢«è°ƒæ•´ï¼Œç›‘æ§é—®é¢˜â€¦â€¦ ç®¡ç†é—®é¢˜ã€‚æ²¡æœ‰æ¢³ç†å‡ºå…³é”®æœåŠ¡ä»¥åŠæœåŠ¡çš„ä¾èµ–å…³ç³»ï¼Œè¿è¡Œä¿¡æ¯æ²¡æœ‰å’Œæ§åˆ¶ç³»ç»ŸåŒæ­¥â€¦â€¦ç¡¬ä»¶é—®é¢˜ã€‚ç¡¬ç›˜æŸåã€ç½‘å¡å‡ºé—®é¢˜ã€äº¤æ¢æœºå‡ºé—®é¢˜ã€æœºæˆ¿æ‰ç”µã€æŒ–æ˜æœºé—®é¢˜â€¦â€¦\n","permalink":"http://blog.chalme.top/posts/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%BF%B0/","summary":"åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€äº›æ¯”è¾ƒå…³é”®çš„è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­åŒ…æ‹¬å®¹é”™ã€æ€§èƒ½ã€ç®¡ç†ç­‰å‡ ä¸ªæ–¹é¢ã€‚\nå®¹é”™è®¾è®¡åˆå«å¼¹åŠ›è®¾è®¡ï¼Œå…¶ä¸­ç€çœ¼äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„å„ç§â€œå®¹å¿â€èƒ½åŠ›ï¼ŒåŒ…æ‹¬å®¹é”™èƒ½åŠ›ï¼ˆæœåŠ¡éš”ç¦»ã€å¼‚æ­¥è°ƒç”¨ã€è¯·æ±‚å¹‚ç­‰æ€§ï¼‰ã€å¯ä¼¸ç¼©æ€§ï¼ˆæœ‰ / æ— çŠ¶æ€çš„æœåŠ¡ï¼‰ã€ä¸€è‡´æ€§ï¼ˆè¡¥å¿äº‹åŠ¡ã€é‡è¯•ï¼‰ã€åº”å¯¹å¤§æµé‡çš„èƒ½åŠ›ï¼ˆç†”æ–­ã€é™çº§ï¼‰ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç¡®ä¿ç³»ç»Ÿæ­£ç¡®æ€§çš„å‰æä¸‹ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§æ˜¯å¼¹åŠ›è®¾è®¡ä¿éšœçš„é‡ç‚¹ã€‚ ç®¡ç†ç¯‡ä¼šè®²è¿°ä¸€äº›ç®¡ç†åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„çš„ä¸€äº›è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚ç½‘å…³æ–¹é¢çš„ï¼Œè¾¹è½¦æ¨¡å¼ï¼Œè¿˜æœ‰ä¸€äº›åˆšåˆšå¼€å§‹æµè¡Œçš„ï¼Œå¦‚ Service Mesh ç›¸å…³çš„è®¾è®¡æ¨¡å¼ã€‚ æ€§èƒ½è®¾è®¡ç¯‡ä¼šè®²è¿°ä¸€äº›ç¼“å­˜ã€CQRSã€ç´¢å¼•è¡¨ã€ä¼˜å…ˆçº§é˜Ÿåˆ—ã€ä¸šåŠ¡åˆ†ç‰‡ç­‰ç›¸å…³çš„æ¶æ„æ¨¡å¼ã€‚\næ•…éšœåŸå›  ç½‘ç»œé—®é¢˜ã€‚ç½‘ç»œé“¾æ¥å‡ºç°é—®é¢˜ï¼Œç½‘ç»œå¸¦å®½å‡ºç°æ‹¥å¡â€¦â€¦ æ€§èƒ½é—®é¢˜ã€‚æ•°æ®åº“æ…¢ SQLã€Java Full GCã€ç¡¬ç›˜ IO è¿‡å¤§ã€CPU é£™é«˜ã€å†…å­˜ä¸è¶³â€¦â€¦ å®‰å…¨é—®é¢˜ã€‚è¢«ç½‘ç»œæ”»å‡»ï¼Œå¦‚ DDoS ç­‰ã€‚ è¿ç»´é—®é¢˜ã€‚ç³»ç»Ÿæ€»æ˜¯åœ¨è¢«æ›´æ–°å’Œä¿®æ”¹ï¼Œæ¶æ„ä¹Ÿåœ¨ä¸æ–­åœ°è¢«è°ƒæ•´ï¼Œç›‘æ§é—®é¢˜â€¦â€¦ ç®¡ç†é—®é¢˜ã€‚æ²¡æœ‰æ¢³ç†å‡ºå…³é”®æœåŠ¡ä»¥åŠæœåŠ¡çš„ä¾èµ–å…³ç³»ï¼Œè¿è¡Œä¿¡æ¯æ²¡æœ‰å’Œæ§åˆ¶ç³»ç»ŸåŒæ­¥â€¦â€¦ç¡¬ä»¶é—®é¢˜ã€‚ç¡¬ç›˜æŸåã€ç½‘å¡å‡ºé—®é¢˜ã€äº¤æ¢æœºå‡ºé—®é¢˜ã€æœºæˆ¿æ‰ç”µã€æŒ–æ˜æœºé—®é¢˜â€¦â€¦","title":"åˆ†å¸ƒå¼å…³é”®è®¾è®¡æ¦‚è¿°"},{"content":" æ­¤ç³»åˆ—ä¸»è¦æ˜¯é˜…è¯»é™ˆçš“æå®¢æ—¶é—´çš„è¯¾ç¨‹ã€Šå·¦è€³å¬é£ã€‹çš„åˆ†å¸ƒå¼ç†è®ºç¬”è®°ã€‚éå¸¸ç³»ç»Ÿçš„è®²è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ–¹æ–¹é¢é¢ã€‚\nåˆ†å¸ƒå¼ ä¸»è¦æ˜¯ä¸¤ä¸ªï¼š\nå¢å¤§ç³»ç»Ÿå®¹é‡ åŠ å¼ºç³»ç»Ÿå¯ç”¨ å¦å¤–ï¼š\nç³»ç»Ÿæ¨¡å—åŒ–ï¼Œé‡ç”¨æ€§æé«˜ å¼€å‘å’Œå‘å¸ƒ å¹¶è¡Œï¼Œæ›´å¿« ç³»ç»Ÿæ‰©å±•æ€§ å›¢é˜Ÿåä½œ å¾®æœåŠ¡çš„å‡ºç°ä½¿å¾—å¼€å‘é€Ÿåº¦å˜å¾—æ›´å¿«ï¼Œéƒ¨ç½²å¿«ï¼Œéš”ç¦»æ€§é«˜ï¼Œç³»ç»Ÿçš„æ‰©å±•åº¦ä¹Ÿå¾ˆå¥½ï¼Œä½†æ˜¯åœ¨é›†æˆæµ‹è¯•ã€è¿ç»´å’ŒæœåŠ¡ç®¡ç†ç­‰æ–¹é¢å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚æ‰€ä»¥ï¼Œéœ€è¦ä¸€å¥—æ¯”è¾ƒå¥½çš„å¾®æœåŠ¡ PaaS å¹³å°ã€‚å°±åƒ Spring Cloud ä¸€æ ·éœ€è¦æä¾›å„ç§é…ç½®æœåŠ¡ã€æœåŠ¡å‘ç°ã€æ™ºèƒ½è·¯ç”±ã€æ§åˆ¶æ€»çº¿â€¦â€¦è¿˜æœ‰åƒ Kubernetes æä¾›çš„å„å¼å„æ ·çš„éƒ¨ç½²å’Œè°ƒåº¦æ–¹å¼ã€‚\næ²¡æœ‰è¿™äº› PaaS å±‚çš„æ”¯æ’‘ï¼Œå¾®æœåŠ¡ä¹Ÿæ˜¯å¾ˆéš¾è¢«ç®¡ç†å’Œè¿ç»´çš„ã€‚\næŠ€æœ¯æ ˆ æä¾›ç³»ç»Ÿçš„æ€§èƒ½ ç¼“å­˜ç³»ç»Ÿã€‚ ä»å‰ç«¯çš„æµè§ˆå™¨ï¼Œåˆ°ç½‘ç»œï¼ŒæœåŠ¡ï¼Œæ•°æ®åº“ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Œç£ç›˜å’Œ CPUã€‚ è´Ÿè½½å‡è¡¡æŠ€æœ¯ã€‚ æ˜¯æ°´å¹³æ‰©å±•çš„å…³é”®æŠ€æœ¯ã€‚ å¼‚æ­¥è°ƒç”¨ã€‚ æ•°æ®åˆ†åŒºå’Œæ•°æ®é•œåƒã€‚ æ•°æ®åˆ†åŒºæ˜¯æŠŠæ•°æ®æŒ‰ä¸€å®šæ–¹å¼åˆ†æˆå¤šä¸ªåŒºã€‚æ¯ä¸ªä¸åŒçš„æ•°æ®åŒºåˆ†æ‹…ä¸åŒåŒºçš„æµé‡ã€‚ æ•°æ®é•œåƒã€‚ æŠŠä¸€ä¸ªæ•°æ®åº“é•œåƒ æˆå¤šåˆ†ä¸€æ ·çš„æ•°æ®ã€‚ æé«˜æ¶æ„çš„ç¨³å®šæ€§ æœåŠ¡æ‹†åˆ†ã€‚ä¸¤ä¸ªç›®çš„ï¼š éš”ç¦»æ•…éšœï¼Œé‡ç”¨ã€‚ å¼•å…¥ æœåŠ¡ä¾èµ–çš„é—®é¢˜ã€‚ æœåŠ¡å†—ä½™ã€‚ ç›®çš„ï¼š å»é™¤å•ç‚¹æ•…éšœï¼Œå¹¶å¯ä»¥å¼¹æ€§ä¼¸ç¼©å’Œæ•…éšœè½¬ç§»ã€‚ é™æµé™çº§ã€‚ ç³»ç»Ÿæ‰›ä¸ä½å‹åŠ›ã€‚ åªèƒ½é€šè¿‡é™æµ ï¼Œ æ‹’ç»ä¸€éƒ¨åˆ†ç”¨æˆ·ã€‚åŠŸèƒ½é™çº§ï¼Œåœæ‰ä¸€éƒ¨åˆ†æœåŠ¡ã€‚ é«˜å¯ç”¨æ¶æ„ã€‚ æ¯”å¦‚ï¼Œå¤šç§Ÿæˆ·éš”ç¦»ï¼Œç¾å¤‡å¤šæ´»ã€‚ å†—ä½™ ä¸å‡ºå•ç‚¹æ•…éšœã€‚ é«˜å¯ç”¨è¿ç»´ã€‚ DevOps ä¸­çš„ CI/CDï¼ˆæŒç»­é›†æˆ/æŒç»­éƒ¨ç½²ï¼‰ã€‚ ä¸€ä¸ªè‰¯å¥½çš„è¿ç»´åº”è¯¥æ˜¯ä¸€æ¡å¾ˆæµç•…çš„å‘å¸ƒç®¡çº¿ã€‚å…¶ä¸­åšäº†è¶³å¤Ÿçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè¿˜å¯ä»¥åšç°åº¦å‘å¸ƒï¼Œä»¥åŠçº¿ä¸Šç³»ç»Ÿçš„è‡ªåŠ¨åŒ–æ§åˆ¶ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…³é”®æŠ€æœ¯ å…¨æ ˆç³»ç»Ÿç›‘æ§ æœåŠ¡ / èµ„æºè°ƒåº¦ æµé‡è°ƒåº¦ï¼› çŠ¶æ€/ æ•°æ®è°ƒåº¦ï¼› å¼€å‘å’Œè¿ç»´çš„è‡ªåŠ¨åŒ–ã€‚ ","permalink":"http://blog.chalme.top/posts/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA%E5%89%8D%E8%A8%80/","summary":" æ­¤ç³»åˆ—ä¸»è¦æ˜¯é˜…è¯»é™ˆçš“æå®¢æ—¶é—´çš„è¯¾ç¨‹ã€Šå·¦è€³å¬é£ã€‹çš„åˆ†å¸ƒå¼ç†è®ºç¬”è®°ã€‚éå¸¸ç³»ç»Ÿçš„è®²è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ–¹æ–¹é¢é¢ã€‚\nåˆ†å¸ƒå¼ ä¸»è¦æ˜¯ä¸¤ä¸ªï¼š\nå¢å¤§ç³»ç»Ÿå®¹é‡ åŠ å¼ºç³»ç»Ÿå¯ç”¨ å¦å¤–ï¼š\nç³»ç»Ÿæ¨¡å—åŒ–ï¼Œé‡ç”¨æ€§æé«˜ å¼€å‘å’Œå‘å¸ƒ å¹¶è¡Œï¼Œæ›´å¿« ç³»ç»Ÿæ‰©å±•æ€§ å›¢é˜Ÿåä½œ å¾®æœåŠ¡çš„å‡ºç°ä½¿å¾—å¼€å‘é€Ÿåº¦å˜å¾—æ›´å¿«ï¼Œéƒ¨ç½²å¿«ï¼Œéš”ç¦»æ€§é«˜ï¼Œç³»ç»Ÿçš„æ‰©å±•åº¦ä¹Ÿå¾ˆå¥½ï¼Œä½†æ˜¯åœ¨é›†æˆæµ‹è¯•ã€è¿ç»´å’ŒæœåŠ¡ç®¡ç†ç­‰æ–¹é¢å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚æ‰€ä»¥ï¼Œéœ€è¦ä¸€å¥—æ¯”è¾ƒå¥½çš„å¾®æœåŠ¡ PaaS å¹³å°ã€‚å°±åƒ Spring Cloud ä¸€æ ·éœ€è¦æä¾›å„ç§é…ç½®æœåŠ¡ã€æœåŠ¡å‘ç°ã€æ™ºèƒ½è·¯ç”±ã€æ§åˆ¶æ€»çº¿â€¦â€¦è¿˜æœ‰åƒ Kubernetes æä¾›çš„å„å¼å„æ ·çš„éƒ¨ç½²å’Œè°ƒåº¦æ–¹å¼ã€‚\næ²¡æœ‰è¿™äº› PaaS å±‚çš„æ”¯æ’‘ï¼Œå¾®æœåŠ¡ä¹Ÿæ˜¯å¾ˆéš¾è¢«ç®¡ç†å’Œè¿ç»´çš„ã€‚\næŠ€æœ¯æ ˆ æä¾›ç³»ç»Ÿçš„æ€§èƒ½ ç¼“å­˜ç³»ç»Ÿã€‚ ä»å‰ç«¯çš„æµè§ˆå™¨ï¼Œåˆ°ç½‘ç»œï¼ŒæœåŠ¡ï¼Œæ•°æ®åº“ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Œç£ç›˜å’Œ CPUã€‚ è´Ÿè½½å‡è¡¡æŠ€æœ¯ã€‚ æ˜¯æ°´å¹³æ‰©å±•çš„å…³é”®æŠ€æœ¯ã€‚ å¼‚æ­¥è°ƒç”¨ã€‚ æ•°æ®åˆ†åŒºå’Œæ•°æ®é•œåƒã€‚ æ•°æ®åˆ†åŒºæ˜¯æŠŠæ•°æ®æŒ‰ä¸€å®šæ–¹å¼åˆ†æˆå¤šä¸ªåŒºã€‚æ¯ä¸ªä¸åŒçš„æ•°æ®åŒºåˆ†æ‹…ä¸åŒåŒºçš„æµé‡ã€‚ æ•°æ®é•œåƒã€‚ æŠŠä¸€ä¸ªæ•°æ®åº“é•œåƒ æˆå¤šåˆ†ä¸€æ ·çš„æ•°æ®ã€‚ æé«˜æ¶æ„çš„ç¨³å®šæ€§ æœåŠ¡æ‹†åˆ†ã€‚ä¸¤ä¸ªç›®çš„ï¼š éš”ç¦»æ•…éšœï¼Œé‡ç”¨ã€‚ å¼•å…¥ æœåŠ¡ä¾èµ–çš„é—®é¢˜ã€‚ æœåŠ¡å†—ä½™ã€‚ ç›®çš„ï¼š å»é™¤å•ç‚¹æ•…éšœï¼Œå¹¶å¯ä»¥å¼¹æ€§ä¼¸ç¼©å’Œæ•…éšœè½¬ç§»ã€‚ é™æµé™çº§ã€‚ ç³»ç»Ÿæ‰›ä¸ä½å‹åŠ›ã€‚ åªèƒ½é€šè¿‡é™æµ ï¼Œ æ‹’ç»ä¸€éƒ¨åˆ†ç”¨æˆ·ã€‚åŠŸèƒ½é™çº§ï¼Œåœæ‰ä¸€éƒ¨åˆ†æœåŠ¡ã€‚ é«˜å¯ç”¨æ¶æ„ã€‚ æ¯”å¦‚ï¼Œå¤šç§Ÿæˆ·éš”ç¦»ï¼Œç¾å¤‡å¤šæ´»ã€‚ å†—ä½™ ä¸å‡ºå•ç‚¹æ•…éšœã€‚ é«˜å¯ç”¨è¿ç»´ã€‚ DevOps ä¸­çš„ CI/CDï¼ˆæŒç»­é›†æˆ/æŒç»­éƒ¨ç½²ï¼‰ã€‚ ä¸€ä¸ªè‰¯å¥½çš„è¿ç»´åº”è¯¥æ˜¯ä¸€æ¡å¾ˆæµç•…çš„å‘å¸ƒç®¡çº¿ã€‚å…¶ä¸­åšäº†è¶³å¤Ÿçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè¿˜å¯ä»¥åšç°åº¦å‘å¸ƒï¼Œä»¥åŠçº¿ä¸Šç³»ç»Ÿçš„è‡ªåŠ¨åŒ–æ§åˆ¶ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…³é”®æŠ€æœ¯ å…¨æ ˆç³»ç»Ÿç›‘æ§ æœåŠ¡ / èµ„æºè°ƒåº¦ æµé‡è°ƒåº¦ï¼› çŠ¶æ€/ æ•°æ®è°ƒåº¦ï¼› å¼€å‘å’Œè¿ç»´çš„è‡ªåŠ¨åŒ–ã€‚ ","title":"åˆ†å¸ƒå¼ç†è®ºå‰è¨€"},{"content":"å‰è¨€ åšå®¢åœ¨å¤§å­¦æ—¶ä»£å°±å»ºç«‹äº†ï¼Œä¸»è¦ä½¿ç”¨ github page çš„èƒ½åŠ›æ­å»ºã€‚åˆšå¼€å§‹ä½¿ç”¨ hexo , è™½ç„¶å…·æœ‰ä¸é”™çš„èƒ½åŠ›ã€‚ä½†æ€»å½’åœ¨æ„å»ºç¼–è¯‘æ•ˆç‡æ¯”è¾ƒä½ï¼Œå½±å“å¿ƒæƒ…ä¹¦å†™å†…å®¹åŠå†™ä½œæ•ˆç‡ã€‚\nhugo å¾ˆæ—©ä¹‹å‰å°±æ³¨æ„åˆ° hugoï¼Œè¿™æ˜¯éå¸¸é«˜æ•ˆçš„åšå®¢å·¥å…·ï¼ˆå…¶ä¸»è¦ä½¿ç”¨ go è¯­è¨€ç¼–å†™ï¼‰ã€‚ æœ€ç»ˆå†³å®šè¿ç§»åˆ° hugoã€‚ ç®€å•çš„å¯¹æ¯”å¦‚ä¸‹ï¼š\nhexo hugo ç¤¾åŒºæ”¯æŒ å¥½ å¥½ ç¼–è¯‘é€Ÿåº¦ å¿« æ…¢ ä¸»é¢˜ å°‘ å¤šä¸”åŠŸèƒ½å®Œå–„ å°ç»“ ï¼šåœ¨ github star çš„ç»´åº¦ä¸Šçœ‹ï¼Œhugo å·²ç»è¶…è¶Š hexoã€‚ è™½ç„¶åœ¨ä¸»é¢˜è¿™ä¸ªç»´åº¦ï¼Œå¾ˆå¤šä¸»é¢˜åŠŸèƒ½éƒ½è¿˜åœ¨åœ¨å®Œå–„ï¼› ä¸å¯å¿½è§†çš„æ˜¯ç”¨æˆ·ä½“éªŒï¼Œ hugo çš„æ„å»ºç¼–è¯‘é€Ÿåº¦å¾ˆå¿«ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä¸ªäººæœ€çœ‹é‡çš„ç‚¹ã€‚ é€šè¿‡ç¤¾åŒºçš„ååº”æ¥çœ‹ï¼Œæœªæ¥ hugo ä¼šæœ‰æ›´å¥½çš„å‘å±•ã€‚\nè¿ç§» è¿ç§»çš„è¿‡ç¨‹è¿˜æ˜¯æœ‰ç‚¹ç—›è‹¦ã€‚ ä¸€æ–¹é¢ï¼Œæ¯•ç«Ÿæ˜¯ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼Œéœ€è¦ç†Ÿæ‚‰ä¸€ä¸‹ã€‚å¦å¤–ï¼Œæ—§çš„æ–‡ç« ä¹Ÿéœ€è¦è¿ç§»åˆ°æ–°çš„æ¨¡å¼ä¸‹ï¼Œè¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦çš„ã€‚\nåœ¨ä¸»é¢˜ä½¿ç”¨æ–¹é¢ä½¿ç”¨çš„æ˜¯ PaperMod, è¯¥ä¸»é¢˜ç¤¾åŒºä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„ï¼Œå¹¶ä¸”ç»´æŠ¤ç§¯æã€‚\nåç»­ æœ€è¿‘åœ¨æ•´ç†è¿‡å»å‡ å¹´çš„å†…å®¹ï¼Œå‘ç°è®°å½•äº†å¾ˆå¤šå„ç§å„æ ·çš„çŸ¥è¯†å’Œä½“ä¼šï¼Œè¿˜æ˜¯å¾ˆæ¬£æ…°çš„ã€‚ ä¸è¿‡ä½¿ç”¨äº†å¾ˆå¤šç¬”è®°è½¯ä»¶ï¼ˆä»å°è±¡ -\u0026gt; ä¸ºçŸ¥ -\u0026gt; è¯­é›€ -\u0026gt; Fsnotes) ï¼Œè¿™å—éœ€è¦å¤§é‡çš„æ—¶é—´æ•´ç†ï¼Œè¿™ä¸ªæ˜¯å¿…é¡»è¦åšçš„ã€‚ åé¢ï¼Œä¹Ÿä¼šå°†ä¸€äº›æœ‰ä»·å€¼å†…å®¹åŠä½“ä¼šå‘å¸ƒåˆ°åšå®¢ä¸Šã€‚ ä¸»è¦ä¸¤ä¸ªåŸå› ï¼š\nä¸€æ–¹é¢ å†™ä½œæ•´ç†çš„è¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªé‡æ–°è®¤è¯†ä½“ä¼šçš„é‡è¦æ—¶åˆ»; å¦ä¸€ä¸ªæ–¹é¢ï¼Œä¹Ÿå¯ä»¥è®°å½•æˆé•¿çš„è¿‡ç¨‹ã€‚ ","permalink":"http://blog.chalme.top/posts/think/%E8%BF%81%E7%A7%BB%E5%8D%9A%E5%AE%A2/","summary":"å‰è¨€ åšå®¢åœ¨å¤§å­¦æ—¶ä»£å°±å»ºç«‹äº†ï¼Œä¸»è¦ä½¿ç”¨ github page çš„èƒ½åŠ›æ­å»ºã€‚åˆšå¼€å§‹ä½¿ç”¨ hexo , è™½ç„¶å…·æœ‰ä¸é”™çš„èƒ½åŠ›ã€‚ä½†æ€»å½’åœ¨æ„å»ºç¼–è¯‘æ•ˆç‡æ¯”è¾ƒä½ï¼Œå½±å“å¿ƒæƒ…ä¹¦å†™å†…å®¹åŠå†™ä½œæ•ˆç‡ã€‚\nhugo å¾ˆæ—©ä¹‹å‰å°±æ³¨æ„åˆ° hugoï¼Œè¿™æ˜¯éå¸¸é«˜æ•ˆçš„åšå®¢å·¥å…·ï¼ˆå…¶ä¸»è¦ä½¿ç”¨ go è¯­è¨€ç¼–å†™ï¼‰ã€‚ æœ€ç»ˆå†³å®šè¿ç§»åˆ° hugoã€‚ ç®€å•çš„å¯¹æ¯”å¦‚ä¸‹ï¼š\nhexo hugo ç¤¾åŒºæ”¯æŒ å¥½ å¥½ ç¼–è¯‘é€Ÿåº¦ å¿« æ…¢ ä¸»é¢˜ å°‘ å¤šä¸”åŠŸèƒ½å®Œå–„ å°ç»“ ï¼šåœ¨ github star çš„ç»´åº¦ä¸Šçœ‹ï¼Œhugo å·²ç»è¶…è¶Š hexoã€‚ è™½ç„¶åœ¨ä¸»é¢˜è¿™ä¸ªç»´åº¦ï¼Œå¾ˆå¤šä¸»é¢˜åŠŸèƒ½éƒ½è¿˜åœ¨åœ¨å®Œå–„ï¼› ä¸å¯å¿½è§†çš„æ˜¯ç”¨æˆ·ä½“éªŒï¼Œ hugo çš„æ„å»ºç¼–è¯‘é€Ÿåº¦å¾ˆå¿«ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä¸ªäººæœ€çœ‹é‡çš„ç‚¹ã€‚ é€šè¿‡ç¤¾åŒºçš„ååº”æ¥çœ‹ï¼Œæœªæ¥ hugo ä¼šæœ‰æ›´å¥½çš„å‘å±•ã€‚\nè¿ç§» è¿ç§»çš„è¿‡ç¨‹è¿˜æ˜¯æœ‰ç‚¹ç—›è‹¦ã€‚ ä¸€æ–¹é¢ï¼Œæ¯•ç«Ÿæ˜¯ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼Œéœ€è¦ç†Ÿæ‚‰ä¸€ä¸‹ã€‚å¦å¤–ï¼Œæ—§çš„æ–‡ç« ä¹Ÿéœ€è¦è¿ç§»åˆ°æ–°çš„æ¨¡å¼ä¸‹ï¼Œè¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦çš„ã€‚\nåœ¨ä¸»é¢˜ä½¿ç”¨æ–¹é¢ä½¿ç”¨çš„æ˜¯ PaperMod, è¯¥ä¸»é¢˜ç¤¾åŒºä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„ï¼Œå¹¶ä¸”ç»´æŠ¤ç§¯æã€‚\nåç»­ æœ€è¿‘åœ¨æ•´ç†è¿‡å»å‡ å¹´çš„å†…å®¹ï¼Œå‘ç°è®°å½•äº†å¾ˆå¤šå„ç§å„æ ·çš„çŸ¥è¯†å’Œä½“ä¼šï¼Œè¿˜æ˜¯å¾ˆæ¬£æ…°çš„ã€‚ ä¸è¿‡ä½¿ç”¨äº†å¾ˆå¤šç¬”è®°è½¯ä»¶ï¼ˆä»å°è±¡ -\u0026gt; ä¸ºçŸ¥ -\u0026gt; è¯­é›€ -\u0026gt; Fsnotes) ï¼Œè¿™å—éœ€è¦å¤§é‡çš„æ—¶é—´æ•´ç†ï¼Œè¿™ä¸ªæ˜¯å¿…é¡»è¦åšçš„ã€‚ åé¢ï¼Œä¹Ÿä¼šå°†ä¸€äº›æœ‰ä»·å€¼å†…å®¹åŠä½“ä¼šå‘å¸ƒåˆ°åšå®¢ä¸Šã€‚ ä¸»è¦ä¸¤ä¸ªåŸå› ï¼š\nä¸€æ–¹é¢ å†™ä½œæ•´ç†çš„è¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªé‡æ–°è®¤è¯†ä½“ä¼šçš„é‡è¦æ—¶åˆ»; å¦ä¸€ä¸ªæ–¹é¢ï¼Œä¹Ÿå¯ä»¥è®°å½•æˆé•¿çš„è¿‡ç¨‹ã€‚ ","title":"è¿ç§»åšå®¢"},{"content":" æ­¤æ–‡ç« ä¸»è¦æ•´ç†äº† macos ä¸ªäººå¸¸ç”¨çš„è½¯ä»¶ã€‚è½¯ä»¶åˆ†ä¸º appstore å’Œ brewä¸¤ä¸ªæ¥æºã€‚ brewè½¯ä»¶æ¥æºä¸€èˆ¬éƒ½æ˜¯å¼€æºçš„é¡¹ç›®ã€‚\nappstore å·¥å…· Justfocus ç•ªèŒ„å·¥ä½œ\nCaffeinated é¿å… mac ç¡çœ \niShot æˆªå›¾è½¯ä»¶ï¼ŒåŠŸèƒ½é½å…¨ã€‚ ä¹Ÿå¯ä»¥ç”¨ xnip ç­‰ä»£æ›¿ã€‚\nbrew èµ„æº è½¯ä»¶ clashx github\nClashX æ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•è½»é‡åŒ–çš„ä»£ç†å®¢æˆ·ç«¯\ncalibre github\nThe official source code repository for the calibre ebook manager\nmotrix A full-featured download manager\nlisten1 github\nListen 1 å¯ä»¥æœç´¢å’Œæ’­æ”¾æ¥è‡ªå¤šä¸ªä¸»æµéŸ³ä¹ç½‘ç«™çš„æ­Œæ›²ï¼Œè®©ä½ çš„æ›²åº“æ›´å…¨é¢ã€‚å¹¶æ”¯æŒæ”¶è—åŠŸèƒ½ï¼Œæ–¹ä¾¿çš„åˆ›å»ºè‡ªå·±çš„æ­Œå•ã€‚\nNetNewsWire github\nItâ€™s a free and open source feed reader for macOS and iOS.\namethyst github\nAutomatic tiling window manager for macOS Ã  la xmonad.\nrectangle github\nMove and resize windows on macOS with keyboard shortcuts and snap areas\naerial github\nApple TV Aerial Screensaver for Mac. å±å¹•ä¿æŠ¤ç¨‹åº\nblurred github\nA macOS utility that helps reduce distraction by dimming your inactive noise.ï¼ˆä¸“æ³¨å½“å‰çš„ appï¼‰\nhidden github An ultra-light MacOS utility that helps hide menu bar icons\ncheatsheet official\nJust hold the âŒ˜-Key a bit longer to get a list of all active shortcuts of the current application. It\u0026rsquo;s as simple as that.(å±•ç¤ºå½“å‰ App å¿«æ·é”®æˆ–ä¿®æ”¹ï¼‰\nclean-me github\nA macOS system analyser and cleaner\neul github\nğŸ–¥ï¸ macOS status monitoring app written in SwiftUI.\nkeka github\nThe macOS file archiver\nmonitorcontrol github\nğŸ–¥ Control your display\u0026rsquo;s brightness \u0026amp; volume on your Mac as if it was a native Apple Display. Use Apple Keyboard keys or custom shortcuts. Shows the native macOS OSDs.(æ§åˆ¶æ˜¾ç¤ºå™¨)\nmaccy github\nLightweight clipboard manager for macOS\nuPic github\nğŸ“¤uPic is a native, powerful, beautiful and simple picture and file upload tool for macOS.\nç¬”è®° fsnotes github\nNotes manager for macOS/iOS\nnotable github\nThe Markdown-based note-taking app that doesn\u0026rsquo;t suck.\nå¼€å‘ AnotherRedisDesktopManager github\nintellij-idea iterm2 syncthing github\nOpen Source Continuous File Synchronization\nvimrc github\ngit clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime sh ~/.vim_runtime/install_awesome_vimrc.sh å…¶ä»– swiftbar github\nPowerful macOS menu bar customization tool\nHammerspoon github\nThis is a tool for powerful automation of OS X. At its core, Hammerspoon is just a bridge between the operating system and a Lua scripting engine.\nCakebrew Manage your Homebrew formulas with style using Cakebrew. github\niptv https://github.com/iptv-org/iptv\ncommand fzf fzf is a general-purpose command-line fuzzy finder.\nwrk github\na HTTP benchmarking tool\nmkcert github\nA simple zero-config tool to make locally trusted development certificates with any names you\u0026rsquo;d like.\nbrew install clashx; brew install netnewswire; brew install calibre; brew install motrix; brew install listen1; brew install netnewswire; brew install amethyst; brew install rectangle; brew install aerial; brew install blurred; brew install hiddenbar; brew install cheatsheet; brew install clean-me; brew install eul; brew install fsnotes; brew install keka; brew install maccy; brew install monitorcontrol; brew install rectangle; brew install upic; brew install another-redis-desktop-manager; brew install cakebrew; brew install iterm2; brew install intellij-idea; brew install syncthing; brew install swiftbar; brew install hammerspoon; brew install fzf; brew install wrk; ","permalink":"http://blog.chalme.top/posts/macos/macos-software/","summary":"æ­¤æ–‡ç« ä¸»è¦æ•´ç†äº† macos ä¸ªäººå¸¸ç”¨çš„è½¯ä»¶ã€‚è½¯ä»¶åˆ†ä¸º appstore å’Œ brewä¸¤ä¸ªæ¥æºã€‚ brewè½¯ä»¶æ¥æºä¸€èˆ¬éƒ½æ˜¯å¼€æºçš„é¡¹ç›®ã€‚\nappstore å·¥å…· Justfocus ç•ªèŒ„å·¥ä½œ\nCaffeinated é¿å… mac ç¡çœ \niShot æˆªå›¾è½¯ä»¶ï¼ŒåŠŸèƒ½é½å…¨ã€‚ ä¹Ÿå¯ä»¥ç”¨ xnip ç­‰ä»£æ›¿ã€‚\nbrew èµ„æº è½¯ä»¶ clashx github\nClashX æ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•è½»é‡åŒ–çš„ä»£ç†å®¢æˆ·ç«¯\ncalibre github\nThe official source code repository for the calibre ebook manager\nmotrix A full-featured download manager\nlisten1 github\nListen 1 å¯ä»¥æœç´¢å’Œæ’­æ”¾æ¥è‡ªå¤šä¸ªä¸»æµéŸ³ä¹ç½‘ç«™çš„æ­Œæ›²ï¼Œè®©ä½ çš„æ›²åº“æ›´å…¨é¢ã€‚å¹¶æ”¯æŒæ”¶è—åŠŸèƒ½ï¼Œæ–¹ä¾¿çš„åˆ›å»ºè‡ªå·±çš„æ­Œå•ã€‚\nNetNewsWire github\nItâ€™s a free and open source feed reader for macOS and iOS.\namethyst github\nAutomatic tiling window manager for macOS Ã  la xmonad.","title":"Macos Software"},{"content":"æ¦‚è¿° sedæ˜¯stream editorçš„ç®€ç§°ï¼Œä¹Ÿå°±æ˜¯æµç¼–è¾‘å™¨ã€‚å®ƒä¸€æ¬¡å¤„ç†ä¸€è¡Œå†…å®¹ï¼Œå¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸º\u0026quot;pattern space\u0026quot;ï¼Œæ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®Œæˆåï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰ æ”¹å˜ï¼Œé™¤éä½ ä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚\nåŸºç¡€ -E -- use extended regular expressions -a -- delay opening files listed with w function -e -- specify sed commands to run -f -- add contents of file to commands to run -i -- edit files in-place, running scripts separately for each file -l -- make output line buffered -n -- suppress automatic printing of pattern space a,append è¿½åŠ  i,insert æ’å…¥ d,delete åˆ é™¤ s,substitution æ›¿æ¢ c,change ä¿®æ”¹ y,transform è½¬æ¢ æ›¿æ¢ æ›¿æ¢æ ‡è®° sï¼ˆsubstitutionï¼‰é»˜è®¤æƒ…å†µä¸‹åªæ›¿æ¢æ¯è¡Œä¸­å‡ºç°çš„ç¬¬ä¸€å¤„ã€‚ä½¿ç”¨æ›¿æ¢æ ‡è®°ï¼ˆsubstitution flagï¼‰æŒ‡å®šæ›¿æ¢ä½ç½®ã€‚æ›¿æ¢æ ‡è®°åœ¨æ›¿æ¢å‘½ä»¤å­—ç¬¦ä¸²ä¹‹åè®¾ç½®ã€‚ s/pattern/replacement/flags æœ‰4ç§å¯ç”¨çš„æ›¿æ¢æ ‡è®°ï¼š\næ•°å­—ï¼Œè¡¨æ˜æ–°æ–‡æœ¬å°†æ›¿æ¢ç¬¬å‡ å¤„æ¨¡å¼åŒ¹é…çš„åœ°æ–¹ï¼› gï¼Œè¡¨æ˜æ–°æ–‡æœ¬å°†ä¼šæ›¿æ¢æ‰€æœ‰åŒ¹é…çš„æ–‡æœ¬ï¼› pï¼Œè¡¨æ˜æ›¿æ¢è¿‡çš„è¡Œè¦æ‰“å°å‡ºæ¥ï¼› w fileï¼Œå°†æ›¿æ¢çš„ç»“æœå†™åˆ°æ–‡ä»¶ä¸­ã€‚ æ›¿æ¢å­—ç¬¦ sedå…è®¸é€‰æ‹©å…¶ä»–å­—ç¬¦æ¥ä½œä¸ºæ›¿æ¢å‘½ä»¤ä¸­çš„å­—ç¬¦ä¸²åˆ†éš”ç¬¦ï¼š\nsed \u0026#39;s!/bin/bash!/bin/csh!\u0026#39; /etc/passwd ä½¿ç”¨åœ°å€ é»˜è®¤æƒ…å†µä¸‹ï¼Œsedå‘½ä»¤ä¼šä½œç”¨äºæ–‡æœ¬æ•°æ®çš„æ‰€æœ‰è¡Œã€‚å¦‚æœåªæƒ³å°†å‘½ä»¤ä½œç”¨äºç‰¹å®šè¡Œæˆ–æŸäº›è¡Œï¼Œåˆ™å¿…é¡»ç”¨è¡Œå¯»å€ï¼ˆline addressingï¼‰ã€‚\nä»¥æ•°å­—å½¢å¼è¡¨ç¤ºè¡ŒåŒºé—´ ç”¨æ–‡æœ¬æ¨¡å¼æ¥è¿‡æ»¤å‡ºè¡Œ æ ¼å¼ [address]command ä»¥æ•°å­—å½¢å¼è¡¨ç¤ºè¡ŒåŒºé—´ sed \u0026#39;2s/dog/cat/\u0026#39; data1.txt sed \u0026#39;2,3s/dog/cat/\u0026#39; data1.txt sed \u0026#39;2,$s/dog/cat/\u0026#39; data1.txt ä½¿ç”¨æ–‡æœ¬æ¨¡å¼è¿‡æ»¤å™¨ sedç¼–è¾‘å™¨å…è®¸æŒ‡å®šæ–‡æœ¬æ¨¡å¼æ¥è¿‡æ»¤å‡ºå‘½ä»¤è¦ä½œç”¨çš„è¡Œ /pattern/command\nsed -n \u0026#39;/special/s/test/dog/p\u0026#39; data1.txt å‘½ä»¤ç»„åˆ sed \u0026#39;2{ \u0026gt; s/fox/elephant/ \u0026gt; s/dog/cat/ \u0026gt; }\u0026#39; data1.txt åˆ é™¤è¡Œ åˆ é™¤å‘½ä»¤dåˆ é™¤åŒ¹é…æŒ‡å®šå¯»å€æ¨¡å¼çš„æ‰€æœ‰è¡Œã€‚å¦‚æœæ²¡æœ‰åŠ å…¥å¯»å€æ¨¡å¼ï¼Œæµä¸­çš„æ‰€æœ‰æ–‡æœ¬è¡Œéƒ½ä¼šè¢«åˆ é™¤ã€‚\nsed \u0026#39;1d\u0026#39; data1.txt sed \u0026#39;/spe/d\u0026#39; data1.txt æ’å…¥å’Œé™„åŠ æ–‡æœ¬ æ’å…¥ï¼ˆinsertï¼‰å‘½ä»¤ï¼ˆiï¼‰ä¼šåœ¨æŒ‡å®šè¡Œå‰å¢åŠ ä¸€ä¸ªæ–°è¡Œï¼› é™„åŠ ï¼ˆappendï¼‰å‘½ä»¤ï¼ˆaï¼‰ä¼šåœ¨æŒ‡å®šè¡Œåå¢åŠ ä¸€ä¸ªæ–°è¡Œã€‚ sed \u0026#39;[address]command\\ new line\u0026#39; $ echo \u0026#34;Test Line 2\u0026#34; | sed \u0026#39;i\\Test Line 1\u0026#39; Test Line 1 Test Line 2 $ echo \u0026#34;Test Line 2\u0026#34; | sed \u0026#39;a\\Test Line 1\u0026#39; Test Line 2 Test Line 1 #åœ¨å‘½ä»¤è¡Œä¸Šä½¿ç”¨sedæ—¶ï¼Œä¼šçœ‹åˆ°æ¬¡æç¤ºç¬¦æ¥æé†’è¾“å…¥æ–°çš„è¡Œæ•°æ®ã€‚å¿…é¡»åœ¨è¯¥è¡Œå®Œæˆsedç¼–è¾‘å™¨å‘½ä»¤ã€‚ $ echo \u0026#34;Test Line 2\u0026#34; | sed \u0026#39;i\\ \u0026gt; Test Line 1\u0026#39; Test Line 1 Test Line 2 ä¿®æ”¹è¡Œ ä¿®æ”¹ï¼ˆchangeï¼‰å‘½ä»¤(c)å…è®¸ä¿®æ”¹(æ›¿æ¢)æ•°æ®æµä¸­æ•´è¡Œæ–‡æœ¬çš„å†…å®¹.å¦‚æœä½œç”¨äºåœ°å€åŒºé—´ï¼Œsedä¼šç”¨ä¸€è¡Œæ–‡æœ¬ä»£æ›¿åŒºé—´å†…çš„æ‰€æœ‰è¡Œï¼Œè€Œéé€ä¸€æ›¿æ¢ã€‚\nsed \u0026#39;1,2c\\ hello \u0026#39; data1.txt è½¬æ¢å‘½ä»¤ è½¬æ¢ï¼ˆtransformï¼‰å‘½ä»¤ï¼ˆyï¼‰æ˜¯å”¯ä¸€å¯ä»¥å¤„ç†å•ä¸ªå­—ç¬¦çš„sedç¼–è¾‘å™¨å‘½ä»¤ã€‚è½¬æ¢å‘½ä»¤æ ¼å¼å¦‚ä¸‹: [address]y/inchars/outchars/\nå›é¡¾æ‰“å° 3ä¸ªå‘½ä»¤ä¹Ÿèƒ½ç”¨æ¥æ‰“å°æ•°æ®æµä¸­çš„ä¿¡æ¯ï¼š på‘½ä»¤ç”¨æ¥æ‰“å°æ–‡æœ¬è¡Œï¼› ç­‰å·ï¼ˆ=ï¼‰å‘½ä»¤ç”¨æ¥æ‰“å°è¡Œå·ï¼› lï¼ˆå°å†™çš„Lï¼‰å‘½ä»¤ç”¨æ¥åˆ—å‡ºè¡Œã€‚\nä½¿ç”¨sedå¤„ç†æ–‡ä»¶ å†™å…¥æ–‡ä»¶ wå‘½ä»¤ç”¨æ¥å‘æ–‡ä»¶å†™å…¥è¡Œ [address]w filename\nä»æ–‡ä»¶è¯»å–æ•°æ® è¯»å–ï¼ˆreadï¼‰å‘½ä»¤ï¼ˆrï¼‰å°†ä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶ä¸­çš„æ•°æ®æ’å…¥åˆ°æ•°æ®æµä¸­ [address]r filename\nhttps://jixiaocan.github.io/posts/cmd-sed/ https://markrepo.github.io/commands/2018/06/26/sed/ ","permalink":"http://blog.chalme.top/posts/linux/command/sed/","summary":"æ¦‚è¿° sedæ˜¯stream editorçš„ç®€ç§°ï¼Œä¹Ÿå°±æ˜¯æµç¼–è¾‘å™¨ã€‚å®ƒä¸€æ¬¡å¤„ç†ä¸€è¡Œå†…å®¹ï¼Œå¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸º\u0026quot;pattern space\u0026quot;ï¼Œæ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®Œæˆåï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰ æ”¹å˜ï¼Œé™¤éä½ ä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚\nåŸºç¡€ -E -- use extended regular expressions -a -- delay opening files listed with w function -e -- specify sed commands to run -f -- add contents of file to commands to run -i -- edit files in-place, running scripts separately for each file -l -- make output line buffered -n -- suppress automatic printing of pattern space a,append è¿½åŠ  i,insert æ’å…¥ d,delete åˆ é™¤ s,substitution æ›¿æ¢ c,change ä¿®æ”¹ y,transform è½¬æ¢ æ›¿æ¢ æ›¿æ¢æ ‡è®° sï¼ˆsubstitutionï¼‰é»˜è®¤æƒ…å†µä¸‹åªæ›¿æ¢æ¯è¡Œä¸­å‡ºç°çš„ç¬¬ä¸€å¤„ã€‚ä½¿ç”¨æ›¿æ¢æ ‡è®°ï¼ˆsubstitution flagï¼‰æŒ‡å®šæ›¿æ¢ä½ç½®ã€‚æ›¿æ¢æ ‡è®°åœ¨æ›¿æ¢å‘½ä»¤å­—ç¬¦ä¸²ä¹‹åè®¾ç½®ã€‚ s/pattern/replacement/flags æœ‰4ç§å¯ç”¨çš„æ›¿æ¢æ ‡è®°ï¼š","title":"Sed"},{"content":"ä¹‹å‰åœ¨é€›åšå®¢çš„æ—¶å€™ï¼Œå‘ç° zsh çš„ä¸€ç¯‡é…ç½®æ–‡æ¡£ï¼Œç”¨ä¸Šååˆ†çˆ½ã€‚æ‰è¿‡äº†æ²¡å‡ å¤©ï¼Œåˆçœ‹åˆ°äº† fish è¿™ä¸ª shellï¼Œç¡®å®æ„Ÿè§‰æ¯” zsh å¼ºã€‚æ„Ÿè§‰å¥½å–„å˜å•Šã€‚ -_-!!ä¸è¿‡ç¡®å®å¥½ç”¨ï¼ï¼ï¼\nzsh ä½¿ç”¨ (oh-my-zsh) æ¥æå‡ä½“æ£€ï¼Œè¿˜æ˜¯ä¸é”™çš„ï¼Œgithub æœ‰ 40000+çš„æ˜Ÿ\nfishï¼ˆæ¨èï¼‰ fish (Friendly Interactive Shell)\nfish is a fully-equipped command line shell (like bash or zsh) that is smart and user-friendly. fish supports powerful features like syntax highlighting, autosuggestions, and tab completions that just work, with nothing to learn or configure.\nIf you want to make your command line more productive, more useful, and more fun, without learning a bunch of arcane syntax and configuration options, then fish might be just what you\u0026rsquo;re looking for!\nä¸ºä»€ä¹ˆæˆ‘å–œæ¬¢ ä¸éœ€è¦è¿‡å¤šé…ç½®ï¼Œç”¨æˆ·å‹å¥½ã€‚ å¿«ï¼Œç›¸æ¯”ï¼ˆè¿‡å¤šé…ç½®çš„ zsh æ¥è¯´ï¼‰ vi æ¨¡å¼æ”¯æŒ (Oh-my-zsh)çš„åŠŸèƒ½åŸºæœ¬éƒ½æ”¯æŒ ä½¿ç”¨ Oh-my-fishæ¥ç®¡ç†æ’ä»¶ä¸»é¢˜ç­‰ç­‰ï¼ˆå’Œ oh-my-zsh)åŠŸèƒ½å·®ä¸å¤š\ntheme æˆ‘çš„ä¸»é¢˜ æ¨è batman, es(ç›®å‰æˆ‘ä½¿ç”¨çš„ä¸»é¢˜) plugin z(ç±»ä¼¼ autojump åŠŸèƒ½ï¼Œæ ¹æ®å†å²å¿«æ·è¿›å…¥ç›®å½•) re-search (å‘åæœç´¢å†å²å‘½ä»¤) å‚è€ƒ zsh 1 2 3\n","permalink":"http://blog.chalme.top/posts/history/%E5%85%B3%E4%BA%8Eshell/","summary":"ä¹‹å‰åœ¨é€›åšå®¢çš„æ—¶å€™ï¼Œå‘ç° zsh çš„ä¸€ç¯‡é…ç½®æ–‡æ¡£ï¼Œç”¨ä¸Šååˆ†çˆ½ã€‚æ‰è¿‡äº†æ²¡å‡ å¤©ï¼Œåˆçœ‹åˆ°äº† fish è¿™ä¸ª shellï¼Œç¡®å®æ„Ÿè§‰æ¯” zsh å¼ºã€‚æ„Ÿè§‰å¥½å–„å˜å•Šã€‚ -_-!!ä¸è¿‡ç¡®å®å¥½ç”¨ï¼ï¼ï¼\nzsh ä½¿ç”¨ (oh-my-zsh) æ¥æå‡ä½“æ£€ï¼Œè¿˜æ˜¯ä¸é”™çš„ï¼Œgithub æœ‰ 40000+çš„æ˜Ÿ\nfishï¼ˆæ¨èï¼‰ fish (Friendly Interactive Shell)\nfish is a fully-equipped command line shell (like bash or zsh) that is smart and user-friendly. fish supports powerful features like syntax highlighting, autosuggestions, and tab completions that just work, with nothing to learn or configure.\nIf you want to make your command line more productive, more useful, and more fun, without learning a bunch of arcane syntax and configuration options, then fish might be just what you\u0026rsquo;re looking for!","title":"å…³äºshell"},{"content":"Iterator pattern(è¿­ä»£å™¨æ¨¡å¼) è¿™ä¸ªæ¨¡å¼å·²ç»è¢«æ•´åˆå…¥Javaçš„Collection.åœ¨å¤§å¤šæ•°åœºåˆä¸‹æ— éœ€è‡ªå·±åˆ¶é€ ä¸€ä¸ªIterator,åªè¦å°†å¯¹è±¡è£…å…¥Collectionä¸­ï¼Œç›´æ¥ä½¿ç”¨Iteratorè¿›è¡Œå¯¹è±¡éå†.æ›´å¤š\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.11-iterator/","summary":"Iterator pattern(è¿­ä»£å™¨æ¨¡å¼) è¿™ä¸ªæ¨¡å¼å·²ç»è¢«æ•´åˆå…¥Javaçš„Collection.åœ¨å¤§å¤šæ•°åœºåˆä¸‹æ— éœ€è‡ªå·±åˆ¶é€ ä¸€ä¸ªIterator,åªè¦å°†å¯¹è±¡è£…å…¥Collectionä¸­ï¼Œç›´æ¥ä½¿ç”¨Iteratorè¿›è¡Œå¯¹è±¡éå†.æ›´å¤š","title":"3.11 Iterator"},{"content":"Visitor pattern (è®¿é—®è€…æ¨¡å¼) ä½œç”¨äºæŸä¸ªå¯¹è±¡ç¾¤ä¸­å„ä¸ªå¯¹è±¡çš„æ“ä½œ. å®ƒå¯ä»¥ä½¿ä½ åœ¨ä¸æ”¹å˜è¿™äº›å¯¹è±¡æœ¬èº«çš„æƒ…å†µä¸‹,å®šä¹‰ä½œç”¨äºè¿™äº›å¯¹è±¡çš„æ–°æ“ä½œ.\nåœ¨Javaä¸­,Visitoræ¨¡å¼å®é™…ä¸Šæ˜¯åˆ†ç¦»äº†collectionç»“æ„ä¸­çš„å…ƒç´ å’Œå¯¹è¿™äº›å…ƒç´ è¿›è¡Œæ“ä½œçš„è¡Œä¸º. ä¸ºä½•ä½¿ç”¨Visitor? Javaçš„Collection(åŒ…æ‹¬Vectorå’ŒHashtable)æ˜¯æˆ‘ä»¬æœ€ç»å¸¸ä½¿ç”¨çš„æŠ€æœ¯,å¯æ˜¯Collectionå¥½è±¡æ˜¯ä¸ªé»‘è‰²å¤§æŸ“ç¼¸,æœ¬æ¥æœ‰å„ç§é²œæ˜ç±»å‹ç‰¹å¾çš„å¯¹è±¡ä¸€æ—¦æ”¾å…¥å,å†å–å‡ºæ—¶,è¿™äº›ç±»å‹å°±æ¶ˆå¤±äº†.é‚£ä¹ˆæˆ‘ä»¬åŠ¿å¿…è¦ç”¨Ifæ¥åˆ¤æ–­,å¦‚:\nIterator iterator = collection.iterator() while (iterator.hasNext()) { Object o = iterator.next(); if (o instanceof Collection) messyPrintCollection((Collection)o); else if (o instanceof String) System.out.println(\u0026#34;\u0026#39;\u0026#34;+o.toString()+\u0026#34;\u0026#39;\u0026#34;); else if (o instanceof Float) System.out.println(o.toString()+\u0026#34;f\u0026#34;); else System.out.println(o.toString()); } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬ä½¿ç”¨äº† instanceofæ¥åˆ¤æ–­ oçš„ç±»å‹.\nå¾ˆæ˜¾ç„¶,è¿™æ ·åšçš„ç¼ºç‚¹ä»£ç If else if å¾ˆç¹ç.æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Visitoræ¨¡å¼è§£å†³å®ƒ.\nå¦‚ä½•ä½¿ç”¨Visitor? é’ˆå¯¹ä¸Šä¾‹,å®šä¹‰æ¥å£å«Visitable,ç”¨æ¥å®šä¹‰ä¸€ä¸ªAcceptæ“ä½œ,ä¹Ÿå°±æ˜¯è¯´è®©Collectionæ¯ä¸ªå…ƒç´ å…·å¤‡å¯è®¿é—®æ€§.\nè¢«è®¿é—®è€…æ˜¯æˆ‘ä»¬Collectionçš„æ¯ä¸ªå…ƒç´ Element,æˆ‘ä»¬è¦ä¸ºè¿™äº›Elementå®šä¹‰ä¸€ä¸ªå¯ä»¥æ¥å—è®¿é—®çš„æ¥å£(è®¿é—®å’Œè¢«è®¿é—®æ˜¯äº’åŠ¨çš„,åªæœ‰è®¿é—®è€…,è¢«è®¿é—®è€…å¦‚æœè¡¨ç¤ºä¸æ¬¢è¿,è®¿é—®è€…å°±ä¸èƒ½è®¿é—®),å–åä¸ºVisitableï¼Œä¹Ÿå¯å–åä¸ºElementã€‚\npublic interface Visitable { public void accept(Visitor visitor); } è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ç»§æ‰¿è¿™ä¸ªæ–°çš„æ¥å£Visitableï¼š\npublic class StringElement implements Visitable { private String value; public StringElement(String string) { value = string; } public String getValue(){ return value; } //å®šä¹‰acceptçš„å…·ä½“å†…å®¹ è¿™é‡Œæ˜¯å¾ˆç®€å•çš„ä¸€å¥è°ƒç”¨ public void accept(Visitor visitor) { visitor.visitString(this); } } ä¸Šé¢æ˜¯è¢«è®¿é—®è€…æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸‹é¢å†å»ºç«‹ä¸€ä¸ªFloatç±»å‹çš„ï¼š\npublic class FloatElement implements Visitable { private Float value; public FloatElement(Float value) { this.value = value; } public Float getValue(){ return value; } //å®šä¹‰acceptçš„å…·ä½“å†…å®¹ è¿™é‡Œæ˜¯å¾ˆç®€å•çš„ä¸€å¥è°ƒç”¨ public void accept(Visitor visitor) { visitor.visitFloat(this); } } æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªæ¥å£visitorè®¿é—®è€…ï¼Œåœ¨è¿™ä¸ªæ¥å£ä¸­,æœ‰ä¸€äº›è®¿é—®æ“ä½œï¼Œè¿™äº›è®¿é—®æ“ä½œæ˜¯ä¸“é—¨è®¿é—®å¯¹è±¡é›†åˆCollectionä¸­æœ‰å¯èƒ½çš„æ‰€æœ‰ç±»ï¼Œç›®å‰æˆ‘ä»¬å‡å®šæœ‰ä¸‰ä¸ªè¡Œä¸ºï¼šè®¿é—®å¯¹è±¡é›†åˆä¸­çš„å­—ç¬¦ä¸²ç±»å‹ï¼›è®¿é—®å¯¹è±¡é›†åˆä¸­çš„Floatç±»å‹ï¼›è®¿é—®å¯¹è±¡é›†åˆä¸­çš„å¯¹è±¡é›†åˆç±»å‹ã€‚æ³¨æ„æœ€åä¸€ä¸ªç±»å‹æ˜¯é›†åˆåµŒå¥—ï¼Œé€šè¿‡è¿™ä¸ªåµŒå¥—å®ç°å¯ä»¥çœ‹å‡ºä½¿ç”¨è®¿é—®æ¨¡å¼çš„ä¸€ä¸ªä¼˜ç‚¹ã€‚\næ¥å£visitorè®¿é—®è€…å¦‚ä¸‹ï¼š\npublic interface Visitor { public void visitString(StringElement stringE); public void visitFloat(FloatElement floatE); public void visitCollection(Collection collection); } è®¿é—®è€…çš„å®ç°:\npublic class ConcreteVisitor implements Visitor { //åœ¨æœ¬æ–¹æ³•ä¸­,æˆ‘ä»¬å®ç°äº†å¯¹Collectionçš„å…ƒç´ çš„æˆåŠŸè®¿é—® public void visitCollection(Collection collection) { Iterator iterator = collection.iterator() while (iterator.hasNext()) { Object o = iterator.next(); if (o instanceof Visitable) ((Visitable)o).accept(this); } ï½ public void visitString(StringElement stringE) { System.out.println(\u0026#34;\u0026#39;\u0026#34;+stringE.getValue()+\u0026#34;\u0026#39;\u0026#34;); } public void visitFloat(FloatElement floatE){ System.out.println(floatE.getValue().toString()+\u0026#34;f\u0026#34;); } } åœ¨ä¸Šé¢çš„visitCollectionæˆ‘ä»¬å®ç°äº†å¯¹Collectionæ¯ä¸ªå…ƒç´ è®¿é—®,åªä½¿ç”¨äº†ä¸€ä¸ªåˆ¤æ–­è¯­å¥,åªè¦åˆ¤æ–­å…¶æ˜¯å¦å¯ä»¥è®¿é—®.\nStringElementåªæ˜¯ä¸€ä¸ªå®ç°ï¼Œå¯ä»¥æ‹“å±•ä¸ºæ›´å¤šçš„å®ç°ï¼Œæ•´ä¸ªæ ¸å¿ƒå¥¥å¦™åœ¨acceptæ–¹æ³•ä¸­ï¼Œåœ¨éå†Collectionæ—¶ï¼Œé€šè¿‡ç›¸åº”çš„acceptæ–¹æ³•è°ƒç”¨å…·ä½“ç±»å‹çš„è¢«è®¿é—®è€…ã€‚è¿™ä¸€æ­¥ç¡®å®šäº†è¢«è®¿é—®è€…ç±»å‹ï¼Œ\nå¦‚æœæ˜¯StringElementï¼Œè€ŒStringElementåˆ™å›è°ƒè®¿é—®è€…çš„visiteStringæ–¹æ³•ï¼Œè¿™ä¸€æ­¥å®ç°äº†è¡Œä¸ºæ“ä½œæ–¹æ³•ã€‚\nå®¢æˆ·ç«¯ä»£ç ï¼š\nVisitor visitor = new ConcreteVisitor(); StringElement stringE = new StringElement(\u0026#34;I am a String\u0026#34;); visitor.visitString(stringE); Collection list = new ArrayList(); list.add(new StringElement(\u0026#34;I am a String1\u0026#34;)); list.add(new StringElement(\u0026#34;I am a String2\u0026#34;)); list.add(new FloatElement(new Float(12))); list.add(new StringElement(\u0026#34;I am a String3\u0026#34;)); visitor.visitCollection(list); å®¢æˆ·ç«¯ä»£ç ä¸­çš„listå¯¹è±¡é›†åˆä¸­æ”¾ç½®äº†å¤šç§æ•°æ®ç±»å‹ï¼Œå¯¹å¯¹è±¡é›†åˆä¸­çš„è®¿é—®ä¸å¿…è±¡ä¸€å¼€å§‹é‚£æ ·ï¼Œä½¿ç”¨instance ofé€ä¸ªåˆ¤æ–­ï¼Œè€Œæ˜¯é€šè¿‡è®¿é—®è€…æ¨¡å¼å·§å¦™å®ç°äº†ã€‚\nè‡³æ­¤,æˆ‘ä»¬å®Œæˆäº†Visitoræ¨¡å¼åŸºæœ¬ç»“æ„.\nä½¿ç”¨Visitoræ¨¡å¼çš„å‰æ ä½¿ç”¨è®¿é—®è€…æ¨¡å¼æ˜¯å¯¹è±¡ç¾¤ç»“æ„ä¸­(Collection) ä¸­çš„å¯¹è±¡ç±»å‹å¾ˆå°‘æ”¹å˜ã€‚\nåœ¨ä¸¤ä¸ªæ¥å£Visitorå’ŒVisitableä¸­,ç¡®ä¿Visitableå¾ˆå°‘å˜åŒ–,ä¹Ÿå°±æ˜¯è¯´ï¼Œç¡®ä¿ä¸èƒ½è€æœ‰æ–°çš„Elementå…ƒç´ ç±»å‹åŠ è¿›æ¥ï¼Œå¯ä»¥å˜åŒ–çš„æ˜¯è®¿é—®è€…è¡Œä¸ºæˆ–æ“ä½œï¼Œä¹Ÿå°±æ˜¯Visitorçš„ä¸åŒå­ç±»å¯ä»¥æœ‰å¤šç§,è¿™æ ·ä½¿ç”¨è®¿é—®è€…æ¨¡å¼æœ€æ–¹ä¾¿.\nå¦‚æœå¯¹è±¡é›†åˆä¸­çš„å¯¹è±¡é›†åˆç»å¸¸æœ‰å˜åŒ–, é‚£ä¹ˆä¸ä½†Visitorå®ç°è¦å˜åŒ–ï¼ŒVisistableä¹Ÿè¦å¢åŠ ç›¸åº”è¡Œä¸ºï¼ŒGOFå»ºè®®æ˜¯,ä¸å¦‚åœ¨è¿™äº›å¯¹è±¡ç±»ä¸­ç›´æ¥é€ä¸ªå®šä¹‰æ“ä½œï¼Œæ— éœ€ä½¿ç”¨è®¿é—®è€…è®¾è®¡æ¨¡å¼ã€‚\nä½†æ˜¯åœ¨Javaä¸­ï¼ŒJavaçš„ReflectæŠ€æœ¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå› æ­¤ç»“åˆreflectåå°„æœºåˆ¶ï¼Œå¯ä»¥ä½¿å¾—è®¿é—®è€…æ¨¡å¼é€‚ç”¨èŒƒå›´æ›´å¹¿äº†ã€‚\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.10-visitor/","summary":"Visitor pattern (è®¿é—®è€…æ¨¡å¼) ä½œç”¨äºæŸä¸ªå¯¹è±¡ç¾¤ä¸­å„ä¸ªå¯¹è±¡çš„æ“ä½œ. å®ƒå¯ä»¥ä½¿ä½ åœ¨ä¸æ”¹å˜è¿™äº›å¯¹è±¡æœ¬èº«çš„æƒ…å†µä¸‹,å®šä¹‰ä½œç”¨äºè¿™äº›å¯¹è±¡çš„æ–°æ“ä½œ.\nåœ¨Javaä¸­,Visitoræ¨¡å¼å®é™…ä¸Šæ˜¯åˆ†ç¦»äº†collectionç»“æ„ä¸­çš„å…ƒç´ å’Œå¯¹è¿™äº›å…ƒç´ è¿›è¡Œæ“ä½œçš„è¡Œä¸º. ä¸ºä½•ä½¿ç”¨Visitor? Javaçš„Collection(åŒ…æ‹¬Vectorå’ŒHashtable)æ˜¯æˆ‘ä»¬æœ€ç»å¸¸ä½¿ç”¨çš„æŠ€æœ¯,å¯æ˜¯Collectionå¥½è±¡æ˜¯ä¸ªé»‘è‰²å¤§æŸ“ç¼¸,æœ¬æ¥æœ‰å„ç§é²œæ˜ç±»å‹ç‰¹å¾çš„å¯¹è±¡ä¸€æ—¦æ”¾å…¥å,å†å–å‡ºæ—¶,è¿™äº›ç±»å‹å°±æ¶ˆå¤±äº†.é‚£ä¹ˆæˆ‘ä»¬åŠ¿å¿…è¦ç”¨Ifæ¥åˆ¤æ–­,å¦‚:\nIterator iterator = collection.iterator() while (iterator.hasNext()) { Object o = iterator.next(); if (o instanceof Collection) messyPrintCollection((Collection)o); else if (o instanceof String) System.out.println(\u0026#34;\u0026#39;\u0026#34;+o.toString()+\u0026#34;\u0026#39;\u0026#34;); else if (o instanceof Float) System.out.println(o.toString()+\u0026#34;f\u0026#34;); else System.out.println(o.toString()); } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬ä½¿ç”¨äº† instanceofæ¥åˆ¤æ–­ oçš„ç±»å‹.\nå¾ˆæ˜¾ç„¶,è¿™æ ·åšçš„ç¼ºç‚¹ä»£ç If else if å¾ˆç¹ç.æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Visitoræ¨¡å¼è§£å†³å®ƒ.\nå¦‚ä½•ä½¿ç”¨Visitor? é’ˆå¯¹ä¸Šä¾‹,å®šä¹‰æ¥å£å«Visitable,ç”¨æ¥å®šä¹‰ä¸€ä¸ªAcceptæ“ä½œ,ä¹Ÿå°±æ˜¯è¯´è®©Collectionæ¯ä¸ªå…ƒç´ å…·å¤‡å¯è®¿é—®æ€§.\nè¢«è®¿é—®è€…æ˜¯æˆ‘ä»¬Collectionçš„æ¯ä¸ªå…ƒç´ Element,æˆ‘ä»¬è¦ä¸ºè¿™äº›Elementå®šä¹‰ä¸€ä¸ªå¯ä»¥æ¥å—è®¿é—®çš„æ¥å£(è®¿é—®å’Œè¢«è®¿é—®æ˜¯äº’åŠ¨çš„,åªæœ‰è®¿é—®è€…,è¢«è®¿é—®è€…å¦‚æœè¡¨ç¤ºä¸æ¬¢è¿,è®¿é—®è€…å°±ä¸èƒ½è®¿é—®),å–åä¸ºVisitableï¼Œä¹Ÿå¯å–åä¸ºElementã€‚\npublic interface Visitable { public void accept(Visitor visitor); } è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ç»§æ‰¿è¿™ä¸ªæ–°çš„æ¥å£Visitableï¼š\npublic class StringElement implements Visitable { private String value; public StringElement(String string) { value = string; } public String getValue(){ return value; } //å®šä¹‰acceptçš„å…·ä½“å†…å®¹ è¿™é‡Œæ˜¯å¾ˆç®€å•çš„ä¸€å¥è°ƒç”¨ public void accept(Visitor visitor) { visitor.","title":"3.10 Visitor"},{"content":"Interpreter pattern(è§£é‡Šè€…æ¨¡å¼) å®šä¹‰ å®šä¹‰è¯­è¨€çš„æ–‡æ³• ,å¹¶ä¸”å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¯¥è¯­è¨€ä¸­çš„å¥å­.\nInterpreterä¼¼ä¹ä½¿ç”¨é¢ä¸æ˜¯å¾ˆå¹¿,å®ƒæè¿°äº†ä¸€ä¸ªè¯­è¨€è§£é‡Šå™¨æ˜¯å¦‚ä½•æ„æˆçš„,åœ¨å®é™…åº”ç”¨ä¸­,æˆ‘ä»¬å¯èƒ½å¾ˆå°‘å»æ„é€ ä¸€ä¸ªè¯­è¨€çš„æ–‡æ³•.æˆ‘ä»¬è¿˜æ˜¯æ¥ç®€å•çš„äº†è§£ä¸€ä¸‹: é¦–å…ˆè¦å»ºç«‹ä¸€ä¸ªæ¥å£,ç”¨æ¥æè¿°å…±åŒçš„æ“ä½œ.\npublic interface AbstractExpression { void interpret( Context context ); } å†çœ‹çœ‹åŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯\npublic interface Context { } AbstractExpressionçš„å…·ä½“å®ç°åˆ†ä¸¤ç§:ç»ˆç»“ç¬¦è¡¨è¾¾å¼å’Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼:\npublic class TerminalExpression implements AbstractExpression { public void interpret( Context context ) { } } å¯¹äºæ–‡æ³•ä¸­æ²¡ä¸€æ¡è§„åˆ™,éç»ˆç»“ç¬¦è¡¨è¾¾å¼éƒ½å¿…é¡»çš„:\npublic class NonterminalExpression implements AbstractExpression { private AbstractExpression successor; public void setSuccessor( AbstractExpression successor ) { this.successor = successor; } public AbstractExpression getSuccessor() { return successor; } public void interpret( Context context ) { } } ","permalink":"http://blog.chalme.top/posts/design-patterns/3.9-interpreter/","summary":"Interpreter pattern(è§£é‡Šè€…æ¨¡å¼) å®šä¹‰ å®šä¹‰è¯­è¨€çš„æ–‡æ³• ,å¹¶ä¸”å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¯¥è¯­è¨€ä¸­çš„å¥å­.\nInterpreterä¼¼ä¹ä½¿ç”¨é¢ä¸æ˜¯å¾ˆå¹¿,å®ƒæè¿°äº†ä¸€ä¸ªè¯­è¨€è§£é‡Šå™¨æ˜¯å¦‚ä½•æ„æˆçš„,åœ¨å®é™…åº”ç”¨ä¸­,æˆ‘ä»¬å¯èƒ½å¾ˆå°‘å»æ„é€ ä¸€ä¸ªè¯­è¨€çš„æ–‡æ³•.æˆ‘ä»¬è¿˜æ˜¯æ¥ç®€å•çš„äº†è§£ä¸€ä¸‹: é¦–å…ˆè¦å»ºç«‹ä¸€ä¸ªæ¥å£,ç”¨æ¥æè¿°å…±åŒçš„æ“ä½œ.\npublic interface AbstractExpression { void interpret( Context context ); } å†çœ‹çœ‹åŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯\npublic interface Context { } AbstractExpressionçš„å…·ä½“å®ç°åˆ†ä¸¤ç§:ç»ˆç»“ç¬¦è¡¨è¾¾å¼å’Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼:\npublic class TerminalExpression implements AbstractExpression { public void interpret( Context context ) { } } å¯¹äºæ–‡æ³•ä¸­æ²¡ä¸€æ¡è§„åˆ™,éç»ˆç»“ç¬¦è¡¨è¾¾å¼éƒ½å¿…é¡»çš„:\npublic class NonterminalExpression implements AbstractExpression { private AbstractExpression successor; public void setSuccessor( AbstractExpression successor ) { this.successor = successor; } public AbstractExpression getSuccessor() { return successor; } public void interpret( Context context ) { } } ","title":"3.9 Interpreter"},{"content":"Mediator pattern(ä¸­ä»‹è€…æ¨¡å¼) å®šä¹‰ ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å…³äºå¯¹è±¡äº¤äº’è¡Œä¸º.\nä¸ºä½•ä½¿ç”¨Mediator? å„ä¸ªå¯¹è±¡ä¹‹é—´çš„äº¤äº’æ“ä½œéå¸¸å¤š;æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºæ“ä½œéƒ½ä¾èµ–å½¼æ­¤å¯¹æ–¹,ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸º,åŒæ—¶ä¼šæ¶‰åŠåˆ°ä¿®æ”¹å¾ˆå¤šå…¶ä»–å¯¹è±¡çš„è¡Œä¸º,å¦‚æœä½¿ç”¨Mediatoræ¨¡å¼,å¯ä»¥ä½¿å„ä¸ªå¯¹è±¡é—´çš„è€¦åˆæ¾æ•£,åªéœ€å…³å¿ƒå’Œ Mediatorçš„å…³ç³»,ä½¿å¤šå¯¹å¤šçš„å…³ç³»å˜æˆäº†ä¸€å¯¹å¤šçš„å…³ç³»,å¯ä»¥é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,æé«˜å¯ä¿®æ”¹æ‰©å±•æ€§.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆ æœ‰ä¸€ä¸ªæ¥å£,ç”¨æ¥å®šä¹‰æˆå‘˜å¯¹è±¡ä¹‹é—´çš„äº¤äº’è”ç³»æ–¹å¼:\npublic interface Mediator { } Meiatorå…·ä½“å®ç°,çœŸæ­£å®ç°äº¤äº’æ“ä½œçš„å†…å®¹:\npublic class ConcreteMediator implements Mediator { //å‡è®¾å½“å‰æœ‰ä¸¤ä¸ªæˆå‘˜. private ConcreteColleague1 colleague1 = new ConcreteColleague1(); private ConcreteColleague2 colleague2 = new ConcreteColleague2(); ... } å†çœ‹çœ‹å¦å¤–ä¸€ä¸ªå‚ä¸è€…:æˆå‘˜,å› ä¸ºæ˜¯äº¤äº’è¡Œä¸º,éƒ½éœ€è¦åŒæ–¹æä¾›ä¸€äº›å…±åŒæ¥å£,è¿™ç§è¦æ±‚åœ¨Visitor Observerç­‰æ¨¡å¼ä¸­éƒ½æ˜¯ç›¸åŒçš„.\npublic class Colleague { private Mediator mediator; public Mediator getMediator() { return mediator; } public void setMediator( Mediator mediator ) { this.mediator = mediator; } } public class ConcreteColleague1 { } public class ConcreteColleague2 { } æ¯ä¸ªæˆå‘˜éƒ½å¿…é¡»çŸ¥é“Mediator,å¹¶ä¸”å’Œ Mediatorè”ç³»,è€Œä¸æ˜¯å’Œå…¶ä»–æˆå‘˜è”ç³».\nè‡³æ­¤,Mediatoræ¨¡å¼æ¡†æ¶å®Œæˆ,å¯ä»¥å‘ç°Mediatoræ¨¡å¼è§„å®šä¸æ˜¯å¾ˆå¤š,å¤§ä½“æ¡†æ¶ä¹Ÿæ¯”è¾ƒç®€å•,ä½†å®é™…ä½¿ç”¨èµ·æ¥å°±éå¸¸çµæ´».\nMediatoræ¨¡å¼åœ¨äº‹ä»¶é©±åŠ¨ç±»åº”ç”¨ä¸­æ¯”è¾ƒå¤š,ä¾‹å¦‚ç•Œé¢è®¾è®¡GUI.;èŠå¤©,æ¶ˆæ¯ä¼ é€’ç­‰,åœ¨èŠå¤©åº”ç”¨ä¸­,éœ€è¦æœ‰ä¸€ä¸ªMessageMediator,ä¸“é—¨è´Ÿè´£request/reponseä¹‹é—´ä»»åŠ¡çš„è°ƒèŠ‚. MVCæ˜¯J2EEçš„ä¸€ä¸ªåŸºæœ¬æ¨¡å¼,View Controlleræ˜¯ä¸€ç§Mediator,å®ƒæ˜¯Jspå’ŒæœåŠ¡å™¨ä¸Šåº”ç”¨ç¨‹åºé—´çš„Mediator.\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.8-mediator/","summary":"Mediator pattern(ä¸­ä»‹è€…æ¨¡å¼) å®šä¹‰ ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å…³äºå¯¹è±¡äº¤äº’è¡Œä¸º.\nä¸ºä½•ä½¿ç”¨Mediator? å„ä¸ªå¯¹è±¡ä¹‹é—´çš„äº¤äº’æ“ä½œéå¸¸å¤š;æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºæ“ä½œéƒ½ä¾èµ–å½¼æ­¤å¯¹æ–¹,ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸º,åŒæ—¶ä¼šæ¶‰åŠåˆ°ä¿®æ”¹å¾ˆå¤šå…¶ä»–å¯¹è±¡çš„è¡Œä¸º,å¦‚æœä½¿ç”¨Mediatoræ¨¡å¼,å¯ä»¥ä½¿å„ä¸ªå¯¹è±¡é—´çš„è€¦åˆæ¾æ•£,åªéœ€å…³å¿ƒå’Œ Mediatorçš„å…³ç³»,ä½¿å¤šå¯¹å¤šçš„å…³ç³»å˜æˆäº†ä¸€å¯¹å¤šçš„å…³ç³»,å¯ä»¥é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,æé«˜å¯ä¿®æ”¹æ‰©å±•æ€§.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆ æœ‰ä¸€ä¸ªæ¥å£,ç”¨æ¥å®šä¹‰æˆå‘˜å¯¹è±¡ä¹‹é—´çš„äº¤äº’è”ç³»æ–¹å¼:\npublic interface Mediator { } Meiatorå…·ä½“å®ç°,çœŸæ­£å®ç°äº¤äº’æ“ä½œçš„å†…å®¹:\npublic class ConcreteMediator implements Mediator { //å‡è®¾å½“å‰æœ‰ä¸¤ä¸ªæˆå‘˜. private ConcreteColleague1 colleague1 = new ConcreteColleague1(); private ConcreteColleague2 colleague2 = new ConcreteColleague2(); ... } å†çœ‹çœ‹å¦å¤–ä¸€ä¸ªå‚ä¸è€…:æˆå‘˜,å› ä¸ºæ˜¯äº¤äº’è¡Œä¸º,éƒ½éœ€è¦åŒæ–¹æä¾›ä¸€äº›å…±åŒæ¥å£,è¿™ç§è¦æ±‚åœ¨Visitor Observerç­‰æ¨¡å¼ä¸­éƒ½æ˜¯ç›¸åŒçš„.\npublic class Colleague { private Mediator mediator; public Mediator getMediator() { return mediator; } public void setMediator( Mediator mediator ) { this.mediator = mediator; } } public class ConcreteColleague1 { } public class ConcreteColleague2 { } æ¯ä¸ªæˆå‘˜éƒ½å¿…é¡»çŸ¥é“Mediator,å¹¶ä¸”å’Œ Mediatorè”ç³»,è€Œä¸æ˜¯å’Œå…¶ä»–æˆå‘˜è”ç³».","title":"3.8 Mediator"},{"content":"Strategy pattern(ç­–ç•¥æ¨¡å¼) å®šä¹‰ å±äºè®¾è®¡æ¨¡å¼ä¸­ å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼,ä¸»è¦æ˜¯å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠè¿™äº›ç®—æ³•ä¸€ä¸ªä¸ªå°è£…æˆå•ç‹¬çš„ç±».\nStratrgyåº”ç”¨æ¯”è¾ƒå¹¿æ³›,æ¯”å¦‚, å…¬å¸ç»è¥ä¸šåŠ¡å˜åŒ–å›¾, å¯èƒ½æœ‰ä¸¤ç§å®ç°æ–¹å¼,ä¸€ä¸ªæ˜¯çº¿æ¡æ›²çº¿,ä¸€ä¸ªæ˜¯æ¡†å›¾(bar),è¿™æ˜¯ä¸¤ç§ç®—æ³•,å¯ä»¥ä½¿ç”¨Strategyå®ç°. å¦‚ä½•ä½¿ç”¨? è¿™é‡Œä»¥å­—ç¬¦ä¸²æ›¿ä»£ä¸ºä¾‹, æœ‰ä¸€ä¸ªæ–‡ä»¶,æˆ‘ä»¬éœ€è¦è¯»å–å,å¸Œæœ›æ›¿ä»£å…¶ä¸­ç›¸åº”çš„å˜é‡,ç„¶åè¾“å‡º.å…³äºæ›¿ä»£å…¶ä¸­å˜é‡çš„æ–¹æ³•å¯èƒ½æœ‰å¤šç§æ–¹æ³•,è¿™å–å†³äºç”¨æˆ·çš„è¦æ±‚,æ‰€ä»¥æˆ‘ä»¬è¦å‡†å¤‡å‡ å¥—å˜é‡å­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ. é¦–å…ˆ,æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæŠ½è±¡ç±»RepTempRule å®šä¹‰ä¸€äº›å…¬ç”¨å˜é‡å’Œæ–¹æ³•:\npublic abstract class RepTempRule{ protected String oldString=\u0026#34;\u0026#34;; public void setOldString(String oldString){ this.oldString=oldString; } protected String newString=\u0026#34;\u0026#34;; public String getNewString(){ return newString; } public abstract void replace() throws Exception; } åœ¨RepTempRuleä¸­ æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•abstractéœ€è¦ç»§æ‰¿æ˜ç¡®,è¿™ä¸ªreplaceé‡Œå…¶å®æ˜¯æ›¿ä»£çš„å…·ä½“æ–¹æ³•. æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªå­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ, 1.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆbbb; 2.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆccc;\nå¯¹åº”çš„ç±»åˆ†åˆ«æ˜¯RepTempRuleOne RepTempRuleTwo\npublic class RepTempRuleOne extends RepTempRule{ public void replace() throws Exception{ //replaceFirstæ˜¯jdk1.4æ–°ç‰¹æ€§ newString=oldString.replaceFirst(\u0026#34;aaa\u0026#34;, \u0026#34;bbbb\u0026#34;) System.out.println(\u0026#34;this is replace one\u0026#34;); } } public class RepTempRuleTwo extends RepTempRule{ public void replace() throws Exception{ newString=oldString.replaceFirst(\u0026#34;aaa\u0026#34;, \u0026#34;ccc\u0026#34;) System.out.println(\u0026#34;this is replace Two\u0026#34;);ã€€} } ç¬¬äºŒæ­¥ï¼šæˆ‘ä»¬è¦å»ºç«‹ä¸€ä¸ªç®—æ³•è§£å†³ç±»ï¼Œç”¨æ¥æä¾›å®¢æˆ·ç«¯å¯ä»¥è‡ªç”±é€‰æ‹©ç®—æ³•ã€‚\npublic class RepTempRuleSolve { private RepTempRule strategy; public RepTempRuleSolve(RepTempRule rule){ this.strategy=rule; } public String getNewContext(Site site,String oldString) { return strategy.replace(site,oldString); } public void changeAlgorithm(RepTempRule newAlgorithm) { strategy = newAlgorithm; } } è°ƒç”¨å¦‚ä¸‹:\npublic class test{ ...... public void testReplace(){ //ä½¿ç”¨ç¬¬ä¸€å¥—æ›¿ä»£æ–¹æ¡ˆ RepTempRuleSolve solver=new RepTempRuleSolve(new RepTempRuleOne()); solver.getNewContext(site,context); //ä½¿ç”¨ç¬¬äºŒå¥— solver=new RepTempRuleSolve(new RepTempRuleTwo()); solver.getNewContext(site,context); } ..... } æˆ‘ä»¬è¾¾åˆ°äº†åœ¨è¿è¡ŒæœŸé—´ï¼Œå¯ä»¥è‡ªç”±åˆ‡æ¢ç®—æ³•çš„ç›®çš„ã€‚\nå®é™…æ•´ä¸ªStrategyçš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯æŠ½è±¡ç±»çš„ä½¿ç”¨,ä½¿ç”¨Strategyæ¨¡å¼å¯ä»¥åœ¨ç”¨æˆ·éœ€è¦å˜åŒ–æ—¶,ä¿®æ”¹é‡å¾ˆå°‘,è€Œä¸”å¿«é€Ÿ.\nStrategyå’ŒFactoryæœ‰ä¸€å®šçš„ç±»ä¼¼,Strategyç›¸å¯¹ç®€å•å®¹æ˜“ç†è§£,å¹¶ä¸”å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ»è‡ªç”±åˆ‡æ¢ã€‚Factoryé‡ç‚¹æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡ã€‚\nStrategyé€‚åˆä¸‹åˆ—åœºåˆ: ä»¥ä¸åŒçš„æ ¼å¼ä¿å­˜æ–‡ä»¶;\nä»¥ä¸åŒçš„ç®—æ³•å‹ç¼©æ–‡ä»¶;\nä»¥ä¸åŒçš„ç®—æ³•æˆªè·å›¾è±¡;\nä»¥ä¸åŒçš„æ ¼å¼è¾“å‡ºåŒæ ·æ•°æ®çš„å›¾å½¢,æ¯”å¦‚æ›²çº¿ æˆ–æ¡†å›¾barç­‰\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.7-strategy/","summary":"Strategy pattern(ç­–ç•¥æ¨¡å¼) å®šä¹‰ å±äºè®¾è®¡æ¨¡å¼ä¸­ å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼,ä¸»è¦æ˜¯å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠè¿™äº›ç®—æ³•ä¸€ä¸ªä¸ªå°è£…æˆå•ç‹¬çš„ç±».\nStratrgyåº”ç”¨æ¯”è¾ƒå¹¿æ³›,æ¯”å¦‚, å…¬å¸ç»è¥ä¸šåŠ¡å˜åŒ–å›¾, å¯èƒ½æœ‰ä¸¤ç§å®ç°æ–¹å¼,ä¸€ä¸ªæ˜¯çº¿æ¡æ›²çº¿,ä¸€ä¸ªæ˜¯æ¡†å›¾(bar),è¿™æ˜¯ä¸¤ç§ç®—æ³•,å¯ä»¥ä½¿ç”¨Strategyå®ç°. å¦‚ä½•ä½¿ç”¨? è¿™é‡Œä»¥å­—ç¬¦ä¸²æ›¿ä»£ä¸ºä¾‹, æœ‰ä¸€ä¸ªæ–‡ä»¶,æˆ‘ä»¬éœ€è¦è¯»å–å,å¸Œæœ›æ›¿ä»£å…¶ä¸­ç›¸åº”çš„å˜é‡,ç„¶åè¾“å‡º.å…³äºæ›¿ä»£å…¶ä¸­å˜é‡çš„æ–¹æ³•å¯èƒ½æœ‰å¤šç§æ–¹æ³•,è¿™å–å†³äºç”¨æˆ·çš„è¦æ±‚,æ‰€ä»¥æˆ‘ä»¬è¦å‡†å¤‡å‡ å¥—å˜é‡å­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ. é¦–å…ˆ,æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæŠ½è±¡ç±»RepTempRule å®šä¹‰ä¸€äº›å…¬ç”¨å˜é‡å’Œæ–¹æ³•:\npublic abstract class RepTempRule{ protected String oldString=\u0026#34;\u0026#34;; public void setOldString(String oldString){ this.oldString=oldString; } protected String newString=\u0026#34;\u0026#34;; public String getNewString(){ return newString; } public abstract void replace() throws Exception; } åœ¨RepTempRuleä¸­ æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•abstractéœ€è¦ç»§æ‰¿æ˜ç¡®,è¿™ä¸ªreplaceé‡Œå…¶å®æ˜¯æ›¿ä»£çš„å…·ä½“æ–¹æ³•. æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªå­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ, 1.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆbbb; 2.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆccc;\nå¯¹åº”çš„ç±»åˆ†åˆ«æ˜¯RepTempRuleOne RepTempRuleTwo\npublic class RepTempRuleOne extends RepTempRule{ public void replace() throws Exception{ //replaceFirstæ˜¯jdk1.4æ–°ç‰¹æ€§ newString=oldString.replaceFirst(\u0026#34;aaa\u0026#34;, \u0026#34;bbbb\u0026#34;) System.out.println(\u0026#34;this is replace one\u0026#34;); } } public class RepTempRuleTwo extends RepTempRule{ public void replace() throws Exception{ newString=oldString.","title":"3.7 Strategy"},{"content":"State(çŠ¶æ€æ¨¡å¼)çš„å®šä¹‰ ä¸åŒçš„çŠ¶æ€,ä¸åŒçš„è¡Œä¸º;æˆ–è€…è¯´,æ¯ä¸ªçŠ¶æ€æœ‰ç€ç›¸åº”çš„è¡Œä¸º.\nä½•æ—¶ä½¿ç”¨? Stateæ¨¡å¼åœ¨å®é™…ä½¿ç”¨ä¸­æ¯”è¾ƒå¤š,é€‚åˆ\u0026quot;çŠ¶æ€çš„åˆ‡æ¢\u0026quot;.å› ä¸ºæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨If elseif else è¿›è¡ŒçŠ¶æ€åˆ‡æ¢, å¦‚æœé’ˆå¯¹çŠ¶æ€çš„è¿™æ ·åˆ¤æ–­åˆ‡æ¢åå¤å‡ºç°,æˆ‘ä»¬å°±è¦è”æƒ³åˆ°æ˜¯å¦å¯ä»¥é‡‡å–Stateæ¨¡å¼äº†.\nä¸åªæ˜¯æ ¹æ®çŠ¶æ€,ä¹Ÿæœ‰æ ¹æ®å±æ€§.å¦‚æœæŸä¸ªå¯¹è±¡çš„å±æ€§ä¸åŒ,å¯¹è±¡çš„è¡Œä¸ºå°±ä¸ä¸€æ ·,è¿™ç‚¹åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­å‡ºç°é¢‘ç‡æ¯”è¾ƒé«˜,æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ä¸€ä¸ªæ•°æ®è¡¨çš„å°¾éƒ¨,åŠ ä¸Špropertyå±æ€§å«ä¹‰çš„å­—æ®µ,ç”¨ä»¥æ ‡è¯†è®°å½•ä¸­ä¸€äº›ç‰¹æ®Šæ€§è´¨çš„è®°å½•,è¿™ç§å±æ€§çš„æ”¹å˜(åˆ‡æ¢)åˆæ˜¯éšæ—¶å¯èƒ½å‘ç”Ÿçš„,å°±æœ‰å¯èƒ½è¦ä½¿ç”¨State.\næ˜¯å¦ä½¿ç”¨? åœ¨å®é™…ä½¿ç”¨,ç±»ä¼¼å¼€å…³ä¸€æ ·çš„çŠ¶æ€åˆ‡æ¢æ˜¯å¾ˆå¤šçš„,ä½†æœ‰æ—¶å¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾,å–å†³äºä½ çš„ç»éªŒå’Œå¯¹ç³»ç»Ÿçš„ç†è§£æ·±åº¦.\nè¿™é‡Œè¦é˜è¿°çš„æ˜¯\u0026quot;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026quot; å’Œ\u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„, \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;ä¹Ÿæ˜¯æœ‰ if..elseifç»“æ„,ä¾‹å¦‚:\nif (which==1) state=\u0026ldquo;hello\u0026rdquo;; else if (which==2) state=\u0026ldquo;hi\u0026rdquo;; else if (which==3) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™æ˜¯ä¸€ä¸ª \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;,stateå€¼çš„ä¸åŒæ˜¯æ ¹æ®whichå˜é‡æ¥å†³å®šçš„,whichå’Œstateæ²¡æœ‰å…³ç³».å¦‚æœæ”¹æˆ:\nif (state.euqals(\u0026ldquo;bye\u0026rdquo;)) state=\u0026ldquo;hello\u0026rdquo;; else if (state.euqals(\u0026ldquo;hello\u0026rdquo;)) state=\u0026ldquo;hi\u0026rdquo;; else if (state.euqals(\u0026ldquo;hi\u0026rdquo;)) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™å°±æ˜¯ \u0026ldquo;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026rdquo;,æ˜¯å°†stateçš„çŠ¶æ€ä»\u0026quot;hello\u0026quot;åˆ‡æ¢åˆ°\u0026quot;hi\u0026quot;,å†åˆ‡æ¢åˆ°\u0026quot;\u0026ldquo;bye\u0026rdquo;;åœ¨åˆ‡æ¢åˆ°\u0026quot;hello\u0026quot;,å¥½è±¡ä¸€ä¸ªæ—‹è½¬å¼€å…³,è¿™ç§çŠ¶æ€æ”¹å˜å°±å¯ä»¥ä½¿ç”¨Stateæ¨¡å¼äº†.\nå¦‚æœå•çº¯æœ‰ä¸Šé¢ä¸€ç§å°†\u0026quot;hello\u0026quot;\u0026ndash;\u0026gt;\u0026ldquo;hi\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;bye\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;hello\u0026quot;è¿™ä¸€ä¸ªæ–¹å‘åˆ‡æ¢,ä¹Ÿä¸ä¸€å®šéœ€è¦ä½¿ç”¨Stateæ¨¡å¼,å› ä¸ºStateæ¨¡å¼ä¼šå»ºç«‹å¾ˆå¤šå­ç±»,å¤æ‚åŒ–,ä½†æ˜¯å¦‚æœåˆå‘ç”Ÿå¦å¤–ä¸€ä¸ªè¡Œä¸º:å°†ä¸Šé¢çš„åˆ‡æ¢æ–¹å‘åè¿‡æ¥åˆ‡æ¢,æˆ–è€…éœ€è¦ä»»æ„åˆ‡æ¢,å°±éœ€è¦Stateäº†.\nè¯·çœ‹ä¸‹ä¾‹:\npublic class Context{ private Color state=null; public void push(){ //å¦‚æœå½“å‰redçŠ¶æ€ å°±åˆ‡æ¢åˆ°blue if (state==Color.red) state=Color.blue; //å¦‚æœå½“å‰blueçŠ¶æ€ å°±åˆ‡æ¢åˆ°green else if (state==Color.blue) state=Color.green; //å¦‚æœå½“å‰blackçŠ¶æ€ å°±åˆ‡æ¢åˆ°red else if (state==Color.black) state=Color.red; //å¦‚æœå½“å‰greençŠ¶æ€ å°±åˆ‡æ¢åˆ°black else if (state==Color.green) state=Color.black; Sample sample=new Sample(state); sample.operate(); } public void pull(){ //ä¸pushçŠ¶æ€åˆ‡æ¢æ­£å¥½ç›¸å if (state==Color.green) state=Color.blue; else if (state==Color.black) state=Color.green; else if (state==Color.blue) state=Color.red; else if (state==Color.red) state=Color.black; Sample2 sample2=new Sample2(state); sample2.operate(); } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬æœ‰ä¸¤ä¸ªåŠ¨ä½œpushæ¨å’Œpullæ‹‰,è¿™ä¸¤ä¸ªå¼€å…³åŠ¨ä½œ,æ”¹å˜äº†Contexté¢œè‰²,è‡³æ­¤,æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨Stateæ¨¡å¼ä¼˜åŒ–å®ƒ.\nå¦å¤–æ³¨æ„:ä½†å°±ä¸Šä¾‹,stateçš„å˜åŒ–,åªæ˜¯ç®€å•çš„é¢œè‰²èµ‹å€¼,è¿™ä¸ªå…·ä½“è¡Œä¸ºæ˜¯å¾ˆç®€å•çš„,Stateé€‚åˆå·¨å¤§çš„å…·ä½“è¡Œä¸º,å› æ­¤åœ¨,å°±æœ¬ä¾‹,å®é™…ä½¿ç”¨ä¸­ä¹Ÿä¸ä¸€å®šéè¦ä½¿ç”¨Stateæ¨¡å¼,è¿™ä¼šå¢åŠ å­ç±»çš„æ•°ç›®,ç®€å•çš„å˜å¤æ‚.\nä¾‹å¦‚: é“¶è¡Œå¸æˆ·, ç»å¸¸ä¼šåœ¨Open çŠ¶æ€å’ŒCloseçŠ¶æ€é—´è½¬æ¢.\nä¾‹å¦‚: ç»å…¸çš„TcpConnection, Tcpçš„çŠ¶æ€æœ‰åˆ›å»º ä¾¦å¬ å…³é—­ä¸‰ä¸ª,å¹¶ä¸”åå¤è½¬æ¢,å…¶åˆ›å»º ä¾¦å¬ å…³é—­çš„å…·ä½“è¡Œä¸ºä¸æ˜¯ç®€å•ä¸€ä¸¤å¥å°±èƒ½å®Œæˆçš„,é€‚åˆä½¿ç”¨State\nä¾‹å¦‚:ä¿¡ç®±POPå¸å·, ä¼šæœ‰å››ç§çŠ¶æ€, start HaveUsername Authorized quit,æ¯ä¸ªçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºåº”è¯¥æ˜¯æ¯”è¾ƒå¤§çš„.é€‚åˆä½¿ç”¨State\nä¾‹å¦‚:åœ¨å·¥å…·ç®±æŒ‘é€‰ä¸åŒå·¥å…·,å¯ä»¥çœ‹æˆåœ¨ä¸åŒå·¥å…·ä¸­åˆ‡æ¢,é€‚åˆä½¿ç”¨State.å¦‚ å…·ä½“ç»˜å›¾ç¨‹åº,ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸åŒå·¥å…·ç»˜åˆ¶æ–¹æ¡† ç›´çº¿ æ›²çº¿,è¿™ç§çŠ¶æ€åˆ‡æ¢å¯ä»¥ä½¿ç”¨State.\nå¦‚ä½•ä½¿ç”¨ Stateéœ€è¦ä¸¤ç§ç±»å‹å®ä½“å‚ä¸:\nstate manager çŠ¶æ€ç®¡ç†å™¨ ,å°±æ˜¯å¼€å…³ ,å¦‚ä¸Šé¢ä¾‹å­çš„Contextå®é™…å°±æ˜¯ä¸€ä¸ªstate manager, åœ¨state managerä¸­æœ‰å¯¹çŠ¶æ€çš„åˆ‡æ¢åŠ¨ä½œ. ç”¨æŠ½è±¡ç±»æˆ–æ¥å£å®ç°çš„çˆ¶ç±»,,ä¸åŒçŠ¶æ€å°±æ˜¯ç»§æ‰¿è¿™ä¸ªçˆ¶ç±»çš„ä¸åŒå­ç±». ä»¥ä¸Šé¢çš„Contextä¸ºä¾‹.æˆ‘ä»¬è¦ä¿®æ”¹å®ƒ,å»ºç«‹ä¸¤ä¸ªç±»å‹çš„å®ä½“.\nç¬¬ä¸€æ­¥: é¦–å…ˆå»ºç«‹ä¸€ä¸ªçˆ¶ç±»: public abstract class State{ public abstract void handlepush(Context c); public abstract void handlepull(Context c); public abstract void getcolor(); } çˆ¶ç±»ä¸­çš„æ–¹æ³•è¦å¯¹åº”state managerä¸­çš„å¼€å…³è¡Œä¸º,åœ¨state managerä¸­ æœ¬ä¾‹å°±æ˜¯Contextä¸­,æœ‰ä¸¤ä¸ªå¼€å…³åŠ¨ä½œpushæ¨å’Œpullæ‹‰.é‚£ä¹ˆåœ¨çŠ¶æ€çˆ¶ç±»ä¸­å°±è¦æœ‰å…·ä½“å¤„ç†è¿™ä¸¤ä¸ªåŠ¨ä½œ:handlepush() handlepull(); åŒæ—¶è¿˜éœ€è¦ä¸€ä¸ªè·å–pushæˆ–pullç»“æœçš„æ–¹æ³•getcolor()\nä¸‹é¢æ˜¯å…·ä½“å­ç±»çš„å®ç°:\npublic class BlueState extends State{ public void handlepush(Context c){ //æ ¹æ®pushæ–¹æ³•\u0026#34;å¦‚æœæ˜¯blueçŠ¶æ€çš„åˆ‡æ¢åˆ°green\u0026#34; ; c.setState(new GreenState()); } public void handlepull(Context c){ //æ ¹æ®pullæ–¹æ³•\u0026#34;å¦‚æœæ˜¯blueçŠ¶æ€çš„åˆ‡æ¢åˆ°red\u0026#34; ; c.setState(new RedState()); } public abstract void getcolor(){ return (Color.blue)} } åŒæ · å…¶ä»–çŠ¶æ€çš„å­ç±»å®ç°å¦‚blueä¸€æ ·.\nç¬¬äºŒæ­¥: è¦é‡æ–°æ”¹å†™State manager ä¹Ÿå°±æ˜¯æœ¬ä¾‹çš„Context: public class Context{ private Sate state=null; //æˆ‘ä»¬å°†åŸæ¥çš„ Color state æ”¹æˆäº†æ–°å»ºçš„State state; //setStateæ˜¯ç”¨æ¥æ”¹å˜stateçš„çŠ¶æ€ ä½¿ç”¨setStateå®ç°çŠ¶æ€çš„åˆ‡æ¢ pulic void setState(State state){ this.state=state; } public void push(){ //çŠ¶æ€çš„åˆ‡æ¢çš„ç»†èŠ‚éƒ¨åˆ†,åœ¨æœ¬ä¾‹ä¸­æ˜¯é¢œè‰²çš„å˜åŒ–,å·²ç»å°è£…åœ¨å­ç±»çš„handlepushä¸­å®ç°,è¿™é‡Œæ— éœ€å…³å¿ƒ state.handlepush(this); //å› ä¸ºsampleè¦ä½¿ç”¨stateä¸­çš„ä¸€ä¸ªåˆ‡æ¢ç»“æœ,ä½¿ç”¨getColor() Sample sample=new Sample(state.getColor()); sample.operate(); } public void pull(){ state.handlepull(this); Sample2 sample2=new Sample2(state.getColor()); sample2.operate(); } } è‡³æ­¤,æˆ‘ä»¬ä¹Ÿå°±å®ç°äº†Stateçš„refactoryingè¿‡ç¨‹.\nä»¥ä¸Šåªæ˜¯ç›¸å½“ç®€å•çš„ä¸€ä¸ªå®ä¾‹,åœ¨å®é™…åº”ç”¨ä¸­,handlepushæˆ–handelpullçš„å¤„ç†æ˜¯å¤æ‚çš„.\nçŠ¶æ€æ¨¡å¼ä¼˜ç‚¹ï¼š ï¼ˆ1ï¼‰ å°è£…è½¬æ¢è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯è½¬æ¢è§„åˆ™ ï¼ˆ2ï¼‰ æšä¸¾å¯èƒ½çš„çŠ¶æ€ï¼Œå› æ­¤ï¼Œéœ€è¦äº‹å…ˆç¡®å®šçŠ¶æ€ç§ç±»ã€‚\nçŠ¶æ€æ¨¡å¼å¯ä»¥å…è®¸å®¢æˆ·ç«¯æ”¹å˜çŠ¶æ€çš„è½¬æ¢è¡Œä¸ºï¼Œè€ŒçŠ¶æ€æœºåˆ™æ˜¯èƒ½å¤Ÿè‡ªåŠ¨æ”¹å˜çŠ¶æ€ï¼ŒçŠ¶æ€æœºæ˜¯ä¸€ä¸ªæ¯”è¾ƒç‹¬ç«‹çš„è€Œä¸”å¤æ‚çš„æœºåˆ¶ï¼Œå…·ä½“å¯å‚è€ƒä¸€ä¸ªçŠ¶æ€æœºå¼€æºé¡¹ç›®ï¼šhttp://sourceforge.net/projects/smframework/\nçŠ¶æ€æ¨¡å¼åœ¨å·¥ä½œæµæˆ–æ¸¸æˆç­‰å„ç§ç³»ç»Ÿä¸­æœ‰å¤§é‡ä½¿ç”¨ï¼Œç”šè‡³æ˜¯è¿™äº›ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½è®¾è®¡ï¼Œä¾‹å¦‚æ”¿åºœOAä¸­ï¼Œä¸€ä¸ªæ‰¹æ–‡çš„çŠ¶æ€æœ‰å¤šç§ï¼šæœªåŠï¼›æ­£åœ¨åŠç†ï¼›æ­£åœ¨æ‰¹ç¤ºï¼›æ­£åœ¨å®¡æ ¸ï¼›å·²ç»å®Œæˆç­‰å„ç§çŠ¶æ€ï¼Œä½¿ç”¨çŠ¶æ€æœºå¯ä»¥å°è£…è¿™ä¸ªçŠ¶æ€çš„å˜åŒ–è§„åˆ™ï¼Œä»è€Œè¾¾åˆ°æ‰©å……çŠ¶æ€æ—¶ï¼Œä¸å¿…æ¶‰åŠåˆ°çŠ¶æ€çš„ä½¿ç”¨è€…ã€‚\nåœ¨ç½‘ç»œæ¸¸æˆä¸­ï¼Œä¸€ä¸ªæ¸¸æˆæ´»åŠ¨å­˜åœ¨å¼€å§‹ï¼›å¼€ç©ï¼›æ­£åœ¨ç©ï¼›è¾“èµ¢ç­‰å„ç§çŠ¶æ€ï¼Œä½¿ç”¨çŠ¶æ€æ¨¡å¼å°±å¯ä»¥å®ç°æ¸¸æˆçŠ¶æ€çš„æ€»æ§ï¼Œè€Œæ¸¸æˆçŠ¶æ€å†³å®šäº†æ¸¸æˆçš„å„ä¸ªæ–¹é¢ï¼Œä½¿ç”¨çŠ¶æ€æ¨¡å¼å¯ä»¥å¯¹æ•´ä¸ªæ¸¸æˆæ¶æ„åŠŸèƒ½å®ç°èµ·åˆ°å†³å®šçš„ä¸»å¯¼ä½œç”¨ã€‚\nçŠ¶æ€æ¨¡å¼å®è´¨ ä½¿ç”¨çŠ¶æ€æ¨¡å¼å‰ï¼Œå®¢æˆ·ç«¯å¤–ç•Œéœ€è¦ä»‹å…¥æ”¹å˜çŠ¶æ€ï¼Œè€ŒçŠ¶æ€æ”¹å˜çš„å®ç°æ˜¯çç¢æˆ–å¤æ‚çš„ã€‚\nä½¿ç”¨çŠ¶æ€æ¨¡å¼åï¼Œå®¢æˆ·ç«¯å¤–ç•Œå¯ä»¥ç›´æ¥ä½¿ç”¨äº‹ä»¶Eventå®ç°ï¼Œæ ¹æœ¬ä¸å¿…å…³å¿ƒè¯¥äº‹ä»¶å¯¼è‡´å¦‚ä½•çŠ¶æ€å˜åŒ–ï¼Œè¿™äº›æ˜¯ç”±çŠ¶æ€æœºç­‰å†…éƒ¨å®ç°ã€‚\nè¿™æ˜¯ä¸€ç§Event-condition-Stateï¼ŒçŠ¶æ€æ¨¡å¼å°è£…äº†condition-Stateéƒ¨åˆ†ã€‚\næ¯ä¸ªçŠ¶æ€å½¢æˆä¸€ä¸ªå­ç±»ï¼Œæ¯ä¸ªçŠ¶æ€åªå…³å¿ƒå®ƒçš„ä¸‹ä¸€ä¸ªå¯èƒ½çŠ¶æ€ï¼Œä»è€Œæ— å½¢ä¸­å½¢æˆäº†çŠ¶æ€è½¬æ¢çš„è§„åˆ™ã€‚å¦‚æœæ–°çš„çŠ¶æ€åŠ å…¥ï¼Œåªæ¶‰åŠå®ƒçš„å‰ä¸€ä¸ªçŠ¶æ€ä¿®æ”¹å’Œå®šä¹‰ã€‚\nçŠ¶æ€è½¬æ¢æœ‰å‡ ä¸ªæ–¹æ³•å®ç°ï¼šä¸€ä¸ªåœ¨æ¯ä¸ªçŠ¶æ€å®ç°next()ï¼ŒæŒ‡å®šä¸‹ä¸€ä¸ªçŠ¶æ€ï¼›è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œè®¾å®šä¸€ä¸ªStateOwnerï¼Œåœ¨StateOwnerè®¾å®šstateEnterçŠ¶æ€è¿›å…¥å’ŒstateExitçŠ¶æ€é€€å‡ºè¡Œä¸ºã€‚\nçŠ¶æ€ä»ä¸€ä¸ªæ–¹é¢è¯´æ˜äº†æµç¨‹ï¼Œæµç¨‹æ˜¯éšæ—¶é—´è€Œæ”¹å˜ï¼ŒçŠ¶æ€æ˜¯æˆªå–æµç¨‹æŸä¸ªæ—¶é—´ç‰‡ã€‚\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.6-state/","summary":"State(çŠ¶æ€æ¨¡å¼)çš„å®šä¹‰ ä¸åŒçš„çŠ¶æ€,ä¸åŒçš„è¡Œä¸º;æˆ–è€…è¯´,æ¯ä¸ªçŠ¶æ€æœ‰ç€ç›¸åº”çš„è¡Œä¸º.\nä½•æ—¶ä½¿ç”¨? Stateæ¨¡å¼åœ¨å®é™…ä½¿ç”¨ä¸­æ¯”è¾ƒå¤š,é€‚åˆ\u0026quot;çŠ¶æ€çš„åˆ‡æ¢\u0026quot;.å› ä¸ºæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨If elseif else è¿›è¡ŒçŠ¶æ€åˆ‡æ¢, å¦‚æœé’ˆå¯¹çŠ¶æ€çš„è¿™æ ·åˆ¤æ–­åˆ‡æ¢åå¤å‡ºç°,æˆ‘ä»¬å°±è¦è”æƒ³åˆ°æ˜¯å¦å¯ä»¥é‡‡å–Stateæ¨¡å¼äº†.\nä¸åªæ˜¯æ ¹æ®çŠ¶æ€,ä¹Ÿæœ‰æ ¹æ®å±æ€§.å¦‚æœæŸä¸ªå¯¹è±¡çš„å±æ€§ä¸åŒ,å¯¹è±¡çš„è¡Œä¸ºå°±ä¸ä¸€æ ·,è¿™ç‚¹åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­å‡ºç°é¢‘ç‡æ¯”è¾ƒé«˜,æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ä¸€ä¸ªæ•°æ®è¡¨çš„å°¾éƒ¨,åŠ ä¸Špropertyå±æ€§å«ä¹‰çš„å­—æ®µ,ç”¨ä»¥æ ‡è¯†è®°å½•ä¸­ä¸€äº›ç‰¹æ®Šæ€§è´¨çš„è®°å½•,è¿™ç§å±æ€§çš„æ”¹å˜(åˆ‡æ¢)åˆæ˜¯éšæ—¶å¯èƒ½å‘ç”Ÿçš„,å°±æœ‰å¯èƒ½è¦ä½¿ç”¨State.\næ˜¯å¦ä½¿ç”¨? åœ¨å®é™…ä½¿ç”¨,ç±»ä¼¼å¼€å…³ä¸€æ ·çš„çŠ¶æ€åˆ‡æ¢æ˜¯å¾ˆå¤šçš„,ä½†æœ‰æ—¶å¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾,å–å†³äºä½ çš„ç»éªŒå’Œå¯¹ç³»ç»Ÿçš„ç†è§£æ·±åº¦.\nè¿™é‡Œè¦é˜è¿°çš„æ˜¯\u0026quot;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026quot; å’Œ\u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„, \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;ä¹Ÿæ˜¯æœ‰ if..elseifç»“æ„,ä¾‹å¦‚:\nif (which==1) state=\u0026ldquo;hello\u0026rdquo;; else if (which==2) state=\u0026ldquo;hi\u0026rdquo;; else if (which==3) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™æ˜¯ä¸€ä¸ª \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;,stateå€¼çš„ä¸åŒæ˜¯æ ¹æ®whichå˜é‡æ¥å†³å®šçš„,whichå’Œstateæ²¡æœ‰å…³ç³».å¦‚æœæ”¹æˆ:\nif (state.euqals(\u0026ldquo;bye\u0026rdquo;)) state=\u0026ldquo;hello\u0026rdquo;; else if (state.euqals(\u0026ldquo;hello\u0026rdquo;)) state=\u0026ldquo;hi\u0026rdquo;; else if (state.euqals(\u0026ldquo;hi\u0026rdquo;)) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™å°±æ˜¯ \u0026ldquo;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026rdquo;,æ˜¯å°†stateçš„çŠ¶æ€ä»\u0026quot;hello\u0026quot;åˆ‡æ¢åˆ°\u0026quot;hi\u0026quot;,å†åˆ‡æ¢åˆ°\u0026quot;\u0026ldquo;bye\u0026rdquo;;åœ¨åˆ‡æ¢åˆ°\u0026quot;hello\u0026quot;,å¥½è±¡ä¸€ä¸ªæ—‹è½¬å¼€å…³,è¿™ç§çŠ¶æ€æ”¹å˜å°±å¯ä»¥ä½¿ç”¨Stateæ¨¡å¼äº†.\nå¦‚æœå•çº¯æœ‰ä¸Šé¢ä¸€ç§å°†\u0026quot;hello\u0026quot;\u0026ndash;\u0026gt;\u0026ldquo;hi\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;bye\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;hello\u0026quot;è¿™ä¸€ä¸ªæ–¹å‘åˆ‡æ¢,ä¹Ÿä¸ä¸€å®šéœ€è¦ä½¿ç”¨Stateæ¨¡å¼,å› ä¸ºStateæ¨¡å¼ä¼šå»ºç«‹å¾ˆå¤šå­ç±»,å¤æ‚åŒ–,ä½†æ˜¯å¦‚æœåˆå‘ç”Ÿå¦å¤–ä¸€ä¸ªè¡Œä¸º:å°†ä¸Šé¢çš„åˆ‡æ¢æ–¹å‘åè¿‡æ¥åˆ‡æ¢,æˆ–è€…éœ€è¦ä»»æ„åˆ‡æ¢,å°±éœ€è¦Stateäº†.\nè¯·çœ‹ä¸‹ä¾‹:\npublic class Context{ private Color state=null; public void push(){ //å¦‚æœå½“å‰redçŠ¶æ€ å°±åˆ‡æ¢åˆ°blue if (state==Color.red) state=Color.blue; //å¦‚æœå½“å‰blueçŠ¶æ€ å°±åˆ‡æ¢åˆ°green else if (state==Color.blue) state=Color.green; //å¦‚æœå½“å‰blackçŠ¶æ€ å°±åˆ‡æ¢åˆ°red else if (state==Color.","title":"3.6 State"},{"content":"Commandæ¨¡å¼æ˜¯æœ€è®©æˆ‘ç–‘æƒ‘çš„ä¸€ä¸ªæ¨¡å¼,æˆ‘åœ¨é˜…è¯»äº†å¾ˆå¤šä»£ç å,æ‰æ„Ÿè§‰éšçº¦æŒæ¡å…¶å¤§æ¦‚åŸç†,æˆ‘è®¤ä¸ºç†è§£è®¾è®¡æ¨¡å¼æœ€ä¸»è¦æ˜¯æŒæ¡èµ·åŸç†æ„é€ ,è¿™æ ·æ‰å¯¹è‡ªå·±å®é™…ç¼–ç¨‹æœ‰æŒ‡å¯¼ä½œç”¨.Commandæ¨¡å¼å®é™…ä¸Šä¸æ˜¯ä¸ªå¾ˆå…·ä½“,è§„å®šå¾ˆå¤šçš„æ¨¡å¼,æ­£æ˜¯è¿™ä¸ªçµæ´»æ€§,è®©äººæœ‰äº›confuse.\nCommandå‘½ä»¤æ¨¡å¼ n å°†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ— éœ€äº†è§£è¿™ä¸ªè¯·æ±‚æ¿€æ´»çš„ åŠ¨ä½œæˆ–æœ‰å…³æ¥å—è¿™ä¸ªè¯·æ±‚çš„å¤„ç†ç»†èŠ‚ã€‚\nè¿™æ˜¯ä¸€ç§ä¸¤å°æœºå™¨ä¹‹é—´é€šè®¯è”ç³»æ€§è´¨çš„æ¨¡å¼ï¼Œç±»ä¼¼ä¼ ç»Ÿè¿‡ç¨‹è¯­ è¨€çš„ CallBackåŠŸèƒ½ã€‚\nå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶åˆ«åä¸ºåŠ¨ä½œ(Action)æ¨¡å¼æˆ–äº‹åŠ¡(Transaction)æ¨¡å¼ã€‚\nä¼˜ç‚¹ è§£è€¦äº†å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´è”ç³»ã€‚ å‘é€è€…è°ƒç”¨ä¸€ä¸ªæ“ä½œï¼Œæ¥å—è€…æ¥å—è¯·æ±‚æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œå› ä¸ºä½¿ç”¨Commandæ¨¡å¼è§£è€¦ï¼Œå‘é€è€…æ— éœ€çŸ¥é“æ¥å—è€…ä»»ä½•æ¥å£ã€‚\nä¸å°‘Commandæ¨¡å¼çš„ä»£ç éƒ½æ˜¯é’ˆå¯¹å›¾å½¢ç•Œé¢çš„,å®ƒå®é™…å°±æ˜¯èœå•å‘½ä»¤,æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸‹æ‹‰èœå•é€‰æ‹©ä¸€ä¸ªå‘½ä»¤æ—¶,ç„¶åä¼šæ‰§è¡Œä¸€äº›åŠ¨ä½œ.\nå°†è¿™äº›å‘½ä»¤å°è£…æˆåœ¨ä¸€ä¸ªç±»ä¸­,ç„¶åç”¨æˆ·(è°ƒç”¨è€…)å†å¯¹è¿™ä¸ªç±»è¿›è¡Œæ“ä½œ,è¿™å°±æ˜¯Commandæ¨¡å¼,æ¢å¥è¯è¯´,æœ¬æ¥ç”¨æˆ·(è°ƒç”¨è€…)æ˜¯ç›´æ¥è°ƒç”¨è¿™äº›å‘½ä»¤çš„,å¦‚èœå•ä¸Šæ‰“å¼€æ–‡æ¡£(è°ƒç”¨è€…),å°±ç›´æ¥æŒ‡å‘æ‰“å¼€æ–‡æ¡£çš„ä»£ç ,ä½¿ç”¨Commandæ¨¡å¼,å°±æ˜¯åœ¨è¿™ä¸¤è€…ä¹‹é—´å¢åŠ ä¸€ä¸ªä¸­é—´è€…,å°†è¿™ç§ç›´æ¥å…³ç³»æ‹—æ–­,åŒæ—¶ä¸¤è€…ä¹‹é—´éƒ½éš”ç¦»,åŸºæœ¬æ²¡æœ‰å…³ç³»äº†.\næ˜¾ç„¶è¿™æ ·åšçš„å¥½å¤„æ˜¯ç¬¦åˆå°è£…çš„ç‰¹æ€§,é™ä½è€¦åˆåº¦,Commandæ˜¯å°†å¯¹è¡Œä¸ºè¿›è¡Œå°è£…çš„å…¸å‹æ¨¡å¼,Factoryæ˜¯å°†åˆ›å»ºè¿›è¡Œå°è£…çš„æ¨¡å¼, ä»Commandæ¨¡å¼,æˆ‘ä¹Ÿå‘ç°è®¾è®¡æ¨¡å¼ä¸€ä¸ª\u0026quot;é€šç—…\u0026quot;:å¥½è±¡å–œæ¬¢å°†ç®€å•çš„é—®é¢˜å¤æ‚åŒ–, å–œæ¬¢åœ¨ä¸åŒç±»ä¸­å¢åŠ ç¬¬ä¸‰è€…,å½“ç„¶è¿™æ ·åšæœ‰åˆ©äºä»£ç çš„å¥å£®æ€§ å¯ç»´æŠ¤æ€§ è¿˜æœ‰å¤ç”¨æ€§.\nå¦‚ä½•ä½¿ç”¨? å…·ä½“çš„Commandæ¨¡å¼ä»£ç å„å¼å„æ ·,å› ä¸ºå¦‚ä½•å°è£…å‘½ä»¤,ä¸åŒç³»ç»Ÿ,æœ‰ä¸åŒçš„åšæ³•.ä¸‹é¢äº‹ä¾‹æ˜¯å°†å‘½ä»¤å°è£…åœ¨ä¸€ä¸ªCollectionçš„Listä¸­,ä»»ä½•å¯¹è±¡ä¸€æ—¦åŠ å…¥Listä¸­,å®é™…ä¸Šè£…å…¥äº†ä¸€ä¸ªå°é—­çš„é»‘ç›’ä¸­,å¯¹è±¡çš„ç‰¹æ€§æ¶ˆå¤±äº†,åªæœ‰å–å‡ºæ—¶,æ‰æœ‰å¯èƒ½æ¨¡ç³Šçš„åˆ†è¾¨å‡º:å…¸å‹çš„Commandæ¨¡å¼éœ€è¦æœ‰ä¸€ä¸ªæ¥å£.æ¥å£ä¸­æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•,è¿™å°±æ˜¯\u0026quot;å°†å‘½ä»¤/è¯·æ±‚å°è£…ä¸ºå¯¹è±¡\u0026quot;:\npublic interface Command { public abstract void execute ( ); } å…·ä½“ä¸åŒå‘½ä»¤/è¯·æ±‚ä»£ç æ˜¯å®ç°æ¥å£Command,ä¸‹é¢æœ‰ä¸‰ä¸ªå…·ä½“å‘½ä»¤\npublic class Engineer implements Command { public void execute( ) { //do Engineer\u0026#39;s command } } public class Programmer implements Command { public void execute( ) { //do programmer\u0026#39;s command } } public class Politician implements Command { public void execute( ) { //do Politician\u0026#39;s command } } æŒ‰ç…§é€šå¸¸åšæ³•,æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸‰ä¸ªCommand,ä½†æ˜¯ä½¿ç”¨Commandæ¨¡å¼,æˆ‘ä»¬è¦å°†ä»–ä»¬å°è£…èµ·æ¥,æ‰”åˆ°é»‘ç›’å­Listé‡Œå»:\npublic class producer{ public static List produceRequests() { List queue = new ArrayList(); queue.add( new DomesticEngineer() ); queue.add( new Politician() ); queue.add( new Programmer() ); return queue; } } è¿™ä¸‰ä¸ªå‘½ä»¤è¿›å…¥Listä¸­å,å·²ç»å¤±å»äº†å…¶å¤–è¡¨ç‰¹å¾,ä»¥åå†å–å‡º,ä¹Ÿå¯èƒ½æ— æ³•åˆ†è¾¨å‡ºè°æ˜¯Engineer è°æ˜¯Programmeräº†,çœ‹ä¸‹é¢å®¢æˆ·ç«¯å¦‚ä½•è°ƒç”¨Commandæ¨¡å¼:\npublic class TestCommand { public static void main(String[] args) { List queue = Producer.produceRequests(); for (Iterator it = queue.iterator(); it.hasNext(); ) //å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨executeæ–¹æ³•ï¼Œæ— éœ€çŸ¥é“è¢«è°ƒç”¨è€…çš„å…¶å®ƒæ›´å¤šç±»çš„æ–¹æ³•åã€‚ ((Command)it.next()).execute(); } } ç”±æ­¤å¯è§,è°ƒç”¨è€…åŸºæœ¬åªå’Œæ¥å£æ‰“äº¤é“,ä¸åˆå…·ä½“å®ç°äº¤äº’,è¿™ä¹Ÿä½“ç°äº†ä¸€ä¸ªåŸåˆ™,é¢å‘æ¥å£ç¼–ç¨‹,è¿™æ ·,ä»¥åå¢åŠ ç¬¬å››ä¸ªå…·ä½“å‘½ä»¤æ—¶,å°±ä¸å¿…ä¿®æ”¹è°ƒç”¨è€…TestCommandä¸­çš„ä»£ç äº†.\nç†è§£äº†ä¸Šé¢çš„ä»£ç çš„æ ¸å¿ƒåŸç†,åœ¨ä½¿ç”¨ä¸­,å°±åº”è¯¥å„äººæœ‰è‡ªå·±æ–¹æ³•äº†,ç‰¹åˆ«æ˜¯åœ¨å¦‚ä½•åˆ†ç¦»è°ƒç”¨è€…å’Œå…·ä½“å‘½ä»¤ä¸Š,æœ‰å¾ˆå¤šå®ç°æ–¹æ³•,ä¸Šé¢çš„ä»£ç æ˜¯ä½¿ç”¨\u0026quot;ä»Listè¿‡ä¸€é\u0026quot;çš„åšæ³•.è¿™ç§åšæ³•åªæ˜¯ä¸ºäº†æ¼”ç¤º.\nä½¿ç”¨Commandæ¨¡å¼çš„ä¸€ä¸ªå¥½ç†ç”±è¿˜å› ä¸ºå®ƒèƒ½å®ç°UndoåŠŸèƒ½.æ¯ä¸ªå…·ä½“å‘½ä»¤éƒ½å¯ä»¥è®°ä½å®ƒåˆšåˆšæ‰§è¡Œçš„åŠ¨ä½œ,å¹¶ä¸”åœ¨éœ€è¦æ—¶æ¢å¤.\nCommandæ¨¡å¼åœ¨ç•Œé¢è®¾è®¡ä¸­åº”ç”¨å¹¿æ³›.Javaçš„Swingä¸­èœå•å‘½ä»¤éƒ½æ˜¯ä½¿ç”¨Commandæ¨¡å¼,ç”±äºJavaåœ¨ç•Œé¢è®¾è®¡çš„æ€§èƒ½ä¸Šè¿˜æœ‰æ¬ ç¼º,å› æ­¤ç•Œé¢è®¾è®¡å…·ä½“ä»£ç æˆ‘ä»¬å°±ä¸è®¨è®º,ç½‘ç»œä¸Šæœ‰å¾ˆå¤šè¿™æ ·çš„ç¤ºä¾‹.\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.5-command/","summary":"Commandæ¨¡å¼æ˜¯æœ€è®©æˆ‘ç–‘æƒ‘çš„ä¸€ä¸ªæ¨¡å¼,æˆ‘åœ¨é˜…è¯»äº†å¾ˆå¤šä»£ç å,æ‰æ„Ÿè§‰éšçº¦æŒæ¡å…¶å¤§æ¦‚åŸç†,æˆ‘è®¤ä¸ºç†è§£è®¾è®¡æ¨¡å¼æœ€ä¸»è¦æ˜¯æŒæ¡èµ·åŸç†æ„é€ ,è¿™æ ·æ‰å¯¹è‡ªå·±å®é™…ç¼–ç¨‹æœ‰æŒ‡å¯¼ä½œç”¨.Commandæ¨¡å¼å®é™…ä¸Šä¸æ˜¯ä¸ªå¾ˆå…·ä½“,è§„å®šå¾ˆå¤šçš„æ¨¡å¼,æ­£æ˜¯è¿™ä¸ªçµæ´»æ€§,è®©äººæœ‰äº›confuse.\nCommandå‘½ä»¤æ¨¡å¼ n å°†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ— éœ€äº†è§£è¿™ä¸ªè¯·æ±‚æ¿€æ´»çš„ åŠ¨ä½œæˆ–æœ‰å…³æ¥å—è¿™ä¸ªè¯·æ±‚çš„å¤„ç†ç»†èŠ‚ã€‚\nè¿™æ˜¯ä¸€ç§ä¸¤å°æœºå™¨ä¹‹é—´é€šè®¯è”ç³»æ€§è´¨çš„æ¨¡å¼ï¼Œç±»ä¼¼ä¼ ç»Ÿè¿‡ç¨‹è¯­ è¨€çš„ CallBackåŠŸèƒ½ã€‚\nå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶åˆ«åä¸ºåŠ¨ä½œ(Action)æ¨¡å¼æˆ–äº‹åŠ¡(Transaction)æ¨¡å¼ã€‚\nä¼˜ç‚¹ è§£è€¦äº†å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´è”ç³»ã€‚ å‘é€è€…è°ƒç”¨ä¸€ä¸ªæ“ä½œï¼Œæ¥å—è€…æ¥å—è¯·æ±‚æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œå› ä¸ºä½¿ç”¨Commandæ¨¡å¼è§£è€¦ï¼Œå‘é€è€…æ— éœ€çŸ¥é“æ¥å—è€…ä»»ä½•æ¥å£ã€‚\nä¸å°‘Commandæ¨¡å¼çš„ä»£ç éƒ½æ˜¯é’ˆå¯¹å›¾å½¢ç•Œé¢çš„,å®ƒå®é™…å°±æ˜¯èœå•å‘½ä»¤,æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸‹æ‹‰èœå•é€‰æ‹©ä¸€ä¸ªå‘½ä»¤æ—¶,ç„¶åä¼šæ‰§è¡Œä¸€äº›åŠ¨ä½œ.\nå°†è¿™äº›å‘½ä»¤å°è£…æˆåœ¨ä¸€ä¸ªç±»ä¸­,ç„¶åç”¨æˆ·(è°ƒç”¨è€…)å†å¯¹è¿™ä¸ªç±»è¿›è¡Œæ“ä½œ,è¿™å°±æ˜¯Commandæ¨¡å¼,æ¢å¥è¯è¯´,æœ¬æ¥ç”¨æˆ·(è°ƒç”¨è€…)æ˜¯ç›´æ¥è°ƒç”¨è¿™äº›å‘½ä»¤çš„,å¦‚èœå•ä¸Šæ‰“å¼€æ–‡æ¡£(è°ƒç”¨è€…),å°±ç›´æ¥æŒ‡å‘æ‰“å¼€æ–‡æ¡£çš„ä»£ç ,ä½¿ç”¨Commandæ¨¡å¼,å°±æ˜¯åœ¨è¿™ä¸¤è€…ä¹‹é—´å¢åŠ ä¸€ä¸ªä¸­é—´è€…,å°†è¿™ç§ç›´æ¥å…³ç³»æ‹—æ–­,åŒæ—¶ä¸¤è€…ä¹‹é—´éƒ½éš”ç¦»,åŸºæœ¬æ²¡æœ‰å…³ç³»äº†.\næ˜¾ç„¶è¿™æ ·åšçš„å¥½å¤„æ˜¯ç¬¦åˆå°è£…çš„ç‰¹æ€§,é™ä½è€¦åˆåº¦,Commandæ˜¯å°†å¯¹è¡Œä¸ºè¿›è¡Œå°è£…çš„å…¸å‹æ¨¡å¼,Factoryæ˜¯å°†åˆ›å»ºè¿›è¡Œå°è£…çš„æ¨¡å¼, ä»Commandæ¨¡å¼,æˆ‘ä¹Ÿå‘ç°è®¾è®¡æ¨¡å¼ä¸€ä¸ª\u0026quot;é€šç—…\u0026quot;:å¥½è±¡å–œæ¬¢å°†ç®€å•çš„é—®é¢˜å¤æ‚åŒ–, å–œæ¬¢åœ¨ä¸åŒç±»ä¸­å¢åŠ ç¬¬ä¸‰è€…,å½“ç„¶è¿™æ ·åšæœ‰åˆ©äºä»£ç çš„å¥å£®æ€§ å¯ç»´æŠ¤æ€§ è¿˜æœ‰å¤ç”¨æ€§.\nå¦‚ä½•ä½¿ç”¨? å…·ä½“çš„Commandæ¨¡å¼ä»£ç å„å¼å„æ ·,å› ä¸ºå¦‚ä½•å°è£…å‘½ä»¤,ä¸åŒç³»ç»Ÿ,æœ‰ä¸åŒçš„åšæ³•.ä¸‹é¢äº‹ä¾‹æ˜¯å°†å‘½ä»¤å°è£…åœ¨ä¸€ä¸ªCollectionçš„Listä¸­,ä»»ä½•å¯¹è±¡ä¸€æ—¦åŠ å…¥Listä¸­,å®é™…ä¸Šè£…å…¥äº†ä¸€ä¸ªå°é—­çš„é»‘ç›’ä¸­,å¯¹è±¡çš„ç‰¹æ€§æ¶ˆå¤±äº†,åªæœ‰å–å‡ºæ—¶,æ‰æœ‰å¯èƒ½æ¨¡ç³Šçš„åˆ†è¾¨å‡º:å…¸å‹çš„Commandæ¨¡å¼éœ€è¦æœ‰ä¸€ä¸ªæ¥å£.æ¥å£ä¸­æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•,è¿™å°±æ˜¯\u0026quot;å°†å‘½ä»¤/è¯·æ±‚å°è£…ä¸ºå¯¹è±¡\u0026quot;:\npublic interface Command { public abstract void execute ( ); } å…·ä½“ä¸åŒå‘½ä»¤/è¯·æ±‚ä»£ç æ˜¯å®ç°æ¥å£Command,ä¸‹é¢æœ‰ä¸‰ä¸ªå…·ä½“å‘½ä»¤\npublic class Engineer implements Command { public void execute( ) { //do Engineer\u0026#39;s command } } public class Programmer implements Command { public void execute( ) { //do programmer\u0026#39;s command } } public class Politician implements Command { public void execute( ) { //do Politician\u0026#39;s command } } æŒ‰ç…§é€šå¸¸åšæ³•,æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸‰ä¸ªCommand,ä½†æ˜¯ä½¿ç”¨Commandæ¨¡å¼,æˆ‘ä»¬è¦å°†ä»–ä»¬å°è£…èµ·æ¥,æ‰”åˆ°é»‘ç›’å­Listé‡Œå»:","title":"3.5 Command"},{"content":"Chain of Responsibility (èŒè´£é“¾æ¨¡å¼) Chain of Responsibility(CoR) æ˜¯ç”¨ä¸€ç³»åˆ—ç±»(classes)è¯•å›¾å¤„ç†ä¸€ä¸ªè¯·æ±‚request,è¿™äº›ç±»ä¹‹é—´æ˜¯ä¸€ä¸ªæ¾æ•£çš„è€¦åˆ,å”¯ä¸€å…±åŒç‚¹æ˜¯åœ¨ä»–ä»¬ä¹‹é—´ä¼ é€’request. ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥äº†ä¸€ä¸ªè¯·æ±‚ï¼ŒAç±»å…ˆå¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Bç±»å¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Cç±»å¤„ç†ï¼Œå°±è¿™æ ·è±¡ä¸€ä¸ªé“¾æ¡(chain)ä¸€æ ·ä¼ é€’ä¸‹å»ã€‚\nå¦‚ä½•ä½¿ç”¨? è™½ç„¶è¿™ä¸€æ®µæ˜¯å¦‚ä½•ä½¿ç”¨CoR,ä½†æ˜¯ä¹Ÿæ˜¯æ¼”ç¤ºä»€ä¹ˆæ˜¯CoR.\næœ‰ä¸€ä¸ªHandleræ¥å£:\npublic interface Handler{ public void handleRequest(); } è¿™æ˜¯ä¸€ä¸ªå¤„ç†requestçš„äº‹ä¾‹ï¼Œ å¦‚æœæœ‰å¤šç§request,æ¯”å¦‚ è¯·æ±‚å¸®åŠ© è¯·æ±‚æ‰“å° æˆ–è¯·æ±‚æ ¼å¼åŒ–ï¼š\næœ€å…ˆæƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨æ¥å£ä¸­å¢åŠ å¤šä¸ªè¯·æ±‚ï¼š\npublic interface Handler{ public void handleHelp(); public void handlePrint(); public void handleFormat(); } å…·ä½“æ˜¯ä¸€æ®µå®ç°æ¥å£Handlerä»£ç ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleHelp(){ //å…·ä½“å¤„ç†è¯·æ±‚Helpçš„ä»£ç  ... } public void handlePrint(){ //å¦‚æœæ˜¯print è½¬å»å¤„ç†Print successor.handlePrint(); } public void handleFormat(){ //å¦‚æœæ˜¯Format è½¬å»å¤„ç†format successor.handleFormat(); } } ä¸€å…±æœ‰ä¸‰ä¸ªè¿™æ ·çš„å…·ä½“å®ç°ç±»ï¼Œä¸Šé¢æ˜¯å¤„ç†help,è¿˜æœ‰å¤„ç†Print å¤„ç†Formatè¿™å¤§æ¦‚æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ç¼–ç¨‹æ€è·¯ã€‚\nè™½ç„¶æ€è·¯ç®€å•æ˜äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ‰©å±•é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å†å¢åŠ ä¸€ä¸ªè¯·æ±‚requestç§ç±»,éœ€è¦ä¿®æ”¹æ¥å£åŠå…¶æ¯ä¸€ä¸ªå®ç°ã€‚\nç¬¬äºŒæ–¹æ¡ˆ:å°†æ¯ç§requestéƒ½å˜æˆä¸€ä¸ªæ¥å£ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ä»¥ä¸‹ä»£ç  ï¼š\npublic interface HelpHandler{ public void handleHelp(); } public interface PrintHandler{ public void handlePrint(); } public interface FormatHandler{ public void handleFormat(); } public class ConcreteHandler implements HelpHandler,PrintHandler,FormatHandlet{ private HelpHandler helpSuccessor; private PrintHandler printSuccessor; private FormatHandler formatSuccessor; public ConcreteHandler(HelpHandler helpSuccessor,PrintHandler printSuccessor,FormatHandler formatSuccessor) { this.helpSuccessor=helpSuccessor; this.printSuccessor=printSuccessor; this.formatSuccessor=formatSuccessor; } public void handleHelp(){ ....... } public void handlePrint(){this.printSuccessor=printSuccessor;} public void handleFormat(){this.formatSuccessor=formatSuccessor;} } è¿™ä¸ªåŠæ³•åœ¨å¢åŠ æ–°çš„è¯·æ±‚requestæƒ…å†µä¸‹ï¼Œåªæ˜¯èŠ‚çœäº†æ¥å£çš„ä¿®æ”¹é‡ï¼Œæ¥å£å®ç°ConcreteHandlerè¿˜éœ€è¦ä¿®æ”¹ã€‚è€Œä¸”ä»£ç æ˜¾ç„¶ä¸ç®€å•ç¾ä¸½ã€‚\nè§£å†³æ–¹æ¡ˆ3: åœ¨Handleræ¥å£ä¸­åªä½¿ç”¨ä¸€ä¸ªå‚æ•°åŒ–æ–¹æ³•ï¼š\npublic interface Handler{ public void handleRequest(String request); } é‚£ä¹ˆHandlerå®ç°ä»£ç å¦‚ä¸‹ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleRequest(String request){ if (request.equals(\u0026#34;Help\u0026#34;)){ //è¿™é‡Œæ˜¯å¤„ç†Helpçš„å…·ä½“ä»£ç  }else //ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª successor.handle(request); } } } è¿™é‡Œå…ˆå‡è®¾requestæ˜¯Stringç±»å‹ï¼Œå¦‚æœä¸æ˜¯æ€ä¹ˆåŠï¼Ÿå½“ç„¶æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸“é—¨ç±»Request\næœ€åè§£å†³æ–¹æ¡ˆ:æ¥å£Handlerçš„ä»£ç å¦‚ä¸‹ï¼š\npublic interface Handler{ public void handleRequest(Request request); } Requestç±»çš„å®šä¹‰:\npublic class Request{ private String type; public Request(String type){this.type=type;} public String getType(){return type;} public void execute(){ //requestçœŸæ­£å…·ä½“è¡Œä¸ºä»£ç  } } é‚£ä¹ˆHandlerå®ç°ä»£ç å¦‚ä¸‹ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleRequest(Request request){ if (request instanceof HelpRequest){ //è¿™é‡Œæ˜¯å¤„ç†Helpçš„å…·ä½“ä»£ç  }else if (request instanceof PrintRequst){ request.execute(); }else //ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª successor.handle(request); } } } è¿™ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¯CoR, åœ¨ä¸€ä¸ªé“¾ä¸Š,éƒ½æœ‰ç›¸åº”èŒè´£çš„ç±»,å› æ­¤å«Chain of Responsibility.\nCoRçš„ä¼˜ç‚¹ å› ä¸ºæ— æ³•é¢„çŸ¥æ¥è‡ªå¤–ç•Œï¼ˆå®¢æˆ·ç«¯ï¼‰çš„è¯·æ±‚æ˜¯å±äºå“ªç§ç±»å‹ï¼Œæ¯ä¸ªç±»å¦‚æœç¢°åˆ°å®ƒä¸èƒ½å¤„ç†çš„è¯·æ±‚åªè¦æ”¾å¼ƒå°±å¯ä»¥ã€‚\nç¼ºç‚¹æ˜¯æ•ˆç‡ä½ï¼Œå› ä¸ºä¸€ä¸ªè¯·æ±‚çš„å®Œæˆå¯èƒ½è¦éå†åˆ°æœ€åæ‰å¯èƒ½å®Œæˆï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ ‘çš„æ¦‚å¿µä¼˜åŒ–ã€‚ åœ¨Java AWT1.0ä¸­ï¼Œå¯¹äºé¼ æ ‡æŒ‰é”®äº‹æƒ…çš„å¤„ç†å°±æ˜¯ä½¿ç”¨CoR,åˆ°Java.1.1ä»¥åï¼Œå°±ä½¿ç”¨Observerä»£æ›¿CoR\næ‰©å±•æ€§å·®ï¼Œå› ä¸ºåœ¨CoRä¸­ï¼Œä¸€å®šè¦æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£Handler.å±€é™æ€§å°±åœ¨è¿™é‡Œã€‚\nä¸Commandæ¨¡å¼åŒºåˆ« Command æ¨¡å¼éœ€è¦äº‹å…ˆåå•†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„è°ƒç”¨å…³ç³»ï¼Œæ¯”å¦‚ 1 ä»£è¡¨ start 2 ä»£è¡¨ move ç­‰ï¼Œè¿™äº› éƒ½æ˜¯å°è£…åœ¨ request ä¸­ï¼Œåˆ°è¾¾æœåŠ¡å™¨ç«¯å†åˆ†è§£ã€‚\nCoR æ¨¡å¼å°±æ— éœ€è¿™ç§äº‹å…ˆçº¦å®šï¼ŒæœåŠ¡å™¨ç«¯å¯ä»¥ä½¿ç”¨ CoR æ¨¡å¼è¿›è¡Œå®¢æˆ·ç«¯è¯·æ±‚çš„çŒœæµ‹ï¼Œä¸€ä¸ªä¸ªçŒœæµ‹ è¯•éªŒã€‚\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.4-chain-of-responsibility/","summary":"Chain of Responsibility (èŒè´£é“¾æ¨¡å¼) Chain of Responsibility(CoR) æ˜¯ç”¨ä¸€ç³»åˆ—ç±»(classes)è¯•å›¾å¤„ç†ä¸€ä¸ªè¯·æ±‚request,è¿™äº›ç±»ä¹‹é—´æ˜¯ä¸€ä¸ªæ¾æ•£çš„è€¦åˆ,å”¯ä¸€å…±åŒç‚¹æ˜¯åœ¨ä»–ä»¬ä¹‹é—´ä¼ é€’request. ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥äº†ä¸€ä¸ªè¯·æ±‚ï¼ŒAç±»å…ˆå¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Bç±»å¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Cç±»å¤„ç†ï¼Œå°±è¿™æ ·è±¡ä¸€ä¸ªé“¾æ¡(chain)ä¸€æ ·ä¼ é€’ä¸‹å»ã€‚\nå¦‚ä½•ä½¿ç”¨? è™½ç„¶è¿™ä¸€æ®µæ˜¯å¦‚ä½•ä½¿ç”¨CoR,ä½†æ˜¯ä¹Ÿæ˜¯æ¼”ç¤ºä»€ä¹ˆæ˜¯CoR.\næœ‰ä¸€ä¸ªHandleræ¥å£:\npublic interface Handler{ public void handleRequest(); } è¿™æ˜¯ä¸€ä¸ªå¤„ç†requestçš„äº‹ä¾‹ï¼Œ å¦‚æœæœ‰å¤šç§request,æ¯”å¦‚ è¯·æ±‚å¸®åŠ© è¯·æ±‚æ‰“å° æˆ–è¯·æ±‚æ ¼å¼åŒ–ï¼š\næœ€å…ˆæƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨æ¥å£ä¸­å¢åŠ å¤šä¸ªè¯·æ±‚ï¼š\npublic interface Handler{ public void handleHelp(); public void handlePrint(); public void handleFormat(); } å…·ä½“æ˜¯ä¸€æ®µå®ç°æ¥å£Handlerä»£ç ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleHelp(){ //å…·ä½“å¤„ç†è¯·æ±‚Helpçš„ä»£ç  ... } public void handlePrint(){ //å¦‚æœæ˜¯print è½¬å»å¤„ç†Print successor.handlePrint(); } public void handleFormat(){ //å¦‚æœæ˜¯Format è½¬å»å¤„ç†format successor.","title":"3.4 Chain of Responsibility"},{"content":"Observer(è§‚å¯Ÿè€…æ¨¡å¼)å®šä¹‰ è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€ä¸Šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚\né“¾æ¥\nå…·ä½“è®²è§£\nJavaæ·±å…¥åˆ°ä¸€å®šç¨‹åº¦,å°±ä¸å¯é¿å…çš„ç¢°åˆ°è®¾è®¡æ¨¡å¼(design pattern)è¿™ä¸€æ¦‚å¿µ,äº†è§£è®¾è®¡æ¨¡å¼,å°†ä½¿è‡ªå·±å¯¹javaä¸­çš„æ¥å£æˆ–æŠ½è±¡ç±»åº”ç”¨æœ‰æ›´æ·±çš„ç†è§£.è®¾è®¡æ¨¡å¼åœ¨javaçš„ä¸­å‹ç³»ç»Ÿä¸­åº”ç”¨å¹¿æ³›,éµå¾ªä¸€å®šçš„ç¼–ç¨‹æ¨¡å¼,æ‰èƒ½ä½¿è‡ªå·±çš„ä»£ç ä¾¿äºç†è§£,æ˜“äºäº¤æµ,Observer(è§‚å¯Ÿè€…)æ¨¡å¼æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªæ¨¡å¼,å°¤å…¶åœ¨ç•Œé¢è®¾è®¡ä¸­åº”ç”¨å¹¿æ³›,è€Œæœ¬ç«™æ‰€å…³æ³¨çš„æ˜¯Javaåœ¨ç”µå­å•†åŠ¡ç³»ç»Ÿä¸­åº”ç”¨,å› æ­¤æƒ³ä»ç”µå­å•†åŠ¡å®ä¾‹ä¸­åˆ†æObserverçš„åº”ç”¨.\nè™½ç„¶ç½‘ä¸Šå•†åº—å½¢å¼å¤šæ ·,æ¯ä¸ªç«™ç‚¹æœ‰è‡ªå·±çš„ç‰¹è‰²,ä½†ä¹Ÿæœ‰å…¶ä¸€èˆ¬çš„å…±æ€§,å•å°±\u0026quot;å•†å“çš„å˜åŒ–,ä»¥ä¾¿åŠæ—¶é€šçŸ¥è®¢æˆ·\u0026quot;è¿™ä¸€ç‚¹,æ˜¯å¾ˆå¤šç½‘ä¸Šå•†åº—å…±æœ‰çš„æ¨¡å¼,è¿™ä¸€æ¨¡å¼ç±»ä¼¼Observer paternè§‚å¯Ÿè€…æ¨¡å¼.\nå…·ä½“çš„è¯´,å¦‚æœç½‘ä¸Šå•†åº—ä¸­å•†å“åœ¨åç§° ä»·æ ¼ç­‰æ–¹é¢æœ‰å˜åŒ–,å¦‚æœç³»ç»Ÿèƒ½è‡ªåŠ¨é€šçŸ¥ä¼šå‘˜,å°†æ˜¯ç½‘ä¸Šå•†åº—åŒºåˆ«ä¼ ç»Ÿå•†åº—çš„ä¸€å¤§ç‰¹è‰².è¿™å°±éœ€è¦åœ¨å•†å“productä¸­åŠ å…¥Observerè¿™æ ·è§’è‰²,ä»¥ä¾¿productç»†èŠ‚å‘ç”Ÿå˜åŒ–æ—¶,Observerèƒ½è‡ªåŠ¨è§‚å¯Ÿåˆ°è¿™ç§å˜åŒ–,å¹¶èƒ½è¿›è¡ŒåŠæ—¶çš„updateæˆ–notifyåŠ¨ä½œ.\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.3-observer/","summary":"Observer(è§‚å¯Ÿè€…æ¨¡å¼)å®šä¹‰ è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€ä¸Šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚\né“¾æ¥\nå…·ä½“è®²è§£\nJavaæ·±å…¥åˆ°ä¸€å®šç¨‹åº¦,å°±ä¸å¯é¿å…çš„ç¢°åˆ°è®¾è®¡æ¨¡å¼(design pattern)è¿™ä¸€æ¦‚å¿µ,äº†è§£è®¾è®¡æ¨¡å¼,å°†ä½¿è‡ªå·±å¯¹javaä¸­çš„æ¥å£æˆ–æŠ½è±¡ç±»åº”ç”¨æœ‰æ›´æ·±çš„ç†è§£.è®¾è®¡æ¨¡å¼åœ¨javaçš„ä¸­å‹ç³»ç»Ÿä¸­åº”ç”¨å¹¿æ³›,éµå¾ªä¸€å®šçš„ç¼–ç¨‹æ¨¡å¼,æ‰èƒ½ä½¿è‡ªå·±çš„ä»£ç ä¾¿äºç†è§£,æ˜“äºäº¤æµ,Observer(è§‚å¯Ÿè€…)æ¨¡å¼æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªæ¨¡å¼,å°¤å…¶åœ¨ç•Œé¢è®¾è®¡ä¸­åº”ç”¨å¹¿æ³›,è€Œæœ¬ç«™æ‰€å…³æ³¨çš„æ˜¯Javaåœ¨ç”µå­å•†åŠ¡ç³»ç»Ÿä¸­åº”ç”¨,å› æ­¤æƒ³ä»ç”µå­å•†åŠ¡å®ä¾‹ä¸­åˆ†æObserverçš„åº”ç”¨.\nè™½ç„¶ç½‘ä¸Šå•†åº—å½¢å¼å¤šæ ·,æ¯ä¸ªç«™ç‚¹æœ‰è‡ªå·±çš„ç‰¹è‰²,ä½†ä¹Ÿæœ‰å…¶ä¸€èˆ¬çš„å…±æ€§,å•å°±\u0026quot;å•†å“çš„å˜åŒ–,ä»¥ä¾¿åŠæ—¶é€šçŸ¥è®¢æˆ·\u0026quot;è¿™ä¸€ç‚¹,æ˜¯å¾ˆå¤šç½‘ä¸Šå•†åº—å…±æœ‰çš„æ¨¡å¼,è¿™ä¸€æ¨¡å¼ç±»ä¼¼Observer paternè§‚å¯Ÿè€…æ¨¡å¼.\nå…·ä½“çš„è¯´,å¦‚æœç½‘ä¸Šå•†åº—ä¸­å•†å“åœ¨åç§° ä»·æ ¼ç­‰æ–¹é¢æœ‰å˜åŒ–,å¦‚æœç³»ç»Ÿèƒ½è‡ªåŠ¨é€šçŸ¥ä¼šå‘˜,å°†æ˜¯ç½‘ä¸Šå•†åº—åŒºåˆ«ä¼ ç»Ÿå•†åº—çš„ä¸€å¤§ç‰¹è‰².è¿™å°±éœ€è¦åœ¨å•†å“productä¸­åŠ å…¥Observerè¿™æ ·è§’è‰²,ä»¥ä¾¿productç»†èŠ‚å‘ç”Ÿå˜åŒ–æ—¶,Observerèƒ½è‡ªåŠ¨è§‚å¯Ÿåˆ°è¿™ç§å˜åŒ–,å¹¶èƒ½è¿›è¡ŒåŠæ—¶çš„updateæˆ–notifyåŠ¨ä½œ.","title":"3.3 Observer"},{"content":"Memento(å¤‡å¿˜å½•æ¨¡å¼)å®šä¹‰ mementoæ˜¯ä¸€ä¸ªä¿å­˜å¦å¤–ä¸€ä¸ªå¯¹è±¡å†…éƒ¨çŠ¶æ€æ‹·è´çš„å¯¹è±¡.è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€.\nMementoæ¨¡å¼ç›¸å¯¹ä¹Ÿæ¯”è¾ƒå¥½ç†è§£,æˆ‘ä»¬çœ‹ä¸‹åˆ—ä»£ç :\npublic class Originator { public int number; public File file = null; public Originator(){} // åˆ›å»ºä¸€ä¸ªMemento public Memento getMemento(){ return new Memento(this); } // æ¢å¤åˆ°åŸå§‹å€¼ public void setMemento(Memento m){ number = m.number; file = m.file; } } æˆ‘ä»¬å†çœ‹çœ‹Mementoç±»:\nprivate class Memento implements java.io.Serializable{ public int number; public File file = null; public Memento( Originator o){ number = o.number; file = o.file; } } å¯è§ Mementoä¸­ä¿å­˜äº†Originatorä¸­çš„numberå’Œfileçš„å€¼. é€šè¿‡è°ƒç”¨Originatorä¸­numberå’Œfileå€¼æ”¹å˜çš„è¯,é€šè¿‡è°ƒç”¨setMemento()æ–¹æ³•å¯ä»¥æ¢å¤.\nMementoæ¨¡å¼çš„ç¼ºç‚¹æ˜¯è€—è´¹å¤§,å¦‚æœå†…éƒ¨çŠ¶æ€å¾ˆå¤š,å†ä¿å­˜ä¸€ä»½,æ— æ„è¦æµªè´¹å¤§é‡å†…å­˜.\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.2-memento/","summary":"Memento(å¤‡å¿˜å½•æ¨¡å¼)å®šä¹‰ mementoæ˜¯ä¸€ä¸ªä¿å­˜å¦å¤–ä¸€ä¸ªå¯¹è±¡å†…éƒ¨çŠ¶æ€æ‹·è´çš„å¯¹è±¡.è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€.\nMementoæ¨¡å¼ç›¸å¯¹ä¹Ÿæ¯”è¾ƒå¥½ç†è§£,æˆ‘ä»¬çœ‹ä¸‹åˆ—ä»£ç :\npublic class Originator { public int number; public File file = null; public Originator(){} // åˆ›å»ºä¸€ä¸ªMemento public Memento getMemento(){ return new Memento(this); } // æ¢å¤åˆ°åŸå§‹å€¼ public void setMemento(Memento m){ number = m.number; file = m.file; } } æˆ‘ä»¬å†çœ‹çœ‹Mementoç±»:\nprivate class Memento implements java.io.Serializable{ public int number; public File file = null; public Memento( Originator o){ number = o.number; file = o.file; } } å¯è§ Mementoä¸­ä¿å­˜äº†Originatorä¸­çš„numberå’Œfileçš„å€¼. é€šè¿‡è°ƒç”¨Originatorä¸­numberå’Œfileå€¼æ”¹å˜çš„è¯,é€šè¿‡è°ƒç”¨setMemento()æ–¹æ³•å¯ä»¥æ¢å¤.\nMementoæ¨¡å¼çš„ç¼ºç‚¹æ˜¯è€—è´¹å¤§,å¦‚æœå†…éƒ¨çŠ¶æ€å¾ˆå¤š,å†ä¿å­˜ä¸€ä»½,æ— æ„è¦æµªè´¹å¤§é‡å†…å­˜.","title":"3.2 Memento"},{"content":"Template(æ¨¡æ¿æ¨¡å¼)å®šä¹‰ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­ç®—æ³•çš„éª¨æ¶,å°†ä¸€äº›æ­¥éª¤çš„æ‰§è¡Œå»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­.\nä½¿ç”¨Javaçš„æŠ½è±¡ç±»æ—¶ï¼Œå°±ç»å¸¸ä¼šä½¿ç”¨åˆ°Templateæ¨¡å¼,å› æ­¤Templateæ¨¡å¼ä½¿ç”¨å¾ˆæ™®é.è€Œä¸”å¾ˆå®¹æ˜“ç†è§£å’Œä½¿ç”¨ã€‚\npublic abstract class Benchmark { /** * ä¸‹é¢æ“ä½œæ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨å­ç±»ä¸­å®Œæˆ */ public abstract void benchmark(); /** * é‡å¤æ‰§è¡Œbenchmarkæ¬¡æ•° */ public final long repeat (int count) { if (count \u0026lt;= 0) return 0; else { long startTime = System.currentTimeMillis(); for (int i = 0; i \u0026lt; count; i++) benchmark(); long stopTime = System.currentTimeMillis(); return stopTime - startTime; } } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬å¸Œæœ›é‡å¤æ‰§è¡Œbenchmark()æ“ä½œ,ä½†æ˜¯å¯¹benchmark()çš„å…·ä½“å†…å®¹æ²¡æœ‰è¯´æ˜,è€Œæ˜¯å»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­æè¿°:\npublic class MethodBenchmark extends Benchmark { /** * çœŸæ­£å®šä¹‰benchmarkå†…å®¹ */ public void benchmark() { for (int i = 0; i \u0026lt; Integer.MAX_VALUE; i++){ System.out.printtln(\u0026#34;i=\u0026#34;+i);ã€€} } } è‡³æ­¤,Templateæ¨¡å¼å·²ç»å®Œæˆ,æ˜¯ä¸æ˜¯å¾ˆç®€å•?\næˆ‘ä»¬ç§°repeatæ–¹æ³•ä¸ºæ¨¡æ¿æ–¹æ³•ï¼Œ å®ƒå…¶ä¸­çš„benchmark()å®ç°è¢«å»¶è¿Ÿåˆ°å­ç±»MethodBenchmarkä¸­å®ç°äº†ï¼Œ\nçœ‹çœ‹å¦‚ä½•ä½¿ç”¨:\nBenchmark operation = new MethodBenchmark(); long duration = operation.repeat(Integer.parseInt(args[0].trim())); System.out.println(\u0026#34;The operation took \u0026#34; + duration + \u0026#34; milliseconds\u0026#34;); ä¹Ÿè®¸ä½ ä»¥å‰è¿˜ç–‘æƒ‘æŠ½è±¡ç±»æœ‰ä»€ä¹ˆç”¨,ç°åœ¨ä½ åº”è¯¥å½»åº•æ˜ç™½äº†å§? è‡³äºè¿™æ ·åšçš„å¥½å¤„,å¾ˆæ˜¾ç„¶å•Š,æ‰©å±•æ€§å¼º,ä»¥åBenchmarkå†…å®¹å˜åŒ–,æˆ‘åªè¦å†åšä¸€ä¸ªç»§æ‰¿å­ç±»å°±å¯ä»¥,ä¸å¿…ä¿®æ”¹å…¶ä»–åº”ç”¨ä»£ç .\n","permalink":"http://blog.chalme.top/posts/design-patterns/3.1-template/","summary":"Template(æ¨¡æ¿æ¨¡å¼)å®šä¹‰ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­ç®—æ³•çš„éª¨æ¶,å°†ä¸€äº›æ­¥éª¤çš„æ‰§è¡Œå»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­.\nä½¿ç”¨Javaçš„æŠ½è±¡ç±»æ—¶ï¼Œå°±ç»å¸¸ä¼šä½¿ç”¨åˆ°Templateæ¨¡å¼,å› æ­¤Templateæ¨¡å¼ä½¿ç”¨å¾ˆæ™®é.è€Œä¸”å¾ˆå®¹æ˜“ç†è§£å’Œä½¿ç”¨ã€‚\npublic abstract class Benchmark { /** * ä¸‹é¢æ“ä½œæ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨å­ç±»ä¸­å®Œæˆ */ public abstract void benchmark(); /** * é‡å¤æ‰§è¡Œbenchmarkæ¬¡æ•° */ public final long repeat (int count) { if (count \u0026lt;= 0) return 0; else { long startTime = System.currentTimeMillis(); for (int i = 0; i \u0026lt; count; i++) benchmark(); long stopTime = System.currentTimeMillis(); return stopTime - startTime; } } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬å¸Œæœ›é‡å¤æ‰§è¡Œbenchmark()æ“ä½œ,ä½†æ˜¯å¯¹benchmark()çš„å…·ä½“å†…å®¹æ²¡æœ‰è¯´æ˜,è€Œæ˜¯å»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­æè¿°:\npublic class MethodBenchmark extends Benchmark { /** * çœŸæ­£å®šä¹‰benchmarkå†…å®¹ */ public void benchmark() { for (int i = 0; i \u0026lt; Integer.","title":"3.1 Template"},{"content":"Flyweight(äº«å…ƒæ¨¡å¼)å®šä¹‰ é¿å…å¤§é‡æ‹¥æœ‰ç›¸åŒå†…å®¹çš„å°ç±»çš„å¼€é”€(å¦‚è€—è´¹å†…å­˜),ä½¿å¤§å®¶å…±äº«ä¸€ä¸ªç±»(å…ƒç±»).\né‡ç‚¹ æœ¬è´¨factoryçš„å®ç°ï¼Œå·§å¦™çš„è®¾è®¡ã€‚ hashtable æˆ– hashmap æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨ ä¸ºä»€ä¹ˆä½¿ç”¨? é¢å‘å¯¹è±¡è¯­è¨€çš„åŸåˆ™å°±æ˜¯ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡,ä½†æ˜¯å¦‚æœçœŸæ­£ä½¿ç”¨èµ·æ¥,æœ‰æ—¶å¯¹è±¡æ•°å¯èƒ½æ˜¾å¾—å¾ˆåºå¤§,æ¯”å¦‚,å­—å¤„ç†è½¯ä»¶,å¦‚æœä»¥æ¯ä¸ªæ–‡å­—éƒ½ä½œä¸ºä¸€ä¸ªå¯¹è±¡,å‡ åƒä¸ªå­—,å¯¹è±¡æ•°å°±æ˜¯å‡ åƒ,æ— ç–‘è€—è´¹å†…å­˜,é‚£ä¹ˆæˆ‘ä»¬è¿˜æ˜¯è¦\u0026quot;æ±‚åŒå­˜å¼‚\u0026quot;,æ‰¾å‡ºè¿™äº›å¯¹è±¡ç¾¤çš„å…±åŒç‚¹,è®¾è®¡ä¸€ä¸ªå…ƒç±»,å°è£…å¯ä»¥è¢«å…±äº«çš„ç±»,å¦å¤–,è¿˜æœ‰ä¸€äº›ç‰¹æ€§æ˜¯å–å†³äºåº”ç”¨(context),æ˜¯ä¸å¯å…±äº«çš„,è¿™ä¹ŸFlyweightä¸­ä¸¤ä¸ªé‡è¦æ¦‚å¿µå†…éƒ¨çŠ¶æ€intrinsicå’Œå¤–éƒ¨çŠ¶æ€extrinsicä¹‹åˆ†.\nè¯´ç™½ç‚¹,å°±æ˜¯å…ˆæä¸€ä¸ªçš„åŸå§‹æ¨¡å‹,ç„¶åéšç€ä¸åŒåœºåˆå’Œç¯å¢ƒ,å†äº§ç”Ÿå„å…·ç‰¹å¾çš„å…·ä½“æ¨¡å‹,å¾ˆæ˜¾ç„¶,åœ¨è¿™é‡Œéœ€è¦äº§ç”Ÿä¸åŒçš„æ–°å¯¹è±¡,æ‰€ä»¥Flyweightæ¨¡å¼ä¸­å¸¸å‡ºç°Factoryæ¨¡å¼.Flyweightçš„å†…éƒ¨çŠ¶æ€æ˜¯ç”¨æ¥å…±äº«çš„,Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweight pool(æ¨¡å¼æ± )æ¥å­˜æ”¾å†…éƒ¨çŠ¶æ€çš„å¯¹è±¡.\nFlyweightæ¨¡å¼æ˜¯ä¸€ä¸ªæé«˜ç¨‹åºæ•ˆç‡å’Œæ€§èƒ½çš„æ¨¡å¼,ä¼šå¤§å¤§åŠ å¿«ç¨‹åºçš„è¿è¡Œé€Ÿåº¦.åº”ç”¨åœºåˆå¾ˆå¤š:æ¯”å¦‚ä½ è¦ä»ä¸€ä¸ªæ•°æ®åº“ä¸­è¯»å–ä¸€ç³»åˆ—å­—ç¬¦ä¸²,è¿™äº›å­—ç¬¦ä¸²ä¸­æœ‰è®¸å¤šæ˜¯é‡å¤çš„,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å­—ç¬¦ä¸²å‚¨å­˜åœ¨Flyweightæ± (pool)ä¸­.\nå¦‚ä½•ä½¿ç”¨?\næˆ‘ä»¬å…ˆä»FlyweightæŠ½è±¡æ¥å£å¼€å§‹:\npublic interface Flyweight { public void operation( ExtrinsicState state ); } //ç”¨äºæœ¬æ¨¡å¼çš„æŠ½è±¡æ•°æ®ç±»å‹(è‡ªè¡Œè®¾è®¡) public interface ExtrinsicState { }\nä¸‹é¢æ˜¯æ¥å£çš„å…·ä½“å®ç°(ConcreteFlyweight) ,å¹¶ä¸ºå†…éƒ¨çŠ¶æ€å¢åŠ å†…å­˜ç©ºé—´, ConcreteFlyweightå¿…é¡»æ˜¯å¯å…±äº«çš„,å®ƒä¿å­˜çš„ä»»ä½•çŠ¶æ€éƒ½å¿…é¡»æ˜¯å†…éƒ¨(intrinsic),ä¹Ÿå°±æ˜¯è¯´,ConcreteFlyweightå¿…é¡»å’Œå®ƒçš„åº”ç”¨ç¯å¢ƒåœºåˆæ— å…³.\npublic class ConcreteFlyweight implements Flyweight { private IntrinsicState state; public void operation( ExtrinsicState state ) { //å…·ä½“æ“ä½œ } } å½“ç„¶,å¹¶ä¸æ˜¯æ‰€æœ‰çš„Flyweightå…·ä½“å®ç°å­ç±»éƒ½éœ€è¦è¢«å…±äº«çš„,æ‰€ä»¥è¿˜æœ‰å¦å¤–ä¸€ç§ä¸å…±äº«çš„ConcreteFlyweight:\npublic class UnsharedConcreteFlyweight implements Flyweight { public void operation( ExtrinsicState state ) { } } Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweightæ± (å­˜æ”¾å†…éƒ¨çŠ¶æ€),å½“å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªå…±äº«Flyweightæ—¶,è¿™ä¸ªfactoryé¦–å…ˆæœç´¢æ± ä¸­æ˜¯å¦å·²ç»æœ‰å¯é€‚ç”¨çš„,å¦‚æœæœ‰,factoryåªæ˜¯ç®€å•è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡,å¦åˆ™,åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŠ å…¥åˆ°æ± ä¸­,å†è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡.æ± \npublic class FlyweightFactory { //Flyweight pool private Hashtable flyweights = new Hashtable(); public Flyweight getFlyweight( Object key ) { Flyweight flyweight = (Flyweight) flyweights.get(key); if( flyweight == null ) { //äº§ç”Ÿæ–°çš„ConcreteFlyweight flyweight = new ConcreteFlyweight(); flyweights.put( key, flyweight ); } return flyweight; } } è‡³æ­¤,Flyweightæ¨¡å¼çš„åŸºæœ¬æ¡†æ¶å·²ç»å°±ç»ª,æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è°ƒç”¨:\nFlyweightFactory factory = new FlyweightFactory(); Flyweight fly1 = factory.getFlyweight( \u0026ldquo;Fred\u0026rdquo; ); Flyweight fly2 = factory.getFlyweight( \u0026ldquo;Wilma\u0026rdquo; ); \u0026hellip;\u0026hellip;\nä»è°ƒç”¨ä¸Šçœ‹,å¥½è±¡æ˜¯ä¸ªçº¯ç²¹çš„Factoryä½¿ç”¨,ä½†å¥¥å¦™å°±åœ¨äºFactoryçš„å†…éƒ¨è®¾è®¡ä¸Š.\nFlyweightæ¨¡å¼åœ¨XMLç­‰æ•°æ®æºä¸­åº”ç”¨ æˆ‘ä»¬ä¸Šé¢å·²ç»æåˆ°,å½“å¤§é‡ä»æ•°æ®æºä¸­è¯»å–å­—ç¬¦ä¸²,å…¶ä¸­è‚¯å®šæœ‰é‡å¤çš„,é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨Flyweightæ¨¡å¼å¯ä»¥æé«˜æ•ˆç‡,ä»¥å”±ç‰‡CDä¸ºä¾‹,åœ¨ä¸€ä¸ªXMLæ–‡ä»¶ä¸­,å­˜æ”¾äº†å¤šä¸ªCDçš„èµ„æ–™.\næ¯ä¸ªCDæœ‰ä¸‰ä¸ªå­—æ®µ: 1.å‡ºç‰‡æ—¥æœŸ(year) 2.æ­Œå”±è€…å§“åç­‰ä¿¡æ¯(artist) 3.å”±ç‰‡æ›²ç›® (title)\nå…¶ä¸­,æ­Œå”±è€…å§“åæœ‰å¯èƒ½é‡å¤,ä¹Ÿå°±æ˜¯è¯´,å¯èƒ½æœ‰åŒä¸€ä¸ªæ¼”å”±è€…çš„å¤šä¸ªä¸åŒæ—¶æœŸ ä¸åŒæ›²ç›®çš„CD.æˆ‘ä»¬å°†\u0026quot;æ­Œå”±è€…å§“å\u0026quot;ä½œä¸ºå¯å…±äº«çš„ConcreteFlyweight.å…¶ä»–ä¸¤ä¸ªå­—æ®µä½œä¸ºUnsharedConcreteFlyweight.\né¦–å…ˆçœ‹çœ‹æ•°æ®æºXMLæ–‡ä»¶çš„å†…å®¹:\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;collection\u0026gt; \u0026lt;cd\u0026gt; \u0026lt;title\u0026gt;Another Green World\u0026lt;/title\u0026gt; \u0026lt;year\u0026gt;1978\u0026lt;/year\u0026gt; \u0026lt;artist\u0026gt;Eno, Brian\u0026lt;/artist\u0026gt; \u0026lt;/cd\u0026gt; \u0026lt;cd\u0026gt; \u0026lt;title\u0026gt;Greatest Hits\u0026lt;/title\u0026gt; \u0026lt;year\u0026gt;1950\u0026lt;/year\u0026gt; \u0026lt;artist\u0026gt;Holiday, Billie\u0026lt;/artist\u0026gt; \u0026lt;/cd\u0026gt; \u0026lt;cd\u0026gt; \u0026lt;title\u0026gt;Taking Tiger Mountain (by strategy)\u0026lt;/title\u0026gt; \u0026lt;year\u0026gt;1977\u0026lt;/year\u0026gt; \u0026lt;artist\u0026gt;Eno, Brian\u0026lt;/artist\u0026gt; \u0026lt;/cd\u0026gt; ....... \u0026lt;/collection\u0026gt; è™½ç„¶ä¸Šé¢ä¸¾ä¾‹CDåªæœ‰3å¼ ,CDå¯çœ‹æˆæ˜¯å¤§é‡é‡å¤çš„å°ç±»,å› ä¸ºå…¶ä¸­æˆåˆ†åªæœ‰ä¸‰ä¸ªå­—æ®µ,è€Œä¸”æœ‰é‡å¤çš„(æ­Œå”±è€…å§“å).\nCDå°±æ˜¯ç±»ä¼¼ä¸Šé¢æ¥å£ Flyweight:\npublic class CD { private String title; private int year; private Artist artist; public String getTitle() {ã€€return title;ã€€} public int getYear() {ã€€return year;ã€€} public Artist getArtist() {ã€€return artist;ã€€} public void setTitle(String t){ã€€title = t;} public void setYear(int y){year = y;} public void setArtist(Artist a){artist = a;} } å°†\u0026quot;æ­Œå”±è€…å§“å\u0026quot;ä½œä¸ºå¯å…±äº«çš„ConcreteFlyweight:\npublic class Artist { //å†…éƒ¨çŠ¶æ€ private String name; // note that Artist is immutable. String getName(){return name;} Artist(String n){ name = n; } } å†çœ‹çœ‹Flyweight factory,ä¸“é—¨ç”¨æ¥åˆ¶é€ ä¸Šé¢çš„å¯å…±äº«çš„ConcreteFlyweight:Artist\npublic class ArtistFactory { Hashtable pool = new Hashtable(); Artist getArtist(String key){ Artist result; result = (Artist)pool.get(key); ////äº§ç”Ÿæ–°çš„Artist if(result == null) { result = new Artist(key); pool.put(key,result); } return result; } } å½“ä½ æœ‰å‡ åƒå¼ ç”šè‡³æ›´å¤šCDæ—¶,Flyweightæ¨¡å¼å°†èŠ‚çœæ›´å¤šç©ºé—´,å…±äº«çš„flyweightè¶Šå¤š,ç©ºé—´èŠ‚çœä¹Ÿå°±è¶Šå¤§.\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.7-flyweight/","summary":"Flyweight(äº«å…ƒæ¨¡å¼)å®šä¹‰ é¿å…å¤§é‡æ‹¥æœ‰ç›¸åŒå†…å®¹çš„å°ç±»çš„å¼€é”€(å¦‚è€—è´¹å†…å­˜),ä½¿å¤§å®¶å…±äº«ä¸€ä¸ªç±»(å…ƒç±»).\né‡ç‚¹ æœ¬è´¨factoryçš„å®ç°ï¼Œå·§å¦™çš„è®¾è®¡ã€‚ hashtable æˆ– hashmap æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨ ä¸ºä»€ä¹ˆä½¿ç”¨? é¢å‘å¯¹è±¡è¯­è¨€çš„åŸåˆ™å°±æ˜¯ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡,ä½†æ˜¯å¦‚æœçœŸæ­£ä½¿ç”¨èµ·æ¥,æœ‰æ—¶å¯¹è±¡æ•°å¯èƒ½æ˜¾å¾—å¾ˆåºå¤§,æ¯”å¦‚,å­—å¤„ç†è½¯ä»¶,å¦‚æœä»¥æ¯ä¸ªæ–‡å­—éƒ½ä½œä¸ºä¸€ä¸ªå¯¹è±¡,å‡ åƒä¸ªå­—,å¯¹è±¡æ•°å°±æ˜¯å‡ åƒ,æ— ç–‘è€—è´¹å†…å­˜,é‚£ä¹ˆæˆ‘ä»¬è¿˜æ˜¯è¦\u0026quot;æ±‚åŒå­˜å¼‚\u0026quot;,æ‰¾å‡ºè¿™äº›å¯¹è±¡ç¾¤çš„å…±åŒç‚¹,è®¾è®¡ä¸€ä¸ªå…ƒç±»,å°è£…å¯ä»¥è¢«å…±äº«çš„ç±»,å¦å¤–,è¿˜æœ‰ä¸€äº›ç‰¹æ€§æ˜¯å–å†³äºåº”ç”¨(context),æ˜¯ä¸å¯å…±äº«çš„,è¿™ä¹ŸFlyweightä¸­ä¸¤ä¸ªé‡è¦æ¦‚å¿µå†…éƒ¨çŠ¶æ€intrinsicå’Œå¤–éƒ¨çŠ¶æ€extrinsicä¹‹åˆ†.\nè¯´ç™½ç‚¹,å°±æ˜¯å…ˆæä¸€ä¸ªçš„åŸå§‹æ¨¡å‹,ç„¶åéšç€ä¸åŒåœºåˆå’Œç¯å¢ƒ,å†äº§ç”Ÿå„å…·ç‰¹å¾çš„å…·ä½“æ¨¡å‹,å¾ˆæ˜¾ç„¶,åœ¨è¿™é‡Œéœ€è¦äº§ç”Ÿä¸åŒçš„æ–°å¯¹è±¡,æ‰€ä»¥Flyweightæ¨¡å¼ä¸­å¸¸å‡ºç°Factoryæ¨¡å¼.Flyweightçš„å†…éƒ¨çŠ¶æ€æ˜¯ç”¨æ¥å…±äº«çš„,Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweight pool(æ¨¡å¼æ± )æ¥å­˜æ”¾å†…éƒ¨çŠ¶æ€çš„å¯¹è±¡.\nFlyweightæ¨¡å¼æ˜¯ä¸€ä¸ªæé«˜ç¨‹åºæ•ˆç‡å’Œæ€§èƒ½çš„æ¨¡å¼,ä¼šå¤§å¤§åŠ å¿«ç¨‹åºçš„è¿è¡Œé€Ÿåº¦.åº”ç”¨åœºåˆå¾ˆå¤š:æ¯”å¦‚ä½ è¦ä»ä¸€ä¸ªæ•°æ®åº“ä¸­è¯»å–ä¸€ç³»åˆ—å­—ç¬¦ä¸²,è¿™äº›å­—ç¬¦ä¸²ä¸­æœ‰è®¸å¤šæ˜¯é‡å¤çš„,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å­—ç¬¦ä¸²å‚¨å­˜åœ¨Flyweightæ± (pool)ä¸­.\nå¦‚ä½•ä½¿ç”¨?\næˆ‘ä»¬å…ˆä»FlyweightæŠ½è±¡æ¥å£å¼€å§‹:\npublic interface Flyweight { public void operation( ExtrinsicState state ); } //ç”¨äºæœ¬æ¨¡å¼çš„æŠ½è±¡æ•°æ®ç±»å‹(è‡ªè¡Œè®¾è®¡) public interface ExtrinsicState { }\nä¸‹é¢æ˜¯æ¥å£çš„å…·ä½“å®ç°(ConcreteFlyweight) ,å¹¶ä¸ºå†…éƒ¨çŠ¶æ€å¢åŠ å†…å­˜ç©ºé—´, ConcreteFlyweightå¿…é¡»æ˜¯å¯å…±äº«çš„,å®ƒä¿å­˜çš„ä»»ä½•çŠ¶æ€éƒ½å¿…é¡»æ˜¯å†…éƒ¨(intrinsic),ä¹Ÿå°±æ˜¯è¯´,ConcreteFlyweightå¿…é¡»å’Œå®ƒçš„åº”ç”¨ç¯å¢ƒåœºåˆæ— å…³.\npublic class ConcreteFlyweight implements Flyweight { private IntrinsicState state; public void operation( ExtrinsicState state ) { //å…·ä½“æ“ä½œ } } å½“ç„¶,å¹¶ä¸æ˜¯æ‰€æœ‰çš„Flyweightå…·ä½“å®ç°å­ç±»éƒ½éœ€è¦è¢«å…±äº«çš„,æ‰€ä»¥è¿˜æœ‰å¦å¤–ä¸€ç§ä¸å…±äº«çš„ConcreteFlyweight:\npublic class UnsharedConcreteFlyweight implements Flyweight { public void operation( ExtrinsicState state ) { } } Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweightæ± (å­˜æ”¾å†…éƒ¨çŠ¶æ€),å½“å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªå…±äº«Flyweightæ—¶,è¿™ä¸ªfactoryé¦–å…ˆæœç´¢æ± ä¸­æ˜¯å¦å·²ç»æœ‰å¯é€‚ç”¨çš„,å¦‚æœæœ‰,factoryåªæ˜¯ç®€å•è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡,å¦åˆ™,åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŠ å…¥åˆ°æ± ä¸­,å†è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡.","title":"2.7 Flyweight"},{"content":"Bridge(æ¡¥æ¥æ¨¡å¼)å®šä¹‰ å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ’åˆ†å¼€æ¥,å„è‡ªç‹¬ç«‹,ä½†èƒ½åŠ¨æ€çš„ç»“åˆã€‚\nåœ¨é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬æ¦‚å¿µä¸­ï¼Œå¯¹è±¡è¿™ä¸ªæ¦‚å¿µå®é™…æ˜¯ç”±å±æ€§å’Œè¡Œä¸ºä¸¤ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œå±æ€§æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§é™æ­¢çš„ï¼Œæ˜¯ä¸€ç§æŠ½è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¡Œä¸ºæ˜¯åŒ…å«åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯ï¼Œåœ¨æœ‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›è¡Œä¸ºä¹Ÿè¿›è¡Œå½’ç±»ï¼Œå½¢æˆä¸€ä¸ªæ€»çš„è¡Œä¸ºæ¥å£ï¼Œè¿™å°±æ˜¯æ¡¥æ¨¡å¼çš„ç”¨å¤„ã€‚\né‡ç‚¹ å•ä¾‹æ¨¡å‹çš„ä½¿ç”¨å’Œ è°ƒç”¨ ä¸ºä»€ä¹ˆä½¿ç”¨? ä¸å¸Œæœ›æŠ½è±¡éƒ¨åˆ†å’Œè¡Œä¸ºæœ‰ä¸€ç§å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œè€Œæ˜¯åº”è¯¥å¯ä»¥åŠ¨æ€è”ç³»çš„ã€‚\nå¦‚æœä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£æœ‰å¤šä¸ªå…·ä½“å®ç°(å­ç±»ã€concrete subclass),è¿™äº›å­ç±»ä¹‹é—´å…³ç³»å¯èƒ½æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ:\nè¿™å¤šä¸ªå­ç±»ä¹‹é—´æ¦‚å¿µæ˜¯å¹¶åˆ—çš„,å¦‚å‰é¢ä¸¾ä¾‹,æ‰“æ¡©,æœ‰ä¸¤ä¸ªconcrete class:æ–¹å½¢æ¡©å’Œåœ†å½¢æ¡©;è¿™ä¸¤ä¸ªå½¢çŠ¶ä¸Šçš„æ¡©æ˜¯å¹¶åˆ—çš„,æ²¡æœ‰æ¦‚å¿µä¸Šçš„é‡å¤ã€‚\nè¿™å¤šä¸ªå­ç±»ä¹‹ä¸­æœ‰å†…å®¹æ¦‚å¿µä¸Šé‡å .é‚£ä¹ˆéœ€è¦æˆ‘ä»¬æŠŠæŠ½è±¡å…±åŒéƒ¨åˆ†å’Œè¡Œä¸ºå…±åŒéƒ¨åˆ†å„è‡ªç‹¬ç«‹å¼€æ¥,åŸæ¥æ˜¯å‡†å¤‡æ”¾åœ¨ä¸€ä¸ªæ¥å£é‡Œ,ç°åœ¨éœ€è¦è®¾è®¡ä¸¤ä¸ªæ¥å£ï¼šæŠ½è±¡æ¥å£å’Œè¡Œä¸ºæ¥å£ï¼Œåˆ†åˆ«æ”¾ç½®æŠ½è±¡å’Œè¡Œä¸º.\nä¾‹å¦‚,ä¸€æ¯å’–å•¡ä¸ºä¾‹,å­ç±»å®ç°ç±»ä¸ºå››ä¸ªï¼šä¸­æ¯åŠ å¥¶ã€å¤§æ¯åŠ å¥¶ã€ ä¸­æ¯ä¸åŠ å¥¶ã€å¤§æ¯ä¸åŠ å¥¶ã€‚\nä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼šä¸Šé¢å››ä¸ªå­ç±»ä¸­æœ‰æ¦‚å¿µé‡å ï¼Œå¯ä»å¦å¤–ä¸€ä¸ªè§’åº¦è¿›è¡Œè€ƒè™‘ï¼Œè¿™å››ä¸ªç±»å®é™…æ˜¯ä¸¤ä¸ªè§’è‰²çš„ç»„åˆï¼šæŠ½è±¡ å’Œè¡Œä¸ºï¼Œå…¶ä¸­æŠ½è±¡ä¸ºï¼šä¸­æ¯å’Œå¤§æ¯ï¼›è¡Œä¸ºä¸ºï¼šåŠ å¥¶ ä¸åŠ å¥¶ï¼ˆå¦‚åŠ æ©™æ± åŠ è‹¹æœæ±ï¼‰.\nå®ç°å››ä¸ªå­ç±»åœ¨æŠ½è±¡å’Œè¡Œä¸ºä¹‹é—´å‘ç”Ÿäº†å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œå¦‚æœä»¥ååŠ¨æ€å¢åŠ åŠ è‘¡è„æ±çš„è¡Œä¸ºï¼Œå°±å¿…é¡»å†å¢åŠ ä¸¤ä¸ªç±»ï¼šä¸­æ¯åŠ è‘¡è„æ±å’Œå¤§æ¯åŠ è‘¡è„æ±ã€‚æ˜¾ç„¶æ··ä¹±,æ‰©å±•æ€§æå·®ã€‚\né‚£æˆ‘ä»¬ä»åˆ†ç¦»æŠ½è±¡å’Œè¡Œä¸ºçš„è§’åº¦ï¼Œä½¿ç”¨Bridgeæ¨¡å¼æ¥å®ç°ã€‚\nå¦‚ä½•å®ç°? ä»¥ä¸Šé¢æåˆ°çš„å’–å•¡ ä¸ºä¾‹. æˆ‘ä»¬åŸæ¥æ‰“ç®—åªè®¾è®¡ä¸€ä¸ªæ¥å£(æŠ½è±¡ç±»),ä½¿ç”¨Bridgeæ¨¡å¼å,æˆ‘ä»¬éœ€è¦å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ†å¼€,åŠ å¥¶å’Œä¸åŠ å¥¶å±äºè¡Œä¸º,æˆ‘ä»¬å°†å®ƒä»¬æŠ½è±¡æˆä¸€ä¸ªä¸“é—¨çš„è¡Œä¸ºæ¥å£.\nå…ˆçœ‹çœ‹æŠ½è±¡éƒ¨åˆ†çš„æ¥å£ä»£ç :\npublic abstract class Coffee { CoffeeImp coffeeImp; public void setCoffeeImp() { this.CoffeeImp = CoffeeImpSingleton.getTheCoffeImp(); } public CoffeeImp getCoffeeImp() {return this.CoffeeImp;} public abstract void pourCoffee(); } å…¶ä¸­CoffeeImp æ˜¯åŠ ä¸åŠ å¥¶çš„è¡Œä¸ºæ¥å£,çœ‹å…¶ä»£ç å¦‚ä¸‹:\npublic abstract class CoffeeImp { public abstract void pourCoffeeImp(); } ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸¤ä¸ªæŠ½è±¡ç±»,ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å¯¹å…¶è¿›è¡Œç»§æ‰¿,å®ç°concrete class:\n//ä¸­æ¯ public class MediumCoffee extends Coffee { public MediumCoffee() {setCoffeeImp();} public void pourCoffee() { CoffeeImp coffeeImp = this.getCoffeeImp(); //æˆ‘ä»¬ä»¥é‡å¤æ¬¡æ•°æ¥è¯´æ˜æ˜¯å†²ä¸­æ¯è¿˜æ˜¯å¤§æ¯ ,é‡å¤2æ¬¡æ˜¯ä¸­æ¯ for (int i = 0; i \u0026lt; 2; i++) { coffeeImp.pourCoffeeImp(); } } } //å¤§æ¯ public class SuperSizeCoffee extends Coffee { public SuperSizeCoffee() {setCoffeeImp();} public void pourCoffee() { CoffeeImp coffeeImp = this.getCoffeeImp(); //æˆ‘ä»¬ä»¥é‡å¤æ¬¡æ•°æ¥è¯´æ˜æ˜¯å†²ä¸­æ¯è¿˜æ˜¯å¤§æ¯ ,é‡å¤5æ¬¡æ˜¯å¤§æ¯ for (int i = 0; i \u0026lt; 5; i++) { coffeeImp.pourCoffeeImp(); } } } ä¸Šé¢åˆ†åˆ«æ˜¯ä¸­æ¯å’Œå¤§æ¯çš„å…·ä½“å®ç°.ä¸‹é¢å†å¯¹è¡Œä¸ºCoffeeImpè¿›è¡Œç»§æ‰¿:\n//åŠ å¥¶ public class MilkCoffeeImp extends CoffeeImp { MilkCoffeeImp() {} public void pourCoffeeImp() { System.out.println(\u0026#34;åŠ äº†ç¾å‘³çš„ç‰›å¥¶\u0026#34;); } } //ä¸åŠ å¥¶ public class FragrantCoffeeImp extends CoffeeImp { FragrantCoffeeImp() {} public void pourCoffeeImp() { System.out.println(\u0026#34;ä»€ä¹ˆä¹Ÿæ²¡åŠ ,æ¸…é¦™\u0026#34;); } } Bridgeæ¨¡å¼çš„åŸºæœ¬æ¡†æ¶æˆ‘ä»¬å·²ç»æ­å¥½äº†,åˆ«å¿˜è®°å®šä¹‰ä¸­è¿˜æœ‰ä¸€å¥:åŠ¨æ€ç»“åˆ,æˆ‘ä»¬ç°åœ¨å¯ä»¥å–åˆ°è‡³å°‘å››ç§å’–å•¡: 1.ä¸­æ¯åŠ å¥¶ 2.ä¸­æ¯ä¸åŠ å¥¶ 3.å¤§æ¯åŠ å¥¶ 4.å¤§æ¯ä¸åŠ å¥¶\nçœ‹çœ‹æ˜¯å¦‚ä½•åŠ¨æ€ç»“åˆçš„,åœ¨ä½¿ç”¨ä¹‹å‰,æˆ‘ä»¬åšä¸ªå‡†å¤‡å·¥ä½œ,è®¾è®¡ä¸€ä¸ªå•æ€ç±»(Singleton)ç”¨æ¥holdå½“å‰çš„CoffeeImp:\npublic class CoffeeImpSingleton { private static CoffeeImp coffeeImp; public CoffeeImpSingleton(CoffeeImp coffeeImpIn) {this.coffeeImp = coffeeImpIn;} public static CoffeeImp getTheCoffeeImp() { return coffeeImp; } } çœ‹çœ‹ä¸­æ¯åŠ å¥¶ å’Œå¤§æ¯åŠ å¥¶ æ˜¯æ€ä¹ˆå‡ºæ¥çš„:\n//æ‹¿å‡ºç‰›å¥¶ CoffeeImpSingleton coffeeImpSingleton = new CoffeeImpSingleton(new MilkCoffeeImp()); //ä¸­æ¯åŠ å¥¶ MediumCoffee mediumCoffee = new MediumCoffee(); mediumCoffee.pourCoffee(); //å¤§æ¯åŠ å¥¶ SuperSizeCoffee superSizeCoffee = new SuperSizeCoffee(); superSizeCoffee.pourCoffee(); æ³¨æ„: Bridgeæ¨¡å¼çš„æ‰§è¡Œç±»å¦‚CoffeeImpå’ŒCoffeeæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³», æ­£ç¡®åˆ›å»ºCoffeeImpæ˜¯è¯¥æ¨¡å¼çš„å…³é”®ã€‚\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.6-bridge/","summary":"Bridge(æ¡¥æ¥æ¨¡å¼)å®šä¹‰ å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ’åˆ†å¼€æ¥,å„è‡ªç‹¬ç«‹,ä½†èƒ½åŠ¨æ€çš„ç»“åˆã€‚\nåœ¨é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬æ¦‚å¿µä¸­ï¼Œå¯¹è±¡è¿™ä¸ªæ¦‚å¿µå®é™…æ˜¯ç”±å±æ€§å’Œè¡Œä¸ºä¸¤ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œå±æ€§æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§é™æ­¢çš„ï¼Œæ˜¯ä¸€ç§æŠ½è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¡Œä¸ºæ˜¯åŒ…å«åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯ï¼Œåœ¨æœ‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›è¡Œä¸ºä¹Ÿè¿›è¡Œå½’ç±»ï¼Œå½¢æˆä¸€ä¸ªæ€»çš„è¡Œä¸ºæ¥å£ï¼Œè¿™å°±æ˜¯æ¡¥æ¨¡å¼çš„ç”¨å¤„ã€‚\né‡ç‚¹ å•ä¾‹æ¨¡å‹çš„ä½¿ç”¨å’Œ è°ƒç”¨ ä¸ºä»€ä¹ˆä½¿ç”¨? ä¸å¸Œæœ›æŠ½è±¡éƒ¨åˆ†å’Œè¡Œä¸ºæœ‰ä¸€ç§å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œè€Œæ˜¯åº”è¯¥å¯ä»¥åŠ¨æ€è”ç³»çš„ã€‚\nå¦‚æœä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£æœ‰å¤šä¸ªå…·ä½“å®ç°(å­ç±»ã€concrete subclass),è¿™äº›å­ç±»ä¹‹é—´å…³ç³»å¯èƒ½æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ:\nè¿™å¤šä¸ªå­ç±»ä¹‹é—´æ¦‚å¿µæ˜¯å¹¶åˆ—çš„,å¦‚å‰é¢ä¸¾ä¾‹,æ‰“æ¡©,æœ‰ä¸¤ä¸ªconcrete class:æ–¹å½¢æ¡©å’Œåœ†å½¢æ¡©;è¿™ä¸¤ä¸ªå½¢çŠ¶ä¸Šçš„æ¡©æ˜¯å¹¶åˆ—çš„,æ²¡æœ‰æ¦‚å¿µä¸Šçš„é‡å¤ã€‚\nè¿™å¤šä¸ªå­ç±»ä¹‹ä¸­æœ‰å†…å®¹æ¦‚å¿µä¸Šé‡å .é‚£ä¹ˆéœ€è¦æˆ‘ä»¬æŠŠæŠ½è±¡å…±åŒéƒ¨åˆ†å’Œè¡Œä¸ºå…±åŒéƒ¨åˆ†å„è‡ªç‹¬ç«‹å¼€æ¥,åŸæ¥æ˜¯å‡†å¤‡æ”¾åœ¨ä¸€ä¸ªæ¥å£é‡Œ,ç°åœ¨éœ€è¦è®¾è®¡ä¸¤ä¸ªæ¥å£ï¼šæŠ½è±¡æ¥å£å’Œè¡Œä¸ºæ¥å£ï¼Œåˆ†åˆ«æ”¾ç½®æŠ½è±¡å’Œè¡Œä¸º.\nä¾‹å¦‚,ä¸€æ¯å’–å•¡ä¸ºä¾‹,å­ç±»å®ç°ç±»ä¸ºå››ä¸ªï¼šä¸­æ¯åŠ å¥¶ã€å¤§æ¯åŠ å¥¶ã€ ä¸­æ¯ä¸åŠ å¥¶ã€å¤§æ¯ä¸åŠ å¥¶ã€‚\nä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼šä¸Šé¢å››ä¸ªå­ç±»ä¸­æœ‰æ¦‚å¿µé‡å ï¼Œå¯ä»å¦å¤–ä¸€ä¸ªè§’åº¦è¿›è¡Œè€ƒè™‘ï¼Œè¿™å››ä¸ªç±»å®é™…æ˜¯ä¸¤ä¸ªè§’è‰²çš„ç»„åˆï¼šæŠ½è±¡ å’Œè¡Œä¸ºï¼Œå…¶ä¸­æŠ½è±¡ä¸ºï¼šä¸­æ¯å’Œå¤§æ¯ï¼›è¡Œä¸ºä¸ºï¼šåŠ å¥¶ ä¸åŠ å¥¶ï¼ˆå¦‚åŠ æ©™æ± åŠ è‹¹æœæ±ï¼‰.\nå®ç°å››ä¸ªå­ç±»åœ¨æŠ½è±¡å’Œè¡Œä¸ºä¹‹é—´å‘ç”Ÿäº†å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œå¦‚æœä»¥ååŠ¨æ€å¢åŠ åŠ è‘¡è„æ±çš„è¡Œä¸ºï¼Œå°±å¿…é¡»å†å¢åŠ ä¸¤ä¸ªç±»ï¼šä¸­æ¯åŠ è‘¡è„æ±å’Œå¤§æ¯åŠ è‘¡è„æ±ã€‚æ˜¾ç„¶æ··ä¹±,æ‰©å±•æ€§æå·®ã€‚\né‚£æˆ‘ä»¬ä»åˆ†ç¦»æŠ½è±¡å’Œè¡Œä¸ºçš„è§’åº¦ï¼Œä½¿ç”¨Bridgeæ¨¡å¼æ¥å®ç°ã€‚\nå¦‚ä½•å®ç°? ä»¥ä¸Šé¢æåˆ°çš„å’–å•¡ ä¸ºä¾‹. æˆ‘ä»¬åŸæ¥æ‰“ç®—åªè®¾è®¡ä¸€ä¸ªæ¥å£(æŠ½è±¡ç±»),ä½¿ç”¨Bridgeæ¨¡å¼å,æˆ‘ä»¬éœ€è¦å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ†å¼€,åŠ å¥¶å’Œä¸åŠ å¥¶å±äºè¡Œä¸º,æˆ‘ä»¬å°†å®ƒä»¬æŠ½è±¡æˆä¸€ä¸ªä¸“é—¨çš„è¡Œä¸ºæ¥å£.\nå…ˆçœ‹çœ‹æŠ½è±¡éƒ¨åˆ†çš„æ¥å£ä»£ç :\npublic abstract class Coffee { CoffeeImp coffeeImp; public void setCoffeeImp() { this.CoffeeImp = CoffeeImpSingleton.getTheCoffeImp(); } public CoffeeImp getCoffeeImp() {return this.CoffeeImp;} public abstract void pourCoffee(); } å…¶ä¸­CoffeeImp æ˜¯åŠ ä¸åŠ å¥¶çš„è¡Œä¸ºæ¥å£,çœ‹å…¶ä»£ç å¦‚ä¸‹:\npublic abstract class CoffeeImp { public abstract void pourCoffeeImp(); } ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸¤ä¸ªæŠ½è±¡ç±»,ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å¯¹å…¶è¿›è¡Œç»§æ‰¿,å®ç°concrete class:\n//ä¸­æ¯ public class MediumCoffee extends Coffee { public MediumCoffee() {setCoffeeImp();} public void pourCoffee() { CoffeeImp coffeeImp = this.","title":"2.6 Bridge"},{"content":"Composite(ç»„åˆæ¨¡å¼)å®šä¹‰ å°†å¯¹è±¡ä»¥æ ‘å½¢ç»“æ„ç»„ç»‡èµ·æ¥,ä»¥è¾¾æˆâ€œéƒ¨åˆ†ï¼æ•´ä½“â€ çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§.\nCompositeæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œæƒ³åˆ°Compositeå°±åº”è¯¥æƒ³åˆ°æ ‘å½¢ç»“æ„å›¾ã€‚ç»„åˆä½“å†…è¿™äº›å¯¹è±¡éƒ½æœ‰å…±åŒæ¥å£,å½“ç»„åˆä½“ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ‰§è¡Œæ—¶ï¼ŒCompositeå°†éå†(Iterator)æ•´ä¸ªæ ‘å½¢ç»“æ„,å¯»æ‰¾åŒæ ·åŒ…å«è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡å¹¶å®ç°è°ƒç”¨æ‰§è¡Œã€‚å¯ä»¥ç”¨ç‰µä¸€åŠ¨ç™¾æ¥å½¢å®¹ã€‚\næ‰€ä»¥Compositeæ¨¡å¼ä½¿ç”¨åˆ°Iteratoræ¨¡å¼ï¼Œå’ŒChain of Responsibilityæ¨¡å¼ç±»ä¼¼ã€‚\næœ¬è´¨ å®šä¹‰ interface æˆ– abstract class\næ ¸å¿ƒ åœ¨class(ç»§æ‰¿æˆ–å®ç°) ä¸­ä½¿ç”¨äº† arraylist . å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ  å…¶ä»– å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€classï¼‰\nCompositeå¥½å¤„ ä½¿å®¢æˆ·ç«¯è°ƒç”¨ç®€å•ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´çš„ä½¿ç”¨ç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œç”¨æˆ·å°±ä¸å¿…å…³ç³»è‡ªå·±å¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œè¿™å°±ç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚ æ›´å®¹æ˜“åœ¨ç»„åˆä½“å†…åŠ å…¥å¯¹è±¡éƒ¨ä»¶. å®¢æˆ·ç«¯ä¸å¿…å› ä¸ºåŠ å…¥äº†æ–°çš„å¯¹è±¡éƒ¨ä»¶è€Œæ›´æ”¹ä»£ç ã€‚ å¦‚ä½•ä½¿ç”¨Composite é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é€šç”¨æ–¹å¼äº†ï¼Œå…¶ä»–è®¾è®¡æ¨¡å¼å¯¹æ¥å£å†…éƒ¨å®šä¹‰é™åˆ¶ä¸å¤šï¼ŒCompositeå´æœ‰ä¸ªè§„å®šï¼Œé‚£å°±æ˜¯è¦åœ¨æ¥å£å†…éƒ¨å®šä¹‰ä¸€ä¸ªç”¨äºè®¿é—®å’Œç®¡ç†Compositeç»„åˆä½“çš„å¯¹è±¡ä»¬ï¼ˆæˆ–ç§°éƒ¨ä»¶Componentï¼‰.\nä¸‹é¢çš„ä»£ç æ˜¯ä»¥æŠ½è±¡ç±»å®šä¹‰ï¼Œä¸€èˆ¬å°½é‡ç”¨æ¥å£interface,\npublic abstract class Equipment { private String name; //å®ä»· public abstract double netPrice(); //æŠ˜æ‰£ä»·æ ¼ public abstract double discountPrice(); //å¢åŠ éƒ¨ä»¶æ–¹æ³•ã€€public boolean add(Equipment equipment) { return false; } //åˆ é™¤éƒ¨ä»¶æ–¹æ³• public boolean remove(Equipment equipment) { return false; } //æ³¨æ„è¿™é‡Œï¼Œè¿™é‡Œå°±æä¾›ä¸€ç§ç”¨äºè®¿é—®ç»„åˆä½“ç±»çš„éƒ¨ä»¶æ–¹æ³•ã€‚ public Iterator iter() { return null; } public Equipment(final String name) { this.name=name; } } æŠ½è±¡ç±»Equipmentå°±æ˜¯Componentå®šä¹‰ï¼Œä»£è¡¨ç€ç»„åˆä½“ç±»çš„å¯¹è±¡ä»¬,Equipmentä¸­å®šä¹‰å‡ ä¸ªå…±åŒçš„æ–¹æ³•ã€‚\npublic class Disk extends Equipment { public Disk(String name) { super(name); } //å®šä¹‰Diskå®ä»·ä¸º1 public double netPrice() { return 1.; } //å®šä¹‰äº†diskæŠ˜æ‰£ä»·æ ¼æ˜¯0.5 å¯¹æŠ˜ã€‚ public double discountPrice() { return .5; } } Diskæ˜¯ç»„åˆä½“å†…çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–ç§°ä¸€ä¸ªéƒ¨ä»¶ï¼Œè¿™ä¸ªéƒ¨ä»¶æ˜¯ä¸ªå•ç‹¬å…ƒç´ ( Primitive)ã€‚ è¿˜æœ‰ä¸€ç§å¯èƒ½æ˜¯ï¼Œä¸€ä¸ªéƒ¨ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªç»„åˆä½“ï¼Œå°±æ˜¯è¯´è¿™ä¸ªéƒ¨ä»¶ä¸‹é¢è¿˜æœ‰\u0026rsquo;å„¿å­\u0026rsquo;ï¼Œè¿™æ˜¯æ ‘å½¢ç»“æ„ä¸­é€šå¸¸çš„æƒ…å†µï¼Œåº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚ç°åœ¨æˆ‘ä»¬å…ˆè¦å®šä¹‰è¿™ä¸ªç»„åˆä½“ï¼š\nabstract class CompositeEquipment extends Equipment { private int i=0; //å®šä¹‰ä¸€ä¸ªVector ç”¨æ¥å­˜æ”¾\u0026#39;å„¿å­\u0026#39; private Lsit equipment=new ArrayList(); public CompositeEquipment(String name) { super(name); } public boolean add(Equipment equipment) { this.equipment.add(equipment); return true; } public double netPrice() { double netPrice=0.; Iterator iter=equipment.iterator(); for(iter.hasNext()) netPrice+=((Equipment)iter.next()).netPrice(); return netPrice; } public double discountPrice() { double discountPrice=0.; Iterator iter=equipment.iterator(); for(iter.hasNext()) discountPrice+=((Equipment)iter.next()).discountPrice(); return discountPrice; } //æ³¨æ„è¿™é‡Œï¼Œè¿™é‡Œå°±æä¾›ç”¨äºè®¿é—®è‡ªå·±ç»„åˆä½“å†…çš„éƒ¨ä»¶æ–¹æ³•ã€‚ //ä¸Šé¢dIsk ä¹‹æ‰€ä»¥æ²¡æœ‰ï¼Œæ˜¯å› ä¸ºDiskæ˜¯ä¸ªå•ç‹¬(Primitive)çš„å…ƒç´ . public Iterator iter() { return equipment.iterator() ; { //é‡è½½Iteratoræ–¹æ³• public boolean hasNext() { return i\u0026lt;equipment.size(); } //é‡è½½Iteratoræ–¹æ³• public Object next() { if(hasNext()) return equipment.elementAt(i++); else throw new NoSuchElementException(); } } ä¸Šé¢CompositeEquipmentç»§æ‰¿äº†Equipment,åŒæ—¶ä¸ºè‡ªå·±é‡Œé¢çš„å¯¹è±¡ä»¬æä¾›äº†å¤–éƒ¨è®¿é—®çš„æ–¹æ³•,é‡è½½äº†Iterator,Iteratoræ˜¯Javaçš„Collectionçš„ä¸€ä¸ªæ¥å£ï¼Œæ˜¯Iteratoræ¨¡å¼çš„å®ç°.\næˆ‘ä»¬å†çœ‹çœ‹CompositeEquipmentçš„ä¸¤ä¸ªå…·ä½“ç±»:ç›˜ç›’Chassiså’Œç®±å­Cabinetï¼Œç®±å­é‡Œé¢å¯ä»¥æ”¾å¾ˆå¤šä¸œè¥¿ï¼Œå¦‚åº•æ¿ï¼Œç”µæºç›’ï¼Œç¡¬ç›˜ç›’ç­‰ï¼›ç›˜ç›’é‡Œé¢å¯ä»¥æ”¾ä¸€äº›å°è®¾å¤‡ï¼Œå¦‚ç¡¬ç›˜ è½¯é©±ç­‰ã€‚æ— ç–‘è¿™ä¸¤ä¸ªéƒ½æ˜¯å±äºç»„åˆä½“æ€§è´¨çš„ã€‚\npublic class Chassis extends CompositeEquipment { public Chassis(String name) { super(name); } public double netPrice() { return 1.+super.netPrice(); } public double discountPrice() { return .5+super.discountPrice(); } } public class Cabinet extends CompositeEquipment { public Cabinet(String name) { super(name); } public double netPrice() { return 1.+super.netPrice(); } public double discountPrice() { return .5+super.discountPrice(); } } è‡³æ­¤æˆ‘ä»¬å®Œæˆäº†æ•´ä¸ªCompositeæ¨¡å¼çš„æ¶æ„ã€‚\næˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®¢æˆ·ç«¯è°ƒç”¨Composoteä»£ç :\nCabinet cabinet=new Cabinet(\u0026#34;Tower\u0026#34;); Chassis chassis=new Chassis(\u0026#34;PC Chassis\u0026#34;); //å°†PC Chassisè£…åˆ°Towerä¸­ (å°†ç›˜ç›’è£…åˆ°ç®±å­é‡Œ) cabinet.add(chassis); //å°†ä¸€ä¸ª10GBçš„ç¡¬ç›˜è£…åˆ° PC Chassis (å°†ç¡¬ç›˜è£…åˆ°ç›˜ç›’é‡Œ) chassis.add(new Disk(\u0026#34;10 GB\u0026#34;)); //è°ƒç”¨ netPrice()æ–¹æ³•; System.out.println(\u0026#34;netPrice=\u0026#34;+cabinet.netPrice()); System.out.println(\u0026#34;discountPrice=\u0026#34;+cabinet.discountPrice()); ä¸Šé¢è°ƒç”¨çš„æ–¹æ³•netPrice()æˆ–discountPrice()ï¼Œå®é™…ä¸ŠCompositeä½¿ç”¨Iteratoréå†äº†æ•´ä¸ªæ ‘å½¢ç»“æ„,å¯»æ‰¾åŒæ ·åŒ…å«è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡å¹¶å®ç°è°ƒç”¨æ‰§è¡Œ.\nCompositeæ˜¯ä¸ªå¾ˆå·§å¦™ä½“ç°æ™ºæ…§çš„æ¨¡å¼ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœç¢°åˆ°æ ‘å½¢ç»“æ„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•æ˜¯å¦å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ã€‚\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.4-composite/","summary":"Composite(ç»„åˆæ¨¡å¼)å®šä¹‰ å°†å¯¹è±¡ä»¥æ ‘å½¢ç»“æ„ç»„ç»‡èµ·æ¥,ä»¥è¾¾æˆâ€œéƒ¨åˆ†ï¼æ•´ä½“â€ çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§.\nCompositeæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œæƒ³åˆ°Compositeå°±åº”è¯¥æƒ³åˆ°æ ‘å½¢ç»“æ„å›¾ã€‚ç»„åˆä½“å†…è¿™äº›å¯¹è±¡éƒ½æœ‰å…±åŒæ¥å£,å½“ç»„åˆä½“ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ‰§è¡Œæ—¶ï¼ŒCompositeå°†éå†(Iterator)æ•´ä¸ªæ ‘å½¢ç»“æ„,å¯»æ‰¾åŒæ ·åŒ…å«è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡å¹¶å®ç°è°ƒç”¨æ‰§è¡Œã€‚å¯ä»¥ç”¨ç‰µä¸€åŠ¨ç™¾æ¥å½¢å®¹ã€‚\næ‰€ä»¥Compositeæ¨¡å¼ä½¿ç”¨åˆ°Iteratoræ¨¡å¼ï¼Œå’ŒChain of Responsibilityæ¨¡å¼ç±»ä¼¼ã€‚\næœ¬è´¨ å®šä¹‰ interface æˆ– abstract class\næ ¸å¿ƒ åœ¨class(ç»§æ‰¿æˆ–å®ç°) ä¸­ä½¿ç”¨äº† arraylist . å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ  å…¶ä»– å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€classï¼‰\nCompositeå¥½å¤„ ä½¿å®¢æˆ·ç«¯è°ƒç”¨ç®€å•ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´çš„ä½¿ç”¨ç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œç”¨æˆ·å°±ä¸å¿…å…³ç³»è‡ªå·±å¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œè¿™å°±ç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚ æ›´å®¹æ˜“åœ¨ç»„åˆä½“å†…åŠ å…¥å¯¹è±¡éƒ¨ä»¶. å®¢æˆ·ç«¯ä¸å¿…å› ä¸ºåŠ å…¥äº†æ–°çš„å¯¹è±¡éƒ¨ä»¶è€Œæ›´æ”¹ä»£ç ã€‚ å¦‚ä½•ä½¿ç”¨Composite é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é€šç”¨æ–¹å¼äº†ï¼Œå…¶ä»–è®¾è®¡æ¨¡å¼å¯¹æ¥å£å†…éƒ¨å®šä¹‰é™åˆ¶ä¸å¤šï¼ŒCompositeå´æœ‰ä¸ªè§„å®šï¼Œé‚£å°±æ˜¯è¦åœ¨æ¥å£å†…éƒ¨å®šä¹‰ä¸€ä¸ªç”¨äºè®¿é—®å’Œç®¡ç†Compositeç»„åˆä½“çš„å¯¹è±¡ä»¬ï¼ˆæˆ–ç§°éƒ¨ä»¶Componentï¼‰.\nä¸‹é¢çš„ä»£ç æ˜¯ä»¥æŠ½è±¡ç±»å®šä¹‰ï¼Œä¸€èˆ¬å°½é‡ç”¨æ¥å£interface,\npublic abstract class Equipment { private String name; //å®ä»· public abstract double netPrice(); //æŠ˜æ‰£ä»·æ ¼ public abstract double discountPrice(); //å¢åŠ éƒ¨ä»¶æ–¹æ³•ã€€public boolean add(Equipment equipment) { return false; } //åˆ é™¤éƒ¨ä»¶æ–¹æ³• public boolean remove(Equipment equipment) { return false; } //æ³¨æ„è¿™é‡Œï¼Œè¿™é‡Œå°±æä¾›ä¸€ç§ç”¨äºè®¿é—®ç»„åˆä½“ç±»çš„éƒ¨ä»¶æ–¹æ³•ã€‚ public Iterator iter() { return null; } public Equipment(final String name) { this.","title":"2.4 Composite"},{"content":"Decorator(è£…é¥°è€…æ¨¡å¼) å®šä¹‰ åŠ¨æ€ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£,å°±è±¡åœ¨å¢™ä¸Šåˆ·æ²¹æ¼†.ä½¿ç”¨Decoratoræ¨¡å¼ç›¸æ¯”ç”¨ç”Ÿæˆå­ç±»æ–¹å¼è¾¾åˆ°åŠŸèƒ½çš„æ‰©å……æ˜¾å¾—æ›´ä¸ºçµæ´».\næœ¬è´¨ interface(ä¸€èˆ¬éƒ½è¦)\nä¸»è¦æ˜¯ç¼–å†™ è¢«è£…é¥°è€…ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åŠ å…¥è£…é¥°è€…ï¼Œç„¶ååœ¨è¢«è£…é¥°è€…ç±»ä¸­æ³¨æ„å¯¹è£…é¥°è€…ç±»çš„è°ƒç”¨\nä¸ºä»€ä¹ˆä½¿ç”¨Decorator? æˆ‘ä»¬é€šå¸¸å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥å®ç°åŠŸèƒ½çš„æ‹“å±•,å¦‚æœè¿™äº›éœ€è¦æ‹“å±•çš„åŠŸèƒ½çš„ç§ç±»å¾ˆç¹å¤š,é‚£ä¹ˆåŠ¿å¿…ç”Ÿæˆå¾ˆå¤šå­ç±»,å¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§,åŒæ—¶,ä½¿ç”¨ç»§æ‰¿å®ç°åŠŸèƒ½æ‹“å±•,æˆ‘ä»¬å¿…é¡»å¯é¢„è§è¿™äº›æ‹“å±•åŠŸèƒ½,è¿™äº›åŠŸèƒ½æ˜¯ç¼–è¯‘æ—¶å°±ç¡®å®šäº†,æ˜¯é™æ€çš„.\nä½¿ç”¨Decoratorçš„ç†ç”±æ˜¯:è¿™äº›åŠŸèƒ½éœ€è¦ç”±ç”¨æˆ·åŠ¨æ€å†³å®šåŠ å…¥çš„æ–¹å¼å’Œæ—¶æœº.Decoratoræä¾›äº†\u0026quot;å³æ’å³ç”¨\u0026quot;çš„æ–¹æ³•,åœ¨è¿è¡ŒæœŸé—´å†³å®šä½•æ—¶å¢åŠ ä½•ç§åŠŸèƒ½.\nå¦‚ä½•ä½¿ç”¨? ä¸¾Adapterä¸­çš„æ‰“æ¡©ç¤ºä¾‹,åœ¨Adapterä¸­æœ‰ä¸¤ç§ç±»:æ–¹å½¢æ¡© åœ†å½¢æ¡©,Adapteræ¨¡å¼å±•ç¤ºå¦‚ä½•ç»¼åˆä½¿ç”¨è¿™ä¸¤ä¸ªç±»,åœ¨Decoratoræ¨¡å¼ä¸­,æˆ‘ä»¬æ˜¯è¦åœ¨æ‰“æ¡©æ—¶å¢åŠ ä¸€äº›é¢å¤–åŠŸèƒ½,æ¯”å¦‚,æŒ–å‘ åœ¨æ¡©ä¸Šé’‰æœ¨æ¿ç­‰,ä¸å…³å¿ƒå¦‚ä½•ä½¿ç”¨ä¸¤ä¸ªä¸ç›¸å…³çš„ç±».\næˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªæ¥å£:\npublic interface Work { public void insert(); } æ¥å£Workæœ‰ä¸€ä¸ªå…·ä½“å®ç°:æ’å…¥æ–¹å½¢æ¡©æˆ–åœ†å½¢æ¡©,è¿™ä¸¤ä¸ªåŒºåˆ«å¯¹Decoratoræ˜¯æ— æ‰€è°“.æˆ‘ä»¬ä»¥æ’å…¥æ–¹å½¢æ¡©ä¸ºä¾‹:\npublic class SquarePeg implements Work{ public void insert(){ System.out.println(\u0026#34;æ–¹å½¢æ¡©æ’å…¥\u0026#34;); } } ç°åœ¨æœ‰ä¸€ä¸ªåº”ç”¨:éœ€è¦åœ¨æ¡©æ‰“å…¥å‰,æŒ–å‘,åœ¨æ‰“å…¥å,åœ¨æ¡©ä¸Šé’‰æœ¨æ¿,è¿™äº›é¢å¤–çš„åŠŸèƒ½æ˜¯åŠ¨æ€,å¯èƒ½éšæ„å¢åŠ è°ƒæ•´ä¿®æ”¹,æ¯”å¦‚,å¯èƒ½åˆéœ€è¦åœ¨æ‰“æ¡©ä¹‹åé’‰æ¶å­(åªæ˜¯æ¯”å–»).\né‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨Decoratoræ¨¡å¼,è¿™é‡Œæ–¹å½¢æ¡©SquarePegæ˜¯decoratee(è¢«åˆ·æ²¹æ¼†è€…),æˆ‘ä»¬éœ€è¦åœ¨decorateeä¸Šåˆ·äº›\u0026quot;æ²¹æ¼†\u0026quot;,è¿™äº›æ²¹æ¼†å°±æ˜¯é‚£äº›é¢å¤–çš„åŠŸèƒ½.\npublic class Decorator implements Work{ private Work work; //é¢å¤–å¢åŠ çš„åŠŸèƒ½è¢«æ‰“åŒ…åœ¨è¿™ä¸ªListä¸­ private ArrayList others = new ArrayList(); //åœ¨æ„é€ å™¨ä¸­ä½¿ç”¨ç»„åˆnewæ–¹å¼,å¼•å…¥Workå¯¹è±¡; public Decorator(Work work) { this.work=work; others.add(\u0026#34;æŒ–å‘\u0026#34;); others.add(\u0026#34;é’‰æœ¨æ¿\u0026#34;); } public void insert(){ newMethod(); } //åœ¨æ–°æ–¹æ³•ä¸­,æˆ‘ä»¬åœ¨insertä¹‹å‰å¢åŠ å…¶ä»–æ–¹æ³•,è¿™é‡Œæ¬¡åºå…ˆåæ˜¯ç”¨æˆ·çµæ´»æŒ‡å®šçš„ public void newMethod() { otherMethod(); work.insert(); } public void otherMethod() { ListIterator listIterator = others.listIterator(); while (listIterator.hasNext()) { System.out.println(((String)(listIterator.next())) + \u0026#34; æ­£åœ¨è¿›è¡Œ\u0026#34;); } } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬æŠŠæŒ–å‘å’Œé’‰æœ¨æ¿éƒ½æ’åœ¨äº†æ‰“æ¡©insertå‰é¢,è¿™é‡Œåªæ˜¯ä¸¾ä¾‹è¯´æ˜é¢å¤–åŠŸèƒ½æ¬¡åºå¯ä»¥ä»»æ„å®‰æ’.\nå¥½äº†,Decoratoræ¨¡å¼å‡ºæ¥äº†,æˆ‘ä»¬çœ‹å¦‚ä½•è°ƒç”¨:\nWork squarePeg = new SquarePeg(); Work decorator = new Decorator(squarePeg); decorator.insert(); Decoratoræ¨¡å¼è‡³æ­¤å®Œæˆ.\nå¦‚æœä½ ç»†å¿ƒ,ä¼šå‘ç°,ä¸Šé¢è°ƒç”¨ç±»ä¼¼æˆ‘ä»¬è¯»å–æ–‡ä»¶æ—¶çš„è°ƒç”¨:\nFileReader fr = new FileReader(filename); BufferedReader br = new BufferedReader(fr);\nå®é™…ä¸ŠJava çš„I/O APIå°±æ˜¯ä½¿ç”¨Decoratorå®ç°çš„,I/Oå˜ç§å¾ˆå¤š,å¦‚æœéƒ½é‡‡å–ç»§æ‰¿æ–¹æ³•,å°†ä¼šäº§ç”Ÿå¾ˆå¤šå­ç±»,æ˜¾ç„¶ç›¸å½“ç¹ç.\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.5-decorator/","summary":"Decorator(è£…é¥°è€…æ¨¡å¼) å®šä¹‰ åŠ¨æ€ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£,å°±è±¡åœ¨å¢™ä¸Šåˆ·æ²¹æ¼†.ä½¿ç”¨Decoratoræ¨¡å¼ç›¸æ¯”ç”¨ç”Ÿæˆå­ç±»æ–¹å¼è¾¾åˆ°åŠŸèƒ½çš„æ‰©å……æ˜¾å¾—æ›´ä¸ºçµæ´».\næœ¬è´¨ interface(ä¸€èˆ¬éƒ½è¦)\nä¸»è¦æ˜¯ç¼–å†™ è¢«è£…é¥°è€…ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åŠ å…¥è£…é¥°è€…ï¼Œç„¶ååœ¨è¢«è£…é¥°è€…ç±»ä¸­æ³¨æ„å¯¹è£…é¥°è€…ç±»çš„è°ƒç”¨\nä¸ºä»€ä¹ˆä½¿ç”¨Decorator? æˆ‘ä»¬é€šå¸¸å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥å®ç°åŠŸèƒ½çš„æ‹“å±•,å¦‚æœè¿™äº›éœ€è¦æ‹“å±•çš„åŠŸèƒ½çš„ç§ç±»å¾ˆç¹å¤š,é‚£ä¹ˆåŠ¿å¿…ç”Ÿæˆå¾ˆå¤šå­ç±»,å¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§,åŒæ—¶,ä½¿ç”¨ç»§æ‰¿å®ç°åŠŸèƒ½æ‹“å±•,æˆ‘ä»¬å¿…é¡»å¯é¢„è§è¿™äº›æ‹“å±•åŠŸèƒ½,è¿™äº›åŠŸèƒ½æ˜¯ç¼–è¯‘æ—¶å°±ç¡®å®šäº†,æ˜¯é™æ€çš„.\nä½¿ç”¨Decoratorçš„ç†ç”±æ˜¯:è¿™äº›åŠŸèƒ½éœ€è¦ç”±ç”¨æˆ·åŠ¨æ€å†³å®šåŠ å…¥çš„æ–¹å¼å’Œæ—¶æœº.Decoratoræä¾›äº†\u0026quot;å³æ’å³ç”¨\u0026quot;çš„æ–¹æ³•,åœ¨è¿è¡ŒæœŸé—´å†³å®šä½•æ—¶å¢åŠ ä½•ç§åŠŸèƒ½.\nå¦‚ä½•ä½¿ç”¨? ä¸¾Adapterä¸­çš„æ‰“æ¡©ç¤ºä¾‹,åœ¨Adapterä¸­æœ‰ä¸¤ç§ç±»:æ–¹å½¢æ¡© åœ†å½¢æ¡©,Adapteræ¨¡å¼å±•ç¤ºå¦‚ä½•ç»¼åˆä½¿ç”¨è¿™ä¸¤ä¸ªç±»,åœ¨Decoratoræ¨¡å¼ä¸­,æˆ‘ä»¬æ˜¯è¦åœ¨æ‰“æ¡©æ—¶å¢åŠ ä¸€äº›é¢å¤–åŠŸèƒ½,æ¯”å¦‚,æŒ–å‘ åœ¨æ¡©ä¸Šé’‰æœ¨æ¿ç­‰,ä¸å…³å¿ƒå¦‚ä½•ä½¿ç”¨ä¸¤ä¸ªä¸ç›¸å…³çš„ç±».\næˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªæ¥å£:\npublic interface Work { public void insert(); } æ¥å£Workæœ‰ä¸€ä¸ªå…·ä½“å®ç°:æ’å…¥æ–¹å½¢æ¡©æˆ–åœ†å½¢æ¡©,è¿™ä¸¤ä¸ªåŒºåˆ«å¯¹Decoratoræ˜¯æ— æ‰€è°“.æˆ‘ä»¬ä»¥æ’å…¥æ–¹å½¢æ¡©ä¸ºä¾‹:\npublic class SquarePeg implements Work{ public void insert(){ System.out.println(\u0026#34;æ–¹å½¢æ¡©æ’å…¥\u0026#34;); } } ç°åœ¨æœ‰ä¸€ä¸ªåº”ç”¨:éœ€è¦åœ¨æ¡©æ‰“å…¥å‰,æŒ–å‘,åœ¨æ‰“å…¥å,åœ¨æ¡©ä¸Šé’‰æœ¨æ¿,è¿™äº›é¢å¤–çš„åŠŸèƒ½æ˜¯åŠ¨æ€,å¯èƒ½éšæ„å¢åŠ è°ƒæ•´ä¿®æ”¹,æ¯”å¦‚,å¯èƒ½åˆéœ€è¦åœ¨æ‰“æ¡©ä¹‹åé’‰æ¶å­(åªæ˜¯æ¯”å–»).\né‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨Decoratoræ¨¡å¼,è¿™é‡Œæ–¹å½¢æ¡©SquarePegæ˜¯decoratee(è¢«åˆ·æ²¹æ¼†è€…),æˆ‘ä»¬éœ€è¦åœ¨decorateeä¸Šåˆ·äº›\u0026quot;æ²¹æ¼†\u0026quot;,è¿™äº›æ²¹æ¼†å°±æ˜¯é‚£äº›é¢å¤–çš„åŠŸèƒ½.\npublic class Decorator implements Work{ private Work work; //é¢å¤–å¢åŠ çš„åŠŸèƒ½è¢«æ‰“åŒ…åœ¨è¿™ä¸ªListä¸­ private ArrayList others = new ArrayList(); //åœ¨æ„é€ å™¨ä¸­ä½¿ç”¨ç»„åˆnewæ–¹å¼,å¼•å…¥Workå¯¹è±¡; public Decorator(Work work) { this.work=work; others.add(\u0026#34;æŒ–å‘\u0026#34;); others.add(\u0026#34;é’‰æœ¨æ¿\u0026#34;); } public void insert(){ newMethod(); } //åœ¨æ–°æ–¹æ³•ä¸­,æˆ‘ä»¬åœ¨insertä¹‹å‰å¢åŠ å…¶ä»–æ–¹æ³•,è¿™é‡Œæ¬¡åºå…ˆåæ˜¯ç”¨æˆ·çµæ´»æŒ‡å®šçš„ public void newMethod() { otherMethod(); work.","title":"2.5 Decorator"},{"content":"Adapter(é€‚é…è€…æ¨¡å¼) å®šä¹‰ å°†ä¸¤ä¸ªä¸å…¼å®¹çš„ç±»çº åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå±äºç»“æ„å‹æ¨¡å¼,éœ€è¦æœ‰Adaptee(è¢«é€‚é…è€…)å’ŒAdaptor(é€‚é…å™¨)ä¸¤ä¸ªèº«ä»½.\nä¸ºä½•ä½¿ç”¨? æˆ‘ä»¬ç»å¸¸ç¢°åˆ°è¦å°†ä¸¤ä¸ªæ²¡æœ‰å…³ç³»çš„ç±»ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨,ç¬¬ä¸€è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä¿®æ”¹å„è‡ªç±»çš„æ¥å£ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰æºä»£ç ï¼Œæˆ–è€…ï¼Œæˆ‘ä»¬ä¸æ„¿æ„ä¸ºäº†ä¸€ä¸ªåº”ç”¨è€Œä¿®æ”¹å„è‡ªçš„æ¥å£ã€‚ æ€ä¹ˆåŠ?\nä½¿ç”¨Adapterï¼Œåœ¨è¿™ä¸¤ç§æ¥å£ä¹‹é—´åˆ›å»ºä¸€ä¸ªæ··åˆæ¥å£(æ··è¡€å„¿).\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.3-adapter/","summary":"Adapter(é€‚é…è€…æ¨¡å¼) å®šä¹‰ å°†ä¸¤ä¸ªä¸å…¼å®¹çš„ç±»çº åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå±äºç»“æ„å‹æ¨¡å¼,éœ€è¦æœ‰Adaptee(è¢«é€‚é…è€…)å’ŒAdaptor(é€‚é…å™¨)ä¸¤ä¸ªèº«ä»½.\nä¸ºä½•ä½¿ç”¨? æˆ‘ä»¬ç»å¸¸ç¢°åˆ°è¦å°†ä¸¤ä¸ªæ²¡æœ‰å…³ç³»çš„ç±»ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨,ç¬¬ä¸€è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä¿®æ”¹å„è‡ªç±»çš„æ¥å£ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰æºä»£ç ï¼Œæˆ–è€…ï¼Œæˆ‘ä»¬ä¸æ„¿æ„ä¸ºäº†ä¸€ä¸ªåº”ç”¨è€Œä¿®æ”¹å„è‡ªçš„æ¥å£ã€‚ æ€ä¹ˆåŠ?\nä½¿ç”¨Adapterï¼Œåœ¨è¿™ä¸¤ç§æ¥å£ä¹‹é—´åˆ›å»ºä¸€ä¸ªæ··åˆæ¥å£(æ··è¡€å„¿).","title":"2.3 Adapter"},{"content":"Proxy(ä»£ç†æ¨¡å¼)å®šä¹‰ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®.\nä»£ç†æ¨¡å¼æ˜¯æ¯”è¾ƒæœ‰ç”¨é€”çš„ä¸€ç§æ¨¡å¼,è€Œä¸”å˜ç§è¾ƒå¤š,åº”ç”¨åœºåˆè¦†ç›–ä»å°ç»“æ„åˆ°æ•´ä¸ªç³»ç»Ÿçš„å¤§ç»“æ„,Proxyæ˜¯ä»£ç†çš„æ„æ€,æˆ‘ä»¬ä¹Ÿè®¸æœ‰ä»£ç†æœåŠ¡å™¨ç­‰æ¦‚å¿µ,ä»£ç†æ¦‚å¿µå¯ä»¥è§£é‡Šä¸º:åœ¨å‡ºå‘ç‚¹åˆ°ç›®çš„åœ°ä¹‹é—´æœ‰ä¸€é“ä¸­é—´å±‚,æ„ä¸ºä»£ç†.\nä¸ºä»€ä¹ˆè¦ä½¿ç”¨Proxy? æˆæƒæœºåˆ¶ ä¸åŒçº§åˆ«çš„ç”¨æˆ·å¯¹åŒä¸€å¯¹è±¡æ‹¥æœ‰ä¸åŒçš„è®¿é—®æƒåˆ©,å¦‚Jiveè®ºå›ç³»ç»Ÿä¸­,å°±ä½¿ç”¨Proxyè¿›è¡Œæˆæƒæœºåˆ¶æ§åˆ¶,è®¿é—®è®ºå›æœ‰ä¸¤ç§äºº:æ³¨å†Œç”¨æˆ·å’Œæ¸¸å®¢(æœªæ³¨å†Œç”¨æˆ·),Jiveä¸­å°±é€šè¿‡ç±»ä¼¼ForumProxyè¿™æ ·çš„ä»£ç†æ¥æ§åˆ¶è¿™ä¸¤ç§ç”¨æˆ·å¯¹è®ºå›çš„è®¿é—®æƒé™.\næŸä¸ªå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥æ“ä½œåˆ°æŸä¸ªå¯¹è±¡,ä½†åˆå¿…é¡»å’Œé‚£ä¸ªå¯¹è±¡æœ‰æ‰€äº’åŠ¨. ä¸¾ä¾‹ä¸¤ä¸ªå…·ä½“æƒ…å†µ:\nå¦‚æœé‚£ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªæ˜¯å¾ˆå¤§çš„å›¾ç‰‡,éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥,é‚£ä¹ˆå½“è¿™ä¸ªå›¾ç‰‡åŒ…å«åœ¨æ–‡æ¡£ä¸­æ—¶,ä½¿ç”¨ç¼–è¾‘å™¨æˆ–æµè§ˆå™¨æ‰“å¼€è¿™ä¸ªæ–‡æ¡£,æ‰“å¼€æ–‡æ¡£å¿…é¡»å¾ˆè¿…é€Ÿ,ä¸èƒ½ç­‰å¾…å¤§å›¾ç‰‡å¤„ç†å®Œæˆ,è¿™æ—¶éœ€è¦åšä¸ªå›¾ç‰‡Proxyæ¥ä»£æ›¿çœŸæ­£çš„å›¾ç‰‡. å¦‚æœé‚£ä¸ªå¯¹è±¡åœ¨Internetçš„æŸä¸ªè¿œç«¯æœåŠ¡å™¨ä¸Š,ç›´æ¥æ“ä½œè¿™ä¸ªå¯¹è±¡å› ä¸ºç½‘ç»œé€Ÿåº¦åŸå› å¯èƒ½æ¯”è¾ƒæ…¢,é‚£æˆ‘ä»¬å¯ä»¥å…ˆç”¨Proxyæ¥ä»£æ›¿é‚£ä¸ªå¯¹è±¡. æ€»ä¹‹åŸåˆ™æ˜¯,å¯¹äºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡,åªæœ‰åœ¨ä½¿ç”¨å®ƒæ—¶æ‰åˆ›å»º,è¿™ä¸ªåŸåˆ™å¯ä»¥ä¸ºæˆ‘ä»¬èŠ‚çœå¾ˆå¤šå®è´µçš„Javaå†…å­˜. æ‰€ä»¥,æœ‰äº›äººè®¤ä¸ºJavaè€—è´¹èµ„æºå†…å­˜,æˆ‘ä»¥ä¸ºè¿™å’Œç¨‹åºç¼–åˆ¶æ€è·¯ä¹Ÿæœ‰ä¸€å®šçš„å…³ç³».\nå¦‚ä½•ä½¿ç”¨Proxy? ä»¥Jiveè®ºå›ç³»ç»Ÿä¸ºä¾‹,è®¿é—®è®ºå›ç³»ç»Ÿçš„ç”¨æˆ·æœ‰å¤šç§ç±»å‹:æ³¨å†Œæ™®é€šç”¨æˆ· è®ºå›ç®¡ç†è€… ç³»ç»Ÿç®¡ç†è€… æ¸¸å®¢,æ³¨å†Œæ™®é€šç”¨æˆ·æ‰èƒ½å‘è¨€;è®ºå›ç®¡ç†è€…å¯ä»¥ç®¡ç†ä»–è¢«æˆæƒçš„è®ºå›;ç³»ç»Ÿç®¡ç†è€…å¯ä»¥ç®¡ç†æ‰€æœ‰äº‹åŠ¡ç­‰,è¿™äº›æƒé™åˆ’åˆ†å’Œç®¡ç†æ˜¯ä½¿ç”¨Proxyå®Œæˆçš„.\nForumæ˜¯Jiveçš„æ ¸å¿ƒæ¥å£,åœ¨Forumä¸­é™ˆåˆ—äº†æœ‰å…³è®ºå›æ“ä½œçš„ä¸»è¦è¡Œä¸º,å¦‚è®ºå›åç§° è®ºå›æè¿°çš„è·å–å’Œä¿®æ”¹,å¸–å­å‘è¡¨åˆ é™¤ç¼–è¾‘ç­‰.\nåœ¨ForumPermissionsä¸­å®šä¹‰äº†å„ç§çº§åˆ«æƒé™çš„ç”¨æˆ·:\npublic class ForumPermissions implements Cacheable { /** * Permission to read object. */ public static final int READ = 0; /** * Permission to administer the entire sytem. */ public static final int SYSTEM_ADMIN = 1; /** * Permission to administer a particular forum. */ public static final int FORUM_ADMIN = 2; /** * Permission to administer a particular user. */ public static final int USER_ADMIN = 3; /** * Permission to administer a particular group. */ public static final int GROUP_ADMIN = 4; /** * Permission to moderate threads. */ public static final int MODERATE_THREADS = 5; /** * Permission to create a new thread. */ public static final int CREATE_THREAD = 6; /** * Permission to create a new message. */ public static final int CREATE_MESSAGE = 7; /** * Permission to moderate messages. */ public static final int MODERATE_MESSAGES = 8; ..... public boolean isSystemOrForumAdmin() { return (values[FORUM_ADMIN] || values[SYSTEM_ADMIN]); } ..... } å› æ­¤,Forumä¸­å„ç§æ“ä½œæƒé™æ˜¯å’ŒForumPermissionså®šä¹‰çš„ç”¨æˆ·çº§åˆ«æœ‰å…³ç³»çš„,ä½œä¸ºæ¥å£Forumçš„å®ç°:ForumProxyæ­£æ˜¯å°†è¿™ç§å¯¹åº”å…³ç³»è”ç³»èµ·æ¥.æ¯”å¦‚,ä¿®æ”¹Forumçš„åç§°,åªæœ‰è®ºå›ç®¡ç†è€…æˆ–ç³»ç»Ÿç®¡ç†è€…å¯ä»¥ä¿®æ”¹,ä»£ç å¦‚ä¸‹:\npublic class ForumProxy implements Forum { private ForumPermissions permissions; private Forum forum; this.authorization = authorization; public ForumProxy(Forum forum, Authorization authorization, ForumPermissions permissions) { this.forum = forum; this.authorization = authorization; this.permissions = permissions; } ..... public void setName(String name) throws UnauthorizedException, ForumAlreadyExistsException { //åªæœ‰æ˜¯ç³»ç»Ÿæˆ–è®ºå›ç®¡ç†è€…æ‰å¯ä»¥ä¿®æ”¹åç§° if (permissions.isSystemOrForumAdmin()) { forum.setName(name); } else { throw new UnauthorizedException(); } } ... } è€ŒDbForumæ‰æ˜¯æ¥å£Forumçš„çœŸæ­£å®ç°,ä»¥ä¿®æ”¹è®ºå›åç§°ä¸ºä¾‹:\npublic class DbForum implements Forum, Cacheable { ... public void setName(String name) throws ForumAlreadyExistsException { .... this.name = name; //è¿™é‡ŒçœŸæ­£å°†æ–°åç§°ä¿å­˜åˆ°æ•°æ®åº“ä¸­ saveToDb(); .... } ... } å‡¡æ˜¯æ¶‰åŠåˆ°å¯¹è®ºå›åç§°ä¿®æ”¹è¿™ä¸€äº‹ä»¶,å…¶ä»–ç¨‹åºéƒ½é¦–å…ˆå¾—å’ŒForumProxyæ‰“äº¤é“,ç”±ForumProxyå†³å®šæ˜¯å¦æœ‰æƒé™åšæŸä¸€æ ·äº‹æƒ…,ForumProxyæ˜¯ä¸ªåå‰¯å…¶å®çš„\u0026quot;ç½‘å…³\u0026quot;,\u0026ldquo;å®‰å…¨ä»£ç†ç³»ç»Ÿ\u0026rdquo;.\nåœ¨å¹³æ—¶åº”ç”¨ä¸­,æ— å¯é¿å…æ€»è¦æ¶‰åŠåˆ°ç³»ç»Ÿçš„æˆæƒæˆ–å®‰å…¨ä½“ç³»,ä¸ç®¡ä½ æœ‰æ— æ„è¯†çš„ä½¿ç”¨Proxy,å®é™…ä½ å·²ç»åœ¨ä½¿ç”¨Proxyäº†.\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.2-proxy/","summary":"Proxy(ä»£ç†æ¨¡å¼)å®šä¹‰ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®.\nä»£ç†æ¨¡å¼æ˜¯æ¯”è¾ƒæœ‰ç”¨é€”çš„ä¸€ç§æ¨¡å¼,è€Œä¸”å˜ç§è¾ƒå¤š,åº”ç”¨åœºåˆè¦†ç›–ä»å°ç»“æ„åˆ°æ•´ä¸ªç³»ç»Ÿçš„å¤§ç»“æ„,Proxyæ˜¯ä»£ç†çš„æ„æ€,æˆ‘ä»¬ä¹Ÿè®¸æœ‰ä»£ç†æœåŠ¡å™¨ç­‰æ¦‚å¿µ,ä»£ç†æ¦‚å¿µå¯ä»¥è§£é‡Šä¸º:åœ¨å‡ºå‘ç‚¹åˆ°ç›®çš„åœ°ä¹‹é—´æœ‰ä¸€é“ä¸­é—´å±‚,æ„ä¸ºä»£ç†.\nä¸ºä»€ä¹ˆè¦ä½¿ç”¨Proxy? æˆæƒæœºåˆ¶ ä¸åŒçº§åˆ«çš„ç”¨æˆ·å¯¹åŒä¸€å¯¹è±¡æ‹¥æœ‰ä¸åŒçš„è®¿é—®æƒåˆ©,å¦‚Jiveè®ºå›ç³»ç»Ÿä¸­,å°±ä½¿ç”¨Proxyè¿›è¡Œæˆæƒæœºåˆ¶æ§åˆ¶,è®¿é—®è®ºå›æœ‰ä¸¤ç§äºº:æ³¨å†Œç”¨æˆ·å’Œæ¸¸å®¢(æœªæ³¨å†Œç”¨æˆ·),Jiveä¸­å°±é€šè¿‡ç±»ä¼¼ForumProxyè¿™æ ·çš„ä»£ç†æ¥æ§åˆ¶è¿™ä¸¤ç§ç”¨æˆ·å¯¹è®ºå›çš„è®¿é—®æƒé™.\næŸä¸ªå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥æ“ä½œåˆ°æŸä¸ªå¯¹è±¡,ä½†åˆå¿…é¡»å’Œé‚£ä¸ªå¯¹è±¡æœ‰æ‰€äº’åŠ¨. ä¸¾ä¾‹ä¸¤ä¸ªå…·ä½“æƒ…å†µ:\nå¦‚æœé‚£ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªæ˜¯å¾ˆå¤§çš„å›¾ç‰‡,éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥,é‚£ä¹ˆå½“è¿™ä¸ªå›¾ç‰‡åŒ…å«åœ¨æ–‡æ¡£ä¸­æ—¶,ä½¿ç”¨ç¼–è¾‘å™¨æˆ–æµè§ˆå™¨æ‰“å¼€è¿™ä¸ªæ–‡æ¡£,æ‰“å¼€æ–‡æ¡£å¿…é¡»å¾ˆè¿…é€Ÿ,ä¸èƒ½ç­‰å¾…å¤§å›¾ç‰‡å¤„ç†å®Œæˆ,è¿™æ—¶éœ€è¦åšä¸ªå›¾ç‰‡Proxyæ¥ä»£æ›¿çœŸæ­£çš„å›¾ç‰‡. å¦‚æœé‚£ä¸ªå¯¹è±¡åœ¨Internetçš„æŸä¸ªè¿œç«¯æœåŠ¡å™¨ä¸Š,ç›´æ¥æ“ä½œè¿™ä¸ªå¯¹è±¡å› ä¸ºç½‘ç»œé€Ÿåº¦åŸå› å¯èƒ½æ¯”è¾ƒæ…¢,é‚£æˆ‘ä»¬å¯ä»¥å…ˆç”¨Proxyæ¥ä»£æ›¿é‚£ä¸ªå¯¹è±¡. æ€»ä¹‹åŸåˆ™æ˜¯,å¯¹äºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡,åªæœ‰åœ¨ä½¿ç”¨å®ƒæ—¶æ‰åˆ›å»º,è¿™ä¸ªåŸåˆ™å¯ä»¥ä¸ºæˆ‘ä»¬èŠ‚çœå¾ˆå¤šå®è´µçš„Javaå†…å­˜. æ‰€ä»¥,æœ‰äº›äººè®¤ä¸ºJavaè€—è´¹èµ„æºå†…å­˜,æˆ‘ä»¥ä¸ºè¿™å’Œç¨‹åºç¼–åˆ¶æ€è·¯ä¹Ÿæœ‰ä¸€å®šçš„å…³ç³».\nå¦‚ä½•ä½¿ç”¨Proxy? ä»¥Jiveè®ºå›ç³»ç»Ÿä¸ºä¾‹,è®¿é—®è®ºå›ç³»ç»Ÿçš„ç”¨æˆ·æœ‰å¤šç§ç±»å‹:æ³¨å†Œæ™®é€šç”¨æˆ· è®ºå›ç®¡ç†è€… ç³»ç»Ÿç®¡ç†è€… æ¸¸å®¢,æ³¨å†Œæ™®é€šç”¨æˆ·æ‰èƒ½å‘è¨€;è®ºå›ç®¡ç†è€…å¯ä»¥ç®¡ç†ä»–è¢«æˆæƒçš„è®ºå›;ç³»ç»Ÿç®¡ç†è€…å¯ä»¥ç®¡ç†æ‰€æœ‰äº‹åŠ¡ç­‰,è¿™äº›æƒé™åˆ’åˆ†å’Œç®¡ç†æ˜¯ä½¿ç”¨Proxyå®Œæˆçš„.\nForumæ˜¯Jiveçš„æ ¸å¿ƒæ¥å£,åœ¨Forumä¸­é™ˆåˆ—äº†æœ‰å…³è®ºå›æ“ä½œçš„ä¸»è¦è¡Œä¸º,å¦‚è®ºå›åç§° è®ºå›æè¿°çš„è·å–å’Œä¿®æ”¹,å¸–å­å‘è¡¨åˆ é™¤ç¼–è¾‘ç­‰.\nåœ¨ForumPermissionsä¸­å®šä¹‰äº†å„ç§çº§åˆ«æƒé™çš„ç”¨æˆ·:\npublic class ForumPermissions implements Cacheable { /** * Permission to read object. */ public static final int READ = 0; /** * Permission to administer the entire sytem. */ public static final int SYSTEM_ADMIN = 1; /** * Permission to administer a particular forum. */ public static final int FORUM_ADMIN = 2; /** * Permission to administer a particular user.","title":"2.2 Proxy"},{"content":"Facade (å¤–è§‚ æ€»ç®¡æ¨¡å¼ï¼‰å®šä¹‰ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢.\né“¾æ¥\nFacadeä¸€ä¸ªå…¸å‹åº”ç”¨å°±æ˜¯æ•°æ®åº“JDBCçš„åº”ç”¨\næ‰€æœ‰ç¨‹åºå¯¹æ•°æ®åº“è®¿é—®éƒ½æ˜¯ä½¿ç”¨æ”¹æ¥å£,é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,å¢åŠ äº†çµæ´»æ€§.\nå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨è¿æ¥æ± ,ä¹Ÿåªè¦é’ˆå¯¹facadeæ¥å£ä¿®æ”¹å°±å¯ä»¥.\n","permalink":"http://blog.chalme.top/posts/design-patterns/2.1-facade/","summary":"Facade (å¤–è§‚ æ€»ç®¡æ¨¡å¼ï¼‰å®šä¹‰ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢.\né“¾æ¥\nFacadeä¸€ä¸ªå…¸å‹åº”ç”¨å°±æ˜¯æ•°æ®åº“JDBCçš„åº”ç”¨\næ‰€æœ‰ç¨‹åºå¯¹æ•°æ®åº“è®¿é—®éƒ½æ˜¯ä½¿ç”¨æ”¹æ¥å£,é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,å¢åŠ äº†çµæ´»æ€§.\nå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨è¿æ¥æ± ,ä¹Ÿåªè¦é’ˆå¯¹facadeæ¥å£ä¿®æ”¹å°±å¯ä»¥.","title":"2.1 Facade"},{"content":"Builder(å»ºé€ è€…æ¨¡å¼ï¼‰å®šä¹‰ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»,ä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º.\nBuilderæ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,å®ƒå…è®¸ç”¨æˆ·å¯ä»¥åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬.ç”¨æˆ·ä¸çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚.Builderæ¨¡å¼æ˜¯éå¸¸ç±»ä¼¼æŠ½è±¡å·¥å‚æ¨¡å¼,ç»†å¾®çš„åŒºåˆ«å¤§æ¦‚åªæœ‰åœ¨åå¤ä½¿ç”¨ä¸­æ‰èƒ½ä½“ä¼šåˆ°.\nä¸ºä½•ä½¿ç”¨? æ˜¯ä¸ºäº†å°†æ„å»ºå¤æ‚å¯¹è±¡çš„è¿‡ç¨‹å’Œå®ƒçš„éƒ¨ä»¶è§£è€¦.æ³¨æ„: æ˜¯è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶.\nå› ä¸ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,ä¸ä½†æœ‰å¾ˆå¤šå¤§é‡ç»„æˆéƒ¨åˆ†,å¦‚æ±½è½¦,æœ‰å¾ˆå¤šéƒ¨ä»¶:è½¦è½® æ–¹å‘ç›˜ å‘åŠ¨æœºè¿˜æœ‰å„ç§å°é›¶ä»¶ç­‰ç­‰,éƒ¨ä»¶å¾ˆå¤š,ä½†è¿œä¸æ­¢è¿™äº›,å¦‚ä½•å°†è¿™äº›éƒ¨ä»¶è£…é…æˆä¸€è¾†æ±½è½¦,è¿™ä¸ªè£…é…è¿‡ç¨‹ä¹Ÿå¾ˆå¤æ‚(éœ€è¦å¾ˆå¥½çš„ç»„è£…æŠ€æœ¯),Builderæ¨¡å¼å°±æ˜¯ä¸ºäº†å°†éƒ¨ä»¶å’Œç»„è£…è¿‡ç¨‹åˆ†å¼€.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆå‡è®¾ä¸€ä¸ªå¤æ‚å¯¹è±¡æ˜¯ç”±å¤šä¸ªéƒ¨ä»¶ç»„æˆçš„,Builderæ¨¡å¼æ˜¯æŠŠå¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œéƒ¨ä»¶çš„åˆ›å»ºåˆ†åˆ«å¼€æ¥,åˆ†åˆ«ç”¨Builderç±»å’ŒDirectorç±»æ¥è¡¨ç¤º.\né¦–å…ˆ,éœ€è¦ä¸€ä¸ªæ¥å£,å®ƒå®šä¹‰å¦‚ä½•åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶:\npublic interface Builder { //åˆ›å»ºéƒ¨ä»¶Aã€€æ¯”å¦‚åˆ›å»ºæ±½è½¦è½¦è½® void buildPartA(); //åˆ›å»ºéƒ¨ä»¶B æ¯”å¦‚åˆ›å»ºæ±½è½¦æ–¹å‘ç›˜ void buildPartB(); //åˆ›å»ºéƒ¨ä»¶C æ¯”å¦‚åˆ›å»ºæ±½è½¦å‘åŠ¨æœº void buildPartC(); //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ (è¿”å›æœ€åè£…é…å¥½çš„æ±½è½¦) //æˆå“çš„ç»„è£…è¿‡ç¨‹ä¸åœ¨è¿™é‡Œè¿›è¡Œ,è€Œæ˜¯è½¬ç§»åˆ°ä¸‹é¢çš„Directorç±»ä¸­è¿›è¡Œ. //ä»è€Œå®ç°äº†è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶ Product getResult(); } ç”¨Directoræ„å»ºæœ€åçš„å¤æ‚å¯¹è±¡,è€Œåœ¨ä¸Šé¢Builderæ¥å£ä¸­å°è£…çš„æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªä¸ªéƒ¨ä»¶(å¤æ‚å¯¹è±¡æ˜¯ç”±è¿™äº›éƒ¨ä»¶ç»„æˆçš„),ä¹Ÿå°±æ˜¯è¯´Directorçš„å†…å®¹æ˜¯å¦‚ä½•å°†éƒ¨ä»¶æœ€åç»„è£…æˆæˆå“:\npublic class Director { private Builder builder; public Director( Builder builder ) { this.builder = builder; } // å°†éƒ¨ä»¶partA partB partCæœ€åç»„æˆå¤æ‚å¯¹è±¡ //è¿™é‡Œæ˜¯å°†è½¦è½® æ–¹å‘ç›˜å’Œå‘åŠ¨æœºç»„è£…æˆæ±½è½¦çš„è¿‡ç¨‹ public void construct() { builder.buildPartA(); builder.buildPartB(); builder.buildPartC(); } } Builderçš„å…·ä½“å®ç°ConcreteBuilder:\né€šè¿‡å…·ä½“å®Œæˆæ¥å£Builderæ¥æ„å»ºæˆ–è£…é…äº§å“çš„éƒ¨ä»¶; å®šä¹‰å¹¶æ˜ç¡®å®ƒæ‰€è¦åˆ›å»ºçš„æ˜¯ä»€ä¹ˆå…·ä½“ä¸œè¥¿; æä¾›ä¸€ä¸ªå¯ä»¥é‡æ–°è·å–äº§å“çš„æ¥å£: public class ConcreteBuilder implements Builder { Part partA, partB, partC; public void buildPartA() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartAçš„ä»£ç  }; public void buildPartB() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public void buildPartC() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public Product getResult() { //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ }; } å¤æ‚å¯¹è±¡:äº§å“Product:\npublic interface Product { } å¤æ‚å¯¹è±¡çš„éƒ¨ä»¶:\npublic interface Part { } æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è°ƒç”¨Builderæ¨¡å¼:\nConcreteBuilder builder = new ConcreteBuilder(); Director director = new Director( builder ); director.construct(); Product product = builder.getResult(); åº”ç”¨ åœ¨Javaå®é™…ä½¿ç”¨ä¸­,æˆ‘ä»¬ç»å¸¸ç”¨åˆ°\u0026quot;æ± \u0026quot;(Pool)çš„æ¦‚å¿µ,å½“èµ„æºæä¾›è€…æ— æ³•æä¾›è¶³å¤Ÿçš„èµ„æº,å¹¶ä¸”è¿™äº›èµ„æºéœ€è¦è¢«å¾ˆå¤šç”¨æˆ·åå¤å…±äº«æ—¶,å°±éœ€è¦ä½¿ç”¨æ± .\n\u0026ldquo;æ± \u0026quot;å®é™…æ˜¯ä¸€æ®µå†…å­˜,å½“æ± ä¸­æœ‰ä¸€äº›å¤æ‚çš„èµ„æºçš„\u0026quot;æ–­è‚¢\u0026rdquo;(æ¯”å¦‚æ•°æ®åº“çš„è¿æ¥æ± ,ä¹Ÿè®¸æœ‰æ—¶ä¸€ä¸ªè¿æ¥ä¼šä¸­æ–­),å¦‚æœå¾ªç¯å†åˆ©ç”¨è¿™äº›\u0026quot;æ–­è‚¢\u0026quot;,å°†æé«˜å†…å­˜ä½¿ç”¨æ•ˆç‡,æé«˜æ± çš„æ€§èƒ½.ä¿®æ”¹Builderæ¨¡å¼ä¸­Directorç±»ä½¿ä¹‹èƒ½è¯Šæ–­\u0026quot;æ–­è‚¢\u0026quot;æ–­åœ¨å“ªä¸ªéƒ¨ä»¶ä¸Š,å†ä¿®å¤è¿™ä¸ªéƒ¨ä»¶.\n","permalink":"http://blog.chalme.top/posts/design-patterns/1.4-builder/","summary":"Builder(å»ºé€ è€…æ¨¡å¼ï¼‰å®šä¹‰ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»,ä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º.\nBuilderæ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,å®ƒå…è®¸ç”¨æˆ·å¯ä»¥åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬.ç”¨æˆ·ä¸çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚.Builderæ¨¡å¼æ˜¯éå¸¸ç±»ä¼¼æŠ½è±¡å·¥å‚æ¨¡å¼,ç»†å¾®çš„åŒºåˆ«å¤§æ¦‚åªæœ‰åœ¨åå¤ä½¿ç”¨ä¸­æ‰èƒ½ä½“ä¼šåˆ°.\nä¸ºä½•ä½¿ç”¨? æ˜¯ä¸ºäº†å°†æ„å»ºå¤æ‚å¯¹è±¡çš„è¿‡ç¨‹å’Œå®ƒçš„éƒ¨ä»¶è§£è€¦.æ³¨æ„: æ˜¯è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶.\nå› ä¸ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,ä¸ä½†æœ‰å¾ˆå¤šå¤§é‡ç»„æˆéƒ¨åˆ†,å¦‚æ±½è½¦,æœ‰å¾ˆå¤šéƒ¨ä»¶:è½¦è½® æ–¹å‘ç›˜ å‘åŠ¨æœºè¿˜æœ‰å„ç§å°é›¶ä»¶ç­‰ç­‰,éƒ¨ä»¶å¾ˆå¤š,ä½†è¿œä¸æ­¢è¿™äº›,å¦‚ä½•å°†è¿™äº›éƒ¨ä»¶è£…é…æˆä¸€è¾†æ±½è½¦,è¿™ä¸ªè£…é…è¿‡ç¨‹ä¹Ÿå¾ˆå¤æ‚(éœ€è¦å¾ˆå¥½çš„ç»„è£…æŠ€æœ¯),Builderæ¨¡å¼å°±æ˜¯ä¸ºäº†å°†éƒ¨ä»¶å’Œç»„è£…è¿‡ç¨‹åˆ†å¼€.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆå‡è®¾ä¸€ä¸ªå¤æ‚å¯¹è±¡æ˜¯ç”±å¤šä¸ªéƒ¨ä»¶ç»„æˆçš„,Builderæ¨¡å¼æ˜¯æŠŠå¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œéƒ¨ä»¶çš„åˆ›å»ºåˆ†åˆ«å¼€æ¥,åˆ†åˆ«ç”¨Builderç±»å’ŒDirectorç±»æ¥è¡¨ç¤º.\né¦–å…ˆ,éœ€è¦ä¸€ä¸ªæ¥å£,å®ƒå®šä¹‰å¦‚ä½•åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶:\npublic interface Builder { //åˆ›å»ºéƒ¨ä»¶Aã€€æ¯”å¦‚åˆ›å»ºæ±½è½¦è½¦è½® void buildPartA(); //åˆ›å»ºéƒ¨ä»¶B æ¯”å¦‚åˆ›å»ºæ±½è½¦æ–¹å‘ç›˜ void buildPartB(); //åˆ›å»ºéƒ¨ä»¶C æ¯”å¦‚åˆ›å»ºæ±½è½¦å‘åŠ¨æœº void buildPartC(); //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ (è¿”å›æœ€åè£…é…å¥½çš„æ±½è½¦) //æˆå“çš„ç»„è£…è¿‡ç¨‹ä¸åœ¨è¿™é‡Œè¿›è¡Œ,è€Œæ˜¯è½¬ç§»åˆ°ä¸‹é¢çš„Directorç±»ä¸­è¿›è¡Œ. //ä»è€Œå®ç°äº†è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶ Product getResult(); } ç”¨Directoræ„å»ºæœ€åçš„å¤æ‚å¯¹è±¡,è€Œåœ¨ä¸Šé¢Builderæ¥å£ä¸­å°è£…çš„æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªä¸ªéƒ¨ä»¶(å¤æ‚å¯¹è±¡æ˜¯ç”±è¿™äº›éƒ¨ä»¶ç»„æˆçš„),ä¹Ÿå°±æ˜¯è¯´Directorçš„å†…å®¹æ˜¯å¦‚ä½•å°†éƒ¨ä»¶æœ€åç»„è£…æˆæˆå“:\npublic class Director { private Builder builder; public Director( Builder builder ) { this.builder = builder; } // å°†éƒ¨ä»¶partA partB partCæœ€åç»„æˆå¤æ‚å¯¹è±¡ //è¿™é‡Œæ˜¯å°†è½¦è½® æ–¹å‘ç›˜å’Œå‘åŠ¨æœºç»„è£…æˆæ±½è½¦çš„è¿‡ç¨‹ public void construct() { builder.buildPartA(); builder.buildPartB(); builder.buildPartC(); } } Builderçš„å…·ä½“å®ç°ConcreteBuilder:\né€šè¿‡å…·ä½“å®Œæˆæ¥å£Builderæ¥æ„å»ºæˆ–è£…é…äº§å“çš„éƒ¨ä»¶; å®šä¹‰å¹¶æ˜ç¡®å®ƒæ‰€è¦åˆ›å»ºçš„æ˜¯ä»€ä¹ˆå…·ä½“ä¸œè¥¿; æä¾›ä¸€ä¸ªå¯ä»¥é‡æ–°è·å–äº§å“çš„æ¥å£: public class ConcreteBuilder implements Builder { Part partA, partB, partC; public void buildPartA() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartAçš„ä»£ç  }; public void buildPartB() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public void buildPartC() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public Product getResult() { //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ }; } å¤æ‚å¯¹è±¡:äº§å“Product:","title":"1.4 Builder"},{"content":"Singleton (å•ä¾‹æ¨¡å¼ï¼‰å®šä¹‰ Singletonæ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯ä¿è¯åœ¨Javaåº”ç”¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªç±»Classåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚\nåœ¨å¾ˆå¤šæ“ä½œä¸­ï¼Œæ¯”å¦‚å»ºç«‹ç›®å½• æ•°æ®åº“è¿æ¥éƒ½éœ€è¦è¿™æ ·çš„å•çº¿ç¨‹æ“ä½œ. è¿˜æœ‰, singletonèƒ½å¤Ÿè¢«çŠ¶æ€åŒ–; è¿™æ ·ï¼Œå¤šä¸ªå•æ€ç±»åœ¨ä¸€èµ·å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªçŠ¶æ€ä»“åº“ä¸€æ ·å‘å¤–æä¾›æœåŠ¡ï¼Œæ¯”å¦‚ï¼Œä½ è¦è®ºå›ä¸­çš„å¸–å­è®¡æ•°å™¨ï¼Œæ¯æ¬¡æµè§ˆä¸€æ¬¡éœ€è¦è®¡æ•°ï¼Œå•æ€ç±»èƒ½å¦ä¿æŒä½è¿™ä¸ªè®¡æ•°ï¼Œå¹¶ä¸”èƒ½synchronizeçš„å®‰å…¨è‡ªåŠ¨åŠ 1ï¼Œå¦‚æœä½ è¦æŠŠè¿™ä¸ªæ•°å­—æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹å•æ€æ¥å£çš„æƒ…å†µä¸‹æ–¹ä¾¿çš„åšåˆ°ã€‚\nå¦å¤–æ–¹é¢ï¼ŒSingletonä¹Ÿèƒ½å¤Ÿè¢«æ— çŠ¶æ€åŒ–ã€‚æä¾›å·¥å…·æ€§è´¨çš„åŠŸèƒ½ï¼Œ\nSingletonæ¨¡å¼å°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·å®ç°çš„å¯èƒ½ã€‚ä½¿ç”¨Singletonçš„å¥½å¤„è¿˜åœ¨äºå¯ä»¥èŠ‚çœå†…å­˜ï¼Œå› ä¸ºå®ƒé™åˆ¶äº†å®ä¾‹çš„ä¸ªæ•°ï¼Œæœ‰åˆ©äºJavaåƒåœ¾å›æ”¶ï¼ˆgarbage collectionï¼‰ã€‚\næˆ‘ä»¬å¸¸å¸¸çœ‹åˆ°å·¥å‚æ¨¡å¼ä¸­ç±»è£…å…¥å™¨(class loader)ä¸­ä¹Ÿç”¨Singletonæ¨¡å¼å®ç°çš„,å› ä¸ºè¢«è£…å…¥çš„ç±»å®é™…ä¹Ÿå±äºèµ„æºã€‚\nå¦‚ä½•ä½¿ç”¨ public class Singleton { private Singleton(){} //åœ¨è‡ªå·±å†…éƒ¨å®šä¹‰è‡ªå·±ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Ÿ //æ³¨æ„è¿™æ˜¯private åªä¾›å†…éƒ¨è°ƒç”¨ private static Singleton instance = new Singleton(); //è¿™é‡Œæä¾›äº†ä¸€ä¸ªä¾›å¤–éƒ¨è®¿é—®æœ¬classçš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ã€€public static Singleton getInstance() { return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class TestInstance{ private static TestInstance instance; public static TestInstance getInstance{ if(instance==null){ synchronized(TestInstance.class){ if(instance==null){ instance=new TestInstance(); } } return instance; } } public class SingleClass2{ private static class SingleInstance{ private static SingleClass2 instance = new SingleClass2(); } private SingleClass2(){ } public static SingleClass2 CreateInstance(){ return SingleInstance.instance; } } ","permalink":"http://blog.chalme.top/posts/design-patterns/1.3-singleton/","summary":"Singleton (å•ä¾‹æ¨¡å¼ï¼‰å®šä¹‰ Singletonæ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯ä¿è¯åœ¨Javaåº”ç”¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªç±»Classåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚\nåœ¨å¾ˆå¤šæ“ä½œä¸­ï¼Œæ¯”å¦‚å»ºç«‹ç›®å½• æ•°æ®åº“è¿æ¥éƒ½éœ€è¦è¿™æ ·çš„å•çº¿ç¨‹æ“ä½œ. è¿˜æœ‰, singletonèƒ½å¤Ÿè¢«çŠ¶æ€åŒ–; è¿™æ ·ï¼Œå¤šä¸ªå•æ€ç±»åœ¨ä¸€èµ·å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªçŠ¶æ€ä»“åº“ä¸€æ ·å‘å¤–æä¾›æœåŠ¡ï¼Œæ¯”å¦‚ï¼Œä½ è¦è®ºå›ä¸­çš„å¸–å­è®¡æ•°å™¨ï¼Œæ¯æ¬¡æµè§ˆä¸€æ¬¡éœ€è¦è®¡æ•°ï¼Œå•æ€ç±»èƒ½å¦ä¿æŒä½è¿™ä¸ªè®¡æ•°ï¼Œå¹¶ä¸”èƒ½synchronizeçš„å®‰å…¨è‡ªåŠ¨åŠ 1ï¼Œå¦‚æœä½ è¦æŠŠè¿™ä¸ªæ•°å­—æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹å•æ€æ¥å£çš„æƒ…å†µä¸‹æ–¹ä¾¿çš„åšåˆ°ã€‚\nå¦å¤–æ–¹é¢ï¼ŒSingletonä¹Ÿèƒ½å¤Ÿè¢«æ— çŠ¶æ€åŒ–ã€‚æä¾›å·¥å…·æ€§è´¨çš„åŠŸèƒ½ï¼Œ\nSingletonæ¨¡å¼å°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·å®ç°çš„å¯èƒ½ã€‚ä½¿ç”¨Singletonçš„å¥½å¤„è¿˜åœ¨äºå¯ä»¥èŠ‚çœå†…å­˜ï¼Œå› ä¸ºå®ƒé™åˆ¶äº†å®ä¾‹çš„ä¸ªæ•°ï¼Œæœ‰åˆ©äºJavaåƒåœ¾å›æ”¶ï¼ˆgarbage collectionï¼‰ã€‚\næˆ‘ä»¬å¸¸å¸¸çœ‹åˆ°å·¥å‚æ¨¡å¼ä¸­ç±»è£…å…¥å™¨(class loader)ä¸­ä¹Ÿç”¨Singletonæ¨¡å¼å®ç°çš„,å› ä¸ºè¢«è£…å…¥çš„ç±»å®é™…ä¹Ÿå±äºèµ„æºã€‚\nå¦‚ä½•ä½¿ç”¨ public class Singleton { private Singleton(){} //åœ¨è‡ªå·±å†…éƒ¨å®šä¹‰è‡ªå·±ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Ÿ //æ³¨æ„è¿™æ˜¯private åªä¾›å†…éƒ¨è°ƒç”¨ private static Singleton instance = new Singleton(); //è¿™é‡Œæä¾›äº†ä¸€ä¸ªä¾›å¤–éƒ¨è®¿é—®æœ¬classçš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ã€€public static Singleton getInstance() { return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class TestInstance{ private static TestInstance instance; public static TestInstance getInstance{ if(instance==null){ synchronized(TestInstance.","title":"1.3 Singleton"},{"content":"Prototype Prototype ï¼ˆåŸå‹æ¨¡å¼ï¼‰å®šä¹‰ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»,å¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡. Prototypeæ¨¡å¼å…è®¸ä¸€ä¸ªå¯¹è±¡å†åˆ›å»ºå¦å¤–ä¸€ä¸ªå¯å®šåˆ¶çš„å¯¹è±¡ï¼Œæ ¹æœ¬æ— éœ€çŸ¥é“ä»»ä½•å¦‚ä½•åˆ›å»ºçš„ç»†èŠ‚,å·¥ä½œåŸç†æ˜¯:é€šè¿‡å°†ä¸€ä¸ªåŸå‹å¯¹è±¡ä¼ ç»™é‚£ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡é€šè¿‡è¯·æ±‚åŸå‹å¯¹è±¡æ‹·è´å®ƒä»¬è‡ªå·±æ¥å®æ–½åˆ›å»ºã€‚ ä½¿ç”¨ javaä¸­æœ‰ clone æ–¹æ³•æ¥å®ç°å¯¹è±¡çš„å…‹éš†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ ä»¥ å‹ºå­ä¸ºä¾‹\npublic abstract class AbstractSpoon implements Cloneable { String spoonName; public void setSpoonName(String spoonName) {this.spoonName = spoonName;} public String getSpoonName() {return this.spoonName;} public Object clone() { Object object = null; try { object = super.clone(); } catch (CloneNotSupportedException exception) { System.err.println(\u0026#34;AbstractSpoon is not Cloneable\u0026#34;); } return object; } } public class SoupSpoon extends AbstractSpoon { public SoupSpoon() { setSpoonName(\u0026#34;Soup Spoon\u0026#34;); } } è°ƒç”¨Prototypeæ¨¡å¼å¾ˆç®€å•:\nAbstractSpoon spoon = new SoupSpoon(); AbstractSpoon spoon2 = spoon.clone(); å½“ç„¶ä¹Ÿå¯ä»¥ç»“åˆå·¥å‚æ¨¡å¼æ¥åˆ›å»ºAbstractSpoonå®ä¾‹ã€‚ å®è´¨ï¼š java ä½¿ç”¨object ç±»çš„clone æ–¹æ³•\n","permalink":"http://blog.chalme.top/posts/design-patterns/1.2-prototype/","summary":"Prototype Prototype ï¼ˆåŸå‹æ¨¡å¼ï¼‰å®šä¹‰ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»,å¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡. Prototypeæ¨¡å¼å…è®¸ä¸€ä¸ªå¯¹è±¡å†åˆ›å»ºå¦å¤–ä¸€ä¸ªå¯å®šåˆ¶çš„å¯¹è±¡ï¼Œæ ¹æœ¬æ— éœ€çŸ¥é“ä»»ä½•å¦‚ä½•åˆ›å»ºçš„ç»†èŠ‚,å·¥ä½œåŸç†æ˜¯:é€šè¿‡å°†ä¸€ä¸ªåŸå‹å¯¹è±¡ä¼ ç»™é‚£ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡é€šè¿‡è¯·æ±‚åŸå‹å¯¹è±¡æ‹·è´å®ƒä»¬è‡ªå·±æ¥å®æ–½åˆ›å»ºã€‚ ä½¿ç”¨ javaä¸­æœ‰ clone æ–¹æ³•æ¥å®ç°å¯¹è±¡çš„å…‹éš†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ ä»¥ å‹ºå­ä¸ºä¾‹\npublic abstract class AbstractSpoon implements Cloneable { String spoonName; public void setSpoonName(String spoonName) {this.spoonName = spoonName;} public String getSpoonName() {return this.spoonName;} public Object clone() { Object object = null; try { object = super.clone(); } catch (CloneNotSupportedException exception) { System.err.println(\u0026#34;AbstractSpoon is not Cloneable\u0026#34;); } return object; } } public class SoupSpoon extends AbstractSpoon { public SoupSpoon() { setSpoonName(\u0026#34;Soup Spoon\u0026#34;); } } è°ƒç”¨Prototypeæ¨¡å¼å¾ˆç®€å•:","title":"1.2 Prototype"},{"content":"å·¥å‚æ¨¡å¼å®šä¹‰ æä¾›åˆ›å»ºå¯¹è±¡çš„æ¥å£\nè¯¦ç»†1\nè¯¦ç»†2\nç®€ä»‹ ç®€å•å·¥å‚æ¨¡å¼\nå·¥å‚æ–¹æ³•æ¨¡å¼\næŠ½è±¡å·¥å‚æ¨¡å¼\nç®€å•å·¥å‚æ¨¡å¼ å®ƒç”±ä¸‰ç§è§’è‰²ç»„æˆï¼ˆå…³ç³»è§ä¸‹é¢çš„ç±»å›¾ï¼‰ï¼š\nå·¥å‚ç±»è§’è‰²ï¼šè¿™æ˜¯æœ¬æ¨¡å¼çš„æ ¸å¿ƒï¼Œå«æœ‰ä¸€å®šçš„å•†ä¸šé€»è¾‘å’Œåˆ¤æ–­é€»è¾‘ã€‚åœ¨javaä¸­å®ƒå¾€å¾€ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒä¸€èˆ¬æ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ç”±æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°ã€‚\nå…·ä½“äº§å“è§’è‰²ï¼šå·¥å‚ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næœ¬è´¨ : åœ¨Creator ä¸­ create æ–¹æ³•ä¸­ ä½¿ç”¨ equals(string name)æ–¹æ³•æ¥åˆ›å»º Productã€‚\n//æŠ½è±¡äº§å“è§’è‰² public interface Car{ public void drive(); } //å…·ä½“äº§å“è§’è‰² public class Benz implements Car{ public void drive() { System.out.println(\u0026#34;Driving Benz \u0026#34;); } } public class Bmw implements Car{ public void drive() { System.out.println(\u0026#34;Driving Bmw \u0026#34;); } } ã€‚ã€‚ã€‚ï¼ˆå¥¥è¿ªæˆ‘å°±ä¸å†™äº†:Pï¼‰ //å·¥å‚ç±»è§’è‰² public class Driver{ //å·¥å‚æ–¹æ³• //æ³¨æ„ è¿”å›ç±»å‹ä¸ºæŠ½è±¡äº§å“è§’è‰² public static Car driverCar(String s)throws Exception { //åˆ¤æ–­é€»è¾‘ï¼Œè¿”å›å…·ä½“çš„äº§å“è§’è‰²ç»™Client if(s.equalsIgnoreCase(\u0026#34;Benz\u0026#34;)) return new Benz(); else if(s.equalsIgnoreCase(\u0026#34;Bmw\u0026#34;)) return new Bmw(); ...... else throw new Exception(); ã€‚ã€‚ã€‚ //æ¬¢è¿æš´å‘æˆ·å‡ºåœº...... public class Magnate{ public static void main(String[] args){ try{ //å‘Šè¯‰å¸æœºæˆ‘ä»Šå¤©åå¥”é©° Car car = Driver.driverCar(\u0026#34;benz\u0026#34;); //ä¸‹å‘½ä»¤ï¼šå¼€è½¦ car.drive(); ã€‚ã€‚ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼ å…ˆæ¥çœ‹ä¸‹å®ƒçš„ç»„æˆå§ï¼š\næŠ½è±¡å·¥å‚è§’è‰²ï¼šè¿™æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒä¸åº”ç”¨ç¨‹åºæ— å…³ã€‚æ˜¯å…·ä½“å·¥å‚è§’è‰²å¿…é¡»å®ç°çš„æ¥å£æˆ–è€…å¿…é¡»ç»§æ‰¿çš„çˆ¶ç±»ã€‚åœ¨javaä¸­å®ƒç”±æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“å·¥å‚è§’è‰²ï¼šå®ƒå«æœ‰å’Œå…·ä½“ä¸šåŠ¡é€»è¾‘æœ‰å…³çš„ä»£ç ã€‚ç”±åº”ç”¨ç¨‹åºè°ƒç”¨ä»¥åˆ›å»ºå¯¹åº”çš„å…·ä½“äº§å“çš„å¯¹è±¡ã€‚åœ¨javaä¸­å®ƒç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ æŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒæ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…æ˜¯å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ä¸€èˆ¬æœ‰æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ 4ã€å…·ä½“äº§å“è§’è‰²ï¼šå…·ä½“å·¥å‚è§’è‰²æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ //æŠ½è±¡å·¥å‚è§’è‰² public interface Driver{ public Car driverCar(); } public class BenzDriver implements Driver{ public Car driverCar(){ return new Benz(); } } public class BmwDriver implements Driver{ public Car driverCar() { return new Bmw(); } } ......//åº”è¯¥å’Œå…·ä½“äº§å“å½¢æˆå¯¹åº”å…³ç³»ï¼Œè¿™é‡Œç•¥... //æœ‰è¯·æš´å‘æˆ·å…ˆç”Ÿ public class Magnate { public static void main(String[] args) { try{ Driver driver = new BenzDriver(); Car car = driver.driverCar(); car.drive(); }catch(Exception e) { } } } æŠ½è±¡å·¥å‚æ¨¡å¼ æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç”¨æ„ä¸ºï¼šç»™å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªäº§å“æ—ä¸­çš„äº§å“å¯¹è±¡ã€‚è€Œä¸”ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼è¿˜è¦æ»¡è¶³ä¸€ä¸‹æ¡ä»¶ï¼š\nç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œè€Œç³»ç»Ÿä¸€æ¬¡åªå¯èƒ½æ¶ˆè´¹å…¶ä¸­ä¸€æ—äº§å“ åŒå±äºåŒä¸€ä¸ªäº§å“æ—çš„äº§å“ä¸€èµ·ä½¿ç”¨æ—¶ã€‚ æ¥çœ‹çœ‹æŠ½è±¡å·¥å‚æ¨¡å¼çš„å„ä¸ªè§’è‰²ï¼ˆå’Œå·¥å‚æ–¹æ³•çš„å¦‚å‡ºä¸€è¾™ï¼‰ï¼š\næŠ½è±¡å·¥å‚è§’è‰²ï¼šè¿™æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒä¸åº”ç”¨ç¨‹åºæ— å…³ã€‚æ˜¯å…·ä½“å·¥å‚è§’è‰²å¿…é¡»å®ç°çš„æ¥å£æˆ–è€…å¿…é¡»ç»§æ‰¿çš„çˆ¶ç±»ã€‚åœ¨javaä¸­å®ƒç”±æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“å·¥å‚è§’è‰²ï¼šå®ƒå«æœ‰å’Œå…·ä½“ä¸šåŠ¡é€»è¾‘æœ‰å…³çš„ä»£ç ã€‚ç”±åº”ç”¨ç¨‹åºè°ƒç”¨ä»¥åˆ›å»ºå¯¹åº”çš„å…·ä½“äº§å“çš„å¯¹è±¡ã€‚åœ¨javaä¸­å®ƒç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ æŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒæ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…æ˜¯å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ä¸€èˆ¬æœ‰æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“äº§å“è§’è‰²ï¼šå…·ä½“å·¥å‚è§’è‰²æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ ","permalink":"http://blog.chalme.top/posts/design-patterns/1.1-factory/","summary":"å·¥å‚æ¨¡å¼å®šä¹‰ æä¾›åˆ›å»ºå¯¹è±¡çš„æ¥å£\nè¯¦ç»†1\nè¯¦ç»†2\nç®€ä»‹ ç®€å•å·¥å‚æ¨¡å¼\nå·¥å‚æ–¹æ³•æ¨¡å¼\næŠ½è±¡å·¥å‚æ¨¡å¼\nç®€å•å·¥å‚æ¨¡å¼ å®ƒç”±ä¸‰ç§è§’è‰²ç»„æˆï¼ˆå…³ç³»è§ä¸‹é¢çš„ç±»å›¾ï¼‰ï¼š\nå·¥å‚ç±»è§’è‰²ï¼šè¿™æ˜¯æœ¬æ¨¡å¼çš„æ ¸å¿ƒï¼Œå«æœ‰ä¸€å®šçš„å•†ä¸šé€»è¾‘å’Œåˆ¤æ–­é€»è¾‘ã€‚åœ¨javaä¸­å®ƒå¾€å¾€ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒä¸€èˆ¬æ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ç”±æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°ã€‚\nå…·ä½“äº§å“è§’è‰²ï¼šå·¥å‚ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næœ¬è´¨ : åœ¨Creator ä¸­ create æ–¹æ³•ä¸­ ä½¿ç”¨ equals(string name)æ–¹æ³•æ¥åˆ›å»º Productã€‚\n//æŠ½è±¡äº§å“è§’è‰² public interface Car{ public void drive(); } //å…·ä½“äº§å“è§’è‰² public class Benz implements Car{ public void drive() { System.out.println(\u0026#34;Driving Benz \u0026#34;); } } public class Bmw implements Car{ public void drive() { System.out.println(\u0026#34;Driving Bmw \u0026#34;); } } ã€‚ã€‚ã€‚ï¼ˆå¥¥è¿ªæˆ‘å°±ä¸å†™äº†:Pï¼‰ //å·¥å‚ç±»è§’è‰² public class Driver{ //å·¥å‚æ–¹æ³• //æ³¨æ„ è¿”å›ç±»å‹ä¸ºæŠ½è±¡äº§å“è§’è‰² public static Car driverCar(String s)throws Exception { //åˆ¤æ–­é€»è¾‘ï¼Œè¿”å›å…·ä½“çš„äº§å“è§’è‰²ç»™Client if(s.","title":"1.1 Factory"},{"content":"è®¾è®¡æ¨¡å¼(Patterns in Java) é“¾æ¥ å¦ç±»çš„è®¾è®¡æ¨¡å¼\nå›¾è¯´è®¾è®¡æ¨¡å¼\nå¦‚ä»Šè®¾è®¡æ¨¡å¼å·²ç»æˆä¸ºæ¶æ„å¸ˆå’Œç¨‹åºå‘˜ä¹‹é—´æ²Ÿé€šçš„å¿…å¤‡è¯­è¨€ï¼Œä¹Ÿæ˜¯æ™®é€šç¨‹åºå‘˜æˆé•¿ä¸ºèµ„æ·±ç¨‹åºå‘˜çš„å¿…å¤‡åŸºç¡€ä¹‹ä¸€ã€‚åªæœ‰æŒæ¡äº†è®¾è®¡æ¨¡å¼ï¼Œæ‰èƒ½æ›´å¥½åœ°æŒæ¡DDDé¢†åŸŸé©±åŠ¨è®¾è®¡ç­‰OOåˆ†æè®¾è®¡æ–¹æ³•ï¼Œä¹Ÿæ‰èƒ½æ›´ç†Ÿç»ƒåœ°å­¦ä¹ ä½¿ç”¨ä¸æ–­æ¶Œç°çš„æ–°è¯­è¨€ã€‚\nåˆ›å»ºæ¨¡å¼ï¼ˆ5ï¼‰ Factory(å·¥å‚æ¨¡å¼ï¼‰\nPrototype(åŸå‹æ¨¡å¼ï¼‰\nBuilder\nSingleton(å•ä¾‹æ¨¡å¼ï¼‰\nç»“æ„æ¨¡å¼ï¼ˆ7ï¼‰ Facade\nProxy\nAdapter\nComposite\nDecorator\nBridge\nFlyweight\nè¡Œä¸ºæ¨¡å¼ï¼ˆ11ï¼‰ Template(æ¨¡æ¿æ¨¡å¼ï¼‰\nMemento(å¤‡å¿˜å½•æ¨¡å¼ï¼‰\nObserver(è§‚å¯Ÿè€…æ¨¡å¼ï¼‰\nChain of Responsibility(CoR)\nCommand\nState\nStrategy\nmediator\nInterperter\nVivistor\nIterator\n","permalink":"http://blog.chalme.top/posts/design-patterns/0.0-outline/","summary":"è®¾è®¡æ¨¡å¼(Patterns in Java) é“¾æ¥ å¦ç±»çš„è®¾è®¡æ¨¡å¼\nå›¾è¯´è®¾è®¡æ¨¡å¼\nå¦‚ä»Šè®¾è®¡æ¨¡å¼å·²ç»æˆä¸ºæ¶æ„å¸ˆå’Œç¨‹åºå‘˜ä¹‹é—´æ²Ÿé€šçš„å¿…å¤‡è¯­è¨€ï¼Œä¹Ÿæ˜¯æ™®é€šç¨‹åºå‘˜æˆé•¿ä¸ºèµ„æ·±ç¨‹åºå‘˜çš„å¿…å¤‡åŸºç¡€ä¹‹ä¸€ã€‚åªæœ‰æŒæ¡äº†è®¾è®¡æ¨¡å¼ï¼Œæ‰èƒ½æ›´å¥½åœ°æŒæ¡DDDé¢†åŸŸé©±åŠ¨è®¾è®¡ç­‰OOåˆ†æè®¾è®¡æ–¹æ³•ï¼Œä¹Ÿæ‰èƒ½æ›´ç†Ÿç»ƒåœ°å­¦ä¹ ä½¿ç”¨ä¸æ–­æ¶Œç°çš„æ–°è¯­è¨€ã€‚\nåˆ›å»ºæ¨¡å¼ï¼ˆ5ï¼‰ Factory(å·¥å‚æ¨¡å¼ï¼‰\nPrototype(åŸå‹æ¨¡å¼ï¼‰\nBuilder\nSingleton(å•ä¾‹æ¨¡å¼ï¼‰\nç»“æ„æ¨¡å¼ï¼ˆ7ï¼‰ Facade\nProxy\nAdapter\nComposite\nDecorator\nBridge\nFlyweight\nè¡Œä¸ºæ¨¡å¼ï¼ˆ11ï¼‰ Template(æ¨¡æ¿æ¨¡å¼ï¼‰\nMemento(å¤‡å¿˜å½•æ¨¡å¼ï¼‰\nObserver(è§‚å¯Ÿè€…æ¨¡å¼ï¼‰\nChain of Responsibility(CoR)\nCommand\nState\nStrategy\nmediator\nInterperter\nVivistor\nIterator","title":"0.0 outline"},{"content":"å…³äºå®¹å™¨æŠ€æœ¯ å®¹å™¨å®šä¹‰ é¦–å…ˆå¿…é¡»æ˜¯ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæœ‰ç‚¹ç±»ä¼¼è™šæ‹Ÿæœºçš„æ¦‚å¿µï¼Œä½†åˆæ²¡æœ‰è™šæ‹Ÿæœºé‚£æ ·å½»åº•ã€‚å¦å¤–ï¼Œåœ¨ä¸€ä¸ªå®¹å™¨ç¯å¢ƒå†…ï¼Œåº”è¯¥æœ€å°åŒ–å…¶å¯¹å¤–ç•Œçš„å½±å“ï¼Œæ¯”å¦‚ä¸èƒ½åœ¨å®¹å™¨ä¸­æŠŠ host ä¸Šçš„èµ„æºå…¨éƒ¨æ¶ˆè€—æ‰ï¼Œè¿™å°±æ˜¯èµ„æºæ§åˆ¶ã€‚\nå®¹å™¨æŠ€æœ¯å·²ç»é›†æˆåˆ°äº† Linux å†…æ ¸ä¸­ï¼Œå·²ç»è¢«å½“ä½œ Linux å†…æ ¸åŸç”Ÿæä¾›çš„ç‰¹æ€§ã€‚\nå®¹å™¨æŠ€æœ¯ä¸»è¦åŒ…æ‹¬Namespaceå’ŒCgroupä¸¤ä¸ªå†…æ ¸ç‰¹æ€§ã€‚\nNamespace åˆç§°å‘½åç©ºé—´ï¼Œå®ƒä¸»è¦åšè®¿é—®éš”ç¦»ã€‚å…¶åŸç†æ˜¯é’ˆå¯¹ä¸€ç±»èµ„æºè¿›è¡ŒæŠ½è±¡ï¼Œ å¹¶å°†å…¶å°è£…åœ¨ä¸€èµ·æä¾›ç»™ä¸€ä¸ªå®¹å™¨ä½¿ç”¨ï¼Œå¯¹äºè¿™ç±»èµ„æºï¼Œå›  ä¸ºæ¯ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±çš„æŠ½è±¡ï¼Œè€Œå®ƒä»¬å½¼æ­¤ä¹‹é—´æ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥ åšåˆ°è®¿é—®éš”ç¦»ã€‚ Cgroup æ˜¯ control group çš„ç®€ç§°ï¼Œåˆç§°æ§åˆ¶ç»„ï¼Œå®ƒä¸»è¦æ˜¯åšèµ„æºæ§åˆ¶ã€‚ å…¶åŸç†æ˜¯å°†ä¸€ç»„è¿›ç¨‹æ”¾åœ¨ä¸€ä¸ªæ§åˆ¶ç»„é‡Œï¼Œé€šè¿‡ç»™è¿™ä¸ªæ§åˆ¶ç»„åˆ†é…æŒ‡å®šçš„ å¯ç”¨èµ„æºï¼Œè¾¾åˆ°æ§åˆ¶è¿™ä¸€ç»„è¿›ç¨‹å¯ç”¨èµ„æºçš„ç›®çš„ã€‚ å®é™…ä¸Šï¼ŒNamespace å’Œ Cgroup å¹¶ä¸æ˜¯å¼ºç›¸å…³çš„ä¸¤ç§æŠ€æœ¯ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å• ç‹¬ä½¿ç”¨ä»–ä»¬ï¼Œæ¯”å¦‚å•ç‹¬ä½¿ç”¨ Cgroup åšèµ„æºç®¡ç†ï¼Œå°±æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„åšæ³•ã€‚è€Œ å¦‚æœæŠŠä»–ä»¬åº”ç”¨åˆ°ä¸€èµ·ï¼Œåœ¨ä¸€ä¸ª Namespace ä¸­çš„è¿›ç¨‹æ°å¥½åˆåœ¨ä¸€ä¸ª Cgroup ä¸­ï¼Œ é‚£ä¹ˆè¿™äº›è¿›ç¨‹å°±æ—¢æœ‰è®¿é—®éš”ç¦»ï¼Œåˆæœ‰èµ„æºæ§åˆ¶ï¼Œç¬¦åˆå®¹å™¨çš„ç‰¹æ€§ï¼Œè¿™æ ·å°±åˆ›å»º äº†ä¸€ä¸ªå®¹å™¨ã€‚\nç†è§£å®¹å™¨ å®¹å™¨çš„æ ¸å¿ƒæŠ€æœ¯æ˜¯ Cgroup + Namespace ï¼Œä½†å…‰æœ‰è¿™ä¸¤ä¸ªæŠ½è±¡çš„æŠ€æœ¯æ¦‚å¿µæ˜¯æ—  æ³•ç»„æˆå®¹å™¨ã€‚Linux å®¹å™¨çš„æœ€å°ç»„æˆï¼Œå¯ä»¥ç”±ä»¥ä¸‹å…¬å¼æ¥è¡¨ç¤ºï¼š\nå®¹å™¨ = cgroup + namespace + rootfs + å®¹å™¨å¼•æ“ï¼ˆç”¨æˆ·æ€å·¥å…·ï¼‰ å…¶å„é¡¹åŠŸèƒ½åˆ†åˆ«æ˜¯ï¼š\nCgroupï¼šèµ„æºæ§åˆ¶ã€‚ Namespaceï¼š è®¿é—®æ§åˆ¶ã€‚ rootfsï¼šæ–‡ä»¶ç³»ç»Ÿéš”ç¦»ã€‚ å®¹å™¨å¼•æ“ï¼šç”Ÿå‘½å‘¨æœŸæ§åˆ¶ã€‚ å®¹å™¨çš„åˆ›å»ºåŸç†ã€‚\nä»£ç ä¸€ï¼š pid = clone(fun, stack, flags, clone_arg); (flags: CLONE_NEWPID | CLONE_NEWNS | CLONE_NEWUSER | CLONE_NEWNET | CLONE_NEWipc | CLONE_NEWuts | ...) ä»£ç äºŒï¼š echo $pid \u0026gt; /sys/fs/cgroup/cpu/tasks echo $pid \u0026gt; /sys/fs/cgroup/cpuset/tasks echo $pid \u0026gt; /sys/fs/cgroup/blkio/tasks echo $pid \u0026gt; /sys/fs/cgroup/memory/tasks echo $pid \u0026gt; /sys/fs/cgroup/devices/tasks echo $pid \u0026gt; /sys/fs/cgroup/freezer/tasks ä»£ç ä¸‰ï¼š fun() { ... pivot_root(\u0026#34;path_of_rootfs/\u0026#34;, path); ... exec(\u0026#34;/bin/bash\u0026#34;); ... } ä»£ç ä¸€ï¼Œé€šè¿‡ clone ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶ä¼ å…¥å„ä¸ª Namespace å¯¹åº”çš„ clone flag ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„ Namespaceã€‚æ ¹æ®ä»¥ä¸Šä»£ç  å¯çŸ¥ï¼Œè¯¥è¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„ pidã€mountã€userã€netã€ipcã€uts namespace ã€‚ ä»£ç äºŒï¼Œå°†ä»£ç ä¸€ä¸­çš„è¿›ç¨‹ pid å†™å…¥å„ä¸ª Cgroup å­ç³»ç»Ÿä¸­ï¼Œè¿™æ ·è¯¥è¿›ç¨‹å°± å¯ä»¥å—åˆ°ç›¸åº” Cgroup å­ç³»ç»Ÿçš„æ§åˆ¶ã€‚ ä»£ç ä¸‰ï¼Œè¯¥ fun å‡½æ•°ç”±ä¸Šé¢ç”Ÿæˆçš„æ–°è¿›ç¨‹æ‰§è¡Œï¼Œåœ¨ fun å‡½æ•°ä¸­ï¼Œé€šè¿‡ pivot_root ç³»ç»Ÿè°ƒç”¨ï¼Œä½¿è¿›ç¨‹è¿›å…¥ä¸€ä¸ªæ–°çš„ rootfsï¼Œä¹‹åé€šè¿‡ exec ç³»ç»Ÿ è°ƒç”¨ï¼Œåœ¨æ–°çš„ Namespaceã€Cgroupã€ rootfs ä¸­æ‰§è¡Œ\u0026quot;/bin/bash\u0026quot;ç¨‹åºã€‚ é€šè¿‡ä»¥ä¸Šæ“ä½œï¼ŒæˆåŠŸåœ°åœ¨ä¸€ä¸ªâ€œå®¹å™¨â€ä¸­è¿è¡Œäº†ä¸€ä¸ª bash ç¨‹åºã€‚\nCgroup ä»‹ç» Cgroup æ˜¯ä»€ä¹ˆ Cgroup æ˜¯ control group çš„ç®€å†™ï¼Œå±äº Linux å†…æ ¸æä¾›çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºé™åˆ¶å’Œéš”ç¦»ä¸€ç»„ è¿›ç¨‹å¯¹ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯åšèµ„æº QoSï¼Œè¿™äº›èµ„æºä¸»è¦åŒ…æ‹¬ CPUã€å†…å­˜ã€block I/O å’Œç½‘ ç»œå¸¦å®½ã€‚\nä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼ŒCgroup å®ç°äº†ä¸€ä¸ªé€šç”¨çš„è¿›ç¨‹åˆ†ç»„çš„æ¡†æ¶ï¼Œè€Œä¸åŒèµ„æºçš„å…·ä½“ç®¡ç†åˆ™ æ˜¯ç”±å„ä¸ª Cgroup å­ç³»ç»Ÿå®ç°çš„ã€‚æˆªæ­¢åˆ°å†…æ ¸ 4.1 ç‰ˆæœ¬ï¼ŒCgroup ä¸­å®ç°çš„å­ç³»ç»ŸåŠå…¶ä½œç”¨å¦‚ä¸‹ï¼š devicesï¼šè®¾å¤‡æƒé™æ§åˆ¶ã€‚ cpusetï¼šåˆ†é…æŒ‡å®šçš„ CPU å’Œå†…å­˜èŠ‚ç‚¹ã€‚ cpuï¼šæ§åˆ¶ CPU å ç”¨ç‡ã€‚ cpuacctï¼šç»Ÿè®¡ CPU ä½¿ç”¨æƒ…å†µã€‚ memoryï¼šé™åˆ¶å†…å­˜çš„ä½¿ç”¨ä¸Šé™ã€‚ freezerï¼šå†»ç»“ï¼ˆæš‚åœï¼‰Cgroup ä¸­çš„è¿›ç¨‹ã€‚ net_clsï¼šé…åˆ tcï¼ˆtraffic controllerï¼‰é™åˆ¶ç½‘ç»œå¸¦å®½ã€‚ net_prioï¼šè®¾ç½®è¿›ç¨‹çš„ç½‘ç»œæµé‡ä¼˜å…ˆçº§ã€‚ huge_tlbï¼šé™åˆ¶ HugeTLB çš„ä½¿ç”¨ã€‚ perf_eventï¼šå…è®¸ Perf å·¥å…·åŸºäº Cgroup åˆ†ç»„åšæ€§èƒ½æ£€æµ‹ã€‚ åœ¨ Cgroup å‡ºç°ä¹‹å‰ï¼Œåªèƒ½å¯¹ä¸€ä¸ªè¿›ç¨‹åšä¸€äº›èµ„æºæ§åˆ¶ã€‚ Namespace ä»‹ç» Namespace æ˜¯ä»€ä¹ˆ Namespace æ˜¯å°†å†…æ ¸çš„å…¨å±€èµ„æºåšå°è£…ï¼Œä½¿å¾—æ¯ä¸ª Namespace éƒ½æœ‰ä¸€ä»½ç‹¬ç«‹çš„èµ„æºï¼Œå› æ­¤ä¸åŒçš„è¿›ç¨‹åœ¨å„è‡ªçš„ Namespace å†…å¯¹åŒä¸€ç§èµ„æºçš„ä½¿ç”¨ä¸ä¼šäº’ç›¸å¹²æ‰°ã€‚\nç›®å‰ Linux å†…æ ¸æ€»å…±å®ç°äº† 6 ç§ Namespace: IPC: éš”ç¦» System V IPC å’Œ POSIX æ¶ˆæ¯é˜Ÿåˆ—ã€‚ Networkï¼šéš”ç¦»ç½‘ç»œèµ„æºã€‚ Mountï¼šéš”ç¦»æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ã€‚ PIDï¼šéš”ç¦»è¿›ç¨‹ IDã€‚ UTSï¼šéš”ç¦»ä¸»æœºåå’ŒåŸŸåã€‚ Userï¼šéš”ç¦»ç”¨æˆ· ID å’Œç»„ IDã€‚ æœ€å å¾ˆå¤±æœ›ç›®å‰ä¸èƒ½ç»§ç»­ä¸‹å»ã€‚æˆ‘è¯»çš„è¿™æœ¬ä¹¦æ˜¯dockerè¿›é˜¶ä¸å®è·µï¼Œç¡®å®æ˜¯è¿›é˜¶ï¼Œä¹‹å‰æ²¡æœ‰äº†è§£è¿‡ dockerï¼Œç°åœ¨å†™çš„åŸºæœ¬éƒ½æ˜¯åœ¨æ‘˜æŠ„ä¹¦ä¸Šçš„å†…å®¹ï¼Œæ‘˜æŠ„å¹¶æ²¡æœ‰é”™ï¼Œä½†æ˜¯ç¡®å®ç†è§£ä¸æ˜¯ç‰¹åˆ« æ·±åˆ»ï¼Œè¿‡æ®µæ—¶é—´ï¼Œåœ¨è¯»ã€‚\n","permalink":"http://blog.chalme.top/posts/%E5%AE%B9%E5%99%A8/%E5%85%B3%E4%BA%8E%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/","summary":"å…³äºå®¹å™¨æŠ€æœ¯ å®¹å™¨å®šä¹‰ é¦–å…ˆå¿…é¡»æ˜¯ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæœ‰ç‚¹ç±»ä¼¼è™šæ‹Ÿæœºçš„æ¦‚å¿µï¼Œä½†åˆæ²¡æœ‰è™šæ‹Ÿæœºé‚£æ ·å½»åº•ã€‚å¦å¤–ï¼Œåœ¨ä¸€ä¸ªå®¹å™¨ç¯å¢ƒå†…ï¼Œåº”è¯¥æœ€å°åŒ–å…¶å¯¹å¤–ç•Œçš„å½±å“ï¼Œæ¯”å¦‚ä¸èƒ½åœ¨å®¹å™¨ä¸­æŠŠ host ä¸Šçš„èµ„æºå…¨éƒ¨æ¶ˆè€—æ‰ï¼Œè¿™å°±æ˜¯èµ„æºæ§åˆ¶ã€‚\nå®¹å™¨æŠ€æœ¯å·²ç»é›†æˆåˆ°äº† Linux å†…æ ¸ä¸­ï¼Œå·²ç»è¢«å½“ä½œ Linux å†…æ ¸åŸç”Ÿæä¾›çš„ç‰¹æ€§ã€‚\nå®¹å™¨æŠ€æœ¯ä¸»è¦åŒ…æ‹¬Namespaceå’ŒCgroupä¸¤ä¸ªå†…æ ¸ç‰¹æ€§ã€‚\nNamespace åˆç§°å‘½åç©ºé—´ï¼Œå®ƒä¸»è¦åšè®¿é—®éš”ç¦»ã€‚å…¶åŸç†æ˜¯é’ˆå¯¹ä¸€ç±»èµ„æºè¿›è¡ŒæŠ½è±¡ï¼Œ å¹¶å°†å…¶å°è£…åœ¨ä¸€èµ·æä¾›ç»™ä¸€ä¸ªå®¹å™¨ä½¿ç”¨ï¼Œå¯¹äºè¿™ç±»èµ„æºï¼Œå›  ä¸ºæ¯ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±çš„æŠ½è±¡ï¼Œè€Œå®ƒä»¬å½¼æ­¤ä¹‹é—´æ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥ åšåˆ°è®¿é—®éš”ç¦»ã€‚ Cgroup æ˜¯ control group çš„ç®€ç§°ï¼Œåˆç§°æ§åˆ¶ç»„ï¼Œå®ƒä¸»è¦æ˜¯åšèµ„æºæ§åˆ¶ã€‚ å…¶åŸç†æ˜¯å°†ä¸€ç»„è¿›ç¨‹æ”¾åœ¨ä¸€ä¸ªæ§åˆ¶ç»„é‡Œï¼Œé€šè¿‡ç»™è¿™ä¸ªæ§åˆ¶ç»„åˆ†é…æŒ‡å®šçš„ å¯ç”¨èµ„æºï¼Œè¾¾åˆ°æ§åˆ¶è¿™ä¸€ç»„è¿›ç¨‹å¯ç”¨èµ„æºçš„ç›®çš„ã€‚ å®é™…ä¸Šï¼ŒNamespace å’Œ Cgroup å¹¶ä¸æ˜¯å¼ºç›¸å…³çš„ä¸¤ç§æŠ€æœ¯ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å• ç‹¬ä½¿ç”¨ä»–ä»¬ï¼Œæ¯”å¦‚å•ç‹¬ä½¿ç”¨ Cgroup åšèµ„æºç®¡ç†ï¼Œå°±æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„åšæ³•ã€‚è€Œ å¦‚æœæŠŠä»–ä»¬åº”ç”¨åˆ°ä¸€èµ·ï¼Œåœ¨ä¸€ä¸ª Namespace ä¸­çš„è¿›ç¨‹æ°å¥½åˆåœ¨ä¸€ä¸ª Cgroup ä¸­ï¼Œ é‚£ä¹ˆè¿™äº›è¿›ç¨‹å°±æ—¢æœ‰è®¿é—®éš”ç¦»ï¼Œåˆæœ‰èµ„æºæ§åˆ¶ï¼Œç¬¦åˆå®¹å™¨çš„ç‰¹æ€§ï¼Œè¿™æ ·å°±åˆ›å»º äº†ä¸€ä¸ªå®¹å™¨ã€‚\nç†è§£å®¹å™¨ å®¹å™¨çš„æ ¸å¿ƒæŠ€æœ¯æ˜¯ Cgroup + Namespace ï¼Œä½†å…‰æœ‰è¿™ä¸¤ä¸ªæŠ½è±¡çš„æŠ€æœ¯æ¦‚å¿µæ˜¯æ—  æ³•ç»„æˆå®¹å™¨ã€‚Linux å®¹å™¨çš„æœ€å°ç»„æˆï¼Œå¯ä»¥ç”±ä»¥ä¸‹å…¬å¼æ¥è¡¨ç¤ºï¼š\nå®¹å™¨ = cgroup + namespace + rootfs + å®¹å™¨å¼•æ“ï¼ˆç”¨æˆ·æ€å·¥å…·ï¼‰ å…¶å„é¡¹åŠŸèƒ½åˆ†åˆ«æ˜¯ï¼š\nCgroupï¼šèµ„æºæ§åˆ¶ã€‚ Namespaceï¼š è®¿é—®æ§åˆ¶ã€‚ rootfsï¼šæ–‡ä»¶ç³»ç»Ÿéš”ç¦»ã€‚ å®¹å™¨å¼•æ“ï¼šç”Ÿå‘½å‘¨æœŸæ§åˆ¶ã€‚ å®¹å™¨çš„åˆ›å»ºåŸç†ã€‚\nä»£ç ä¸€ï¼š pid = clone(fun, stack, flags, clone_arg); (flags: CLONE_NEWPID | CLONE_NEWNS | CLONE_NEWUSER | CLONE_NEWNET | CLONE_NEWipc | CLONE_NEWuts | .","title":"å…³äºå®¹å™¨æŠ€æœ¯"},{"content":"å¯¹äºæŒ‡é’ˆçš„ç¡®æˆ‘ä¹‹å‰è¿˜æ²¡çœŸæ­£äº†è§£ï¼Œä¸€æ¬¡é¢è¯•æš´éœ²æ— é—ã€‚ç¡®å®è¿˜æ˜¯åº”è¯¥å¥½å¥½å­¦ä¹ ä¸€ä¸‹æŒ‡é’ˆã€‚\nä»Šå¤©çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œç¡®å®è¿˜æ˜¯æŒºè¯¦ç»†çš„ã€‚ ç‚¹æ­¤è¿›å…¥\näº†è§£æŒ‡é’ˆä¸€èˆ¬è¦æ¸…æ¥š 3 ç‚¹\næŒ‡é’ˆçš„ç±»å‹ æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ æŒ‡é’ˆçš„å€¼ å…·ä½“è¯·çœ‹åŸæ–‡\n","permalink":"http://blog.chalme.top/posts/history/%E6%8C%87%E9%92%88%E7%9A%84%E8%AF%A6%E8%A7%A3/","summary":"å¯¹äºæŒ‡é’ˆçš„ç¡®æˆ‘ä¹‹å‰è¿˜æ²¡çœŸæ­£äº†è§£ï¼Œä¸€æ¬¡é¢è¯•æš´éœ²æ— é—ã€‚ç¡®å®è¿˜æ˜¯åº”è¯¥å¥½å¥½å­¦ä¹ ä¸€ä¸‹æŒ‡é’ˆã€‚\nä»Šå¤©çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œç¡®å®è¿˜æ˜¯æŒºè¯¦ç»†çš„ã€‚ ç‚¹æ­¤è¿›å…¥\näº†è§£æŒ‡é’ˆä¸€èˆ¬è¦æ¸…æ¥š 3 ç‚¹\næŒ‡é’ˆçš„ç±»å‹ æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ æŒ‡é’ˆçš„å€¼ å…·ä½“è¯·çœ‹åŸæ–‡","title":"æŒ‡é’ˆçš„è¯¦è§£"},{"content":"ä»Šå¤©è¿™æ˜¯æˆ‘å†™çš„ç¬¬ä¸€ç¯‡åšå®¢ï¼Œä¸çŸ¥é“åœ¨ä½¿ç”¨ git ä¸­é‡åˆ°è¿‡ä¸‹é¢çš„é—®é¢˜ :\nè‡ªå·±é…ç½®äº†å…¨å±€çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å´æœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä¹‹ä¸Š çš„ git è´¦å·åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Š(æ¯”å¦‚ github, csdn),æˆ–è€…æˆ‘ä»¬æ­£åœ¨åšä¸¤ä¸ªä»¥ä¸Šé¡¹ç›®(åœ¨ github)éœ€è¦é…ç½®ä¸åŒ sshï¼Œ æˆ‘ä»¬çš„ç”¨æˆ·ä¿¡æ¯å´ ä¸åŒ, ä½†æ˜¯æˆ‘ä»¬å´ä¸èƒ½é…ç½®ä¸¤ä¸ªå…¨å±€ä¿¡æ¯ã€‚ä¸ºäº†ä½¿ç”¨ ssh æœåŠ¡ï¼Œé¿å…æ¯æ¬¡éƒ½è¦è¾“å…¥ç”¨æˆ·å¯†ç ï¼Œæˆ‘ä»¬ è¿˜æ˜¯è¦ä½¿ç”¨ç§˜é’¥æ¥é…ç½®ã€‚\nå…¶å®è¿™å°±æ˜¯ä¸ªå‘ å½“æˆ‘ä»¬æ˜¯æ–°æ‰‹æ—¶ï¼Œæ¯æ¬¡çœ‹åˆ°æ•™ç¨‹éƒ½è¦é…ç½®å…¨å±€çš„ä¸ªäººä¿¡æ¯(user.name, user.email)ï¼Œè™½ç„¶å®ƒæ¯”è¾ƒç®€å•ï¼Œä½†ç¡®å®å¯¼è‡´ äº†ä¸€äº›ä½¿ç”¨çš„é—®é¢˜ã€‚ åˆ‡å…¥æ­£é¢˜ï¼Œè§£å†³æ–¹æ¡ˆï¼š\næˆ‘ä»¬ä¸è¦ä½¿ç”¨ä½¿ç”¨å…¨å±€çš„ç”¨æˆ·ä¿¡æ¯é…ç½®ï¼Œæ”¹æˆåœ¨é¡¹ç›®å†…éƒ¨é…ç½®ã€‚\ngit config user.name \u0026#34;username\u0026#34; git config user.email \u0026#34;XXX@email.com\u0026#34; é…ç½®å…¬é’¥æ—¶ï¼Œéœ€è¦åœ¨~/.sshç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ª config çš„æ–‡ä»¶,æ ¼å¼å¦‚ä¸‹\nHost åç§°(è‡ªå·±å†³å®šï¼Œæ–¹ä¾¿è¾“å…¥è®°å¿†çš„) HostName ä¸»æœºå User ç™»å½•çš„ç”¨æˆ·å IdentityFile ç§é’¥åœ°å€ ä¾‹å­\n#github \u0026#34;æ³¨é‡Š Host github.com \u0026#34; ç®€ç§° HostName github.com \u0026#34; æœåŠ¡å™¨åœ°å€ User chalme \u0026#34; ç”¨æˆ·å IdentityFile ~/.ssh/id_rsa \u0026#34; å…¬é’¥åœ°å€ Host code.csdn.net HostName code.csdn.net User chalme IdentityFile ~/.ssh/id_rsa_csdn Host A HostName github.com User B IdentityFile ~/.ssh/id_rsa_csdn ","permalink":"http://blog.chalme.top/posts/history/git%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAssh%E7%94%A8%E6%88%B7/","summary":"ä»Šå¤©è¿™æ˜¯æˆ‘å†™çš„ç¬¬ä¸€ç¯‡åšå®¢ï¼Œä¸çŸ¥é“åœ¨ä½¿ç”¨ git ä¸­é‡åˆ°è¿‡ä¸‹é¢çš„é—®é¢˜ :\nè‡ªå·±é…ç½®äº†å…¨å±€çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å´æœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä¹‹ä¸Š çš„ git è´¦å·åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Š(æ¯”å¦‚ github, csdn),æˆ–è€…æˆ‘ä»¬æ­£åœ¨åšä¸¤ä¸ªä»¥ä¸Šé¡¹ç›®(åœ¨ github)éœ€è¦é…ç½®ä¸åŒ sshï¼Œ æˆ‘ä»¬çš„ç”¨æˆ·ä¿¡æ¯å´ ä¸åŒ, ä½†æ˜¯æˆ‘ä»¬å´ä¸èƒ½é…ç½®ä¸¤ä¸ªå…¨å±€ä¿¡æ¯ã€‚ä¸ºäº†ä½¿ç”¨ ssh æœåŠ¡ï¼Œé¿å…æ¯æ¬¡éƒ½è¦è¾“å…¥ç”¨æˆ·å¯†ç ï¼Œæˆ‘ä»¬ è¿˜æ˜¯è¦ä½¿ç”¨ç§˜é’¥æ¥é…ç½®ã€‚\nå…¶å®è¿™å°±æ˜¯ä¸ªå‘ å½“æˆ‘ä»¬æ˜¯æ–°æ‰‹æ—¶ï¼Œæ¯æ¬¡çœ‹åˆ°æ•™ç¨‹éƒ½è¦é…ç½®å…¨å±€çš„ä¸ªäººä¿¡æ¯(user.name, user.email)ï¼Œè™½ç„¶å®ƒæ¯”è¾ƒç®€å•ï¼Œä½†ç¡®å®å¯¼è‡´ äº†ä¸€äº›ä½¿ç”¨çš„é—®é¢˜ã€‚ åˆ‡å…¥æ­£é¢˜ï¼Œè§£å†³æ–¹æ¡ˆï¼š\næˆ‘ä»¬ä¸è¦ä½¿ç”¨ä½¿ç”¨å…¨å±€çš„ç”¨æˆ·ä¿¡æ¯é…ç½®ï¼Œæ”¹æˆåœ¨é¡¹ç›®å†…éƒ¨é…ç½®ã€‚\ngit config user.name \u0026#34;username\u0026#34; git config user.email \u0026#34;XXX@email.com\u0026#34; é…ç½®å…¬é’¥æ—¶ï¼Œéœ€è¦åœ¨~/.sshç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ª config çš„æ–‡ä»¶,æ ¼å¼å¦‚ä¸‹\nHost åç§°(è‡ªå·±å†³å®šï¼Œæ–¹ä¾¿è¾“å…¥è®°å¿†çš„) HostName ä¸»æœºå User ç™»å½•çš„ç”¨æˆ·å IdentityFile ç§é’¥åœ°å€ ä¾‹å­\n#github \u0026#34;æ³¨é‡Š Host github.com \u0026#34; ç®€ç§° HostName github.com \u0026#34; æœåŠ¡å™¨åœ°å€ User chalme \u0026#34; ç”¨æˆ·å IdentityFile ~/.ssh/id_rsa \u0026#34; å…¬é’¥åœ°å€ Host code.csdn.net HostName code.csdn.net User chalme IdentityFile ~/.ssh/id_rsa_csdn Host A HostName github.","title":"Gité…ç½®å¤šä¸ªsshç”¨æˆ·"},{"content":"","permalink":"http://blog.chalme.top/categories/","summary":"categories","title":"Category"},{"content":"æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ»‘åŠ¨çª—å£ï¼›åŒæŒ‡é’ˆ å·¦å³æŒ‡é’ˆéƒ½åªéå†ä¸€æ¬¡ï¼› æ—¶é—´å¤æ‚åº¦: O(n) ç©ºé—´å¤æ‚åº¦: O(âˆ£Î£âˆ£) (å‡ºç°çš„å­—ç¬¦çš„æ¬¡æ•°ï¼‰\nclass Solution { public int lengthOfLongestSubstring(String s) { Set\u0026lt;Character\u0026gt; record = new HashSet\u0026lt;\u0026gt;(); int ans = 0, n = s.length(); int j = -1; for (int i=0; i\u0026lt;n; i++) { if (i != 0) { record.remove(s.charAt(i-1)); } while (j+1 \u0026lt;n \u0026amp;\u0026amp; !record.contains(s.charAt(j+1))) { record.add(s.charAt(j+1)); j = j+1; } ans = Math.max(ans, j-i+1); } return ans; } } 15. ä¸‰æ•°ä¹‹å’Œ æ€è·¯ æ’åº + åŒæŒ‡é’ˆï¼› æ³¨æ„è¾¹ç•Œ\nclass Solution { public List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; threeSum(int[] nums) { int len = nums.length; List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; result = new ArrayList\u0026lt;\u0026gt;(); Arrays.sort(nums); for (int i=0; i\u0026lt;len; i++) { if (i!=0 \u0026amp;\u0026amp; nums[i] == nums[i-1]) { continue; } int left = i+1; int right = len - 1; while (left \u0026lt; right) { int three = -(nums[i] + nums[left]); while (left \u0026lt; right \u0026amp;\u0026amp; nums[right] \u0026gt; three) { right --; } if (nums[right] == three) { List\u0026lt;Integer\u0026gt; item = new ArrayList\u0026lt;\u0026gt;(); item.add(nums[i]); item.add(nums[left]); item.add(nums[right]); result.add(item); } while (left \u0026lt; right \u0026amp;\u0026amp; nums[left+1] == nums[left]) { left ++; } while (left \u0026lt; right \u0026amp;\u0026amp; nums[right-1] == nums[right]) { right --; } left ++; } } return result; } } 209. é•¿åº¦æœ€å°çš„å­æ•°ç»„ class Solution { public int minSubArrayLen(int target, int[] nums) { int n = nums.length; int left = 0, right = 0; int sum = 0; int res = Integer.MAX_VALUE; while (right \u0026lt; n ) { sum += nums[right]; while (sum \u0026gt;= target) { if (right - left + 1 \u0026lt; res) { res = right - left + 1; } sum -= nums[left]; left ++; } right ++; } return res == Integer.MAX_VALUE ? 0 : res; } } 76. æœ€å°è¦†ç›–å­ä¸² åŒæŒ‡é’ˆ\nclass Solution { public String minWindow(String s, String t) { int[] need = new int[128]; int[] save = new int[128]; for (int i=0; i\u0026lt;t.length(); i++) { need[t.charAt(i)] ++; } int len = s.length(); int min = len + 1; int left = 0, right = 0, cnt = 0, start = 0; while (right \u0026lt; len) { char c = s.charAt(right); if (need[c] == 0) { right ++; continue; } if (save[c] \u0026lt; need[c]) { cnt ++; } save[c] ++; right ++; while (cnt == t.length()) { if (right - left \u0026lt; min) { min = right - left; start = left; } char l = s.charAt(left); if (need[l] == 0) { left ++; continue; } if (save[l] == need[l]) { cnt --; } save[l] --; left ++; } } if (min == len + 1) { return \u0026#34;\u0026#34;; } return s.substring(start, start + min); } } ","permalink":"http://blog.chalme.top/posts/%E7%AE%97%E6%B3%95%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%B1%BB%E5%9E%8B%E9%A2%98-%E5%8F%8C%E6%8C%87%E9%92%88/","summary":"æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æ»‘åŠ¨çª—å£ï¼›åŒæŒ‡é’ˆ å·¦å³æŒ‡é’ˆéƒ½åªéå†ä¸€æ¬¡ï¼› æ—¶é—´å¤æ‚åº¦: O(n) ç©ºé—´å¤æ‚åº¦: O(âˆ£Î£âˆ£) (å‡ºç°çš„å­—ç¬¦çš„æ¬¡æ•°ï¼‰\nclass Solution { public int lengthOfLongestSubstring(String s) { Set\u0026lt;Character\u0026gt; record = new HashSet\u0026lt;\u0026gt;(); int ans = 0, n = s.length(); int j = -1; for (int i=0; i\u0026lt;n; i++) { if (i != 0) { record.remove(s.charAt(i-1)); } while (j+1 \u0026lt;n \u0026amp;\u0026amp; !record.contains(s.charAt(j+1))) { record.add(s.charAt(j+1)); j = j+1; } ans = Math.max(ans, j-i+1); } return ans; } } 15. ä¸‰æ•°ä¹‹å’Œ æ€è·¯ æ’åº + åŒæŒ‡é’ˆï¼› æ³¨æ„è¾¹ç•Œ","title":"ç±»å‹é¢˜-åŒæŒ‡é’ˆ"}]