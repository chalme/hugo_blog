[{"content":" æ­¤æ–‡ç« ä¸»è¦æ•´ç†äº† macos ä¸ªäººå¸¸ç”¨çš„è½¯ä»¶ã€‚è½¯ä»¶åˆ†ä¸º appstore å’Œ brewä¸¤ä¸ªæ¥æºã€‚ brewè½¯ä»¶æ¥æºä¸€èˆ¬éƒ½æ˜¯å¼€æºçš„é¡¹ç›®ã€‚\nappstore å·¥å…· Justfocus ç•ªèŒ„å·¥ä½œ\nCaffeinated é¿å… mac ç¡çœ \niShot æˆªå›¾è½¯ä»¶ï¼ŒåŠŸèƒ½é½å…¨ã€‚ ä¹Ÿå¯ä»¥ç”¨ xnip ç­‰ä»£æ›¿ã€‚\nbrew èµ„æº è½¯ä»¶ clashx github\nClashX æ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•è½»é‡åŒ–çš„ä»£ç†å®¢æˆ·ç«¯\ncalibre github\nThe official source code repository for the calibre ebook manager\nmotrix A full-featured download manager\nlisten1 github\nListen 1 å¯ä»¥æœç´¢å’Œæ’­æ”¾æ¥è‡ªå¤šä¸ªä¸»æµéŸ³ä¹ç½‘ç«™çš„æ­Œæ›²ï¼Œè®©ä½ çš„æ›²åº“æ›´å…¨é¢ã€‚å¹¶æ”¯æŒæ”¶è—åŠŸèƒ½ï¼Œæ–¹ä¾¿çš„åˆ›å»ºè‡ªå·±çš„æ­Œå•ã€‚\nNetNewsWire github\nItâ€™s a free and open source feed reader for macOS and iOS.\namethyst github\nAutomatic tiling window manager for macOS Ã  la xmonad.\nrectangle github\nMove and resize windows on macOS with keyboard shortcuts and snap areas\naerial github\nApple TV Aerial Screensaver for Mac. å±å¹•ä¿æŠ¤ç¨‹åº\nblurred github\nA macOS utility that helps reduce distraction by dimming your inactive noise.ï¼ˆä¸“æ³¨å½“å‰çš„ appï¼‰\nhidden github An ultra-light MacOS utility that helps hide menu bar icons\ncheatsheet official\nJust hold the âŒ˜-Key a bit longer to get a list of all active shortcuts of the current application. It\u0026rsquo;s as simple as that.(å±•ç¤ºå½“å‰ App å¿«æ·é”®æˆ–ä¿®æ”¹ï¼‰\nclean-me github\nA macOS system analyser and cleaner\neul github\nğŸ–¥ï¸ macOS status monitoring app written in SwiftUI.\nkeka github\nThe macOS file archiver\nmonitorcontrol github\nğŸ–¥ Control your display\u0026rsquo;s brightness \u0026amp; volume on your Mac as if it was a native Apple Display. Use Apple Keyboard keys or custom shortcuts. Shows the native macOS OSDs.(æ§åˆ¶æ˜¾ç¤ºå™¨)\nmaccy github\nLightweight clipboard manager for macOS\nuPic github\nğŸ“¤uPic is a native, powerful, beautiful and simple picture and file upload tool for macOS.\nç¬”è®° fsnotes github\nNotes manager for macOS/iOS\nnotable github\nThe Markdown-based note-taking app that doesn\u0026rsquo;t suck.\nå¼€å‘ AnotherRedisDesktopManager github\nintellij-idea iterm2 syncthing github\nOpen Source Continuous File Synchronization\nvimrc github\ngit clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime sh ~/.vim_runtime/install_awesome_vimrc.sh å…¶ä»– swiftbar github\nPowerful macOS menu bar customization tool\nHammerspoon github\nThis is a tool for powerful automation of OS X. At its core, Hammerspoon is just a bridge between the operating system and a Lua scripting engine.\nCakebrew Manage your Homebrew formulas with style using Cakebrew. github\niptv https://github.com/iptv-org/iptv\ncommand fzf fzf is a general-purpose command-line fuzzy finder.\nwrk github\na HTTP benchmarking tool\nmkcert github\nA simple zero-config tool to make locally trusted development certificates with any names you\u0026rsquo;d like.\nbrew install clashx; brew install netnewswire; brew install calibre; brew install motrix; brew install listen1; brew install netnewswire; brew install amethyst; brew install rectangle; brew install aerial; brew install blurred; brew install hiddenbar; brew install cheatsheet; brew install clean-me; brew install eul; brew install fsnotes; brew install keka; brew install maccy; brew install monitorcontrol; brew install rectangle; brew install upic; brew install another-redis-desktop-manager; brew install cakebrew; brew install iterm2; brew install intellij-idea; brew install syncthing; brew install swiftbar; brew install hammerspoon; brew install fzf; brew install wrk; ","permalink":"https://blog.chalme.top/posts/macos/macos-software/","summary":"æ­¤æ–‡ç« ä¸»è¦æ•´ç†äº† macos ä¸ªäººå¸¸ç”¨çš„è½¯ä»¶ã€‚è½¯ä»¶åˆ†ä¸º appstore å’Œ brewä¸¤ä¸ªæ¥æºã€‚ brewè½¯ä»¶æ¥æºä¸€èˆ¬éƒ½æ˜¯å¼€æºçš„é¡¹ç›®ã€‚\nappstore å·¥å…· Justfocus ç•ªèŒ„å·¥ä½œ\nCaffeinated é¿å… mac ç¡çœ \niShot æˆªå›¾è½¯ä»¶ï¼ŒåŠŸèƒ½é½å…¨ã€‚ ä¹Ÿå¯ä»¥ç”¨ xnip ç­‰ä»£æ›¿ã€‚\nbrew èµ„æº è½¯ä»¶ clashx github\nClashX æ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•è½»é‡åŒ–çš„ä»£ç†å®¢æˆ·ç«¯\ncalibre github\nThe official source code repository for the calibre ebook manager\nmotrix A full-featured download manager\nlisten1 github\nListen 1 å¯ä»¥æœç´¢å’Œæ’­æ”¾æ¥è‡ªå¤šä¸ªä¸»æµéŸ³ä¹ç½‘ç«™çš„æ­Œæ›²ï¼Œè®©ä½ çš„æ›²åº“æ›´å…¨é¢ã€‚å¹¶æ”¯æŒæ”¶è—åŠŸèƒ½ï¼Œæ–¹ä¾¿çš„åˆ›å»ºè‡ªå·±çš„æ­Œå•ã€‚\nNetNewsWire github\nItâ€™s a free and open source feed reader for macOS and iOS.\namethyst github\nAutomatic tiling window manager for macOS Ã  la xmonad.","title":"Macos Software"},{"content":"æ¦‚è¿° sedæ˜¯stream editorçš„ç®€ç§°ï¼Œä¹Ÿå°±æ˜¯æµç¼–è¾‘å™¨ã€‚å®ƒä¸€æ¬¡å¤„ç†ä¸€è¡Œå†…å®¹ï¼Œå¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸º\u0026quot;pattern space\u0026quot;ï¼Œæ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®Œæˆåï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰ æ”¹å˜ï¼Œé™¤éä½ ä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚\nåŸºç¡€ -E -- use extended regular expressions -a -- delay opening files listed with w function -e -- specify sed commands to run -f -- add contents of file to commands to run -i -- edit files in-place, running scripts separately for each file -l -- make output line buffered -n -- suppress automatic printing of pattern space a,append è¿½åŠ  i,insert æ’å…¥ d,delete åˆ é™¤ s,substitution æ›¿æ¢ c,change ä¿®æ”¹ y,transform è½¬æ¢ æ›¿æ¢ æ›¿æ¢æ ‡è®° sï¼ˆsubstitutionï¼‰é»˜è®¤æƒ…å†µä¸‹åªæ›¿æ¢æ¯è¡Œä¸­å‡ºç°çš„ç¬¬ä¸€å¤„ã€‚ä½¿ç”¨æ›¿æ¢æ ‡è®°ï¼ˆsubstitution flagï¼‰æŒ‡å®šæ›¿æ¢ä½ç½®ã€‚æ›¿æ¢æ ‡è®°åœ¨æ›¿æ¢å‘½ä»¤å­—ç¬¦ä¸²ä¹‹åè®¾ç½®ã€‚ s/pattern/replacement/flags æœ‰4ç§å¯ç”¨çš„æ›¿æ¢æ ‡è®°ï¼š\næ•°å­—ï¼Œè¡¨æ˜æ–°æ–‡æœ¬å°†æ›¿æ¢ç¬¬å‡ å¤„æ¨¡å¼åŒ¹é…çš„åœ°æ–¹ï¼› gï¼Œè¡¨æ˜æ–°æ–‡æœ¬å°†ä¼šæ›¿æ¢æ‰€æœ‰åŒ¹é…çš„æ–‡æœ¬ï¼› pï¼Œè¡¨æ˜æ›¿æ¢è¿‡çš„è¡Œè¦æ‰“å°å‡ºæ¥ï¼› w fileï¼Œå°†æ›¿æ¢çš„ç»“æœå†™åˆ°æ–‡ä»¶ä¸­ã€‚ æ›¿æ¢å­—ç¬¦ sedå…è®¸é€‰æ‹©å…¶ä»–å­—ç¬¦æ¥ä½œä¸ºæ›¿æ¢å‘½ä»¤ä¸­çš„å­—ç¬¦ä¸²åˆ†éš”ç¬¦ï¼š\nsed \u0026#39;s!/bin/bash!/bin/csh!\u0026#39; /etc/passwd ä½¿ç”¨åœ°å€ é»˜è®¤æƒ…å†µä¸‹ï¼Œsedå‘½ä»¤ä¼šä½œç”¨äºæ–‡æœ¬æ•°æ®çš„æ‰€æœ‰è¡Œã€‚å¦‚æœåªæƒ³å°†å‘½ä»¤ä½œç”¨äºç‰¹å®šè¡Œæˆ–æŸäº›è¡Œï¼Œåˆ™å¿…é¡»ç”¨è¡Œå¯»å€ï¼ˆline addressingï¼‰ã€‚\nä»¥æ•°å­—å½¢å¼è¡¨ç¤ºè¡ŒåŒºé—´ ç”¨æ–‡æœ¬æ¨¡å¼æ¥è¿‡æ»¤å‡ºè¡Œ æ ¼å¼ [address]command ä»¥æ•°å­—å½¢å¼è¡¨ç¤ºè¡ŒåŒºé—´ sed \u0026#39;2s/dog/cat/\u0026#39; data1.txt sed \u0026#39;2,3s/dog/cat/\u0026#39; data1.txt sed \u0026#39;2,$s/dog/cat/\u0026#39; data1.txt ä½¿ç”¨æ–‡æœ¬æ¨¡å¼è¿‡æ»¤å™¨ sedç¼–è¾‘å™¨å…è®¸æŒ‡å®šæ–‡æœ¬æ¨¡å¼æ¥è¿‡æ»¤å‡ºå‘½ä»¤è¦ä½œç”¨çš„è¡Œ /pattern/command\nsed -n \u0026#39;/special/s/test/dog/p\u0026#39; data1.txt å‘½ä»¤ç»„åˆ sed \u0026#39;2{ \u0026gt; s/fox/elephant/ \u0026gt; s/dog/cat/ \u0026gt; }\u0026#39; data1.txt åˆ é™¤è¡Œ åˆ é™¤å‘½ä»¤dåˆ é™¤åŒ¹é…æŒ‡å®šå¯»å€æ¨¡å¼çš„æ‰€æœ‰è¡Œã€‚å¦‚æœæ²¡æœ‰åŠ å…¥å¯»å€æ¨¡å¼ï¼Œæµä¸­çš„æ‰€æœ‰æ–‡æœ¬è¡Œéƒ½ä¼šè¢«åˆ é™¤ã€‚\nsed \u0026#39;1d\u0026#39; data1.txt sed \u0026#39;/spe/d\u0026#39; data1.txt æ’å…¥å’Œé™„åŠ æ–‡æœ¬ æ’å…¥ï¼ˆinsertï¼‰å‘½ä»¤ï¼ˆiï¼‰ä¼šåœ¨æŒ‡å®šè¡Œå‰å¢åŠ ä¸€ä¸ªæ–°è¡Œï¼› é™„åŠ ï¼ˆappendï¼‰å‘½ä»¤ï¼ˆaï¼‰ä¼šåœ¨æŒ‡å®šè¡Œåå¢åŠ ä¸€ä¸ªæ–°è¡Œã€‚ sed \u0026#39;[address]command\\ new line\u0026#39; $ echo \u0026#34;Test Line 2\u0026#34; | sed \u0026#39;i\\Test Line 1\u0026#39; Test Line 1 Test Line 2 $ echo \u0026#34;Test Line 2\u0026#34; | sed \u0026#39;a\\Test Line 1\u0026#39; Test Line 2 Test Line 1 #åœ¨å‘½ä»¤è¡Œä¸Šä½¿ç”¨sedæ—¶ï¼Œä¼šçœ‹åˆ°æ¬¡æç¤ºç¬¦æ¥æé†’è¾“å…¥æ–°çš„è¡Œæ•°æ®ã€‚å¿…é¡»åœ¨è¯¥è¡Œå®Œæˆsedç¼–è¾‘å™¨å‘½ä»¤ã€‚ $ echo \u0026#34;Test Line 2\u0026#34; | sed \u0026#39;i\\ \u0026gt; Test Line 1\u0026#39; Test Line 1 Test Line 2 ä¿®æ”¹è¡Œ ä¿®æ”¹ï¼ˆchangeï¼‰å‘½ä»¤(c)å…è®¸ä¿®æ”¹(æ›¿æ¢)æ•°æ®æµä¸­æ•´è¡Œæ–‡æœ¬çš„å†…å®¹.å¦‚æœä½œç”¨äºåœ°å€åŒºé—´ï¼Œsedä¼šç”¨ä¸€è¡Œæ–‡æœ¬ä»£æ›¿åŒºé—´å†…çš„æ‰€æœ‰è¡Œï¼Œè€Œéé€ä¸€æ›¿æ¢ã€‚\nsed \u0026#39;1,2c\\ hello \u0026#39; data1.txt è½¬æ¢å‘½ä»¤ è½¬æ¢ï¼ˆtransformï¼‰å‘½ä»¤ï¼ˆyï¼‰æ˜¯å”¯ä¸€å¯ä»¥å¤„ç†å•ä¸ªå­—ç¬¦çš„sedç¼–è¾‘å™¨å‘½ä»¤ã€‚è½¬æ¢å‘½ä»¤æ ¼å¼å¦‚ä¸‹: [address]y/inchars/outchars/\nå›é¡¾æ‰“å° 3ä¸ªå‘½ä»¤ä¹Ÿèƒ½ç”¨æ¥æ‰“å°æ•°æ®æµä¸­çš„ä¿¡æ¯ï¼š på‘½ä»¤ç”¨æ¥æ‰“å°æ–‡æœ¬è¡Œï¼› ç­‰å·ï¼ˆ=ï¼‰å‘½ä»¤ç”¨æ¥æ‰“å°è¡Œå·ï¼› lï¼ˆå°å†™çš„Lï¼‰å‘½ä»¤ç”¨æ¥åˆ—å‡ºè¡Œã€‚\nä½¿ç”¨sedå¤„ç†æ–‡ä»¶ å†™å…¥æ–‡ä»¶ wå‘½ä»¤ç”¨æ¥å‘æ–‡ä»¶å†™å…¥è¡Œ [address]w filename\nä»æ–‡ä»¶è¯»å–æ•°æ® è¯»å–ï¼ˆreadï¼‰å‘½ä»¤ï¼ˆrï¼‰å°†ä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶ä¸­çš„æ•°æ®æ’å…¥åˆ°æ•°æ®æµä¸­ [address]r filename\nhttps://jixiaocan.github.io/posts/cmd-sed/ https://markrepo.github.io/commands/2018/06/26/sed/ ","permalink":"https://blog.chalme.top/posts/linux/command/sed/","summary":"æ¦‚è¿° sedæ˜¯stream editorçš„ç®€ç§°ï¼Œä¹Ÿå°±æ˜¯æµç¼–è¾‘å™¨ã€‚å®ƒä¸€æ¬¡å¤„ç†ä¸€è¡Œå†…å®¹ï¼Œå¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸º\u0026quot;pattern space\u0026quot;ï¼Œæ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®Œæˆåï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰ æ”¹å˜ï¼Œé™¤éä½ ä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚\nåŸºç¡€ -E -- use extended regular expressions -a -- delay opening files listed with w function -e -- specify sed commands to run -f -- add contents of file to commands to run -i -- edit files in-place, running scripts separately for each file -l -- make output line buffered -n -- suppress automatic printing of pattern space a,append è¿½åŠ  i,insert æ’å…¥ d,delete åˆ é™¤ s,substitution æ›¿æ¢ c,change ä¿®æ”¹ y,transform è½¬æ¢ æ›¿æ¢ æ›¿æ¢æ ‡è®° sï¼ˆsubstitutionï¼‰é»˜è®¤æƒ…å†µä¸‹åªæ›¿æ¢æ¯è¡Œä¸­å‡ºç°çš„ç¬¬ä¸€å¤„ã€‚ä½¿ç”¨æ›¿æ¢æ ‡è®°ï¼ˆsubstitution flagï¼‰æŒ‡å®šæ›¿æ¢ä½ç½®ã€‚æ›¿æ¢æ ‡è®°åœ¨æ›¿æ¢å‘½ä»¤å­—ç¬¦ä¸²ä¹‹åè®¾ç½®ã€‚ s/pattern/replacement/flags æœ‰4ç§å¯ç”¨çš„æ›¿æ¢æ ‡è®°ï¼š","title":"Sed"},{"content":"First This is first post !!! hji h-\nh-title\ntest hello, world!\n","permalink":"https://blog.chalme.top/posts/first/","summary":"First This is first post !!! hji h-\nh-title\ntest hello, world!","title":"First"},{"content":"Iterator pattern(è¿­ä»£å™¨æ¨¡å¼) è¿™ä¸ªæ¨¡å¼å·²ç»è¢«æ•´åˆå…¥Javaçš„Collection.åœ¨å¤§å¤šæ•°åœºåˆä¸‹æ— éœ€è‡ªå·±åˆ¶é€ ä¸€ä¸ªIterator,åªè¦å°†å¯¹è±¡è£…å…¥Collectionä¸­ï¼Œç›´æ¥ä½¿ç”¨Iteratorè¿›è¡Œå¯¹è±¡éå†.æ›´å¤š\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.11-iterator/","summary":"Iterator pattern(è¿­ä»£å™¨æ¨¡å¼) è¿™ä¸ªæ¨¡å¼å·²ç»è¢«æ•´åˆå…¥Javaçš„Collection.åœ¨å¤§å¤šæ•°åœºåˆä¸‹æ— éœ€è‡ªå·±åˆ¶é€ ä¸€ä¸ªIterator,åªè¦å°†å¯¹è±¡è£…å…¥Collectionä¸­ï¼Œç›´æ¥ä½¿ç”¨Iteratorè¿›è¡Œå¯¹è±¡éå†.æ›´å¤š","title":"3.11 Iterator"},{"content":"Visitor pattern (è®¿é—®è€…æ¨¡å¼) ä½œç”¨äºæŸä¸ªå¯¹è±¡ç¾¤ä¸­å„ä¸ªå¯¹è±¡çš„æ“ä½œ. å®ƒå¯ä»¥ä½¿ä½ åœ¨ä¸æ”¹å˜è¿™äº›å¯¹è±¡æœ¬èº«çš„æƒ…å†µä¸‹,å®šä¹‰ä½œç”¨äºè¿™äº›å¯¹è±¡çš„æ–°æ“ä½œ.\nåœ¨Javaä¸­,Visitoræ¨¡å¼å®é™…ä¸Šæ˜¯åˆ†ç¦»äº†collectionç»“æ„ä¸­çš„å…ƒç´ å’Œå¯¹è¿™äº›å…ƒç´ è¿›è¡Œæ“ä½œçš„è¡Œä¸º. ä¸ºä½•ä½¿ç”¨Visitor? Javaçš„Collection(åŒ…æ‹¬Vectorå’ŒHashtable)æ˜¯æˆ‘ä»¬æœ€ç»å¸¸ä½¿ç”¨çš„æŠ€æœ¯,å¯æ˜¯Collectionå¥½è±¡æ˜¯ä¸ªé»‘è‰²å¤§æŸ“ç¼¸,æœ¬æ¥æœ‰å„ç§é²œæ˜ç±»å‹ç‰¹å¾çš„å¯¹è±¡ä¸€æ—¦æ”¾å…¥å,å†å–å‡ºæ—¶,è¿™äº›ç±»å‹å°±æ¶ˆå¤±äº†.é‚£ä¹ˆæˆ‘ä»¬åŠ¿å¿…è¦ç”¨Ifæ¥åˆ¤æ–­,å¦‚:\nIterator iterator = collection.iterator() while (iterator.hasNext()) { Object o = iterator.next(); if (o instanceof Collection) messyPrintCollection((Collection)o); else if (o instanceof String) System.out.println(\u0026#34;\u0026#39;\u0026#34;+o.toString()+\u0026#34;\u0026#39;\u0026#34;); else if (o instanceof Float) System.out.println(o.toString()+\u0026#34;f\u0026#34;); else System.out.println(o.toString()); } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬ä½¿ç”¨äº† instanceofæ¥åˆ¤æ–­ oçš„ç±»å‹.\nå¾ˆæ˜¾ç„¶,è¿™æ ·åšçš„ç¼ºç‚¹ä»£ç If else if å¾ˆç¹ç.æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Visitoræ¨¡å¼è§£å†³å®ƒ.\nå¦‚ä½•ä½¿ç”¨Visitor? é’ˆå¯¹ä¸Šä¾‹,å®šä¹‰æ¥å£å«Visitable,ç”¨æ¥å®šä¹‰ä¸€ä¸ªAcceptæ“ä½œ,ä¹Ÿå°±æ˜¯è¯´è®©Collectionæ¯ä¸ªå…ƒç´ å…·å¤‡å¯è®¿é—®æ€§.\nè¢«è®¿é—®è€…æ˜¯æˆ‘ä»¬Collectionçš„æ¯ä¸ªå…ƒç´ Element,æˆ‘ä»¬è¦ä¸ºè¿™äº›Elementå®šä¹‰ä¸€ä¸ªå¯ä»¥æ¥å—è®¿é—®çš„æ¥å£(è®¿é—®å’Œè¢«è®¿é—®æ˜¯äº’åŠ¨çš„,åªæœ‰è®¿é—®è€…,è¢«è®¿é—®è€…å¦‚æœè¡¨ç¤ºä¸æ¬¢è¿,è®¿é—®è€…å°±ä¸èƒ½è®¿é—®),å–åä¸ºVisitableï¼Œä¹Ÿå¯å–åä¸ºElementã€‚\npublic interface Visitable { public void accept(Visitor visitor); } è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ç»§æ‰¿è¿™ä¸ªæ–°çš„æ¥å£Visitableï¼š\npublic class StringElement implements Visitable { private String value; public StringElement(String string) { value = string; } public String getValue(){ return value; } //å®šä¹‰acceptçš„å…·ä½“å†…å®¹ è¿™é‡Œæ˜¯å¾ˆç®€å•çš„ä¸€å¥è°ƒç”¨ public void accept(Visitor visitor) { visitor.visitString(this); } } ä¸Šé¢æ˜¯è¢«è®¿é—®è€…æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸‹é¢å†å»ºç«‹ä¸€ä¸ªFloatç±»å‹çš„ï¼š\npublic class FloatElement implements Visitable { private Float value; public FloatElement(Float value) { this.value = value; } public Float getValue(){ return value; } //å®šä¹‰acceptçš„å…·ä½“å†…å®¹ è¿™é‡Œæ˜¯å¾ˆç®€å•çš„ä¸€å¥è°ƒç”¨ public void accept(Visitor visitor) { visitor.visitFloat(this); } } æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªæ¥å£visitorè®¿é—®è€…ï¼Œåœ¨è¿™ä¸ªæ¥å£ä¸­,æœ‰ä¸€äº›è®¿é—®æ“ä½œï¼Œè¿™äº›è®¿é—®æ“ä½œæ˜¯ä¸“é—¨è®¿é—®å¯¹è±¡é›†åˆCollectionä¸­æœ‰å¯èƒ½çš„æ‰€æœ‰ç±»ï¼Œç›®å‰æˆ‘ä»¬å‡å®šæœ‰ä¸‰ä¸ªè¡Œä¸ºï¼šè®¿é—®å¯¹è±¡é›†åˆä¸­çš„å­—ç¬¦ä¸²ç±»å‹ï¼›è®¿é—®å¯¹è±¡é›†åˆä¸­çš„Floatç±»å‹ï¼›è®¿é—®å¯¹è±¡é›†åˆä¸­çš„å¯¹è±¡é›†åˆç±»å‹ã€‚æ³¨æ„æœ€åä¸€ä¸ªç±»å‹æ˜¯é›†åˆåµŒå¥—ï¼Œé€šè¿‡è¿™ä¸ªåµŒå¥—å®ç°å¯ä»¥çœ‹å‡ºä½¿ç”¨è®¿é—®æ¨¡å¼çš„ä¸€ä¸ªä¼˜ç‚¹ã€‚\næ¥å£visitorè®¿é—®è€…å¦‚ä¸‹ï¼š\npublic interface Visitor { public void visitString(StringElement stringE); public void visitFloat(FloatElement floatE); public void visitCollection(Collection collection); } è®¿é—®è€…çš„å®ç°:\npublic class ConcreteVisitor implements Visitor { //åœ¨æœ¬æ–¹æ³•ä¸­,æˆ‘ä»¬å®ç°äº†å¯¹Collectionçš„å…ƒç´ çš„æˆåŠŸè®¿é—® public void visitCollection(Collection collection) { Iterator iterator = collection.iterator() while (iterator.hasNext()) { Object o = iterator.next(); if (o instanceof Visitable) ((Visitable)o).accept(this); } ï½ public void visitString(StringElement stringE) { System.out.println(\u0026#34;\u0026#39;\u0026#34;+stringE.getValue()+\u0026#34;\u0026#39;\u0026#34;); } public void visitFloat(FloatElement floatE){ System.out.println(floatE.getValue().toString()+\u0026#34;f\u0026#34;); } } åœ¨ä¸Šé¢çš„visitCollectionæˆ‘ä»¬å®ç°äº†å¯¹Collectionæ¯ä¸ªå…ƒç´ è®¿é—®,åªä½¿ç”¨äº†ä¸€ä¸ªåˆ¤æ–­è¯­å¥,åªè¦åˆ¤æ–­å…¶æ˜¯å¦å¯ä»¥è®¿é—®.\nStringElementåªæ˜¯ä¸€ä¸ªå®ç°ï¼Œå¯ä»¥æ‹“å±•ä¸ºæ›´å¤šçš„å®ç°ï¼Œæ•´ä¸ªæ ¸å¿ƒå¥¥å¦™åœ¨acceptæ–¹æ³•ä¸­ï¼Œåœ¨éå†Collectionæ—¶ï¼Œé€šè¿‡ç›¸åº”çš„acceptæ–¹æ³•è°ƒç”¨å…·ä½“ç±»å‹çš„è¢«è®¿é—®è€…ã€‚è¿™ä¸€æ­¥ç¡®å®šäº†è¢«è®¿é—®è€…ç±»å‹ï¼Œ\nå¦‚æœæ˜¯StringElementï¼Œè€ŒStringElementåˆ™å›è°ƒè®¿é—®è€…çš„visiteStringæ–¹æ³•ï¼Œè¿™ä¸€æ­¥å®ç°äº†è¡Œä¸ºæ“ä½œæ–¹æ³•ã€‚\nå®¢æˆ·ç«¯ä»£ç ï¼š\nVisitor visitor = new ConcreteVisitor(); StringElement stringE = new StringElement(\u0026#34;I am a String\u0026#34;); visitor.visitString(stringE); Collection list = new ArrayList(); list.add(new StringElement(\u0026#34;I am a String1\u0026#34;)); list.add(new StringElement(\u0026#34;I am a String2\u0026#34;)); list.add(new FloatElement(new Float(12))); list.add(new StringElement(\u0026#34;I am a String3\u0026#34;)); visitor.visitCollection(list); å®¢æˆ·ç«¯ä»£ç ä¸­çš„listå¯¹è±¡é›†åˆä¸­æ”¾ç½®äº†å¤šç§æ•°æ®ç±»å‹ï¼Œå¯¹å¯¹è±¡é›†åˆä¸­çš„è®¿é—®ä¸å¿…è±¡ä¸€å¼€å§‹é‚£æ ·ï¼Œä½¿ç”¨instance ofé€ä¸ªåˆ¤æ–­ï¼Œè€Œæ˜¯é€šè¿‡è®¿é—®è€…æ¨¡å¼å·§å¦™å®ç°äº†ã€‚\nè‡³æ­¤,æˆ‘ä»¬å®Œæˆäº†Visitoræ¨¡å¼åŸºæœ¬ç»“æ„.\nä½¿ç”¨Visitoræ¨¡å¼çš„å‰æ ä½¿ç”¨è®¿é—®è€…æ¨¡å¼æ˜¯å¯¹è±¡ç¾¤ç»“æ„ä¸­(Collection) ä¸­çš„å¯¹è±¡ç±»å‹å¾ˆå°‘æ”¹å˜ã€‚\nåœ¨ä¸¤ä¸ªæ¥å£Visitorå’ŒVisitableä¸­,ç¡®ä¿Visitableå¾ˆå°‘å˜åŒ–,ä¹Ÿå°±æ˜¯è¯´ï¼Œç¡®ä¿ä¸èƒ½è€æœ‰æ–°çš„Elementå…ƒç´ ç±»å‹åŠ è¿›æ¥ï¼Œå¯ä»¥å˜åŒ–çš„æ˜¯è®¿é—®è€…è¡Œä¸ºæˆ–æ“ä½œï¼Œä¹Ÿå°±æ˜¯Visitorçš„ä¸åŒå­ç±»å¯ä»¥æœ‰å¤šç§,è¿™æ ·ä½¿ç”¨è®¿é—®è€…æ¨¡å¼æœ€æ–¹ä¾¿.\nå¦‚æœå¯¹è±¡é›†åˆä¸­çš„å¯¹è±¡é›†åˆç»å¸¸æœ‰å˜åŒ–, é‚£ä¹ˆä¸ä½†Visitorå®ç°è¦å˜åŒ–ï¼ŒVisistableä¹Ÿè¦å¢åŠ ç›¸åº”è¡Œä¸ºï¼ŒGOFå»ºè®®æ˜¯,ä¸å¦‚åœ¨è¿™äº›å¯¹è±¡ç±»ä¸­ç›´æ¥é€ä¸ªå®šä¹‰æ“ä½œï¼Œæ— éœ€ä½¿ç”¨è®¿é—®è€…è®¾è®¡æ¨¡å¼ã€‚\nä½†æ˜¯åœ¨Javaä¸­ï¼ŒJavaçš„ReflectæŠ€æœ¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå› æ­¤ç»“åˆreflectåå°„æœºåˆ¶ï¼Œå¯ä»¥ä½¿å¾—è®¿é—®è€…æ¨¡å¼é€‚ç”¨èŒƒå›´æ›´å¹¿äº†ã€‚\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.10-visitor/","summary":"Visitor pattern (è®¿é—®è€…æ¨¡å¼) ä½œç”¨äºæŸä¸ªå¯¹è±¡ç¾¤ä¸­å„ä¸ªå¯¹è±¡çš„æ“ä½œ. å®ƒå¯ä»¥ä½¿ä½ åœ¨ä¸æ”¹å˜è¿™äº›å¯¹è±¡æœ¬èº«çš„æƒ…å†µä¸‹,å®šä¹‰ä½œç”¨äºè¿™äº›å¯¹è±¡çš„æ–°æ“ä½œ.\nåœ¨Javaä¸­,Visitoræ¨¡å¼å®é™…ä¸Šæ˜¯åˆ†ç¦»äº†collectionç»“æ„ä¸­çš„å…ƒç´ å’Œå¯¹è¿™äº›å…ƒç´ è¿›è¡Œæ“ä½œçš„è¡Œä¸º. ä¸ºä½•ä½¿ç”¨Visitor? Javaçš„Collection(åŒ…æ‹¬Vectorå’ŒHashtable)æ˜¯æˆ‘ä»¬æœ€ç»å¸¸ä½¿ç”¨çš„æŠ€æœ¯,å¯æ˜¯Collectionå¥½è±¡æ˜¯ä¸ªé»‘è‰²å¤§æŸ“ç¼¸,æœ¬æ¥æœ‰å„ç§é²œæ˜ç±»å‹ç‰¹å¾çš„å¯¹è±¡ä¸€æ—¦æ”¾å…¥å,å†å–å‡ºæ—¶,è¿™äº›ç±»å‹å°±æ¶ˆå¤±äº†.é‚£ä¹ˆæˆ‘ä»¬åŠ¿å¿…è¦ç”¨Ifæ¥åˆ¤æ–­,å¦‚:\nIterator iterator = collection.iterator() while (iterator.hasNext()) { Object o = iterator.next(); if (o instanceof Collection) messyPrintCollection((Collection)o); else if (o instanceof String) System.out.println(\u0026#34;\u0026#39;\u0026#34;+o.toString()+\u0026#34;\u0026#39;\u0026#34;); else if (o instanceof Float) System.out.println(o.toString()+\u0026#34;f\u0026#34;); else System.out.println(o.toString()); } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬ä½¿ç”¨äº† instanceofæ¥åˆ¤æ–­ oçš„ç±»å‹.\nå¾ˆæ˜¾ç„¶,è¿™æ ·åšçš„ç¼ºç‚¹ä»£ç If else if å¾ˆç¹ç.æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Visitoræ¨¡å¼è§£å†³å®ƒ.\nå¦‚ä½•ä½¿ç”¨Visitor? é’ˆå¯¹ä¸Šä¾‹,å®šä¹‰æ¥å£å«Visitable,ç”¨æ¥å®šä¹‰ä¸€ä¸ªAcceptæ“ä½œ,ä¹Ÿå°±æ˜¯è¯´è®©Collectionæ¯ä¸ªå…ƒç´ å…·å¤‡å¯è®¿é—®æ€§.\nè¢«è®¿é—®è€…æ˜¯æˆ‘ä»¬Collectionçš„æ¯ä¸ªå…ƒç´ Element,æˆ‘ä»¬è¦ä¸ºè¿™äº›Elementå®šä¹‰ä¸€ä¸ªå¯ä»¥æ¥å—è®¿é—®çš„æ¥å£(è®¿é—®å’Œè¢«è®¿é—®æ˜¯äº’åŠ¨çš„,åªæœ‰è®¿é—®è€…,è¢«è®¿é—®è€…å¦‚æœè¡¨ç¤ºä¸æ¬¢è¿,è®¿é—®è€…å°±ä¸èƒ½è®¿é—®),å–åä¸ºVisitableï¼Œä¹Ÿå¯å–åä¸ºElementã€‚\npublic interface Visitable { public void accept(Visitor visitor); } è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ç»§æ‰¿è¿™ä¸ªæ–°çš„æ¥å£Visitableï¼š\npublic class StringElement implements Visitable { private String value; public StringElement(String string) { value = string; } public String getValue(){ return value; } //å®šä¹‰acceptçš„å…·ä½“å†…å®¹ è¿™é‡Œæ˜¯å¾ˆç®€å•çš„ä¸€å¥è°ƒç”¨ public void accept(Visitor visitor) { visitor.","title":"3.10 Visitor"},{"content":"Interpreter pattern(è§£é‡Šè€…æ¨¡å¼) å®šä¹‰ å®šä¹‰è¯­è¨€çš„æ–‡æ³• ,å¹¶ä¸”å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¯¥è¯­è¨€ä¸­çš„å¥å­.\nInterpreterä¼¼ä¹ä½¿ç”¨é¢ä¸æ˜¯å¾ˆå¹¿,å®ƒæè¿°äº†ä¸€ä¸ªè¯­è¨€è§£é‡Šå™¨æ˜¯å¦‚ä½•æ„æˆçš„,åœ¨å®é™…åº”ç”¨ä¸­,æˆ‘ä»¬å¯èƒ½å¾ˆå°‘å»æ„é€ ä¸€ä¸ªè¯­è¨€çš„æ–‡æ³•.æˆ‘ä»¬è¿˜æ˜¯æ¥ç®€å•çš„äº†è§£ä¸€ä¸‹: é¦–å…ˆè¦å»ºç«‹ä¸€ä¸ªæ¥å£,ç”¨æ¥æè¿°å…±åŒçš„æ“ä½œ.\npublic interface AbstractExpression { void interpret( Context context ); } å†çœ‹çœ‹åŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯\npublic interface Context { } AbstractExpressionçš„å…·ä½“å®ç°åˆ†ä¸¤ç§:ç»ˆç»“ç¬¦è¡¨è¾¾å¼å’Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼:\npublic class TerminalExpression implements AbstractExpression { public void interpret( Context context ) { } } å¯¹äºæ–‡æ³•ä¸­æ²¡ä¸€æ¡è§„åˆ™,éç»ˆç»“ç¬¦è¡¨è¾¾å¼éƒ½å¿…é¡»çš„:\npublic class NonterminalExpression implements AbstractExpression { private AbstractExpression successor; public void setSuccessor( AbstractExpression successor ) { this.successor = successor; } public AbstractExpression getSuccessor() { return successor; } public void interpret( Context context ) { } } ","permalink":"https://blog.chalme.top/posts/design-patterns/3.9-interpreter/","summary":"Interpreter pattern(è§£é‡Šè€…æ¨¡å¼) å®šä¹‰ å®šä¹‰è¯­è¨€çš„æ–‡æ³• ,å¹¶ä¸”å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¯¥è¯­è¨€ä¸­çš„å¥å­.\nInterpreterä¼¼ä¹ä½¿ç”¨é¢ä¸æ˜¯å¾ˆå¹¿,å®ƒæè¿°äº†ä¸€ä¸ªè¯­è¨€è§£é‡Šå™¨æ˜¯å¦‚ä½•æ„æˆçš„,åœ¨å®é™…åº”ç”¨ä¸­,æˆ‘ä»¬å¯èƒ½å¾ˆå°‘å»æ„é€ ä¸€ä¸ªè¯­è¨€çš„æ–‡æ³•.æˆ‘ä»¬è¿˜æ˜¯æ¥ç®€å•çš„äº†è§£ä¸€ä¸‹: é¦–å…ˆè¦å»ºç«‹ä¸€ä¸ªæ¥å£,ç”¨æ¥æè¿°å…±åŒçš„æ“ä½œ.\npublic interface AbstractExpression { void interpret( Context context ); } å†çœ‹çœ‹åŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯\npublic interface Context { } AbstractExpressionçš„å…·ä½“å®ç°åˆ†ä¸¤ç§:ç»ˆç»“ç¬¦è¡¨è¾¾å¼å’Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼:\npublic class TerminalExpression implements AbstractExpression { public void interpret( Context context ) { } } å¯¹äºæ–‡æ³•ä¸­æ²¡ä¸€æ¡è§„åˆ™,éç»ˆç»“ç¬¦è¡¨è¾¾å¼éƒ½å¿…é¡»çš„:\npublic class NonterminalExpression implements AbstractExpression { private AbstractExpression successor; public void setSuccessor( AbstractExpression successor ) { this.successor = successor; } public AbstractExpression getSuccessor() { return successor; } public void interpret( Context context ) { } } ","title":"3.9 Interpreter"},{"content":"Mediator pattern(ä¸­ä»‹è€…æ¨¡å¼) å®šä¹‰ ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å…³äºå¯¹è±¡äº¤äº’è¡Œä¸º.\nä¸ºä½•ä½¿ç”¨Mediator? å„ä¸ªå¯¹è±¡ä¹‹é—´çš„äº¤äº’æ“ä½œéå¸¸å¤š;æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºæ“ä½œéƒ½ä¾èµ–å½¼æ­¤å¯¹æ–¹,ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸º,åŒæ—¶ä¼šæ¶‰åŠåˆ°ä¿®æ”¹å¾ˆå¤šå…¶ä»–å¯¹è±¡çš„è¡Œä¸º,å¦‚æœä½¿ç”¨Mediatoræ¨¡å¼,å¯ä»¥ä½¿å„ä¸ªå¯¹è±¡é—´çš„è€¦åˆæ¾æ•£,åªéœ€å…³å¿ƒå’Œ Mediatorçš„å…³ç³»,ä½¿å¤šå¯¹å¤šçš„å…³ç³»å˜æˆäº†ä¸€å¯¹å¤šçš„å…³ç³»,å¯ä»¥é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,æé«˜å¯ä¿®æ”¹æ‰©å±•æ€§.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆ æœ‰ä¸€ä¸ªæ¥å£,ç”¨æ¥å®šä¹‰æˆå‘˜å¯¹è±¡ä¹‹é—´çš„äº¤äº’è”ç³»æ–¹å¼:\npublic interface Mediator { } Meiatorå…·ä½“å®ç°,çœŸæ­£å®ç°äº¤äº’æ“ä½œçš„å†…å®¹:\npublic class ConcreteMediator implements Mediator { //å‡è®¾å½“å‰æœ‰ä¸¤ä¸ªæˆå‘˜. private ConcreteColleague1 colleague1 = new ConcreteColleague1(); private ConcreteColleague2 colleague2 = new ConcreteColleague2(); ... } å†çœ‹çœ‹å¦å¤–ä¸€ä¸ªå‚ä¸è€…:æˆå‘˜,å› ä¸ºæ˜¯äº¤äº’è¡Œä¸º,éƒ½éœ€è¦åŒæ–¹æä¾›ä¸€äº›å…±åŒæ¥å£,è¿™ç§è¦æ±‚åœ¨Visitor Observerç­‰æ¨¡å¼ä¸­éƒ½æ˜¯ç›¸åŒçš„.\npublic class Colleague { private Mediator mediator; public Mediator getMediator() { return mediator; } public void setMediator( Mediator mediator ) { this.mediator = mediator; } } public class ConcreteColleague1 { } public class ConcreteColleague2 { } æ¯ä¸ªæˆå‘˜éƒ½å¿…é¡»çŸ¥é“Mediator,å¹¶ä¸”å’Œ Mediatorè”ç³»,è€Œä¸æ˜¯å’Œå…¶ä»–æˆå‘˜è”ç³».\nè‡³æ­¤,Mediatoræ¨¡å¼æ¡†æ¶å®Œæˆ,å¯ä»¥å‘ç°Mediatoræ¨¡å¼è§„å®šä¸æ˜¯å¾ˆå¤š,å¤§ä½“æ¡†æ¶ä¹Ÿæ¯”è¾ƒç®€å•,ä½†å®é™…ä½¿ç”¨èµ·æ¥å°±éå¸¸çµæ´».\nMediatoræ¨¡å¼åœ¨äº‹ä»¶é©±åŠ¨ç±»åº”ç”¨ä¸­æ¯”è¾ƒå¤š,ä¾‹å¦‚ç•Œé¢è®¾è®¡GUI.;èŠå¤©,æ¶ˆæ¯ä¼ é€’ç­‰,åœ¨èŠå¤©åº”ç”¨ä¸­,éœ€è¦æœ‰ä¸€ä¸ªMessageMediator,ä¸“é—¨è´Ÿè´£request/reponseä¹‹é—´ä»»åŠ¡çš„è°ƒèŠ‚. MVCæ˜¯J2EEçš„ä¸€ä¸ªåŸºæœ¬æ¨¡å¼,View Controlleræ˜¯ä¸€ç§Mediator,å®ƒæ˜¯Jspå’ŒæœåŠ¡å™¨ä¸Šåº”ç”¨ç¨‹åºé—´çš„Mediator.\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.8-mediator/","summary":"Mediator pattern(ä¸­ä»‹è€…æ¨¡å¼) å®šä¹‰ ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å…³äºå¯¹è±¡äº¤äº’è¡Œä¸º.\nä¸ºä½•ä½¿ç”¨Mediator? å„ä¸ªå¯¹è±¡ä¹‹é—´çš„äº¤äº’æ“ä½œéå¸¸å¤š;æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºæ“ä½œéƒ½ä¾èµ–å½¼æ­¤å¯¹æ–¹,ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸º,åŒæ—¶ä¼šæ¶‰åŠåˆ°ä¿®æ”¹å¾ˆå¤šå…¶ä»–å¯¹è±¡çš„è¡Œä¸º,å¦‚æœä½¿ç”¨Mediatoræ¨¡å¼,å¯ä»¥ä½¿å„ä¸ªå¯¹è±¡é—´çš„è€¦åˆæ¾æ•£,åªéœ€å…³å¿ƒå’Œ Mediatorçš„å…³ç³»,ä½¿å¤šå¯¹å¤šçš„å…³ç³»å˜æˆäº†ä¸€å¯¹å¤šçš„å…³ç³»,å¯ä»¥é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,æé«˜å¯ä¿®æ”¹æ‰©å±•æ€§.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆ æœ‰ä¸€ä¸ªæ¥å£,ç”¨æ¥å®šä¹‰æˆå‘˜å¯¹è±¡ä¹‹é—´çš„äº¤äº’è”ç³»æ–¹å¼:\npublic interface Mediator { } Meiatorå…·ä½“å®ç°,çœŸæ­£å®ç°äº¤äº’æ“ä½œçš„å†…å®¹:\npublic class ConcreteMediator implements Mediator { //å‡è®¾å½“å‰æœ‰ä¸¤ä¸ªæˆå‘˜. private ConcreteColleague1 colleague1 = new ConcreteColleague1(); private ConcreteColleague2 colleague2 = new ConcreteColleague2(); ... } å†çœ‹çœ‹å¦å¤–ä¸€ä¸ªå‚ä¸è€…:æˆå‘˜,å› ä¸ºæ˜¯äº¤äº’è¡Œä¸º,éƒ½éœ€è¦åŒæ–¹æä¾›ä¸€äº›å…±åŒæ¥å£,è¿™ç§è¦æ±‚åœ¨Visitor Observerç­‰æ¨¡å¼ä¸­éƒ½æ˜¯ç›¸åŒçš„.\npublic class Colleague { private Mediator mediator; public Mediator getMediator() { return mediator; } public void setMediator( Mediator mediator ) { this.mediator = mediator; } } public class ConcreteColleague1 { } public class ConcreteColleague2 { } æ¯ä¸ªæˆå‘˜éƒ½å¿…é¡»çŸ¥é“Mediator,å¹¶ä¸”å’Œ Mediatorè”ç³»,è€Œä¸æ˜¯å’Œå…¶ä»–æˆå‘˜è”ç³».","title":"3.8 Mediator"},{"content":"Strategy pattern(ç­–ç•¥æ¨¡å¼) å®šä¹‰ å±äºè®¾è®¡æ¨¡å¼ä¸­ å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼,ä¸»è¦æ˜¯å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠè¿™äº›ç®—æ³•ä¸€ä¸ªä¸ªå°è£…æˆå•ç‹¬çš„ç±».\nStratrgyåº”ç”¨æ¯”è¾ƒå¹¿æ³›,æ¯”å¦‚, å…¬å¸ç»è¥ä¸šåŠ¡å˜åŒ–å›¾, å¯èƒ½æœ‰ä¸¤ç§å®ç°æ–¹å¼,ä¸€ä¸ªæ˜¯çº¿æ¡æ›²çº¿,ä¸€ä¸ªæ˜¯æ¡†å›¾(bar),è¿™æ˜¯ä¸¤ç§ç®—æ³•,å¯ä»¥ä½¿ç”¨Strategyå®ç°. å¦‚ä½•ä½¿ç”¨? è¿™é‡Œä»¥å­—ç¬¦ä¸²æ›¿ä»£ä¸ºä¾‹, æœ‰ä¸€ä¸ªæ–‡ä»¶,æˆ‘ä»¬éœ€è¦è¯»å–å,å¸Œæœ›æ›¿ä»£å…¶ä¸­ç›¸åº”çš„å˜é‡,ç„¶åè¾“å‡º.å…³äºæ›¿ä»£å…¶ä¸­å˜é‡çš„æ–¹æ³•å¯èƒ½æœ‰å¤šç§æ–¹æ³•,è¿™å–å†³äºç”¨æˆ·çš„è¦æ±‚,æ‰€ä»¥æˆ‘ä»¬è¦å‡†å¤‡å‡ å¥—å˜é‡å­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ. é¦–å…ˆ,æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæŠ½è±¡ç±»RepTempRule å®šä¹‰ä¸€äº›å…¬ç”¨å˜é‡å’Œæ–¹æ³•:\npublic abstract class RepTempRule{ protected String oldString=\u0026#34;\u0026#34;; public void setOldString(String oldString){ this.oldString=oldString; } protected String newString=\u0026#34;\u0026#34;; public String getNewString(){ return newString; } public abstract void replace() throws Exception; } åœ¨RepTempRuleä¸­ æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•abstractéœ€è¦ç»§æ‰¿æ˜ç¡®,è¿™ä¸ªreplaceé‡Œå…¶å®æ˜¯æ›¿ä»£çš„å…·ä½“æ–¹æ³•. æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªå­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ, 1.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆbbb; 2.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆccc;\nå¯¹åº”çš„ç±»åˆ†åˆ«æ˜¯RepTempRuleOne RepTempRuleTwo\npublic class RepTempRuleOne extends RepTempRule{ public void replace() throws Exception{ //replaceFirstæ˜¯jdk1.4æ–°ç‰¹æ€§ newString=oldString.replaceFirst(\u0026#34;aaa\u0026#34;, \u0026#34;bbbb\u0026#34;) System.out.println(\u0026#34;this is replace one\u0026#34;); } } public class RepTempRuleTwo extends RepTempRule{ public void replace() throws Exception{ newString=oldString.replaceFirst(\u0026#34;aaa\u0026#34;, \u0026#34;ccc\u0026#34;) System.out.println(\u0026#34;this is replace Two\u0026#34;);ã€€} } ç¬¬äºŒæ­¥ï¼šæˆ‘ä»¬è¦å»ºç«‹ä¸€ä¸ªç®—æ³•è§£å†³ç±»ï¼Œç”¨æ¥æä¾›å®¢æˆ·ç«¯å¯ä»¥è‡ªç”±é€‰æ‹©ç®—æ³•ã€‚\npublic class RepTempRuleSolve { private RepTempRule strategy; public RepTempRuleSolve(RepTempRule rule){ this.strategy=rule; } public String getNewContext(Site site,String oldString) { return strategy.replace(site,oldString); } public void changeAlgorithm(RepTempRule newAlgorithm) { strategy = newAlgorithm; } } è°ƒç”¨å¦‚ä¸‹:\npublic class test{ ...... public void testReplace(){ //ä½¿ç”¨ç¬¬ä¸€å¥—æ›¿ä»£æ–¹æ¡ˆ RepTempRuleSolve solver=new RepTempRuleSolve(new RepTempRuleOne()); solver.getNewContext(site,context); //ä½¿ç”¨ç¬¬äºŒå¥— solver=new RepTempRuleSolve(new RepTempRuleTwo()); solver.getNewContext(site,context); } ..... } æˆ‘ä»¬è¾¾åˆ°äº†åœ¨è¿è¡ŒæœŸé—´ï¼Œå¯ä»¥è‡ªç”±åˆ‡æ¢ç®—æ³•çš„ç›®çš„ã€‚\nå®é™…æ•´ä¸ªStrategyçš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯æŠ½è±¡ç±»çš„ä½¿ç”¨,ä½¿ç”¨Strategyæ¨¡å¼å¯ä»¥åœ¨ç”¨æˆ·éœ€è¦å˜åŒ–æ—¶,ä¿®æ”¹é‡å¾ˆå°‘,è€Œä¸”å¿«é€Ÿ.\nStrategyå’ŒFactoryæœ‰ä¸€å®šçš„ç±»ä¼¼,Strategyç›¸å¯¹ç®€å•å®¹æ˜“ç†è§£,å¹¶ä¸”å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ»è‡ªç”±åˆ‡æ¢ã€‚Factoryé‡ç‚¹æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡ã€‚\nStrategyé€‚åˆä¸‹åˆ—åœºåˆ: ä»¥ä¸åŒçš„æ ¼å¼ä¿å­˜æ–‡ä»¶;\nä»¥ä¸åŒçš„ç®—æ³•å‹ç¼©æ–‡ä»¶;\nä»¥ä¸åŒçš„ç®—æ³•æˆªè·å›¾è±¡;\nä»¥ä¸åŒçš„æ ¼å¼è¾“å‡ºåŒæ ·æ•°æ®çš„å›¾å½¢,æ¯”å¦‚æ›²çº¿ æˆ–æ¡†å›¾barç­‰\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.7-strategy/","summary":"Strategy pattern(ç­–ç•¥æ¨¡å¼) å®šä¹‰ å±äºè®¾è®¡æ¨¡å¼ä¸­ å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼,ä¸»è¦æ˜¯å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠè¿™äº›ç®—æ³•ä¸€ä¸ªä¸ªå°è£…æˆå•ç‹¬çš„ç±».\nStratrgyåº”ç”¨æ¯”è¾ƒå¹¿æ³›,æ¯”å¦‚, å…¬å¸ç»è¥ä¸šåŠ¡å˜åŒ–å›¾, å¯èƒ½æœ‰ä¸¤ç§å®ç°æ–¹å¼,ä¸€ä¸ªæ˜¯çº¿æ¡æ›²çº¿,ä¸€ä¸ªæ˜¯æ¡†å›¾(bar),è¿™æ˜¯ä¸¤ç§ç®—æ³•,å¯ä»¥ä½¿ç”¨Strategyå®ç°. å¦‚ä½•ä½¿ç”¨? è¿™é‡Œä»¥å­—ç¬¦ä¸²æ›¿ä»£ä¸ºä¾‹, æœ‰ä¸€ä¸ªæ–‡ä»¶,æˆ‘ä»¬éœ€è¦è¯»å–å,å¸Œæœ›æ›¿ä»£å…¶ä¸­ç›¸åº”çš„å˜é‡,ç„¶åè¾“å‡º.å…³äºæ›¿ä»£å…¶ä¸­å˜é‡çš„æ–¹æ³•å¯èƒ½æœ‰å¤šç§æ–¹æ³•,è¿™å–å†³äºç”¨æˆ·çš„è¦æ±‚,æ‰€ä»¥æˆ‘ä»¬è¦å‡†å¤‡å‡ å¥—å˜é‡å­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ. é¦–å…ˆ,æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæŠ½è±¡ç±»RepTempRule å®šä¹‰ä¸€äº›å…¬ç”¨å˜é‡å’Œæ–¹æ³•:\npublic abstract class RepTempRule{ protected String oldString=\u0026#34;\u0026#34;; public void setOldString(String oldString){ this.oldString=oldString; } protected String newString=\u0026#34;\u0026#34;; public String getNewString(){ return newString; } public abstract void replace() throws Exception; } åœ¨RepTempRuleä¸­ æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•abstractéœ€è¦ç»§æ‰¿æ˜ç¡®,è¿™ä¸ªreplaceé‡Œå…¶å®æ˜¯æ›¿ä»£çš„å…·ä½“æ–¹æ³•. æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªå­—ç¬¦æ›¿ä»£æ–¹æ¡ˆ, 1.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆbbb; 2.å°†æ–‡æœ¬ä¸­aaaæ›¿ä»£æˆccc;\nå¯¹åº”çš„ç±»åˆ†åˆ«æ˜¯RepTempRuleOne RepTempRuleTwo\npublic class RepTempRuleOne extends RepTempRule{ public void replace() throws Exception{ //replaceFirstæ˜¯jdk1.4æ–°ç‰¹æ€§ newString=oldString.replaceFirst(\u0026#34;aaa\u0026#34;, \u0026#34;bbbb\u0026#34;) System.out.println(\u0026#34;this is replace one\u0026#34;); } } public class RepTempRuleTwo extends RepTempRule{ public void replace() throws Exception{ newString=oldString.","title":"3.7 Strategy"},{"content":"State(çŠ¶æ€æ¨¡å¼)çš„å®šä¹‰ ä¸åŒçš„çŠ¶æ€,ä¸åŒçš„è¡Œä¸º;æˆ–è€…è¯´,æ¯ä¸ªçŠ¶æ€æœ‰ç€ç›¸åº”çš„è¡Œä¸º.\nä½•æ—¶ä½¿ç”¨? Stateæ¨¡å¼åœ¨å®é™…ä½¿ç”¨ä¸­æ¯”è¾ƒå¤š,é€‚åˆ\u0026quot;çŠ¶æ€çš„åˆ‡æ¢\u0026quot;.å› ä¸ºæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨If elseif else è¿›è¡ŒçŠ¶æ€åˆ‡æ¢, å¦‚æœé’ˆå¯¹çŠ¶æ€çš„è¿™æ ·åˆ¤æ–­åˆ‡æ¢åå¤å‡ºç°,æˆ‘ä»¬å°±è¦è”æƒ³åˆ°æ˜¯å¦å¯ä»¥é‡‡å–Stateæ¨¡å¼äº†.\nä¸åªæ˜¯æ ¹æ®çŠ¶æ€,ä¹Ÿæœ‰æ ¹æ®å±æ€§.å¦‚æœæŸä¸ªå¯¹è±¡çš„å±æ€§ä¸åŒ,å¯¹è±¡çš„è¡Œä¸ºå°±ä¸ä¸€æ ·,è¿™ç‚¹åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­å‡ºç°é¢‘ç‡æ¯”è¾ƒé«˜,æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ä¸€ä¸ªæ•°æ®è¡¨çš„å°¾éƒ¨,åŠ ä¸Špropertyå±æ€§å«ä¹‰çš„å­—æ®µ,ç”¨ä»¥æ ‡è¯†è®°å½•ä¸­ä¸€äº›ç‰¹æ®Šæ€§è´¨çš„è®°å½•,è¿™ç§å±æ€§çš„æ”¹å˜(åˆ‡æ¢)åˆæ˜¯éšæ—¶å¯èƒ½å‘ç”Ÿçš„,å°±æœ‰å¯èƒ½è¦ä½¿ç”¨State.\næ˜¯å¦ä½¿ç”¨? åœ¨å®é™…ä½¿ç”¨,ç±»ä¼¼å¼€å…³ä¸€æ ·çš„çŠ¶æ€åˆ‡æ¢æ˜¯å¾ˆå¤šçš„,ä½†æœ‰æ—¶å¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾,å–å†³äºä½ çš„ç»éªŒå’Œå¯¹ç³»ç»Ÿçš„ç†è§£æ·±åº¦.\nè¿™é‡Œè¦é˜è¿°çš„æ˜¯\u0026quot;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026quot; å’Œ\u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„, \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;ä¹Ÿæ˜¯æœ‰ if..elseifç»“æ„,ä¾‹å¦‚:\nif (which==1) state=\u0026ldquo;hello\u0026rdquo;; else if (which==2) state=\u0026ldquo;hi\u0026rdquo;; else if (which==3) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™æ˜¯ä¸€ä¸ª \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;,stateå€¼çš„ä¸åŒæ˜¯æ ¹æ®whichå˜é‡æ¥å†³å®šçš„,whichå’Œstateæ²¡æœ‰å…³ç³».å¦‚æœæ”¹æˆ:\nif (state.euqals(\u0026ldquo;bye\u0026rdquo;)) state=\u0026ldquo;hello\u0026rdquo;; else if (state.euqals(\u0026ldquo;hello\u0026rdquo;)) state=\u0026ldquo;hi\u0026rdquo;; else if (state.euqals(\u0026ldquo;hi\u0026rdquo;)) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™å°±æ˜¯ \u0026ldquo;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026rdquo;,æ˜¯å°†stateçš„çŠ¶æ€ä»\u0026quot;hello\u0026quot;åˆ‡æ¢åˆ°\u0026quot;hi\u0026quot;,å†åˆ‡æ¢åˆ°\u0026quot;\u0026ldquo;bye\u0026rdquo;;åœ¨åˆ‡æ¢åˆ°\u0026quot;hello\u0026quot;,å¥½è±¡ä¸€ä¸ªæ—‹è½¬å¼€å…³,è¿™ç§çŠ¶æ€æ”¹å˜å°±å¯ä»¥ä½¿ç”¨Stateæ¨¡å¼äº†.\nå¦‚æœå•çº¯æœ‰ä¸Šé¢ä¸€ç§å°†\u0026quot;hello\u0026quot;\u0026ndash;\u0026gt;\u0026ldquo;hi\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;bye\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;hello\u0026quot;è¿™ä¸€ä¸ªæ–¹å‘åˆ‡æ¢,ä¹Ÿä¸ä¸€å®šéœ€è¦ä½¿ç”¨Stateæ¨¡å¼,å› ä¸ºStateæ¨¡å¼ä¼šå»ºç«‹å¾ˆå¤šå­ç±»,å¤æ‚åŒ–,ä½†æ˜¯å¦‚æœåˆå‘ç”Ÿå¦å¤–ä¸€ä¸ªè¡Œä¸º:å°†ä¸Šé¢çš„åˆ‡æ¢æ–¹å‘åè¿‡æ¥åˆ‡æ¢,æˆ–è€…éœ€è¦ä»»æ„åˆ‡æ¢,å°±éœ€è¦Stateäº†.\nè¯·çœ‹ä¸‹ä¾‹:\npublic class Context{ private Color state=null; public void push(){ //å¦‚æœå½“å‰redçŠ¶æ€ å°±åˆ‡æ¢åˆ°blue if (state==Color.red) state=Color.blue; //å¦‚æœå½“å‰blueçŠ¶æ€ å°±åˆ‡æ¢åˆ°green else if (state==Color.blue) state=Color.green; //å¦‚æœå½“å‰blackçŠ¶æ€ å°±åˆ‡æ¢åˆ°red else if (state==Color.black) state=Color.red; //å¦‚æœå½“å‰greençŠ¶æ€ å°±åˆ‡æ¢åˆ°black else if (state==Color.green) state=Color.black; Sample sample=new Sample(state); sample.operate(); } public void pull(){ //ä¸pushçŠ¶æ€åˆ‡æ¢æ­£å¥½ç›¸å if (state==Color.green) state=Color.blue; else if (state==Color.black) state=Color.green; else if (state==Color.blue) state=Color.red; else if (state==Color.red) state=Color.black; Sample2 sample2=new Sample2(state); sample2.operate(); } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬æœ‰ä¸¤ä¸ªåŠ¨ä½œpushæ¨å’Œpullæ‹‰,è¿™ä¸¤ä¸ªå¼€å…³åŠ¨ä½œ,æ”¹å˜äº†Contexté¢œè‰²,è‡³æ­¤,æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨Stateæ¨¡å¼ä¼˜åŒ–å®ƒ.\nå¦å¤–æ³¨æ„:ä½†å°±ä¸Šä¾‹,stateçš„å˜åŒ–,åªæ˜¯ç®€å•çš„é¢œè‰²èµ‹å€¼,è¿™ä¸ªå…·ä½“è¡Œä¸ºæ˜¯å¾ˆç®€å•çš„,Stateé€‚åˆå·¨å¤§çš„å…·ä½“è¡Œä¸º,å› æ­¤åœ¨,å°±æœ¬ä¾‹,å®é™…ä½¿ç”¨ä¸­ä¹Ÿä¸ä¸€å®šéè¦ä½¿ç”¨Stateæ¨¡å¼,è¿™ä¼šå¢åŠ å­ç±»çš„æ•°ç›®,ç®€å•çš„å˜å¤æ‚.\nä¾‹å¦‚: é“¶è¡Œå¸æˆ·, ç»å¸¸ä¼šåœ¨Open çŠ¶æ€å’ŒCloseçŠ¶æ€é—´è½¬æ¢.\nä¾‹å¦‚: ç»å…¸çš„TcpConnection, Tcpçš„çŠ¶æ€æœ‰åˆ›å»º ä¾¦å¬ å…³é—­ä¸‰ä¸ª,å¹¶ä¸”åå¤è½¬æ¢,å…¶åˆ›å»º ä¾¦å¬ å…³é—­çš„å…·ä½“è¡Œä¸ºä¸æ˜¯ç®€å•ä¸€ä¸¤å¥å°±èƒ½å®Œæˆçš„,é€‚åˆä½¿ç”¨State\nä¾‹å¦‚:ä¿¡ç®±POPå¸å·, ä¼šæœ‰å››ç§çŠ¶æ€, start HaveUsername Authorized quit,æ¯ä¸ªçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºåº”è¯¥æ˜¯æ¯”è¾ƒå¤§çš„.é€‚åˆä½¿ç”¨State\nä¾‹å¦‚:åœ¨å·¥å…·ç®±æŒ‘é€‰ä¸åŒå·¥å…·,å¯ä»¥çœ‹æˆåœ¨ä¸åŒå·¥å…·ä¸­åˆ‡æ¢,é€‚åˆä½¿ç”¨State.å¦‚ å…·ä½“ç»˜å›¾ç¨‹åº,ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸åŒå·¥å…·ç»˜åˆ¶æ–¹æ¡† ç›´çº¿ æ›²çº¿,è¿™ç§çŠ¶æ€åˆ‡æ¢å¯ä»¥ä½¿ç”¨State.\nå¦‚ä½•ä½¿ç”¨ Stateéœ€è¦ä¸¤ç§ç±»å‹å®ä½“å‚ä¸:\nstate manager çŠ¶æ€ç®¡ç†å™¨ ,å°±æ˜¯å¼€å…³ ,å¦‚ä¸Šé¢ä¾‹å­çš„Contextå®é™…å°±æ˜¯ä¸€ä¸ªstate manager, åœ¨state managerä¸­æœ‰å¯¹çŠ¶æ€çš„åˆ‡æ¢åŠ¨ä½œ. ç”¨æŠ½è±¡ç±»æˆ–æ¥å£å®ç°çš„çˆ¶ç±»,,ä¸åŒçŠ¶æ€å°±æ˜¯ç»§æ‰¿è¿™ä¸ªçˆ¶ç±»çš„ä¸åŒå­ç±». ä»¥ä¸Šé¢çš„Contextä¸ºä¾‹.æˆ‘ä»¬è¦ä¿®æ”¹å®ƒ,å»ºç«‹ä¸¤ä¸ªç±»å‹çš„å®ä½“.\nç¬¬ä¸€æ­¥: é¦–å…ˆå»ºç«‹ä¸€ä¸ªçˆ¶ç±»: public abstract class State{ public abstract void handlepush(Context c); public abstract void handlepull(Context c); public abstract void getcolor(); } çˆ¶ç±»ä¸­çš„æ–¹æ³•è¦å¯¹åº”state managerä¸­çš„å¼€å…³è¡Œä¸º,åœ¨state managerä¸­ æœ¬ä¾‹å°±æ˜¯Contextä¸­,æœ‰ä¸¤ä¸ªå¼€å…³åŠ¨ä½œpushæ¨å’Œpullæ‹‰.é‚£ä¹ˆåœ¨çŠ¶æ€çˆ¶ç±»ä¸­å°±è¦æœ‰å…·ä½“å¤„ç†è¿™ä¸¤ä¸ªåŠ¨ä½œ:handlepush() handlepull(); åŒæ—¶è¿˜éœ€è¦ä¸€ä¸ªè·å–pushæˆ–pullç»“æœçš„æ–¹æ³•getcolor()\nä¸‹é¢æ˜¯å…·ä½“å­ç±»çš„å®ç°:\npublic class BlueState extends State{ public void handlepush(Context c){ //æ ¹æ®pushæ–¹æ³•\u0026#34;å¦‚æœæ˜¯blueçŠ¶æ€çš„åˆ‡æ¢åˆ°green\u0026#34; ; c.setState(new GreenState()); } public void handlepull(Context c){ //æ ¹æ®pullæ–¹æ³•\u0026#34;å¦‚æœæ˜¯blueçŠ¶æ€çš„åˆ‡æ¢åˆ°red\u0026#34; ; c.setState(new RedState()); } public abstract void getcolor(){ return (Color.blue)} } åŒæ · å…¶ä»–çŠ¶æ€çš„å­ç±»å®ç°å¦‚blueä¸€æ ·.\nç¬¬äºŒæ­¥: è¦é‡æ–°æ”¹å†™State manager ä¹Ÿå°±æ˜¯æœ¬ä¾‹çš„Context: public class Context{ private Sate state=null; //æˆ‘ä»¬å°†åŸæ¥çš„ Color state æ”¹æˆäº†æ–°å»ºçš„State state; //setStateæ˜¯ç”¨æ¥æ”¹å˜stateçš„çŠ¶æ€ ä½¿ç”¨setStateå®ç°çŠ¶æ€çš„åˆ‡æ¢ pulic void setState(State state){ this.state=state; } public void push(){ //çŠ¶æ€çš„åˆ‡æ¢çš„ç»†èŠ‚éƒ¨åˆ†,åœ¨æœ¬ä¾‹ä¸­æ˜¯é¢œè‰²çš„å˜åŒ–,å·²ç»å°è£…åœ¨å­ç±»çš„handlepushä¸­å®ç°,è¿™é‡Œæ— éœ€å…³å¿ƒ state.handlepush(this); //å› ä¸ºsampleè¦ä½¿ç”¨stateä¸­çš„ä¸€ä¸ªåˆ‡æ¢ç»“æœ,ä½¿ç”¨getColor() Sample sample=new Sample(state.getColor()); sample.operate(); } public void pull(){ state.handlepull(this); Sample2 sample2=new Sample2(state.getColor()); sample2.operate(); } } è‡³æ­¤,æˆ‘ä»¬ä¹Ÿå°±å®ç°äº†Stateçš„refactoryingè¿‡ç¨‹.\nä»¥ä¸Šåªæ˜¯ç›¸å½“ç®€å•çš„ä¸€ä¸ªå®ä¾‹,åœ¨å®é™…åº”ç”¨ä¸­,handlepushæˆ–handelpullçš„å¤„ç†æ˜¯å¤æ‚çš„.\nçŠ¶æ€æ¨¡å¼ä¼˜ç‚¹ï¼š ï¼ˆ1ï¼‰ å°è£…è½¬æ¢è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯è½¬æ¢è§„åˆ™ ï¼ˆ2ï¼‰ æšä¸¾å¯èƒ½çš„çŠ¶æ€ï¼Œå› æ­¤ï¼Œéœ€è¦äº‹å…ˆç¡®å®šçŠ¶æ€ç§ç±»ã€‚\nçŠ¶æ€æ¨¡å¼å¯ä»¥å…è®¸å®¢æˆ·ç«¯æ”¹å˜çŠ¶æ€çš„è½¬æ¢è¡Œä¸ºï¼Œè€ŒçŠ¶æ€æœºåˆ™æ˜¯èƒ½å¤Ÿè‡ªåŠ¨æ”¹å˜çŠ¶æ€ï¼ŒçŠ¶æ€æœºæ˜¯ä¸€ä¸ªæ¯”è¾ƒç‹¬ç«‹çš„è€Œä¸”å¤æ‚çš„æœºåˆ¶ï¼Œå…·ä½“å¯å‚è€ƒä¸€ä¸ªçŠ¶æ€æœºå¼€æºé¡¹ç›®ï¼šhttp://sourceforge.net/projects/smframework/\nçŠ¶æ€æ¨¡å¼åœ¨å·¥ä½œæµæˆ–æ¸¸æˆç­‰å„ç§ç³»ç»Ÿä¸­æœ‰å¤§é‡ä½¿ç”¨ï¼Œç”šè‡³æ˜¯è¿™äº›ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½è®¾è®¡ï¼Œä¾‹å¦‚æ”¿åºœOAä¸­ï¼Œä¸€ä¸ªæ‰¹æ–‡çš„çŠ¶æ€æœ‰å¤šç§ï¼šæœªåŠï¼›æ­£åœ¨åŠç†ï¼›æ­£åœ¨æ‰¹ç¤ºï¼›æ­£åœ¨å®¡æ ¸ï¼›å·²ç»å®Œæˆç­‰å„ç§çŠ¶æ€ï¼Œä½¿ç”¨çŠ¶æ€æœºå¯ä»¥å°è£…è¿™ä¸ªçŠ¶æ€çš„å˜åŒ–è§„åˆ™ï¼Œä»è€Œè¾¾åˆ°æ‰©å……çŠ¶æ€æ—¶ï¼Œä¸å¿…æ¶‰åŠåˆ°çŠ¶æ€çš„ä½¿ç”¨è€…ã€‚\nåœ¨ç½‘ç»œæ¸¸æˆä¸­ï¼Œä¸€ä¸ªæ¸¸æˆæ´»åŠ¨å­˜åœ¨å¼€å§‹ï¼›å¼€ç©ï¼›æ­£åœ¨ç©ï¼›è¾“èµ¢ç­‰å„ç§çŠ¶æ€ï¼Œä½¿ç”¨çŠ¶æ€æ¨¡å¼å°±å¯ä»¥å®ç°æ¸¸æˆçŠ¶æ€çš„æ€»æ§ï¼Œè€Œæ¸¸æˆçŠ¶æ€å†³å®šäº†æ¸¸æˆçš„å„ä¸ªæ–¹é¢ï¼Œä½¿ç”¨çŠ¶æ€æ¨¡å¼å¯ä»¥å¯¹æ•´ä¸ªæ¸¸æˆæ¶æ„åŠŸèƒ½å®ç°èµ·åˆ°å†³å®šçš„ä¸»å¯¼ä½œç”¨ã€‚\nçŠ¶æ€æ¨¡å¼å®è´¨ ä½¿ç”¨çŠ¶æ€æ¨¡å¼å‰ï¼Œå®¢æˆ·ç«¯å¤–ç•Œéœ€è¦ä»‹å…¥æ”¹å˜çŠ¶æ€ï¼Œè€ŒçŠ¶æ€æ”¹å˜çš„å®ç°æ˜¯çç¢æˆ–å¤æ‚çš„ã€‚\nä½¿ç”¨çŠ¶æ€æ¨¡å¼åï¼Œå®¢æˆ·ç«¯å¤–ç•Œå¯ä»¥ç›´æ¥ä½¿ç”¨äº‹ä»¶Eventå®ç°ï¼Œæ ¹æœ¬ä¸å¿…å…³å¿ƒè¯¥äº‹ä»¶å¯¼è‡´å¦‚ä½•çŠ¶æ€å˜åŒ–ï¼Œè¿™äº›æ˜¯ç”±çŠ¶æ€æœºç­‰å†…éƒ¨å®ç°ã€‚\nè¿™æ˜¯ä¸€ç§Event-condition-Stateï¼ŒçŠ¶æ€æ¨¡å¼å°è£…äº†condition-Stateéƒ¨åˆ†ã€‚\næ¯ä¸ªçŠ¶æ€å½¢æˆä¸€ä¸ªå­ç±»ï¼Œæ¯ä¸ªçŠ¶æ€åªå…³å¿ƒå®ƒçš„ä¸‹ä¸€ä¸ªå¯èƒ½çŠ¶æ€ï¼Œä»è€Œæ— å½¢ä¸­å½¢æˆäº†çŠ¶æ€è½¬æ¢çš„è§„åˆ™ã€‚å¦‚æœæ–°çš„çŠ¶æ€åŠ å…¥ï¼Œåªæ¶‰åŠå®ƒçš„å‰ä¸€ä¸ªçŠ¶æ€ä¿®æ”¹å’Œå®šä¹‰ã€‚\nçŠ¶æ€è½¬æ¢æœ‰å‡ ä¸ªæ–¹æ³•å®ç°ï¼šä¸€ä¸ªåœ¨æ¯ä¸ªçŠ¶æ€å®ç°next()ï¼ŒæŒ‡å®šä¸‹ä¸€ä¸ªçŠ¶æ€ï¼›è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œè®¾å®šä¸€ä¸ªStateOwnerï¼Œåœ¨StateOwnerè®¾å®šstateEnterçŠ¶æ€è¿›å…¥å’ŒstateExitçŠ¶æ€é€€å‡ºè¡Œä¸ºã€‚\nçŠ¶æ€ä»ä¸€ä¸ªæ–¹é¢è¯´æ˜äº†æµç¨‹ï¼Œæµç¨‹æ˜¯éšæ—¶é—´è€Œæ”¹å˜ï¼ŒçŠ¶æ€æ˜¯æˆªå–æµç¨‹æŸä¸ªæ—¶é—´ç‰‡ã€‚\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.6-state/","summary":"State(çŠ¶æ€æ¨¡å¼)çš„å®šä¹‰ ä¸åŒçš„çŠ¶æ€,ä¸åŒçš„è¡Œä¸º;æˆ–è€…è¯´,æ¯ä¸ªçŠ¶æ€æœ‰ç€ç›¸åº”çš„è¡Œä¸º.\nä½•æ—¶ä½¿ç”¨? Stateæ¨¡å¼åœ¨å®é™…ä½¿ç”¨ä¸­æ¯”è¾ƒå¤š,é€‚åˆ\u0026quot;çŠ¶æ€çš„åˆ‡æ¢\u0026quot;.å› ä¸ºæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨If elseif else è¿›è¡ŒçŠ¶æ€åˆ‡æ¢, å¦‚æœé’ˆå¯¹çŠ¶æ€çš„è¿™æ ·åˆ¤æ–­åˆ‡æ¢åå¤å‡ºç°,æˆ‘ä»¬å°±è¦è”æƒ³åˆ°æ˜¯å¦å¯ä»¥é‡‡å–Stateæ¨¡å¼äº†.\nä¸åªæ˜¯æ ¹æ®çŠ¶æ€,ä¹Ÿæœ‰æ ¹æ®å±æ€§.å¦‚æœæŸä¸ªå¯¹è±¡çš„å±æ€§ä¸åŒ,å¯¹è±¡çš„è¡Œä¸ºå°±ä¸ä¸€æ ·,è¿™ç‚¹åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­å‡ºç°é¢‘ç‡æ¯”è¾ƒé«˜,æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ä¸€ä¸ªæ•°æ®è¡¨çš„å°¾éƒ¨,åŠ ä¸Špropertyå±æ€§å«ä¹‰çš„å­—æ®µ,ç”¨ä»¥æ ‡è¯†è®°å½•ä¸­ä¸€äº›ç‰¹æ®Šæ€§è´¨çš„è®°å½•,è¿™ç§å±æ€§çš„æ”¹å˜(åˆ‡æ¢)åˆæ˜¯éšæ—¶å¯èƒ½å‘ç”Ÿçš„,å°±æœ‰å¯èƒ½è¦ä½¿ç”¨State.\næ˜¯å¦ä½¿ç”¨? åœ¨å®é™…ä½¿ç”¨,ç±»ä¼¼å¼€å…³ä¸€æ ·çš„çŠ¶æ€åˆ‡æ¢æ˜¯å¾ˆå¤šçš„,ä½†æœ‰æ—¶å¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾,å–å†³äºä½ çš„ç»éªŒå’Œå¯¹ç³»ç»Ÿçš„ç†è§£æ·±åº¦.\nè¿™é‡Œè¦é˜è¿°çš„æ˜¯\u0026quot;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026quot; å’Œ\u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„, \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;ä¹Ÿæ˜¯æœ‰ if..elseifç»“æ„,ä¾‹å¦‚:\nif (which==1) state=\u0026ldquo;hello\u0026rdquo;; else if (which==2) state=\u0026ldquo;hi\u0026rdquo;; else if (which==3) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™æ˜¯ä¸€ä¸ª \u0026quot; ä¸€èˆ¬çš„çŠ¶æ€åˆ¤æ–­\u0026quot;,stateå€¼çš„ä¸åŒæ˜¯æ ¹æ®whichå˜é‡æ¥å†³å®šçš„,whichå’Œstateæ²¡æœ‰å…³ç³».å¦‚æœæ”¹æˆ:\nif (state.euqals(\u0026ldquo;bye\u0026rdquo;)) state=\u0026ldquo;hello\u0026rdquo;; else if (state.euqals(\u0026ldquo;hello\u0026rdquo;)) state=\u0026ldquo;hi\u0026rdquo;; else if (state.euqals(\u0026ldquo;hi\u0026rdquo;)) state=\u0026ldquo;bye\u0026rdquo;;\nè¿™å°±æ˜¯ \u0026ldquo;å¼€å…³åˆ‡æ¢çŠ¶æ€\u0026rdquo;,æ˜¯å°†stateçš„çŠ¶æ€ä»\u0026quot;hello\u0026quot;åˆ‡æ¢åˆ°\u0026quot;hi\u0026quot;,å†åˆ‡æ¢åˆ°\u0026quot;\u0026ldquo;bye\u0026rdquo;;åœ¨åˆ‡æ¢åˆ°\u0026quot;hello\u0026quot;,å¥½è±¡ä¸€ä¸ªæ—‹è½¬å¼€å…³,è¿™ç§çŠ¶æ€æ”¹å˜å°±å¯ä»¥ä½¿ç”¨Stateæ¨¡å¼äº†.\nå¦‚æœå•çº¯æœ‰ä¸Šé¢ä¸€ç§å°†\u0026quot;hello\u0026quot;\u0026ndash;\u0026gt;\u0026ldquo;hi\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;bye\u0026rdquo;\u0026ndash;\u0026gt;\u0026ldquo;hello\u0026quot;è¿™ä¸€ä¸ªæ–¹å‘åˆ‡æ¢,ä¹Ÿä¸ä¸€å®šéœ€è¦ä½¿ç”¨Stateæ¨¡å¼,å› ä¸ºStateæ¨¡å¼ä¼šå»ºç«‹å¾ˆå¤šå­ç±»,å¤æ‚åŒ–,ä½†æ˜¯å¦‚æœåˆå‘ç”Ÿå¦å¤–ä¸€ä¸ªè¡Œä¸º:å°†ä¸Šé¢çš„åˆ‡æ¢æ–¹å‘åè¿‡æ¥åˆ‡æ¢,æˆ–è€…éœ€è¦ä»»æ„åˆ‡æ¢,å°±éœ€è¦Stateäº†.\nè¯·çœ‹ä¸‹ä¾‹:\npublic class Context{ private Color state=null; public void push(){ //å¦‚æœå½“å‰redçŠ¶æ€ å°±åˆ‡æ¢åˆ°blue if (state==Color.red) state=Color.blue; //å¦‚æœå½“å‰blueçŠ¶æ€ å°±åˆ‡æ¢åˆ°green else if (state==Color.blue) state=Color.green; //å¦‚æœå½“å‰blackçŠ¶æ€ å°±åˆ‡æ¢åˆ°red else if (state==Color.","title":"3.6 State"},{"content":"Commandæ¨¡å¼æ˜¯æœ€è®©æˆ‘ç–‘æƒ‘çš„ä¸€ä¸ªæ¨¡å¼,æˆ‘åœ¨é˜…è¯»äº†å¾ˆå¤šä»£ç å,æ‰æ„Ÿè§‰éšçº¦æŒæ¡å…¶å¤§æ¦‚åŸç†,æˆ‘è®¤ä¸ºç†è§£è®¾è®¡æ¨¡å¼æœ€ä¸»è¦æ˜¯æŒæ¡èµ·åŸç†æ„é€ ,è¿™æ ·æ‰å¯¹è‡ªå·±å®é™…ç¼–ç¨‹æœ‰æŒ‡å¯¼ä½œç”¨.Commandæ¨¡å¼å®é™…ä¸Šä¸æ˜¯ä¸ªå¾ˆå…·ä½“,è§„å®šå¾ˆå¤šçš„æ¨¡å¼,æ­£æ˜¯è¿™ä¸ªçµæ´»æ€§,è®©äººæœ‰äº›confuse.\nCommandå‘½ä»¤æ¨¡å¼ n å°†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ— éœ€äº†è§£è¿™ä¸ªè¯·æ±‚æ¿€æ´»çš„ åŠ¨ä½œæˆ–æœ‰å…³æ¥å—è¿™ä¸ªè¯·æ±‚çš„å¤„ç†ç»†èŠ‚ã€‚\nè¿™æ˜¯ä¸€ç§ä¸¤å°æœºå™¨ä¹‹é—´é€šè®¯è”ç³»æ€§è´¨çš„æ¨¡å¼ï¼Œç±»ä¼¼ä¼ ç»Ÿè¿‡ç¨‹è¯­ è¨€çš„ CallBackåŠŸèƒ½ã€‚\nå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶åˆ«åä¸ºåŠ¨ä½œ(Action)æ¨¡å¼æˆ–äº‹åŠ¡(Transaction)æ¨¡å¼ã€‚\nä¼˜ç‚¹ è§£è€¦äº†å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´è”ç³»ã€‚ å‘é€è€…è°ƒç”¨ä¸€ä¸ªæ“ä½œï¼Œæ¥å—è€…æ¥å—è¯·æ±‚æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œå› ä¸ºä½¿ç”¨Commandæ¨¡å¼è§£è€¦ï¼Œå‘é€è€…æ— éœ€çŸ¥é“æ¥å—è€…ä»»ä½•æ¥å£ã€‚\nä¸å°‘Commandæ¨¡å¼çš„ä»£ç éƒ½æ˜¯é’ˆå¯¹å›¾å½¢ç•Œé¢çš„,å®ƒå®é™…å°±æ˜¯èœå•å‘½ä»¤,æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸‹æ‹‰èœå•é€‰æ‹©ä¸€ä¸ªå‘½ä»¤æ—¶,ç„¶åä¼šæ‰§è¡Œä¸€äº›åŠ¨ä½œ.\nå°†è¿™äº›å‘½ä»¤å°è£…æˆåœ¨ä¸€ä¸ªç±»ä¸­,ç„¶åç”¨æˆ·(è°ƒç”¨è€…)å†å¯¹è¿™ä¸ªç±»è¿›è¡Œæ“ä½œ,è¿™å°±æ˜¯Commandæ¨¡å¼,æ¢å¥è¯è¯´,æœ¬æ¥ç”¨æˆ·(è°ƒç”¨è€…)æ˜¯ç›´æ¥è°ƒç”¨è¿™äº›å‘½ä»¤çš„,å¦‚èœå•ä¸Šæ‰“å¼€æ–‡æ¡£(è°ƒç”¨è€…),å°±ç›´æ¥æŒ‡å‘æ‰“å¼€æ–‡æ¡£çš„ä»£ç ,ä½¿ç”¨Commandæ¨¡å¼,å°±æ˜¯åœ¨è¿™ä¸¤è€…ä¹‹é—´å¢åŠ ä¸€ä¸ªä¸­é—´è€…,å°†è¿™ç§ç›´æ¥å…³ç³»æ‹—æ–­,åŒæ—¶ä¸¤è€…ä¹‹é—´éƒ½éš”ç¦»,åŸºæœ¬æ²¡æœ‰å…³ç³»äº†.\næ˜¾ç„¶è¿™æ ·åšçš„å¥½å¤„æ˜¯ç¬¦åˆå°è£…çš„ç‰¹æ€§,é™ä½è€¦åˆåº¦,Commandæ˜¯å°†å¯¹è¡Œä¸ºè¿›è¡Œå°è£…çš„å…¸å‹æ¨¡å¼,Factoryæ˜¯å°†åˆ›å»ºè¿›è¡Œå°è£…çš„æ¨¡å¼, ä»Commandæ¨¡å¼,æˆ‘ä¹Ÿå‘ç°è®¾è®¡æ¨¡å¼ä¸€ä¸ª\u0026quot;é€šç—…\u0026quot;:å¥½è±¡å–œæ¬¢å°†ç®€å•çš„é—®é¢˜å¤æ‚åŒ–, å–œæ¬¢åœ¨ä¸åŒç±»ä¸­å¢åŠ ç¬¬ä¸‰è€…,å½“ç„¶è¿™æ ·åšæœ‰åˆ©äºä»£ç çš„å¥å£®æ€§ å¯ç»´æŠ¤æ€§ è¿˜æœ‰å¤ç”¨æ€§.\nå¦‚ä½•ä½¿ç”¨? å…·ä½“çš„Commandæ¨¡å¼ä»£ç å„å¼å„æ ·,å› ä¸ºå¦‚ä½•å°è£…å‘½ä»¤,ä¸åŒç³»ç»Ÿ,æœ‰ä¸åŒçš„åšæ³•.ä¸‹é¢äº‹ä¾‹æ˜¯å°†å‘½ä»¤å°è£…åœ¨ä¸€ä¸ªCollectionçš„Listä¸­,ä»»ä½•å¯¹è±¡ä¸€æ—¦åŠ å…¥Listä¸­,å®é™…ä¸Šè£…å…¥äº†ä¸€ä¸ªå°é—­çš„é»‘ç›’ä¸­,å¯¹è±¡çš„ç‰¹æ€§æ¶ˆå¤±äº†,åªæœ‰å–å‡ºæ—¶,æ‰æœ‰å¯èƒ½æ¨¡ç³Šçš„åˆ†è¾¨å‡º:å…¸å‹çš„Commandæ¨¡å¼éœ€è¦æœ‰ä¸€ä¸ªæ¥å£.æ¥å£ä¸­æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•,è¿™å°±æ˜¯\u0026quot;å°†å‘½ä»¤/è¯·æ±‚å°è£…ä¸ºå¯¹è±¡\u0026quot;:\npublic interface Command { public abstract void execute ( ); } å…·ä½“ä¸åŒå‘½ä»¤/è¯·æ±‚ä»£ç æ˜¯å®ç°æ¥å£Command,ä¸‹é¢æœ‰ä¸‰ä¸ªå…·ä½“å‘½ä»¤\npublic class Engineer implements Command { public void execute( ) { //do Engineer\u0026#39;s command } } public class Programmer implements Command { public void execute( ) { //do programmer\u0026#39;s command } } public class Politician implements Command { public void execute( ) { //do Politician\u0026#39;s command } } æŒ‰ç…§é€šå¸¸åšæ³•,æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸‰ä¸ªCommand,ä½†æ˜¯ä½¿ç”¨Commandæ¨¡å¼,æˆ‘ä»¬è¦å°†ä»–ä»¬å°è£…èµ·æ¥,æ‰”åˆ°é»‘ç›’å­Listé‡Œå»:\npublic class producer{ public static List produceRequests() { List queue = new ArrayList(); queue.add( new DomesticEngineer() ); queue.add( new Politician() ); queue.add( new Programmer() ); return queue; } } è¿™ä¸‰ä¸ªå‘½ä»¤è¿›å…¥Listä¸­å,å·²ç»å¤±å»äº†å…¶å¤–è¡¨ç‰¹å¾,ä»¥åå†å–å‡º,ä¹Ÿå¯èƒ½æ— æ³•åˆ†è¾¨å‡ºè°æ˜¯Engineer è°æ˜¯Programmeräº†,çœ‹ä¸‹é¢å®¢æˆ·ç«¯å¦‚ä½•è°ƒç”¨Commandæ¨¡å¼:\npublic class TestCommand { public static void main(String[] args) { List queue = Producer.produceRequests(); for (Iterator it = queue.iterator(); it.hasNext(); ) //å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨executeæ–¹æ³•ï¼Œæ— éœ€çŸ¥é“è¢«è°ƒç”¨è€…çš„å…¶å®ƒæ›´å¤šç±»çš„æ–¹æ³•åã€‚ ((Command)it.next()).execute(); } } ç”±æ­¤å¯è§,è°ƒç”¨è€…åŸºæœ¬åªå’Œæ¥å£æ‰“äº¤é“,ä¸åˆå…·ä½“å®ç°äº¤äº’,è¿™ä¹Ÿä½“ç°äº†ä¸€ä¸ªåŸåˆ™,é¢å‘æ¥å£ç¼–ç¨‹,è¿™æ ·,ä»¥åå¢åŠ ç¬¬å››ä¸ªå…·ä½“å‘½ä»¤æ—¶,å°±ä¸å¿…ä¿®æ”¹è°ƒç”¨è€…TestCommandä¸­çš„ä»£ç äº†.\nç†è§£äº†ä¸Šé¢çš„ä»£ç çš„æ ¸å¿ƒåŸç†,åœ¨ä½¿ç”¨ä¸­,å°±åº”è¯¥å„äººæœ‰è‡ªå·±æ–¹æ³•äº†,ç‰¹åˆ«æ˜¯åœ¨å¦‚ä½•åˆ†ç¦»è°ƒç”¨è€…å’Œå…·ä½“å‘½ä»¤ä¸Š,æœ‰å¾ˆå¤šå®ç°æ–¹æ³•,ä¸Šé¢çš„ä»£ç æ˜¯ä½¿ç”¨\u0026quot;ä»Listè¿‡ä¸€é\u0026quot;çš„åšæ³•.è¿™ç§åšæ³•åªæ˜¯ä¸ºäº†æ¼”ç¤º.\nä½¿ç”¨Commandæ¨¡å¼çš„ä¸€ä¸ªå¥½ç†ç”±è¿˜å› ä¸ºå®ƒèƒ½å®ç°UndoåŠŸèƒ½.æ¯ä¸ªå…·ä½“å‘½ä»¤éƒ½å¯ä»¥è®°ä½å®ƒåˆšåˆšæ‰§è¡Œçš„åŠ¨ä½œ,å¹¶ä¸”åœ¨éœ€è¦æ—¶æ¢å¤.\nCommandæ¨¡å¼åœ¨ç•Œé¢è®¾è®¡ä¸­åº”ç”¨å¹¿æ³›.Javaçš„Swingä¸­èœå•å‘½ä»¤éƒ½æ˜¯ä½¿ç”¨Commandæ¨¡å¼,ç”±äºJavaåœ¨ç•Œé¢è®¾è®¡çš„æ€§èƒ½ä¸Šè¿˜æœ‰æ¬ ç¼º,å› æ­¤ç•Œé¢è®¾è®¡å…·ä½“ä»£ç æˆ‘ä»¬å°±ä¸è®¨è®º,ç½‘ç»œä¸Šæœ‰å¾ˆå¤šè¿™æ ·çš„ç¤ºä¾‹.\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.5-command/","summary":"Commandæ¨¡å¼æ˜¯æœ€è®©æˆ‘ç–‘æƒ‘çš„ä¸€ä¸ªæ¨¡å¼,æˆ‘åœ¨é˜…è¯»äº†å¾ˆå¤šä»£ç å,æ‰æ„Ÿè§‰éšçº¦æŒæ¡å…¶å¤§æ¦‚åŸç†,æˆ‘è®¤ä¸ºç†è§£è®¾è®¡æ¨¡å¼æœ€ä¸»è¦æ˜¯æŒæ¡èµ·åŸç†æ„é€ ,è¿™æ ·æ‰å¯¹è‡ªå·±å®é™…ç¼–ç¨‹æœ‰æŒ‡å¯¼ä½œç”¨.Commandæ¨¡å¼å®é™…ä¸Šä¸æ˜¯ä¸ªå¾ˆå…·ä½“,è§„å®šå¾ˆå¤šçš„æ¨¡å¼,æ­£æ˜¯è¿™ä¸ªçµæ´»æ€§,è®©äººæœ‰äº›confuse.\nCommandå‘½ä»¤æ¨¡å¼ n å°†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ— éœ€äº†è§£è¿™ä¸ªè¯·æ±‚æ¿€æ´»çš„ åŠ¨ä½œæˆ–æœ‰å…³æ¥å—è¿™ä¸ªè¯·æ±‚çš„å¤„ç†ç»†èŠ‚ã€‚\nè¿™æ˜¯ä¸€ç§ä¸¤å°æœºå™¨ä¹‹é—´é€šè®¯è”ç³»æ€§è´¨çš„æ¨¡å¼ï¼Œç±»ä¼¼ä¼ ç»Ÿè¿‡ç¨‹è¯­ è¨€çš„ CallBackåŠŸèƒ½ã€‚\nå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶åˆ«åä¸ºåŠ¨ä½œ(Action)æ¨¡å¼æˆ–äº‹åŠ¡(Transaction)æ¨¡å¼ã€‚\nä¼˜ç‚¹ è§£è€¦äº†å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´è”ç³»ã€‚ å‘é€è€…è°ƒç”¨ä¸€ä¸ªæ“ä½œï¼Œæ¥å—è€…æ¥å—è¯·æ±‚æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œå› ä¸ºä½¿ç”¨Commandæ¨¡å¼è§£è€¦ï¼Œå‘é€è€…æ— éœ€çŸ¥é“æ¥å—è€…ä»»ä½•æ¥å£ã€‚\nä¸å°‘Commandæ¨¡å¼çš„ä»£ç éƒ½æ˜¯é’ˆå¯¹å›¾å½¢ç•Œé¢çš„,å®ƒå®é™…å°±æ˜¯èœå•å‘½ä»¤,æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸‹æ‹‰èœå•é€‰æ‹©ä¸€ä¸ªå‘½ä»¤æ—¶,ç„¶åä¼šæ‰§è¡Œä¸€äº›åŠ¨ä½œ.\nå°†è¿™äº›å‘½ä»¤å°è£…æˆåœ¨ä¸€ä¸ªç±»ä¸­,ç„¶åç”¨æˆ·(è°ƒç”¨è€…)å†å¯¹è¿™ä¸ªç±»è¿›è¡Œæ“ä½œ,è¿™å°±æ˜¯Commandæ¨¡å¼,æ¢å¥è¯è¯´,æœ¬æ¥ç”¨æˆ·(è°ƒç”¨è€…)æ˜¯ç›´æ¥è°ƒç”¨è¿™äº›å‘½ä»¤çš„,å¦‚èœå•ä¸Šæ‰“å¼€æ–‡æ¡£(è°ƒç”¨è€…),å°±ç›´æ¥æŒ‡å‘æ‰“å¼€æ–‡æ¡£çš„ä»£ç ,ä½¿ç”¨Commandæ¨¡å¼,å°±æ˜¯åœ¨è¿™ä¸¤è€…ä¹‹é—´å¢åŠ ä¸€ä¸ªä¸­é—´è€…,å°†è¿™ç§ç›´æ¥å…³ç³»æ‹—æ–­,åŒæ—¶ä¸¤è€…ä¹‹é—´éƒ½éš”ç¦»,åŸºæœ¬æ²¡æœ‰å…³ç³»äº†.\næ˜¾ç„¶è¿™æ ·åšçš„å¥½å¤„æ˜¯ç¬¦åˆå°è£…çš„ç‰¹æ€§,é™ä½è€¦åˆåº¦,Commandæ˜¯å°†å¯¹è¡Œä¸ºè¿›è¡Œå°è£…çš„å…¸å‹æ¨¡å¼,Factoryæ˜¯å°†åˆ›å»ºè¿›è¡Œå°è£…çš„æ¨¡å¼, ä»Commandæ¨¡å¼,æˆ‘ä¹Ÿå‘ç°è®¾è®¡æ¨¡å¼ä¸€ä¸ª\u0026quot;é€šç—…\u0026quot;:å¥½è±¡å–œæ¬¢å°†ç®€å•çš„é—®é¢˜å¤æ‚åŒ–, å–œæ¬¢åœ¨ä¸åŒç±»ä¸­å¢åŠ ç¬¬ä¸‰è€…,å½“ç„¶è¿™æ ·åšæœ‰åˆ©äºä»£ç çš„å¥å£®æ€§ å¯ç»´æŠ¤æ€§ è¿˜æœ‰å¤ç”¨æ€§.\nå¦‚ä½•ä½¿ç”¨? å…·ä½“çš„Commandæ¨¡å¼ä»£ç å„å¼å„æ ·,å› ä¸ºå¦‚ä½•å°è£…å‘½ä»¤,ä¸åŒç³»ç»Ÿ,æœ‰ä¸åŒçš„åšæ³•.ä¸‹é¢äº‹ä¾‹æ˜¯å°†å‘½ä»¤å°è£…åœ¨ä¸€ä¸ªCollectionçš„Listä¸­,ä»»ä½•å¯¹è±¡ä¸€æ—¦åŠ å…¥Listä¸­,å®é™…ä¸Šè£…å…¥äº†ä¸€ä¸ªå°é—­çš„é»‘ç›’ä¸­,å¯¹è±¡çš„ç‰¹æ€§æ¶ˆå¤±äº†,åªæœ‰å–å‡ºæ—¶,æ‰æœ‰å¯èƒ½æ¨¡ç³Šçš„åˆ†è¾¨å‡º:å…¸å‹çš„Commandæ¨¡å¼éœ€è¦æœ‰ä¸€ä¸ªæ¥å£.æ¥å£ä¸­æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•,è¿™å°±æ˜¯\u0026quot;å°†å‘½ä»¤/è¯·æ±‚å°è£…ä¸ºå¯¹è±¡\u0026quot;:\npublic interface Command { public abstract void execute ( ); } å…·ä½“ä¸åŒå‘½ä»¤/è¯·æ±‚ä»£ç æ˜¯å®ç°æ¥å£Command,ä¸‹é¢æœ‰ä¸‰ä¸ªå…·ä½“å‘½ä»¤\npublic class Engineer implements Command { public void execute( ) { //do Engineer\u0026#39;s command } } public class Programmer implements Command { public void execute( ) { //do programmer\u0026#39;s command } } public class Politician implements Command { public void execute( ) { //do Politician\u0026#39;s command } } æŒ‰ç…§é€šå¸¸åšæ³•,æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸‰ä¸ªCommand,ä½†æ˜¯ä½¿ç”¨Commandæ¨¡å¼,æˆ‘ä»¬è¦å°†ä»–ä»¬å°è£…èµ·æ¥,æ‰”åˆ°é»‘ç›’å­Listé‡Œå»:","title":"3.5 Command"},{"content":"Chain of Responsibility (èŒè´£é“¾æ¨¡å¼) Chain of Responsibility(CoR) æ˜¯ç”¨ä¸€ç³»åˆ—ç±»(classes)è¯•å›¾å¤„ç†ä¸€ä¸ªè¯·æ±‚request,è¿™äº›ç±»ä¹‹é—´æ˜¯ä¸€ä¸ªæ¾æ•£çš„è€¦åˆ,å”¯ä¸€å…±åŒç‚¹æ˜¯åœ¨ä»–ä»¬ä¹‹é—´ä¼ é€’request. ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥äº†ä¸€ä¸ªè¯·æ±‚ï¼ŒAç±»å…ˆå¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Bç±»å¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Cç±»å¤„ç†ï¼Œå°±è¿™æ ·è±¡ä¸€ä¸ªé“¾æ¡(chain)ä¸€æ ·ä¼ é€’ä¸‹å»ã€‚\nå¦‚ä½•ä½¿ç”¨? è™½ç„¶è¿™ä¸€æ®µæ˜¯å¦‚ä½•ä½¿ç”¨CoR,ä½†æ˜¯ä¹Ÿæ˜¯æ¼”ç¤ºä»€ä¹ˆæ˜¯CoR.\næœ‰ä¸€ä¸ªHandleræ¥å£:\npublic interface Handler{ public void handleRequest(); } è¿™æ˜¯ä¸€ä¸ªå¤„ç†requestçš„äº‹ä¾‹ï¼Œ å¦‚æœæœ‰å¤šç§request,æ¯”å¦‚ è¯·æ±‚å¸®åŠ© è¯·æ±‚æ‰“å° æˆ–è¯·æ±‚æ ¼å¼åŒ–ï¼š\næœ€å…ˆæƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨æ¥å£ä¸­å¢åŠ å¤šä¸ªè¯·æ±‚ï¼š\npublic interface Handler{ public void handleHelp(); public void handlePrint(); public void handleFormat(); } å…·ä½“æ˜¯ä¸€æ®µå®ç°æ¥å£Handlerä»£ç ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleHelp(){ //å…·ä½“å¤„ç†è¯·æ±‚Helpçš„ä»£ç  ... } public void handlePrint(){ //å¦‚æœæ˜¯print è½¬å»å¤„ç†Print successor.handlePrint(); } public void handleFormat(){ //å¦‚æœæ˜¯Format è½¬å»å¤„ç†format successor.handleFormat(); } } ä¸€å…±æœ‰ä¸‰ä¸ªè¿™æ ·çš„å…·ä½“å®ç°ç±»ï¼Œä¸Šé¢æ˜¯å¤„ç†help,è¿˜æœ‰å¤„ç†Print å¤„ç†Formatè¿™å¤§æ¦‚æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ç¼–ç¨‹æ€è·¯ã€‚\nè™½ç„¶æ€è·¯ç®€å•æ˜äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ‰©å±•é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å†å¢åŠ ä¸€ä¸ªè¯·æ±‚requestç§ç±»,éœ€è¦ä¿®æ”¹æ¥å£åŠå…¶æ¯ä¸€ä¸ªå®ç°ã€‚\nç¬¬äºŒæ–¹æ¡ˆ:å°†æ¯ç§requestéƒ½å˜æˆä¸€ä¸ªæ¥å£ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ä»¥ä¸‹ä»£ç  ï¼š\npublic interface HelpHandler{ public void handleHelp(); } public interface PrintHandler{ public void handlePrint(); } public interface FormatHandler{ public void handleFormat(); } public class ConcreteHandler implements HelpHandler,PrintHandler,FormatHandlet{ private HelpHandler helpSuccessor; private PrintHandler printSuccessor; private FormatHandler formatSuccessor; public ConcreteHandler(HelpHandler helpSuccessor,PrintHandler printSuccessor,FormatHandler formatSuccessor) { this.helpSuccessor=helpSuccessor; this.printSuccessor=printSuccessor; this.formatSuccessor=formatSuccessor; } public void handleHelp(){ ....... } public void handlePrint(){this.printSuccessor=printSuccessor;} public void handleFormat(){this.formatSuccessor=formatSuccessor;} } è¿™ä¸ªåŠæ³•åœ¨å¢åŠ æ–°çš„è¯·æ±‚requestæƒ…å†µä¸‹ï¼Œåªæ˜¯èŠ‚çœäº†æ¥å£çš„ä¿®æ”¹é‡ï¼Œæ¥å£å®ç°ConcreteHandlerè¿˜éœ€è¦ä¿®æ”¹ã€‚è€Œä¸”ä»£ç æ˜¾ç„¶ä¸ç®€å•ç¾ä¸½ã€‚\nè§£å†³æ–¹æ¡ˆ3: åœ¨Handleræ¥å£ä¸­åªä½¿ç”¨ä¸€ä¸ªå‚æ•°åŒ–æ–¹æ³•ï¼š\npublic interface Handler{ public void handleRequest(String request); } é‚£ä¹ˆHandlerå®ç°ä»£ç å¦‚ä¸‹ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleRequest(String request){ if (request.equals(\u0026#34;Help\u0026#34;)){ //è¿™é‡Œæ˜¯å¤„ç†Helpçš„å…·ä½“ä»£ç  }else //ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª successor.handle(request); } } } è¿™é‡Œå…ˆå‡è®¾requestæ˜¯Stringç±»å‹ï¼Œå¦‚æœä¸æ˜¯æ€ä¹ˆåŠï¼Ÿå½“ç„¶æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸“é—¨ç±»Request\næœ€åè§£å†³æ–¹æ¡ˆ:æ¥å£Handlerçš„ä»£ç å¦‚ä¸‹ï¼š\npublic interface Handler{ public void handleRequest(Request request); } Requestç±»çš„å®šä¹‰:\npublic class Request{ private String type; public Request(String type){this.type=type;} public String getType(){return type;} public void execute(){ //requestçœŸæ­£å…·ä½“è¡Œä¸ºä»£ç  } } é‚£ä¹ˆHandlerå®ç°ä»£ç å¦‚ä¸‹ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleRequest(Request request){ if (request instanceof HelpRequest){ //è¿™é‡Œæ˜¯å¤„ç†Helpçš„å…·ä½“ä»£ç  }else if (request instanceof PrintRequst){ request.execute(); }else //ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª successor.handle(request); } } } è¿™ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¯CoR, åœ¨ä¸€ä¸ªé“¾ä¸Š,éƒ½æœ‰ç›¸åº”èŒè´£çš„ç±»,å› æ­¤å«Chain of Responsibility.\nCoRçš„ä¼˜ç‚¹ å› ä¸ºæ— æ³•é¢„çŸ¥æ¥è‡ªå¤–ç•Œï¼ˆå®¢æˆ·ç«¯ï¼‰çš„è¯·æ±‚æ˜¯å±äºå“ªç§ç±»å‹ï¼Œæ¯ä¸ªç±»å¦‚æœç¢°åˆ°å®ƒä¸èƒ½å¤„ç†çš„è¯·æ±‚åªè¦æ”¾å¼ƒå°±å¯ä»¥ã€‚\nç¼ºç‚¹æ˜¯æ•ˆç‡ä½ï¼Œå› ä¸ºä¸€ä¸ªè¯·æ±‚çš„å®Œæˆå¯èƒ½è¦éå†åˆ°æœ€åæ‰å¯èƒ½å®Œæˆï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ ‘çš„æ¦‚å¿µä¼˜åŒ–ã€‚ åœ¨Java AWT1.0ä¸­ï¼Œå¯¹äºé¼ æ ‡æŒ‰é”®äº‹æƒ…çš„å¤„ç†å°±æ˜¯ä½¿ç”¨CoR,åˆ°Java.1.1ä»¥åï¼Œå°±ä½¿ç”¨Observerä»£æ›¿CoR\næ‰©å±•æ€§å·®ï¼Œå› ä¸ºåœ¨CoRä¸­ï¼Œä¸€å®šè¦æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£Handler.å±€é™æ€§å°±åœ¨è¿™é‡Œã€‚\nä¸Commandæ¨¡å¼åŒºåˆ« Command æ¨¡å¼éœ€è¦äº‹å…ˆåå•†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„è°ƒç”¨å…³ç³»ï¼Œæ¯”å¦‚ 1 ä»£è¡¨ start 2 ä»£è¡¨ move ç­‰ï¼Œè¿™äº› éƒ½æ˜¯å°è£…åœ¨ request ä¸­ï¼Œåˆ°è¾¾æœåŠ¡å™¨ç«¯å†åˆ†è§£ã€‚\nCoR æ¨¡å¼å°±æ— éœ€è¿™ç§äº‹å…ˆçº¦å®šï¼ŒæœåŠ¡å™¨ç«¯å¯ä»¥ä½¿ç”¨ CoR æ¨¡å¼è¿›è¡Œå®¢æˆ·ç«¯è¯·æ±‚çš„çŒœæµ‹ï¼Œä¸€ä¸ªä¸ªçŒœæµ‹ è¯•éªŒã€‚\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.4-chain-of-responsibility/","summary":"Chain of Responsibility (èŒè´£é“¾æ¨¡å¼) Chain of Responsibility(CoR) æ˜¯ç”¨ä¸€ç³»åˆ—ç±»(classes)è¯•å›¾å¤„ç†ä¸€ä¸ªè¯·æ±‚request,è¿™äº›ç±»ä¹‹é—´æ˜¯ä¸€ä¸ªæ¾æ•£çš„è€¦åˆ,å”¯ä¸€å…±åŒç‚¹æ˜¯åœ¨ä»–ä»¬ä¹‹é—´ä¼ é€’request. ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥äº†ä¸€ä¸ªè¯·æ±‚ï¼ŒAç±»å…ˆå¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Bç±»å¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œå°±ä¼ é€’åˆ°Cç±»å¤„ç†ï¼Œå°±è¿™æ ·è±¡ä¸€ä¸ªé“¾æ¡(chain)ä¸€æ ·ä¼ é€’ä¸‹å»ã€‚\nå¦‚ä½•ä½¿ç”¨? è™½ç„¶è¿™ä¸€æ®µæ˜¯å¦‚ä½•ä½¿ç”¨CoR,ä½†æ˜¯ä¹Ÿæ˜¯æ¼”ç¤ºä»€ä¹ˆæ˜¯CoR.\næœ‰ä¸€ä¸ªHandleræ¥å£:\npublic interface Handler{ public void handleRequest(); } è¿™æ˜¯ä¸€ä¸ªå¤„ç†requestçš„äº‹ä¾‹ï¼Œ å¦‚æœæœ‰å¤šç§request,æ¯”å¦‚ è¯·æ±‚å¸®åŠ© è¯·æ±‚æ‰“å° æˆ–è¯·æ±‚æ ¼å¼åŒ–ï¼š\næœ€å…ˆæƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨æ¥å£ä¸­å¢åŠ å¤šä¸ªè¯·æ±‚ï¼š\npublic interface Handler{ public void handleHelp(); public void handlePrint(); public void handleFormat(); } å…·ä½“æ˜¯ä¸€æ®µå®ç°æ¥å£Handlerä»£ç ï¼š\npublic class ConcreteHandler implements Handler{ private Handler successor; public ConcreteHandler(Handler successor){ this.successor=successor; } public void handleHelp(){ //å…·ä½“å¤„ç†è¯·æ±‚Helpçš„ä»£ç  ... } public void handlePrint(){ //å¦‚æœæ˜¯print è½¬å»å¤„ç†Print successor.handlePrint(); } public void handleFormat(){ //å¦‚æœæ˜¯Format è½¬å»å¤„ç†format successor.","title":"3.4 Chain of Responsibility"},{"content":"Observer(è§‚å¯Ÿè€…æ¨¡å¼)å®šä¹‰ è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€ä¸Šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚\né“¾æ¥\nå…·ä½“è®²è§£\nJavaæ·±å…¥åˆ°ä¸€å®šç¨‹åº¦,å°±ä¸å¯é¿å…çš„ç¢°åˆ°è®¾è®¡æ¨¡å¼(design pattern)è¿™ä¸€æ¦‚å¿µ,äº†è§£è®¾è®¡æ¨¡å¼,å°†ä½¿è‡ªå·±å¯¹javaä¸­çš„æ¥å£æˆ–æŠ½è±¡ç±»åº”ç”¨æœ‰æ›´æ·±çš„ç†è§£.è®¾è®¡æ¨¡å¼åœ¨javaçš„ä¸­å‹ç³»ç»Ÿä¸­åº”ç”¨å¹¿æ³›,éµå¾ªä¸€å®šçš„ç¼–ç¨‹æ¨¡å¼,æ‰èƒ½ä½¿è‡ªå·±çš„ä»£ç ä¾¿äºç†è§£,æ˜“äºäº¤æµ,Observer(è§‚å¯Ÿè€…)æ¨¡å¼æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªæ¨¡å¼,å°¤å…¶åœ¨ç•Œé¢è®¾è®¡ä¸­åº”ç”¨å¹¿æ³›,è€Œæœ¬ç«™æ‰€å…³æ³¨çš„æ˜¯Javaåœ¨ç”µå­å•†åŠ¡ç³»ç»Ÿä¸­åº”ç”¨,å› æ­¤æƒ³ä»ç”µå­å•†åŠ¡å®ä¾‹ä¸­åˆ†æObserverçš„åº”ç”¨.\nè™½ç„¶ç½‘ä¸Šå•†åº—å½¢å¼å¤šæ ·,æ¯ä¸ªç«™ç‚¹æœ‰è‡ªå·±çš„ç‰¹è‰²,ä½†ä¹Ÿæœ‰å…¶ä¸€èˆ¬çš„å…±æ€§,å•å°±\u0026quot;å•†å“çš„å˜åŒ–,ä»¥ä¾¿åŠæ—¶é€šçŸ¥è®¢æˆ·\u0026quot;è¿™ä¸€ç‚¹,æ˜¯å¾ˆå¤šç½‘ä¸Šå•†åº—å…±æœ‰çš„æ¨¡å¼,è¿™ä¸€æ¨¡å¼ç±»ä¼¼Observer paternè§‚å¯Ÿè€…æ¨¡å¼.\nå…·ä½“çš„è¯´,å¦‚æœç½‘ä¸Šå•†åº—ä¸­å•†å“åœ¨åç§° ä»·æ ¼ç­‰æ–¹é¢æœ‰å˜åŒ–,å¦‚æœç³»ç»Ÿèƒ½è‡ªåŠ¨é€šçŸ¥ä¼šå‘˜,å°†æ˜¯ç½‘ä¸Šå•†åº—åŒºåˆ«ä¼ ç»Ÿå•†åº—çš„ä¸€å¤§ç‰¹è‰².è¿™å°±éœ€è¦åœ¨å•†å“productä¸­åŠ å…¥Observerè¿™æ ·è§’è‰²,ä»¥ä¾¿productç»†èŠ‚å‘ç”Ÿå˜åŒ–æ—¶,Observerèƒ½è‡ªåŠ¨è§‚å¯Ÿåˆ°è¿™ç§å˜åŒ–,å¹¶èƒ½è¿›è¡ŒåŠæ—¶çš„updateæˆ–notifyåŠ¨ä½œ.\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.3-observer/","summary":"Observer(è§‚å¯Ÿè€…æ¨¡å¼)å®šä¹‰ è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€ä¸Šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚\né“¾æ¥\nå…·ä½“è®²è§£\nJavaæ·±å…¥åˆ°ä¸€å®šç¨‹åº¦,å°±ä¸å¯é¿å…çš„ç¢°åˆ°è®¾è®¡æ¨¡å¼(design pattern)è¿™ä¸€æ¦‚å¿µ,äº†è§£è®¾è®¡æ¨¡å¼,å°†ä½¿è‡ªå·±å¯¹javaä¸­çš„æ¥å£æˆ–æŠ½è±¡ç±»åº”ç”¨æœ‰æ›´æ·±çš„ç†è§£.è®¾è®¡æ¨¡å¼åœ¨javaçš„ä¸­å‹ç³»ç»Ÿä¸­åº”ç”¨å¹¿æ³›,éµå¾ªä¸€å®šçš„ç¼–ç¨‹æ¨¡å¼,æ‰èƒ½ä½¿è‡ªå·±çš„ä»£ç ä¾¿äºç†è§£,æ˜“äºäº¤æµ,Observer(è§‚å¯Ÿè€…)æ¨¡å¼æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªæ¨¡å¼,å°¤å…¶åœ¨ç•Œé¢è®¾è®¡ä¸­åº”ç”¨å¹¿æ³›,è€Œæœ¬ç«™æ‰€å…³æ³¨çš„æ˜¯Javaåœ¨ç”µå­å•†åŠ¡ç³»ç»Ÿä¸­åº”ç”¨,å› æ­¤æƒ³ä»ç”µå­å•†åŠ¡å®ä¾‹ä¸­åˆ†æObserverçš„åº”ç”¨.\nè™½ç„¶ç½‘ä¸Šå•†åº—å½¢å¼å¤šæ ·,æ¯ä¸ªç«™ç‚¹æœ‰è‡ªå·±çš„ç‰¹è‰²,ä½†ä¹Ÿæœ‰å…¶ä¸€èˆ¬çš„å…±æ€§,å•å°±\u0026quot;å•†å“çš„å˜åŒ–,ä»¥ä¾¿åŠæ—¶é€šçŸ¥è®¢æˆ·\u0026quot;è¿™ä¸€ç‚¹,æ˜¯å¾ˆå¤šç½‘ä¸Šå•†åº—å…±æœ‰çš„æ¨¡å¼,è¿™ä¸€æ¨¡å¼ç±»ä¼¼Observer paternè§‚å¯Ÿè€…æ¨¡å¼.\nå…·ä½“çš„è¯´,å¦‚æœç½‘ä¸Šå•†åº—ä¸­å•†å“åœ¨åç§° ä»·æ ¼ç­‰æ–¹é¢æœ‰å˜åŒ–,å¦‚æœç³»ç»Ÿèƒ½è‡ªåŠ¨é€šçŸ¥ä¼šå‘˜,å°†æ˜¯ç½‘ä¸Šå•†åº—åŒºåˆ«ä¼ ç»Ÿå•†åº—çš„ä¸€å¤§ç‰¹è‰².è¿™å°±éœ€è¦åœ¨å•†å“productä¸­åŠ å…¥Observerè¿™æ ·è§’è‰²,ä»¥ä¾¿productç»†èŠ‚å‘ç”Ÿå˜åŒ–æ—¶,Observerèƒ½è‡ªåŠ¨è§‚å¯Ÿåˆ°è¿™ç§å˜åŒ–,å¹¶èƒ½è¿›è¡ŒåŠæ—¶çš„updateæˆ–notifyåŠ¨ä½œ.","title":"3.3 Observer"},{"content":"Memento(å¤‡å¿˜å½•æ¨¡å¼)å®šä¹‰ mementoæ˜¯ä¸€ä¸ªä¿å­˜å¦å¤–ä¸€ä¸ªå¯¹è±¡å†…éƒ¨çŠ¶æ€æ‹·è´çš„å¯¹è±¡.è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€.\nMementoæ¨¡å¼ç›¸å¯¹ä¹Ÿæ¯”è¾ƒå¥½ç†è§£,æˆ‘ä»¬çœ‹ä¸‹åˆ—ä»£ç :\npublic class Originator { public int number; public File file = null; public Originator(){} // åˆ›å»ºä¸€ä¸ªMemento public Memento getMemento(){ return new Memento(this); } // æ¢å¤åˆ°åŸå§‹å€¼ public void setMemento(Memento m){ number = m.number; file = m.file; } } æˆ‘ä»¬å†çœ‹çœ‹Mementoç±»:\nprivate class Memento implements java.io.Serializable{ public int number; public File file = null; public Memento( Originator o){ number = o.number; file = o.file; } } å¯è§ Mementoä¸­ä¿å­˜äº†Originatorä¸­çš„numberå’Œfileçš„å€¼. é€šè¿‡è°ƒç”¨Originatorä¸­numberå’Œfileå€¼æ”¹å˜çš„è¯,é€šè¿‡è°ƒç”¨setMemento()æ–¹æ³•å¯ä»¥æ¢å¤.\nMementoæ¨¡å¼çš„ç¼ºç‚¹æ˜¯è€—è´¹å¤§,å¦‚æœå†…éƒ¨çŠ¶æ€å¾ˆå¤š,å†ä¿å­˜ä¸€ä»½,æ— æ„è¦æµªè´¹å¤§é‡å†…å­˜.\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.2-memento/","summary":"Memento(å¤‡å¿˜å½•æ¨¡å¼)å®šä¹‰ mementoæ˜¯ä¸€ä¸ªä¿å­˜å¦å¤–ä¸€ä¸ªå¯¹è±¡å†…éƒ¨çŠ¶æ€æ‹·è´çš„å¯¹è±¡.è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€.\nMementoæ¨¡å¼ç›¸å¯¹ä¹Ÿæ¯”è¾ƒå¥½ç†è§£,æˆ‘ä»¬çœ‹ä¸‹åˆ—ä»£ç :\npublic class Originator { public int number; public File file = null; public Originator(){} // åˆ›å»ºä¸€ä¸ªMemento public Memento getMemento(){ return new Memento(this); } // æ¢å¤åˆ°åŸå§‹å€¼ public void setMemento(Memento m){ number = m.number; file = m.file; } } æˆ‘ä»¬å†çœ‹çœ‹Mementoç±»:\nprivate class Memento implements java.io.Serializable{ public int number; public File file = null; public Memento( Originator o){ number = o.number; file = o.file; } } å¯è§ Mementoä¸­ä¿å­˜äº†Originatorä¸­çš„numberå’Œfileçš„å€¼. é€šè¿‡è°ƒç”¨Originatorä¸­numberå’Œfileå€¼æ”¹å˜çš„è¯,é€šè¿‡è°ƒç”¨setMemento()æ–¹æ³•å¯ä»¥æ¢å¤.\nMementoæ¨¡å¼çš„ç¼ºç‚¹æ˜¯è€—è´¹å¤§,å¦‚æœå†…éƒ¨çŠ¶æ€å¾ˆå¤š,å†ä¿å­˜ä¸€ä»½,æ— æ„è¦æµªè´¹å¤§é‡å†…å­˜.","title":"3.2 Memento"},{"content":"Template(æ¨¡æ¿æ¨¡å¼)å®šä¹‰ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­ç®—æ³•çš„éª¨æ¶,å°†ä¸€äº›æ­¥éª¤çš„æ‰§è¡Œå»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­.\nä½¿ç”¨Javaçš„æŠ½è±¡ç±»æ—¶ï¼Œå°±ç»å¸¸ä¼šä½¿ç”¨åˆ°Templateæ¨¡å¼,å› æ­¤Templateæ¨¡å¼ä½¿ç”¨å¾ˆæ™®é.è€Œä¸”å¾ˆå®¹æ˜“ç†è§£å’Œä½¿ç”¨ã€‚\npublic abstract class Benchmark { /** * ä¸‹é¢æ“ä½œæ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨å­ç±»ä¸­å®Œæˆ */ public abstract void benchmark(); /** * é‡å¤æ‰§è¡Œbenchmarkæ¬¡æ•° */ public final long repeat (int count) { if (count \u0026lt;= 0) return 0; else { long startTime = System.currentTimeMillis(); for (int i = 0; i \u0026lt; count; i++) benchmark(); long stopTime = System.currentTimeMillis(); return stopTime - startTime; } } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬å¸Œæœ›é‡å¤æ‰§è¡Œbenchmark()æ“ä½œ,ä½†æ˜¯å¯¹benchmark()çš„å…·ä½“å†…å®¹æ²¡æœ‰è¯´æ˜,è€Œæ˜¯å»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­æè¿°:\npublic class MethodBenchmark extends Benchmark { /** * çœŸæ­£å®šä¹‰benchmarkå†…å®¹ */ public void benchmark() { for (int i = 0; i \u0026lt; Integer.MAX_VALUE; i++){ System.out.printtln(\u0026#34;i=\u0026#34;+i);ã€€} } } è‡³æ­¤,Templateæ¨¡å¼å·²ç»å®Œæˆ,æ˜¯ä¸æ˜¯å¾ˆç®€å•?\næˆ‘ä»¬ç§°repeatæ–¹æ³•ä¸ºæ¨¡æ¿æ–¹æ³•ï¼Œ å®ƒå…¶ä¸­çš„benchmark()å®ç°è¢«å»¶è¿Ÿåˆ°å­ç±»MethodBenchmarkä¸­å®ç°äº†ï¼Œ\nçœ‹çœ‹å¦‚ä½•ä½¿ç”¨:\nBenchmark operation = new MethodBenchmark(); long duration = operation.repeat(Integer.parseInt(args[0].trim())); System.out.println(\u0026#34;The operation took \u0026#34; + duration + \u0026#34; milliseconds\u0026#34;); ä¹Ÿè®¸ä½ ä»¥å‰è¿˜ç–‘æƒ‘æŠ½è±¡ç±»æœ‰ä»€ä¹ˆç”¨,ç°åœ¨ä½ åº”è¯¥å½»åº•æ˜ç™½äº†å§? è‡³äºè¿™æ ·åšçš„å¥½å¤„,å¾ˆæ˜¾ç„¶å•Š,æ‰©å±•æ€§å¼º,ä»¥åBenchmarkå†…å®¹å˜åŒ–,æˆ‘åªè¦å†åšä¸€ä¸ªç»§æ‰¿å­ç±»å°±å¯ä»¥,ä¸å¿…ä¿®æ”¹å…¶ä»–åº”ç”¨ä»£ç .\n","permalink":"https://blog.chalme.top/posts/design-patterns/3.1-template/","summary":"Template(æ¨¡æ¿æ¨¡å¼)å®šä¹‰ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­ç®—æ³•çš„éª¨æ¶,å°†ä¸€äº›æ­¥éª¤çš„æ‰§è¡Œå»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­.\nä½¿ç”¨Javaçš„æŠ½è±¡ç±»æ—¶ï¼Œå°±ç»å¸¸ä¼šä½¿ç”¨åˆ°Templateæ¨¡å¼,å› æ­¤Templateæ¨¡å¼ä½¿ç”¨å¾ˆæ™®é.è€Œä¸”å¾ˆå®¹æ˜“ç†è§£å’Œä½¿ç”¨ã€‚\npublic abstract class Benchmark { /** * ä¸‹é¢æ“ä½œæ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨å­ç±»ä¸­å®Œæˆ */ public abstract void benchmark(); /** * é‡å¤æ‰§è¡Œbenchmarkæ¬¡æ•° */ public final long repeat (int count) { if (count \u0026lt;= 0) return 0; else { long startTime = System.currentTimeMillis(); for (int i = 0; i \u0026lt; count; i++) benchmark(); long stopTime = System.currentTimeMillis(); return stopTime - startTime; } } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬å¸Œæœ›é‡å¤æ‰§è¡Œbenchmark()æ“ä½œ,ä½†æ˜¯å¯¹benchmark()çš„å…·ä½“å†…å®¹æ²¡æœ‰è¯´æ˜,è€Œæ˜¯å»¶è¿Ÿåˆ°å…¶å­ç±»ä¸­æè¿°:\npublic class MethodBenchmark extends Benchmark { /** * çœŸæ­£å®šä¹‰benchmarkå†…å®¹ */ public void benchmark() { for (int i = 0; i \u0026lt; Integer.","title":"3.1 Template"},{"content":"Flyweight(äº«å…ƒæ¨¡å¼)å®šä¹‰ é¿å…å¤§é‡æ‹¥æœ‰ç›¸åŒå†…å®¹çš„å°ç±»çš„å¼€é”€(å¦‚è€—è´¹å†…å­˜),ä½¿å¤§å®¶å…±äº«ä¸€ä¸ªç±»(å…ƒç±»).\né‡ç‚¹ æœ¬è´¨factoryçš„å®ç°ï¼Œå·§å¦™çš„è®¾è®¡ã€‚ hashtable æˆ– hashmap æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨ ä¸ºä»€ä¹ˆä½¿ç”¨? é¢å‘å¯¹è±¡è¯­è¨€çš„åŸåˆ™å°±æ˜¯ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡,ä½†æ˜¯å¦‚æœçœŸæ­£ä½¿ç”¨èµ·æ¥,æœ‰æ—¶å¯¹è±¡æ•°å¯èƒ½æ˜¾å¾—å¾ˆåºå¤§,æ¯”å¦‚,å­—å¤„ç†è½¯ä»¶,å¦‚æœä»¥æ¯ä¸ªæ–‡å­—éƒ½ä½œä¸ºä¸€ä¸ªå¯¹è±¡,å‡ åƒä¸ªå­—,å¯¹è±¡æ•°å°±æ˜¯å‡ åƒ,æ— ç–‘è€—è´¹å†…å­˜,é‚£ä¹ˆæˆ‘ä»¬è¿˜æ˜¯è¦\u0026quot;æ±‚åŒå­˜å¼‚\u0026quot;,æ‰¾å‡ºè¿™äº›å¯¹è±¡ç¾¤çš„å…±åŒç‚¹,è®¾è®¡ä¸€ä¸ªå…ƒç±»,å°è£…å¯ä»¥è¢«å…±äº«çš„ç±»,å¦å¤–,è¿˜æœ‰ä¸€äº›ç‰¹æ€§æ˜¯å–å†³äºåº”ç”¨(context),æ˜¯ä¸å¯å…±äº«çš„,è¿™ä¹ŸFlyweightä¸­ä¸¤ä¸ªé‡è¦æ¦‚å¿µå†…éƒ¨çŠ¶æ€intrinsicå’Œå¤–éƒ¨çŠ¶æ€extrinsicä¹‹åˆ†.\nè¯´ç™½ç‚¹,å°±æ˜¯å…ˆæä¸€ä¸ªçš„åŸå§‹æ¨¡å‹,ç„¶åéšç€ä¸åŒåœºåˆå’Œç¯å¢ƒ,å†äº§ç”Ÿå„å…·ç‰¹å¾çš„å…·ä½“æ¨¡å‹,å¾ˆæ˜¾ç„¶,åœ¨è¿™é‡Œéœ€è¦äº§ç”Ÿä¸åŒçš„æ–°å¯¹è±¡,æ‰€ä»¥Flyweightæ¨¡å¼ä¸­å¸¸å‡ºç°Factoryæ¨¡å¼.Flyweightçš„å†…éƒ¨çŠ¶æ€æ˜¯ç”¨æ¥å…±äº«çš„,Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweight pool(æ¨¡å¼æ± )æ¥å­˜æ”¾å†…éƒ¨çŠ¶æ€çš„å¯¹è±¡.\nFlyweightæ¨¡å¼æ˜¯ä¸€ä¸ªæé«˜ç¨‹åºæ•ˆç‡å’Œæ€§èƒ½çš„æ¨¡å¼,ä¼šå¤§å¤§åŠ å¿«ç¨‹åºçš„è¿è¡Œé€Ÿåº¦.åº”ç”¨åœºåˆå¾ˆå¤š:æ¯”å¦‚ä½ è¦ä»ä¸€ä¸ªæ•°æ®åº“ä¸­è¯»å–ä¸€ç³»åˆ—å­—ç¬¦ä¸²,è¿™äº›å­—ç¬¦ä¸²ä¸­æœ‰è®¸å¤šæ˜¯é‡å¤çš„,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å­—ç¬¦ä¸²å‚¨å­˜åœ¨Flyweightæ± (pool)ä¸­.\nå¦‚ä½•ä½¿ç”¨?\næˆ‘ä»¬å…ˆä»FlyweightæŠ½è±¡æ¥å£å¼€å§‹:\npublic interface Flyweight { public void operation( ExtrinsicState state ); } //ç”¨äºæœ¬æ¨¡å¼çš„æŠ½è±¡æ•°æ®ç±»å‹(è‡ªè¡Œè®¾è®¡) public interface ExtrinsicState { }\nä¸‹é¢æ˜¯æ¥å£çš„å…·ä½“å®ç°(ConcreteFlyweight) ,å¹¶ä¸ºå†…éƒ¨çŠ¶æ€å¢åŠ å†…å­˜ç©ºé—´, ConcreteFlyweightå¿…é¡»æ˜¯å¯å…±äº«çš„,å®ƒä¿å­˜çš„ä»»ä½•çŠ¶æ€éƒ½å¿…é¡»æ˜¯å†…éƒ¨(intrinsic),ä¹Ÿå°±æ˜¯è¯´,ConcreteFlyweightå¿…é¡»å’Œå®ƒçš„åº”ç”¨ç¯å¢ƒåœºåˆæ— å…³.\npublic class ConcreteFlyweight implements Flyweight { private IntrinsicState state; public void operation( ExtrinsicState state ) { //å…·ä½“æ“ä½œ } } å½“ç„¶,å¹¶ä¸æ˜¯æ‰€æœ‰çš„Flyweightå…·ä½“å®ç°å­ç±»éƒ½éœ€è¦è¢«å…±äº«çš„,æ‰€ä»¥è¿˜æœ‰å¦å¤–ä¸€ç§ä¸å…±äº«çš„ConcreteFlyweight:\npublic class UnsharedConcreteFlyweight implements Flyweight { public void operation( ExtrinsicState state ) { } } Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweightæ± (å­˜æ”¾å†…éƒ¨çŠ¶æ€),å½“å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªå…±äº«Flyweightæ—¶,è¿™ä¸ªfactoryé¦–å…ˆæœç´¢æ± ä¸­æ˜¯å¦å·²ç»æœ‰å¯é€‚ç”¨çš„,å¦‚æœæœ‰,factoryåªæ˜¯ç®€å•è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡,å¦åˆ™,åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŠ å…¥åˆ°æ± ä¸­,å†è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡.æ± \npublic class FlyweightFactory { //Flyweight pool private Hashtable flyweights = new Hashtable(); public Flyweight getFlyweight( Object key ) { Flyweight flyweight = (Flyweight) flyweights.get(key); if( flyweight == null ) { //äº§ç”Ÿæ–°çš„ConcreteFlyweight flyweight = new ConcreteFlyweight(); flyweights.put( key, flyweight ); } return flyweight; } } è‡³æ­¤,Flyweightæ¨¡å¼çš„åŸºæœ¬æ¡†æ¶å·²ç»å°±ç»ª,æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è°ƒç”¨:\nFlyweightFactory factory = new FlyweightFactory(); Flyweight fly1 = factory.getFlyweight( \u0026ldquo;Fred\u0026rdquo; ); Flyweight fly2 = factory.getFlyweight( \u0026ldquo;Wilma\u0026rdquo; ); \u0026hellip;\u0026hellip;\nä»è°ƒç”¨ä¸Šçœ‹,å¥½è±¡æ˜¯ä¸ªçº¯ç²¹çš„Factoryä½¿ç”¨,ä½†å¥¥å¦™å°±åœ¨äºFactoryçš„å†…éƒ¨è®¾è®¡ä¸Š.\nFlyweightæ¨¡å¼åœ¨XMLç­‰æ•°æ®æºä¸­åº”ç”¨ æˆ‘ä»¬ä¸Šé¢å·²ç»æåˆ°,å½“å¤§é‡ä»æ•°æ®æºä¸­è¯»å–å­—ç¬¦ä¸²,å…¶ä¸­è‚¯å®šæœ‰é‡å¤çš„,é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨Flyweightæ¨¡å¼å¯ä»¥æé«˜æ•ˆç‡,ä»¥å”±ç‰‡CDä¸ºä¾‹,åœ¨ä¸€ä¸ªXMLæ–‡ä»¶ä¸­,å­˜æ”¾äº†å¤šä¸ªCDçš„èµ„æ–™.\næ¯ä¸ªCDæœ‰ä¸‰ä¸ªå­—æ®µ: 1.å‡ºç‰‡æ—¥æœŸ(year) 2.æ­Œå”±è€…å§“åç­‰ä¿¡æ¯(artist) 3.å”±ç‰‡æ›²ç›® (title)\nå…¶ä¸­,æ­Œå”±è€…å§“åæœ‰å¯èƒ½é‡å¤,ä¹Ÿå°±æ˜¯è¯´,å¯èƒ½æœ‰åŒä¸€ä¸ªæ¼”å”±è€…çš„å¤šä¸ªä¸åŒæ—¶æœŸ ä¸åŒæ›²ç›®çš„CD.æˆ‘ä»¬å°†\u0026quot;æ­Œå”±è€…å§“å\u0026quot;ä½œä¸ºå¯å…±äº«çš„ConcreteFlyweight.å…¶ä»–ä¸¤ä¸ªå­—æ®µä½œä¸ºUnsharedConcreteFlyweight.\né¦–å…ˆçœ‹çœ‹æ•°æ®æºXMLæ–‡ä»¶çš„å†…å®¹:\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;collection\u0026gt; \u0026lt;cd\u0026gt; \u0026lt;title\u0026gt;Another Green World\u0026lt;/title\u0026gt; \u0026lt;year\u0026gt;1978\u0026lt;/year\u0026gt; \u0026lt;artist\u0026gt;Eno, Brian\u0026lt;/artist\u0026gt; \u0026lt;/cd\u0026gt; \u0026lt;cd\u0026gt; \u0026lt;title\u0026gt;Greatest Hits\u0026lt;/title\u0026gt; \u0026lt;year\u0026gt;1950\u0026lt;/year\u0026gt; \u0026lt;artist\u0026gt;Holiday, Billie\u0026lt;/artist\u0026gt; \u0026lt;/cd\u0026gt; \u0026lt;cd\u0026gt; \u0026lt;title\u0026gt;Taking Tiger Mountain (by strategy)\u0026lt;/title\u0026gt; \u0026lt;year\u0026gt;1977\u0026lt;/year\u0026gt; \u0026lt;artist\u0026gt;Eno, Brian\u0026lt;/artist\u0026gt; \u0026lt;/cd\u0026gt; ....... \u0026lt;/collection\u0026gt; è™½ç„¶ä¸Šé¢ä¸¾ä¾‹CDåªæœ‰3å¼ ,CDå¯çœ‹æˆæ˜¯å¤§é‡é‡å¤çš„å°ç±»,å› ä¸ºå…¶ä¸­æˆåˆ†åªæœ‰ä¸‰ä¸ªå­—æ®µ,è€Œä¸”æœ‰é‡å¤çš„(æ­Œå”±è€…å§“å).\nCDå°±æ˜¯ç±»ä¼¼ä¸Šé¢æ¥å£ Flyweight:\npublic class CD { private String title; private int year; private Artist artist; public String getTitle() {ã€€return title;ã€€} public int getYear() {ã€€return year;ã€€} public Artist getArtist() {ã€€return artist;ã€€} public void setTitle(String t){ã€€title = t;} public void setYear(int y){year = y;} public void setArtist(Artist a){artist = a;} } å°†\u0026quot;æ­Œå”±è€…å§“å\u0026quot;ä½œä¸ºå¯å…±äº«çš„ConcreteFlyweight:\npublic class Artist { //å†…éƒ¨çŠ¶æ€ private String name; // note that Artist is immutable. String getName(){return name;} Artist(String n){ name = n; } } å†çœ‹çœ‹Flyweight factory,ä¸“é—¨ç”¨æ¥åˆ¶é€ ä¸Šé¢çš„å¯å…±äº«çš„ConcreteFlyweight:Artist\npublic class ArtistFactory { Hashtable pool = new Hashtable(); Artist getArtist(String key){ Artist result; result = (Artist)pool.get(key); ////äº§ç”Ÿæ–°çš„Artist if(result == null) { result = new Artist(key); pool.put(key,result); } return result; } } å½“ä½ æœ‰å‡ åƒå¼ ç”šè‡³æ›´å¤šCDæ—¶,Flyweightæ¨¡å¼å°†èŠ‚çœæ›´å¤šç©ºé—´,å…±äº«çš„flyweightè¶Šå¤š,ç©ºé—´èŠ‚çœä¹Ÿå°±è¶Šå¤§.\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.7-flyweight/","summary":"Flyweight(äº«å…ƒæ¨¡å¼)å®šä¹‰ é¿å…å¤§é‡æ‹¥æœ‰ç›¸åŒå†…å®¹çš„å°ç±»çš„å¼€é”€(å¦‚è€—è´¹å†…å­˜),ä½¿å¤§å®¶å…±äº«ä¸€ä¸ªç±»(å…ƒç±»).\né‡ç‚¹ æœ¬è´¨factoryçš„å®ç°ï¼Œå·§å¦™çš„è®¾è®¡ã€‚ hashtable æˆ– hashmap æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨ ä¸ºä»€ä¹ˆä½¿ç”¨? é¢å‘å¯¹è±¡è¯­è¨€çš„åŸåˆ™å°±æ˜¯ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡,ä½†æ˜¯å¦‚æœçœŸæ­£ä½¿ç”¨èµ·æ¥,æœ‰æ—¶å¯¹è±¡æ•°å¯èƒ½æ˜¾å¾—å¾ˆåºå¤§,æ¯”å¦‚,å­—å¤„ç†è½¯ä»¶,å¦‚æœä»¥æ¯ä¸ªæ–‡å­—éƒ½ä½œä¸ºä¸€ä¸ªå¯¹è±¡,å‡ åƒä¸ªå­—,å¯¹è±¡æ•°å°±æ˜¯å‡ åƒ,æ— ç–‘è€—è´¹å†…å­˜,é‚£ä¹ˆæˆ‘ä»¬è¿˜æ˜¯è¦\u0026quot;æ±‚åŒå­˜å¼‚\u0026quot;,æ‰¾å‡ºè¿™äº›å¯¹è±¡ç¾¤çš„å…±åŒç‚¹,è®¾è®¡ä¸€ä¸ªå…ƒç±»,å°è£…å¯ä»¥è¢«å…±äº«çš„ç±»,å¦å¤–,è¿˜æœ‰ä¸€äº›ç‰¹æ€§æ˜¯å–å†³äºåº”ç”¨(context),æ˜¯ä¸å¯å…±äº«çš„,è¿™ä¹ŸFlyweightä¸­ä¸¤ä¸ªé‡è¦æ¦‚å¿µå†…éƒ¨çŠ¶æ€intrinsicå’Œå¤–éƒ¨çŠ¶æ€extrinsicä¹‹åˆ†.\nè¯´ç™½ç‚¹,å°±æ˜¯å…ˆæä¸€ä¸ªçš„åŸå§‹æ¨¡å‹,ç„¶åéšç€ä¸åŒåœºåˆå’Œç¯å¢ƒ,å†äº§ç”Ÿå„å…·ç‰¹å¾çš„å…·ä½“æ¨¡å‹,å¾ˆæ˜¾ç„¶,åœ¨è¿™é‡Œéœ€è¦äº§ç”Ÿä¸åŒçš„æ–°å¯¹è±¡,æ‰€ä»¥Flyweightæ¨¡å¼ä¸­å¸¸å‡ºç°Factoryæ¨¡å¼.Flyweightçš„å†…éƒ¨çŠ¶æ€æ˜¯ç”¨æ¥å…±äº«çš„,Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweight pool(æ¨¡å¼æ± )æ¥å­˜æ”¾å†…éƒ¨çŠ¶æ€çš„å¯¹è±¡.\nFlyweightæ¨¡å¼æ˜¯ä¸€ä¸ªæé«˜ç¨‹åºæ•ˆç‡å’Œæ€§èƒ½çš„æ¨¡å¼,ä¼šå¤§å¤§åŠ å¿«ç¨‹åºçš„è¿è¡Œé€Ÿåº¦.åº”ç”¨åœºåˆå¾ˆå¤š:æ¯”å¦‚ä½ è¦ä»ä¸€ä¸ªæ•°æ®åº“ä¸­è¯»å–ä¸€ç³»åˆ—å­—ç¬¦ä¸²,è¿™äº›å­—ç¬¦ä¸²ä¸­æœ‰è®¸å¤šæ˜¯é‡å¤çš„,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å­—ç¬¦ä¸²å‚¨å­˜åœ¨Flyweightæ± (pool)ä¸­.\nå¦‚ä½•ä½¿ç”¨?\næˆ‘ä»¬å…ˆä»FlyweightæŠ½è±¡æ¥å£å¼€å§‹:\npublic interface Flyweight { public void operation( ExtrinsicState state ); } //ç”¨äºæœ¬æ¨¡å¼çš„æŠ½è±¡æ•°æ®ç±»å‹(è‡ªè¡Œè®¾è®¡) public interface ExtrinsicState { }\nä¸‹é¢æ˜¯æ¥å£çš„å…·ä½“å®ç°(ConcreteFlyweight) ,å¹¶ä¸ºå†…éƒ¨çŠ¶æ€å¢åŠ å†…å­˜ç©ºé—´, ConcreteFlyweightå¿…é¡»æ˜¯å¯å…±äº«çš„,å®ƒä¿å­˜çš„ä»»ä½•çŠ¶æ€éƒ½å¿…é¡»æ˜¯å†…éƒ¨(intrinsic),ä¹Ÿå°±æ˜¯è¯´,ConcreteFlyweightå¿…é¡»å’Œå®ƒçš„åº”ç”¨ç¯å¢ƒåœºåˆæ— å…³.\npublic class ConcreteFlyweight implements Flyweight { private IntrinsicState state; public void operation( ExtrinsicState state ) { //å…·ä½“æ“ä½œ } } å½“ç„¶,å¹¶ä¸æ˜¯æ‰€æœ‰çš„Flyweightå…·ä½“å®ç°å­ç±»éƒ½éœ€è¦è¢«å…±äº«çš„,æ‰€ä»¥è¿˜æœ‰å¦å¤–ä¸€ç§ä¸å…±äº«çš„ConcreteFlyweight:\npublic class UnsharedConcreteFlyweight implements Flyweight { public void operation( ExtrinsicState state ) { } } Flyweight factoryè´Ÿè´£ç»´æŠ¤ä¸€ä¸ªFlyweightæ± (å­˜æ”¾å†…éƒ¨çŠ¶æ€),å½“å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªå…±äº«Flyweightæ—¶,è¿™ä¸ªfactoryé¦–å…ˆæœç´¢æ± ä¸­æ˜¯å¦å·²ç»æœ‰å¯é€‚ç”¨çš„,å¦‚æœæœ‰,factoryåªæ˜¯ç®€å•è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡,å¦åˆ™,åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡,åŠ å…¥åˆ°æ± ä¸­,å†è¿”å›é€å‡ºè¿™ä¸ªå¯¹è±¡.","title":"2.7 Flyweight"},{"content":"Bridge(æ¡¥æ¥æ¨¡å¼)å®šä¹‰ å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ’åˆ†å¼€æ¥,å„è‡ªç‹¬ç«‹,ä½†èƒ½åŠ¨æ€çš„ç»“åˆã€‚\nåœ¨é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬æ¦‚å¿µä¸­ï¼Œå¯¹è±¡è¿™ä¸ªæ¦‚å¿µå®é™…æ˜¯ç”±å±æ€§å’Œè¡Œä¸ºä¸¤ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œå±æ€§æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§é™æ­¢çš„ï¼Œæ˜¯ä¸€ç§æŠ½è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¡Œä¸ºæ˜¯åŒ…å«åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯ï¼Œåœ¨æœ‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›è¡Œä¸ºä¹Ÿè¿›è¡Œå½’ç±»ï¼Œå½¢æˆä¸€ä¸ªæ€»çš„è¡Œä¸ºæ¥å£ï¼Œè¿™å°±æ˜¯æ¡¥æ¨¡å¼çš„ç”¨å¤„ã€‚\né‡ç‚¹ å•ä¾‹æ¨¡å‹çš„ä½¿ç”¨å’Œ è°ƒç”¨ ä¸ºä»€ä¹ˆä½¿ç”¨? ä¸å¸Œæœ›æŠ½è±¡éƒ¨åˆ†å’Œè¡Œä¸ºæœ‰ä¸€ç§å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œè€Œæ˜¯åº”è¯¥å¯ä»¥åŠ¨æ€è”ç³»çš„ã€‚\nå¦‚æœä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£æœ‰å¤šä¸ªå…·ä½“å®ç°(å­ç±»ã€concrete subclass),è¿™äº›å­ç±»ä¹‹é—´å…³ç³»å¯èƒ½æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ:\nè¿™å¤šä¸ªå­ç±»ä¹‹é—´æ¦‚å¿µæ˜¯å¹¶åˆ—çš„,å¦‚å‰é¢ä¸¾ä¾‹,æ‰“æ¡©,æœ‰ä¸¤ä¸ªconcrete class:æ–¹å½¢æ¡©å’Œåœ†å½¢æ¡©;è¿™ä¸¤ä¸ªå½¢çŠ¶ä¸Šçš„æ¡©æ˜¯å¹¶åˆ—çš„,æ²¡æœ‰æ¦‚å¿µä¸Šçš„é‡å¤ã€‚\nè¿™å¤šä¸ªå­ç±»ä¹‹ä¸­æœ‰å†…å®¹æ¦‚å¿µä¸Šé‡å .é‚£ä¹ˆéœ€è¦æˆ‘ä»¬æŠŠæŠ½è±¡å…±åŒéƒ¨åˆ†å’Œè¡Œä¸ºå…±åŒéƒ¨åˆ†å„è‡ªç‹¬ç«‹å¼€æ¥,åŸæ¥æ˜¯å‡†å¤‡æ”¾åœ¨ä¸€ä¸ªæ¥å£é‡Œ,ç°åœ¨éœ€è¦è®¾è®¡ä¸¤ä¸ªæ¥å£ï¼šæŠ½è±¡æ¥å£å’Œè¡Œä¸ºæ¥å£ï¼Œåˆ†åˆ«æ”¾ç½®æŠ½è±¡å’Œè¡Œä¸º.\nä¾‹å¦‚,ä¸€æ¯å’–å•¡ä¸ºä¾‹,å­ç±»å®ç°ç±»ä¸ºå››ä¸ªï¼šä¸­æ¯åŠ å¥¶ã€å¤§æ¯åŠ å¥¶ã€ ä¸­æ¯ä¸åŠ å¥¶ã€å¤§æ¯ä¸åŠ å¥¶ã€‚\nä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼šä¸Šé¢å››ä¸ªå­ç±»ä¸­æœ‰æ¦‚å¿µé‡å ï¼Œå¯ä»å¦å¤–ä¸€ä¸ªè§’åº¦è¿›è¡Œè€ƒè™‘ï¼Œè¿™å››ä¸ªç±»å®é™…æ˜¯ä¸¤ä¸ªè§’è‰²çš„ç»„åˆï¼šæŠ½è±¡ å’Œè¡Œä¸ºï¼Œå…¶ä¸­æŠ½è±¡ä¸ºï¼šä¸­æ¯å’Œå¤§æ¯ï¼›è¡Œä¸ºä¸ºï¼šåŠ å¥¶ ä¸åŠ å¥¶ï¼ˆå¦‚åŠ æ©™æ± åŠ è‹¹æœæ±ï¼‰.\nå®ç°å››ä¸ªå­ç±»åœ¨æŠ½è±¡å’Œè¡Œä¸ºä¹‹é—´å‘ç”Ÿäº†å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œå¦‚æœä»¥ååŠ¨æ€å¢åŠ åŠ è‘¡è„æ±çš„è¡Œä¸ºï¼Œå°±å¿…é¡»å†å¢åŠ ä¸¤ä¸ªç±»ï¼šä¸­æ¯åŠ è‘¡è„æ±å’Œå¤§æ¯åŠ è‘¡è„æ±ã€‚æ˜¾ç„¶æ··ä¹±,æ‰©å±•æ€§æå·®ã€‚\né‚£æˆ‘ä»¬ä»åˆ†ç¦»æŠ½è±¡å’Œè¡Œä¸ºçš„è§’åº¦ï¼Œä½¿ç”¨Bridgeæ¨¡å¼æ¥å®ç°ã€‚\nå¦‚ä½•å®ç°? ä»¥ä¸Šé¢æåˆ°çš„å’–å•¡ ä¸ºä¾‹. æˆ‘ä»¬åŸæ¥æ‰“ç®—åªè®¾è®¡ä¸€ä¸ªæ¥å£(æŠ½è±¡ç±»),ä½¿ç”¨Bridgeæ¨¡å¼å,æˆ‘ä»¬éœ€è¦å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ†å¼€,åŠ å¥¶å’Œä¸åŠ å¥¶å±äºè¡Œä¸º,æˆ‘ä»¬å°†å®ƒä»¬æŠ½è±¡æˆä¸€ä¸ªä¸“é—¨çš„è¡Œä¸ºæ¥å£.\nå…ˆçœ‹çœ‹æŠ½è±¡éƒ¨åˆ†çš„æ¥å£ä»£ç :\npublic abstract class Coffee { CoffeeImp coffeeImp; public void setCoffeeImp() { this.CoffeeImp = CoffeeImpSingleton.getTheCoffeImp(); } public CoffeeImp getCoffeeImp() {return this.CoffeeImp;} public abstract void pourCoffee(); } å…¶ä¸­CoffeeImp æ˜¯åŠ ä¸åŠ å¥¶çš„è¡Œä¸ºæ¥å£,çœ‹å…¶ä»£ç å¦‚ä¸‹:\npublic abstract class CoffeeImp { public abstract void pourCoffeeImp(); } ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸¤ä¸ªæŠ½è±¡ç±»,ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å¯¹å…¶è¿›è¡Œç»§æ‰¿,å®ç°concrete class:\n//ä¸­æ¯ public class MediumCoffee extends Coffee { public MediumCoffee() {setCoffeeImp();} public void pourCoffee() { CoffeeImp coffeeImp = this.getCoffeeImp(); //æˆ‘ä»¬ä»¥é‡å¤æ¬¡æ•°æ¥è¯´æ˜æ˜¯å†²ä¸­æ¯è¿˜æ˜¯å¤§æ¯ ,é‡å¤2æ¬¡æ˜¯ä¸­æ¯ for (int i = 0; i \u0026lt; 2; i++) { coffeeImp.pourCoffeeImp(); } } } //å¤§æ¯ public class SuperSizeCoffee extends Coffee { public SuperSizeCoffee() {setCoffeeImp();} public void pourCoffee() { CoffeeImp coffeeImp = this.getCoffeeImp(); //æˆ‘ä»¬ä»¥é‡å¤æ¬¡æ•°æ¥è¯´æ˜æ˜¯å†²ä¸­æ¯è¿˜æ˜¯å¤§æ¯ ,é‡å¤5æ¬¡æ˜¯å¤§æ¯ for (int i = 0; i \u0026lt; 5; i++) { coffeeImp.pourCoffeeImp(); } } } ä¸Šé¢åˆ†åˆ«æ˜¯ä¸­æ¯å’Œå¤§æ¯çš„å…·ä½“å®ç°.ä¸‹é¢å†å¯¹è¡Œä¸ºCoffeeImpè¿›è¡Œç»§æ‰¿:\n//åŠ å¥¶ public class MilkCoffeeImp extends CoffeeImp { MilkCoffeeImp() {} public void pourCoffeeImp() { System.out.println(\u0026#34;åŠ äº†ç¾å‘³çš„ç‰›å¥¶\u0026#34;); } } //ä¸åŠ å¥¶ public class FragrantCoffeeImp extends CoffeeImp { FragrantCoffeeImp() {} public void pourCoffeeImp() { System.out.println(\u0026#34;ä»€ä¹ˆä¹Ÿæ²¡åŠ ,æ¸…é¦™\u0026#34;); } } Bridgeæ¨¡å¼çš„åŸºæœ¬æ¡†æ¶æˆ‘ä»¬å·²ç»æ­å¥½äº†,åˆ«å¿˜è®°å®šä¹‰ä¸­è¿˜æœ‰ä¸€å¥:åŠ¨æ€ç»“åˆ,æˆ‘ä»¬ç°åœ¨å¯ä»¥å–åˆ°è‡³å°‘å››ç§å’–å•¡: 1.ä¸­æ¯åŠ å¥¶ 2.ä¸­æ¯ä¸åŠ å¥¶ 3.å¤§æ¯åŠ å¥¶ 4.å¤§æ¯ä¸åŠ å¥¶\nçœ‹çœ‹æ˜¯å¦‚ä½•åŠ¨æ€ç»“åˆçš„,åœ¨ä½¿ç”¨ä¹‹å‰,æˆ‘ä»¬åšä¸ªå‡†å¤‡å·¥ä½œ,è®¾è®¡ä¸€ä¸ªå•æ€ç±»(Singleton)ç”¨æ¥holdå½“å‰çš„CoffeeImp:\npublic class CoffeeImpSingleton { private static CoffeeImp coffeeImp; public CoffeeImpSingleton(CoffeeImp coffeeImpIn) {this.coffeeImp = coffeeImpIn;} public static CoffeeImp getTheCoffeeImp() { return coffeeImp; } } çœ‹çœ‹ä¸­æ¯åŠ å¥¶ å’Œå¤§æ¯åŠ å¥¶ æ˜¯æ€ä¹ˆå‡ºæ¥çš„:\n//æ‹¿å‡ºç‰›å¥¶ CoffeeImpSingleton coffeeImpSingleton = new CoffeeImpSingleton(new MilkCoffeeImp()); //ä¸­æ¯åŠ å¥¶ MediumCoffee mediumCoffee = new MediumCoffee(); mediumCoffee.pourCoffee(); //å¤§æ¯åŠ å¥¶ SuperSizeCoffee superSizeCoffee = new SuperSizeCoffee(); superSizeCoffee.pourCoffee(); æ³¨æ„: Bridgeæ¨¡å¼çš„æ‰§è¡Œç±»å¦‚CoffeeImpå’ŒCoffeeæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³», æ­£ç¡®åˆ›å»ºCoffeeImpæ˜¯è¯¥æ¨¡å¼çš„å…³é”®ã€‚\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.6-bridge/","summary":"Bridge(æ¡¥æ¥æ¨¡å¼)å®šä¹‰ å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ’åˆ†å¼€æ¥,å„è‡ªç‹¬ç«‹,ä½†èƒ½åŠ¨æ€çš„ç»“åˆã€‚\nåœ¨é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬æ¦‚å¿µä¸­ï¼Œå¯¹è±¡è¿™ä¸ªæ¦‚å¿µå®é™…æ˜¯ç”±å±æ€§å’Œè¡Œä¸ºä¸¤ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œå±æ€§æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§é™æ­¢çš„ï¼Œæ˜¯ä¸€ç§æŠ½è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¡Œä¸ºæ˜¯åŒ…å«åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯ï¼Œåœ¨æœ‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›è¡Œä¸ºä¹Ÿè¿›è¡Œå½’ç±»ï¼Œå½¢æˆä¸€ä¸ªæ€»çš„è¡Œä¸ºæ¥å£ï¼Œè¿™å°±æ˜¯æ¡¥æ¨¡å¼çš„ç”¨å¤„ã€‚\né‡ç‚¹ å•ä¾‹æ¨¡å‹çš„ä½¿ç”¨å’Œ è°ƒç”¨ ä¸ºä»€ä¹ˆä½¿ç”¨? ä¸å¸Œæœ›æŠ½è±¡éƒ¨åˆ†å’Œè¡Œä¸ºæœ‰ä¸€ç§å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œè€Œæ˜¯åº”è¯¥å¯ä»¥åŠ¨æ€è”ç³»çš„ã€‚\nå¦‚æœä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£æœ‰å¤šä¸ªå…·ä½“å®ç°(å­ç±»ã€concrete subclass),è¿™äº›å­ç±»ä¹‹é—´å…³ç³»å¯èƒ½æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ:\nè¿™å¤šä¸ªå­ç±»ä¹‹é—´æ¦‚å¿µæ˜¯å¹¶åˆ—çš„,å¦‚å‰é¢ä¸¾ä¾‹,æ‰“æ¡©,æœ‰ä¸¤ä¸ªconcrete class:æ–¹å½¢æ¡©å’Œåœ†å½¢æ¡©;è¿™ä¸¤ä¸ªå½¢çŠ¶ä¸Šçš„æ¡©æ˜¯å¹¶åˆ—çš„,æ²¡æœ‰æ¦‚å¿µä¸Šçš„é‡å¤ã€‚\nè¿™å¤šä¸ªå­ç±»ä¹‹ä¸­æœ‰å†…å®¹æ¦‚å¿µä¸Šé‡å .é‚£ä¹ˆéœ€è¦æˆ‘ä»¬æŠŠæŠ½è±¡å…±åŒéƒ¨åˆ†å’Œè¡Œä¸ºå…±åŒéƒ¨åˆ†å„è‡ªç‹¬ç«‹å¼€æ¥,åŸæ¥æ˜¯å‡†å¤‡æ”¾åœ¨ä¸€ä¸ªæ¥å£é‡Œ,ç°åœ¨éœ€è¦è®¾è®¡ä¸¤ä¸ªæ¥å£ï¼šæŠ½è±¡æ¥å£å’Œè¡Œä¸ºæ¥å£ï¼Œåˆ†åˆ«æ”¾ç½®æŠ½è±¡å’Œè¡Œä¸º.\nä¾‹å¦‚,ä¸€æ¯å’–å•¡ä¸ºä¾‹,å­ç±»å®ç°ç±»ä¸ºå››ä¸ªï¼šä¸­æ¯åŠ å¥¶ã€å¤§æ¯åŠ å¥¶ã€ ä¸­æ¯ä¸åŠ å¥¶ã€å¤§æ¯ä¸åŠ å¥¶ã€‚\nä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼šä¸Šé¢å››ä¸ªå­ç±»ä¸­æœ‰æ¦‚å¿µé‡å ï¼Œå¯ä»å¦å¤–ä¸€ä¸ªè§’åº¦è¿›è¡Œè€ƒè™‘ï¼Œè¿™å››ä¸ªç±»å®é™…æ˜¯ä¸¤ä¸ªè§’è‰²çš„ç»„åˆï¼šæŠ½è±¡ å’Œè¡Œä¸ºï¼Œå…¶ä¸­æŠ½è±¡ä¸ºï¼šä¸­æ¯å’Œå¤§æ¯ï¼›è¡Œä¸ºä¸ºï¼šåŠ å¥¶ ä¸åŠ å¥¶ï¼ˆå¦‚åŠ æ©™æ± åŠ è‹¹æœæ±ï¼‰.\nå®ç°å››ä¸ªå­ç±»åœ¨æŠ½è±¡å’Œè¡Œä¸ºä¹‹é—´å‘ç”Ÿäº†å›ºå®šçš„ç»‘å®šå…³ç³»ï¼Œå¦‚æœä»¥ååŠ¨æ€å¢åŠ åŠ è‘¡è„æ±çš„è¡Œä¸ºï¼Œå°±å¿…é¡»å†å¢åŠ ä¸¤ä¸ªç±»ï¼šä¸­æ¯åŠ è‘¡è„æ±å’Œå¤§æ¯åŠ è‘¡è„æ±ã€‚æ˜¾ç„¶æ··ä¹±,æ‰©å±•æ€§æå·®ã€‚\né‚£æˆ‘ä»¬ä»åˆ†ç¦»æŠ½è±¡å’Œè¡Œä¸ºçš„è§’åº¦ï¼Œä½¿ç”¨Bridgeæ¨¡å¼æ¥å®ç°ã€‚\nå¦‚ä½•å®ç°? ä»¥ä¸Šé¢æåˆ°çš„å’–å•¡ ä¸ºä¾‹. æˆ‘ä»¬åŸæ¥æ‰“ç®—åªè®¾è®¡ä¸€ä¸ªæ¥å£(æŠ½è±¡ç±»),ä½¿ç”¨Bridgeæ¨¡å¼å,æˆ‘ä»¬éœ€è¦å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ†å¼€,åŠ å¥¶å’Œä¸åŠ å¥¶å±äºè¡Œä¸º,æˆ‘ä»¬å°†å®ƒä»¬æŠ½è±¡æˆä¸€ä¸ªä¸“é—¨çš„è¡Œä¸ºæ¥å£.\nå…ˆçœ‹çœ‹æŠ½è±¡éƒ¨åˆ†çš„æ¥å£ä»£ç :\npublic abstract class Coffee { CoffeeImp coffeeImp; public void setCoffeeImp() { this.CoffeeImp = CoffeeImpSingleton.getTheCoffeImp(); } public CoffeeImp getCoffeeImp() {return this.CoffeeImp;} public abstract void pourCoffee(); } å…¶ä¸­CoffeeImp æ˜¯åŠ ä¸åŠ å¥¶çš„è¡Œä¸ºæ¥å£,çœ‹å…¶ä»£ç å¦‚ä¸‹:\npublic abstract class CoffeeImp { public abstract void pourCoffeeImp(); } ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸¤ä¸ªæŠ½è±¡ç±»,ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å¯¹å…¶è¿›è¡Œç»§æ‰¿,å®ç°concrete class:\n//ä¸­æ¯ public class MediumCoffee extends Coffee { public MediumCoffee() {setCoffeeImp();} public void pourCoffee() { CoffeeImp coffeeImp = this.","title":"2.6 Bridge"},{"content":"Composite(ç»„åˆæ¨¡å¼)å®šä¹‰ å°†å¯¹è±¡ä»¥æ ‘å½¢ç»“æ„ç»„ç»‡èµ·æ¥,ä»¥è¾¾æˆâ€œéƒ¨åˆ†ï¼æ•´ä½“â€ çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§.\nCompositeæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œæƒ³åˆ°Compositeå°±åº”è¯¥æƒ³åˆ°æ ‘å½¢ç»“æ„å›¾ã€‚ç»„åˆä½“å†…è¿™äº›å¯¹è±¡éƒ½æœ‰å…±åŒæ¥å£,å½“ç»„åˆä½“ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ‰§è¡Œæ—¶ï¼ŒCompositeå°†éå†(Iterator)æ•´ä¸ªæ ‘å½¢ç»“æ„,å¯»æ‰¾åŒæ ·åŒ…å«è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡å¹¶å®ç°è°ƒç”¨æ‰§è¡Œã€‚å¯ä»¥ç”¨ç‰µä¸€åŠ¨ç™¾æ¥å½¢å®¹ã€‚\næ‰€ä»¥Compositeæ¨¡å¼ä½¿ç”¨åˆ°Iteratoræ¨¡å¼ï¼Œå’ŒChain of Responsibilityæ¨¡å¼ç±»ä¼¼ã€‚\næœ¬è´¨ å®šä¹‰ interface æˆ– abstract class\næ ¸å¿ƒ åœ¨class(ç»§æ‰¿æˆ–å®ç°) ä¸­ä½¿ç”¨äº† arraylist . å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ  å…¶ä»– å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€classï¼‰\nCompositeå¥½å¤„ ä½¿å®¢æˆ·ç«¯è°ƒç”¨ç®€å•ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´çš„ä½¿ç”¨ç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œç”¨æˆ·å°±ä¸å¿…å…³ç³»è‡ªå·±å¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œè¿™å°±ç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚ æ›´å®¹æ˜“åœ¨ç»„åˆä½“å†…åŠ å…¥å¯¹è±¡éƒ¨ä»¶. å®¢æˆ·ç«¯ä¸å¿…å› ä¸ºåŠ å…¥äº†æ–°çš„å¯¹è±¡éƒ¨ä»¶è€Œæ›´æ”¹ä»£ç ã€‚ å¦‚ä½•ä½¿ç”¨Composite é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é€šç”¨æ–¹å¼äº†ï¼Œå…¶ä»–è®¾è®¡æ¨¡å¼å¯¹æ¥å£å†…éƒ¨å®šä¹‰é™åˆ¶ä¸å¤šï¼ŒCompositeå´æœ‰ä¸ªè§„å®šï¼Œé‚£å°±æ˜¯è¦åœ¨æ¥å£å†…éƒ¨å®šä¹‰ä¸€ä¸ªç”¨äºè®¿é—®å’Œç®¡ç†Compositeç»„åˆä½“çš„å¯¹è±¡ä»¬ï¼ˆæˆ–ç§°éƒ¨ä»¶Componentï¼‰.\nä¸‹é¢çš„ä»£ç æ˜¯ä»¥æŠ½è±¡ç±»å®šä¹‰ï¼Œä¸€èˆ¬å°½é‡ç”¨æ¥å£interface,\npublic abstract class Equipment { private String name; //å®ä»· public abstract double netPrice(); //æŠ˜æ‰£ä»·æ ¼ public abstract double discountPrice(); //å¢åŠ éƒ¨ä»¶æ–¹æ³•ã€€public boolean add(Equipment equipment) { return false; } //åˆ é™¤éƒ¨ä»¶æ–¹æ³• public boolean remove(Equipment equipment) { return false; } //æ³¨æ„è¿™é‡Œï¼Œè¿™é‡Œå°±æä¾›ä¸€ç§ç”¨äºè®¿é—®ç»„åˆä½“ç±»çš„éƒ¨ä»¶æ–¹æ³•ã€‚ public Iterator iter() { return null; } public Equipment(final String name) { this.name=name; } } æŠ½è±¡ç±»Equipmentå°±æ˜¯Componentå®šä¹‰ï¼Œä»£è¡¨ç€ç»„åˆä½“ç±»çš„å¯¹è±¡ä»¬,Equipmentä¸­å®šä¹‰å‡ ä¸ªå…±åŒçš„æ–¹æ³•ã€‚\npublic class Disk extends Equipment { public Disk(String name) { super(name); } //å®šä¹‰Diskå®ä»·ä¸º1 public double netPrice() { return 1.; } //å®šä¹‰äº†diskæŠ˜æ‰£ä»·æ ¼æ˜¯0.5 å¯¹æŠ˜ã€‚ public double discountPrice() { return .5; } } Diskæ˜¯ç»„åˆä½“å†…çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–ç§°ä¸€ä¸ªéƒ¨ä»¶ï¼Œè¿™ä¸ªéƒ¨ä»¶æ˜¯ä¸ªå•ç‹¬å…ƒç´ ( Primitive)ã€‚ è¿˜æœ‰ä¸€ç§å¯èƒ½æ˜¯ï¼Œä¸€ä¸ªéƒ¨ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªç»„åˆä½“ï¼Œå°±æ˜¯è¯´è¿™ä¸ªéƒ¨ä»¶ä¸‹é¢è¿˜æœ‰\u0026rsquo;å„¿å­\u0026rsquo;ï¼Œè¿™æ˜¯æ ‘å½¢ç»“æ„ä¸­é€šå¸¸çš„æƒ…å†µï¼Œåº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚ç°åœ¨æˆ‘ä»¬å…ˆè¦å®šä¹‰è¿™ä¸ªç»„åˆä½“ï¼š\nabstract class CompositeEquipment extends Equipment { private int i=0; //å®šä¹‰ä¸€ä¸ªVector ç”¨æ¥å­˜æ”¾\u0026#39;å„¿å­\u0026#39; private Lsit equipment=new ArrayList(); public CompositeEquipment(String name) { super(name); } public boolean add(Equipment equipment) { this.equipment.add(equipment); return true; } public double netPrice() { double netPrice=0.; Iterator iter=equipment.iterator(); for(iter.hasNext()) netPrice+=((Equipment)iter.next()).netPrice(); return netPrice; } public double discountPrice() { double discountPrice=0.; Iterator iter=equipment.iterator(); for(iter.hasNext()) discountPrice+=((Equipment)iter.next()).discountPrice(); return discountPrice; } //æ³¨æ„è¿™é‡Œï¼Œè¿™é‡Œå°±æä¾›ç”¨äºè®¿é—®è‡ªå·±ç»„åˆä½“å†…çš„éƒ¨ä»¶æ–¹æ³•ã€‚ //ä¸Šé¢dIsk ä¹‹æ‰€ä»¥æ²¡æœ‰ï¼Œæ˜¯å› ä¸ºDiskæ˜¯ä¸ªå•ç‹¬(Primitive)çš„å…ƒç´ . public Iterator iter() { return equipment.iterator() ; { //é‡è½½Iteratoræ–¹æ³• public boolean hasNext() { return i\u0026lt;equipment.size(); } //é‡è½½Iteratoræ–¹æ³• public Object next() { if(hasNext()) return equipment.elementAt(i++); else throw new NoSuchElementException(); } } ä¸Šé¢CompositeEquipmentç»§æ‰¿äº†Equipment,åŒæ—¶ä¸ºè‡ªå·±é‡Œé¢çš„å¯¹è±¡ä»¬æä¾›äº†å¤–éƒ¨è®¿é—®çš„æ–¹æ³•,é‡è½½äº†Iterator,Iteratoræ˜¯Javaçš„Collectionçš„ä¸€ä¸ªæ¥å£ï¼Œæ˜¯Iteratoræ¨¡å¼çš„å®ç°.\næˆ‘ä»¬å†çœ‹çœ‹CompositeEquipmentçš„ä¸¤ä¸ªå…·ä½“ç±»:ç›˜ç›’Chassiså’Œç®±å­Cabinetï¼Œç®±å­é‡Œé¢å¯ä»¥æ”¾å¾ˆå¤šä¸œè¥¿ï¼Œå¦‚åº•æ¿ï¼Œç”µæºç›’ï¼Œç¡¬ç›˜ç›’ç­‰ï¼›ç›˜ç›’é‡Œé¢å¯ä»¥æ”¾ä¸€äº›å°è®¾å¤‡ï¼Œå¦‚ç¡¬ç›˜ è½¯é©±ç­‰ã€‚æ— ç–‘è¿™ä¸¤ä¸ªéƒ½æ˜¯å±äºç»„åˆä½“æ€§è´¨çš„ã€‚\npublic class Chassis extends CompositeEquipment { public Chassis(String name) { super(name); } public double netPrice() { return 1.+super.netPrice(); } public double discountPrice() { return .5+super.discountPrice(); } } public class Cabinet extends CompositeEquipment { public Cabinet(String name) { super(name); } public double netPrice() { return 1.+super.netPrice(); } public double discountPrice() { return .5+super.discountPrice(); } } è‡³æ­¤æˆ‘ä»¬å®Œæˆäº†æ•´ä¸ªCompositeæ¨¡å¼çš„æ¶æ„ã€‚\næˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®¢æˆ·ç«¯è°ƒç”¨Composoteä»£ç :\nCabinet cabinet=new Cabinet(\u0026#34;Tower\u0026#34;); Chassis chassis=new Chassis(\u0026#34;PC Chassis\u0026#34;); //å°†PC Chassisè£…åˆ°Towerä¸­ (å°†ç›˜ç›’è£…åˆ°ç®±å­é‡Œ) cabinet.add(chassis); //å°†ä¸€ä¸ª10GBçš„ç¡¬ç›˜è£…åˆ° PC Chassis (å°†ç¡¬ç›˜è£…åˆ°ç›˜ç›’é‡Œ) chassis.add(new Disk(\u0026#34;10 GB\u0026#34;)); //è°ƒç”¨ netPrice()æ–¹æ³•; System.out.println(\u0026#34;netPrice=\u0026#34;+cabinet.netPrice()); System.out.println(\u0026#34;discountPrice=\u0026#34;+cabinet.discountPrice()); ä¸Šé¢è°ƒç”¨çš„æ–¹æ³•netPrice()æˆ–discountPrice()ï¼Œå®é™…ä¸ŠCompositeä½¿ç”¨Iteratoréå†äº†æ•´ä¸ªæ ‘å½¢ç»“æ„,å¯»æ‰¾åŒæ ·åŒ…å«è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡å¹¶å®ç°è°ƒç”¨æ‰§è¡Œ.\nCompositeæ˜¯ä¸ªå¾ˆå·§å¦™ä½“ç°æ™ºæ…§çš„æ¨¡å¼ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœç¢°åˆ°æ ‘å½¢ç»“æ„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•æ˜¯å¦å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ã€‚\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.4-composite/","summary":"Composite(ç»„åˆæ¨¡å¼)å®šä¹‰ å°†å¯¹è±¡ä»¥æ ‘å½¢ç»“æ„ç»„ç»‡èµ·æ¥,ä»¥è¾¾æˆâ€œéƒ¨åˆ†ï¼æ•´ä½“â€ çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§.\nCompositeæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œæƒ³åˆ°Compositeå°±åº”è¯¥æƒ³åˆ°æ ‘å½¢ç»“æ„å›¾ã€‚ç»„åˆä½“å†…è¿™äº›å¯¹è±¡éƒ½æœ‰å…±åŒæ¥å£,å½“ç»„åˆä½“ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ‰§è¡Œæ—¶ï¼ŒCompositeå°†éå†(Iterator)æ•´ä¸ªæ ‘å½¢ç»“æ„,å¯»æ‰¾åŒæ ·åŒ…å«è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡å¹¶å®ç°è°ƒç”¨æ‰§è¡Œã€‚å¯ä»¥ç”¨ç‰µä¸€åŠ¨ç™¾æ¥å½¢å®¹ã€‚\næ‰€ä»¥Compositeæ¨¡å¼ä½¿ç”¨åˆ°Iteratoræ¨¡å¼ï¼Œå’ŒChain of Responsibilityæ¨¡å¼ç±»ä¼¼ã€‚\næœ¬è´¨ å®šä¹‰ interface æˆ– abstract class\næ ¸å¿ƒ åœ¨class(ç»§æ‰¿æˆ–å®ç°) ä¸­ä½¿ç”¨äº† arraylist . å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ  å…¶ä»– å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€classï¼‰\nCompositeå¥½å¤„ ä½¿å®¢æˆ·ç«¯è°ƒç”¨ç®€å•ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´çš„ä½¿ç”¨ç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œç”¨æˆ·å°±ä¸å¿…å…³ç³»è‡ªå·±å¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œè¿™å°±ç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚ æ›´å®¹æ˜“åœ¨ç»„åˆä½“å†…åŠ å…¥å¯¹è±¡éƒ¨ä»¶. å®¢æˆ·ç«¯ä¸å¿…å› ä¸ºåŠ å…¥äº†æ–°çš„å¯¹è±¡éƒ¨ä»¶è€Œæ›´æ”¹ä»£ç ã€‚ å¦‚ä½•ä½¿ç”¨Composite é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é€šç”¨æ–¹å¼äº†ï¼Œå…¶ä»–è®¾è®¡æ¨¡å¼å¯¹æ¥å£å†…éƒ¨å®šä¹‰é™åˆ¶ä¸å¤šï¼ŒCompositeå´æœ‰ä¸ªè§„å®šï¼Œé‚£å°±æ˜¯è¦åœ¨æ¥å£å†…éƒ¨å®šä¹‰ä¸€ä¸ªç”¨äºè®¿é—®å’Œç®¡ç†Compositeç»„åˆä½“çš„å¯¹è±¡ä»¬ï¼ˆæˆ–ç§°éƒ¨ä»¶Componentï¼‰.\nä¸‹é¢çš„ä»£ç æ˜¯ä»¥æŠ½è±¡ç±»å®šä¹‰ï¼Œä¸€èˆ¬å°½é‡ç”¨æ¥å£interface,\npublic abstract class Equipment { private String name; //å®ä»· public abstract double netPrice(); //æŠ˜æ‰£ä»·æ ¼ public abstract double discountPrice(); //å¢åŠ éƒ¨ä»¶æ–¹æ³•ã€€public boolean add(Equipment equipment) { return false; } //åˆ é™¤éƒ¨ä»¶æ–¹æ³• public boolean remove(Equipment equipment) { return false; } //æ³¨æ„è¿™é‡Œï¼Œè¿™é‡Œå°±æä¾›ä¸€ç§ç”¨äºè®¿é—®ç»„åˆä½“ç±»çš„éƒ¨ä»¶æ–¹æ³•ã€‚ public Iterator iter() { return null; } public Equipment(final String name) { this.","title":"2.4 Composite"},{"content":"Decorator(è£…é¥°è€…æ¨¡å¼) å®šä¹‰ åŠ¨æ€ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£,å°±è±¡åœ¨å¢™ä¸Šåˆ·æ²¹æ¼†.ä½¿ç”¨Decoratoræ¨¡å¼ç›¸æ¯”ç”¨ç”Ÿæˆå­ç±»æ–¹å¼è¾¾åˆ°åŠŸèƒ½çš„æ‰©å……æ˜¾å¾—æ›´ä¸ºçµæ´».\næœ¬è´¨ interface(ä¸€èˆ¬éƒ½è¦)\nä¸»è¦æ˜¯ç¼–å†™ è¢«è£…é¥°è€…ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åŠ å…¥è£…é¥°è€…ï¼Œç„¶ååœ¨è¢«è£…é¥°è€…ç±»ä¸­æ³¨æ„å¯¹è£…é¥°è€…ç±»çš„è°ƒç”¨\nä¸ºä»€ä¹ˆä½¿ç”¨Decorator? æˆ‘ä»¬é€šå¸¸å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥å®ç°åŠŸèƒ½çš„æ‹“å±•,å¦‚æœè¿™äº›éœ€è¦æ‹“å±•çš„åŠŸèƒ½çš„ç§ç±»å¾ˆç¹å¤š,é‚£ä¹ˆåŠ¿å¿…ç”Ÿæˆå¾ˆå¤šå­ç±»,å¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§,åŒæ—¶,ä½¿ç”¨ç»§æ‰¿å®ç°åŠŸèƒ½æ‹“å±•,æˆ‘ä»¬å¿…é¡»å¯é¢„è§è¿™äº›æ‹“å±•åŠŸèƒ½,è¿™äº›åŠŸèƒ½æ˜¯ç¼–è¯‘æ—¶å°±ç¡®å®šäº†,æ˜¯é™æ€çš„.\nä½¿ç”¨Decoratorçš„ç†ç”±æ˜¯:è¿™äº›åŠŸèƒ½éœ€è¦ç”±ç”¨æˆ·åŠ¨æ€å†³å®šåŠ å…¥çš„æ–¹å¼å’Œæ—¶æœº.Decoratoræä¾›äº†\u0026quot;å³æ’å³ç”¨\u0026quot;çš„æ–¹æ³•,åœ¨è¿è¡ŒæœŸé—´å†³å®šä½•æ—¶å¢åŠ ä½•ç§åŠŸèƒ½.\nå¦‚ä½•ä½¿ç”¨? ä¸¾Adapterä¸­çš„æ‰“æ¡©ç¤ºä¾‹,åœ¨Adapterä¸­æœ‰ä¸¤ç§ç±»:æ–¹å½¢æ¡© åœ†å½¢æ¡©,Adapteræ¨¡å¼å±•ç¤ºå¦‚ä½•ç»¼åˆä½¿ç”¨è¿™ä¸¤ä¸ªç±»,åœ¨Decoratoræ¨¡å¼ä¸­,æˆ‘ä»¬æ˜¯è¦åœ¨æ‰“æ¡©æ—¶å¢åŠ ä¸€äº›é¢å¤–åŠŸèƒ½,æ¯”å¦‚,æŒ–å‘ åœ¨æ¡©ä¸Šé’‰æœ¨æ¿ç­‰,ä¸å…³å¿ƒå¦‚ä½•ä½¿ç”¨ä¸¤ä¸ªä¸ç›¸å…³çš„ç±».\næˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªæ¥å£:\npublic interface Work { public void insert(); } æ¥å£Workæœ‰ä¸€ä¸ªå…·ä½“å®ç°:æ’å…¥æ–¹å½¢æ¡©æˆ–åœ†å½¢æ¡©,è¿™ä¸¤ä¸ªåŒºåˆ«å¯¹Decoratoræ˜¯æ— æ‰€è°“.æˆ‘ä»¬ä»¥æ’å…¥æ–¹å½¢æ¡©ä¸ºä¾‹:\npublic class SquarePeg implements Work{ public void insert(){ System.out.println(\u0026#34;æ–¹å½¢æ¡©æ’å…¥\u0026#34;); } } ç°åœ¨æœ‰ä¸€ä¸ªåº”ç”¨:éœ€è¦åœ¨æ¡©æ‰“å…¥å‰,æŒ–å‘,åœ¨æ‰“å…¥å,åœ¨æ¡©ä¸Šé’‰æœ¨æ¿,è¿™äº›é¢å¤–çš„åŠŸèƒ½æ˜¯åŠ¨æ€,å¯èƒ½éšæ„å¢åŠ è°ƒæ•´ä¿®æ”¹,æ¯”å¦‚,å¯èƒ½åˆéœ€è¦åœ¨æ‰“æ¡©ä¹‹åé’‰æ¶å­(åªæ˜¯æ¯”å–»).\né‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨Decoratoræ¨¡å¼,è¿™é‡Œæ–¹å½¢æ¡©SquarePegæ˜¯decoratee(è¢«åˆ·æ²¹æ¼†è€…),æˆ‘ä»¬éœ€è¦åœ¨decorateeä¸Šåˆ·äº›\u0026quot;æ²¹æ¼†\u0026quot;,è¿™äº›æ²¹æ¼†å°±æ˜¯é‚£äº›é¢å¤–çš„åŠŸèƒ½.\npublic class Decorator implements Work{ private Work work; //é¢å¤–å¢åŠ çš„åŠŸèƒ½è¢«æ‰“åŒ…åœ¨è¿™ä¸ªListä¸­ private ArrayList others = new ArrayList(); //åœ¨æ„é€ å™¨ä¸­ä½¿ç”¨ç»„åˆnewæ–¹å¼,å¼•å…¥Workå¯¹è±¡; public Decorator(Work work) { this.work=work; others.add(\u0026#34;æŒ–å‘\u0026#34;); others.add(\u0026#34;é’‰æœ¨æ¿\u0026#34;); } public void insert(){ newMethod(); } //åœ¨æ–°æ–¹æ³•ä¸­,æˆ‘ä»¬åœ¨insertä¹‹å‰å¢åŠ å…¶ä»–æ–¹æ³•,è¿™é‡Œæ¬¡åºå…ˆåæ˜¯ç”¨æˆ·çµæ´»æŒ‡å®šçš„ public void newMethod() { otherMethod(); work.insert(); } public void otherMethod() { ListIterator listIterator = others.listIterator(); while (listIterator.hasNext()) { System.out.println(((String)(listIterator.next())) + \u0026#34; æ­£åœ¨è¿›è¡Œ\u0026#34;); } } } åœ¨ä¸Šä¾‹ä¸­,æˆ‘ä»¬æŠŠæŒ–å‘å’Œé’‰æœ¨æ¿éƒ½æ’åœ¨äº†æ‰“æ¡©insertå‰é¢,è¿™é‡Œåªæ˜¯ä¸¾ä¾‹è¯´æ˜é¢å¤–åŠŸèƒ½æ¬¡åºå¯ä»¥ä»»æ„å®‰æ’.\nå¥½äº†,Decoratoræ¨¡å¼å‡ºæ¥äº†,æˆ‘ä»¬çœ‹å¦‚ä½•è°ƒç”¨:\nWork squarePeg = new SquarePeg(); Work decorator = new Decorator(squarePeg); decorator.insert(); Decoratoræ¨¡å¼è‡³æ­¤å®Œæˆ.\nå¦‚æœä½ ç»†å¿ƒ,ä¼šå‘ç°,ä¸Šé¢è°ƒç”¨ç±»ä¼¼æˆ‘ä»¬è¯»å–æ–‡ä»¶æ—¶çš„è°ƒç”¨:\nFileReader fr = new FileReader(filename); BufferedReader br = new BufferedReader(fr);\nå®é™…ä¸ŠJava çš„I/O APIå°±æ˜¯ä½¿ç”¨Decoratorå®ç°çš„,I/Oå˜ç§å¾ˆå¤š,å¦‚æœéƒ½é‡‡å–ç»§æ‰¿æ–¹æ³•,å°†ä¼šäº§ç”Ÿå¾ˆå¤šå­ç±»,æ˜¾ç„¶ç›¸å½“ç¹ç.\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.5-decorator/","summary":"Decorator(è£…é¥°è€…æ¨¡å¼) å®šä¹‰ åŠ¨æ€ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£,å°±è±¡åœ¨å¢™ä¸Šåˆ·æ²¹æ¼†.ä½¿ç”¨Decoratoræ¨¡å¼ç›¸æ¯”ç”¨ç”Ÿæˆå­ç±»æ–¹å¼è¾¾åˆ°åŠŸèƒ½çš„æ‰©å……æ˜¾å¾—æ›´ä¸ºçµæ´».\næœ¬è´¨ interface(ä¸€èˆ¬éƒ½è¦)\nä¸»è¦æ˜¯ç¼–å†™ è¢«è£…é¥°è€…ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åŠ å…¥è£…é¥°è€…ï¼Œç„¶ååœ¨è¢«è£…é¥°è€…ç±»ä¸­æ³¨æ„å¯¹è£…é¥°è€…ç±»çš„è°ƒç”¨\nä¸ºä»€ä¹ˆä½¿ç”¨Decorator? æˆ‘ä»¬é€šå¸¸å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥å®ç°åŠŸèƒ½çš„æ‹“å±•,å¦‚æœè¿™äº›éœ€è¦æ‹“å±•çš„åŠŸèƒ½çš„ç§ç±»å¾ˆç¹å¤š,é‚£ä¹ˆåŠ¿å¿…ç”Ÿæˆå¾ˆå¤šå­ç±»,å¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§,åŒæ—¶,ä½¿ç”¨ç»§æ‰¿å®ç°åŠŸèƒ½æ‹“å±•,æˆ‘ä»¬å¿…é¡»å¯é¢„è§è¿™äº›æ‹“å±•åŠŸèƒ½,è¿™äº›åŠŸèƒ½æ˜¯ç¼–è¯‘æ—¶å°±ç¡®å®šäº†,æ˜¯é™æ€çš„.\nä½¿ç”¨Decoratorçš„ç†ç”±æ˜¯:è¿™äº›åŠŸèƒ½éœ€è¦ç”±ç”¨æˆ·åŠ¨æ€å†³å®šåŠ å…¥çš„æ–¹å¼å’Œæ—¶æœº.Decoratoræä¾›äº†\u0026quot;å³æ’å³ç”¨\u0026quot;çš„æ–¹æ³•,åœ¨è¿è¡ŒæœŸé—´å†³å®šä½•æ—¶å¢åŠ ä½•ç§åŠŸèƒ½.\nå¦‚ä½•ä½¿ç”¨? ä¸¾Adapterä¸­çš„æ‰“æ¡©ç¤ºä¾‹,åœ¨Adapterä¸­æœ‰ä¸¤ç§ç±»:æ–¹å½¢æ¡© åœ†å½¢æ¡©,Adapteræ¨¡å¼å±•ç¤ºå¦‚ä½•ç»¼åˆä½¿ç”¨è¿™ä¸¤ä¸ªç±»,åœ¨Decoratoræ¨¡å¼ä¸­,æˆ‘ä»¬æ˜¯è¦åœ¨æ‰“æ¡©æ—¶å¢åŠ ä¸€äº›é¢å¤–åŠŸèƒ½,æ¯”å¦‚,æŒ–å‘ åœ¨æ¡©ä¸Šé’‰æœ¨æ¿ç­‰,ä¸å…³å¿ƒå¦‚ä½•ä½¿ç”¨ä¸¤ä¸ªä¸ç›¸å…³çš„ç±».\næˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªæ¥å£:\npublic interface Work { public void insert(); } æ¥å£Workæœ‰ä¸€ä¸ªå…·ä½“å®ç°:æ’å…¥æ–¹å½¢æ¡©æˆ–åœ†å½¢æ¡©,è¿™ä¸¤ä¸ªåŒºåˆ«å¯¹Decoratoræ˜¯æ— æ‰€è°“.æˆ‘ä»¬ä»¥æ’å…¥æ–¹å½¢æ¡©ä¸ºä¾‹:\npublic class SquarePeg implements Work{ public void insert(){ System.out.println(\u0026#34;æ–¹å½¢æ¡©æ’å…¥\u0026#34;); } } ç°åœ¨æœ‰ä¸€ä¸ªåº”ç”¨:éœ€è¦åœ¨æ¡©æ‰“å…¥å‰,æŒ–å‘,åœ¨æ‰“å…¥å,åœ¨æ¡©ä¸Šé’‰æœ¨æ¿,è¿™äº›é¢å¤–çš„åŠŸèƒ½æ˜¯åŠ¨æ€,å¯èƒ½éšæ„å¢åŠ è°ƒæ•´ä¿®æ”¹,æ¯”å¦‚,å¯èƒ½åˆéœ€è¦åœ¨æ‰“æ¡©ä¹‹åé’‰æ¶å­(åªæ˜¯æ¯”å–»).\né‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨Decoratoræ¨¡å¼,è¿™é‡Œæ–¹å½¢æ¡©SquarePegæ˜¯decoratee(è¢«åˆ·æ²¹æ¼†è€…),æˆ‘ä»¬éœ€è¦åœ¨decorateeä¸Šåˆ·äº›\u0026quot;æ²¹æ¼†\u0026quot;,è¿™äº›æ²¹æ¼†å°±æ˜¯é‚£äº›é¢å¤–çš„åŠŸèƒ½.\npublic class Decorator implements Work{ private Work work; //é¢å¤–å¢åŠ çš„åŠŸèƒ½è¢«æ‰“åŒ…åœ¨è¿™ä¸ªListä¸­ private ArrayList others = new ArrayList(); //åœ¨æ„é€ å™¨ä¸­ä½¿ç”¨ç»„åˆnewæ–¹å¼,å¼•å…¥Workå¯¹è±¡; public Decorator(Work work) { this.work=work; others.add(\u0026#34;æŒ–å‘\u0026#34;); others.add(\u0026#34;é’‰æœ¨æ¿\u0026#34;); } public void insert(){ newMethod(); } //åœ¨æ–°æ–¹æ³•ä¸­,æˆ‘ä»¬åœ¨insertä¹‹å‰å¢åŠ å…¶ä»–æ–¹æ³•,è¿™é‡Œæ¬¡åºå…ˆåæ˜¯ç”¨æˆ·çµæ´»æŒ‡å®šçš„ public void newMethod() { otherMethod(); work.","title":"2.5 Decorator"},{"content":"Adapter(é€‚é…è€…æ¨¡å¼) å®šä¹‰ å°†ä¸¤ä¸ªä¸å…¼å®¹çš„ç±»çº åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå±äºç»“æ„å‹æ¨¡å¼,éœ€è¦æœ‰Adaptee(è¢«é€‚é…è€…)å’ŒAdaptor(é€‚é…å™¨)ä¸¤ä¸ªèº«ä»½.\nä¸ºä½•ä½¿ç”¨? æˆ‘ä»¬ç»å¸¸ç¢°åˆ°è¦å°†ä¸¤ä¸ªæ²¡æœ‰å…³ç³»çš„ç±»ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨,ç¬¬ä¸€è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä¿®æ”¹å„è‡ªç±»çš„æ¥å£ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰æºä»£ç ï¼Œæˆ–è€…ï¼Œæˆ‘ä»¬ä¸æ„¿æ„ä¸ºäº†ä¸€ä¸ªåº”ç”¨è€Œä¿®æ”¹å„è‡ªçš„æ¥å£ã€‚ æ€ä¹ˆåŠ?\nä½¿ç”¨Adapterï¼Œåœ¨è¿™ä¸¤ç§æ¥å£ä¹‹é—´åˆ›å»ºä¸€ä¸ªæ··åˆæ¥å£(æ··è¡€å„¿).\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.3-adapter/","summary":"Adapter(é€‚é…è€…æ¨¡å¼) å®šä¹‰ å°†ä¸¤ä¸ªä¸å…¼å®¹çš„ç±»çº åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå±äºç»“æ„å‹æ¨¡å¼,éœ€è¦æœ‰Adaptee(è¢«é€‚é…è€…)å’ŒAdaptor(é€‚é…å™¨)ä¸¤ä¸ªèº«ä»½.\nä¸ºä½•ä½¿ç”¨? æˆ‘ä»¬ç»å¸¸ç¢°åˆ°è¦å°†ä¸¤ä¸ªæ²¡æœ‰å…³ç³»çš„ç±»ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨,ç¬¬ä¸€è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä¿®æ”¹å„è‡ªç±»çš„æ¥å£ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰æºä»£ç ï¼Œæˆ–è€…ï¼Œæˆ‘ä»¬ä¸æ„¿æ„ä¸ºäº†ä¸€ä¸ªåº”ç”¨è€Œä¿®æ”¹å„è‡ªçš„æ¥å£ã€‚ æ€ä¹ˆåŠ?\nä½¿ç”¨Adapterï¼Œåœ¨è¿™ä¸¤ç§æ¥å£ä¹‹é—´åˆ›å»ºä¸€ä¸ªæ··åˆæ¥å£(æ··è¡€å„¿).","title":"2.3 Adapter"},{"content":"Proxy(ä»£ç†æ¨¡å¼)å®šä¹‰ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®.\nä»£ç†æ¨¡å¼æ˜¯æ¯”è¾ƒæœ‰ç”¨é€”çš„ä¸€ç§æ¨¡å¼,è€Œä¸”å˜ç§è¾ƒå¤š,åº”ç”¨åœºåˆè¦†ç›–ä»å°ç»“æ„åˆ°æ•´ä¸ªç³»ç»Ÿçš„å¤§ç»“æ„,Proxyæ˜¯ä»£ç†çš„æ„æ€,æˆ‘ä»¬ä¹Ÿè®¸æœ‰ä»£ç†æœåŠ¡å™¨ç­‰æ¦‚å¿µ,ä»£ç†æ¦‚å¿µå¯ä»¥è§£é‡Šä¸º:åœ¨å‡ºå‘ç‚¹åˆ°ç›®çš„åœ°ä¹‹é—´æœ‰ä¸€é“ä¸­é—´å±‚,æ„ä¸ºä»£ç†.\nä¸ºä»€ä¹ˆè¦ä½¿ç”¨Proxy? æˆæƒæœºåˆ¶ ä¸åŒçº§åˆ«çš„ç”¨æˆ·å¯¹åŒä¸€å¯¹è±¡æ‹¥æœ‰ä¸åŒçš„è®¿é—®æƒåˆ©,å¦‚Jiveè®ºå›ç³»ç»Ÿä¸­,å°±ä½¿ç”¨Proxyè¿›è¡Œæˆæƒæœºåˆ¶æ§åˆ¶,è®¿é—®è®ºå›æœ‰ä¸¤ç§äºº:æ³¨å†Œç”¨æˆ·å’Œæ¸¸å®¢(æœªæ³¨å†Œç”¨æˆ·),Jiveä¸­å°±é€šè¿‡ç±»ä¼¼ForumProxyè¿™æ ·çš„ä»£ç†æ¥æ§åˆ¶è¿™ä¸¤ç§ç”¨æˆ·å¯¹è®ºå›çš„è®¿é—®æƒé™.\næŸä¸ªå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥æ“ä½œåˆ°æŸä¸ªå¯¹è±¡,ä½†åˆå¿…é¡»å’Œé‚£ä¸ªå¯¹è±¡æœ‰æ‰€äº’åŠ¨. ä¸¾ä¾‹ä¸¤ä¸ªå…·ä½“æƒ…å†µ:\nå¦‚æœé‚£ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªæ˜¯å¾ˆå¤§çš„å›¾ç‰‡,éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥,é‚£ä¹ˆå½“è¿™ä¸ªå›¾ç‰‡åŒ…å«åœ¨æ–‡æ¡£ä¸­æ—¶,ä½¿ç”¨ç¼–è¾‘å™¨æˆ–æµè§ˆå™¨æ‰“å¼€è¿™ä¸ªæ–‡æ¡£,æ‰“å¼€æ–‡æ¡£å¿…é¡»å¾ˆè¿…é€Ÿ,ä¸èƒ½ç­‰å¾…å¤§å›¾ç‰‡å¤„ç†å®Œæˆ,è¿™æ—¶éœ€è¦åšä¸ªå›¾ç‰‡Proxyæ¥ä»£æ›¿çœŸæ­£çš„å›¾ç‰‡. å¦‚æœé‚£ä¸ªå¯¹è±¡åœ¨Internetçš„æŸä¸ªè¿œç«¯æœåŠ¡å™¨ä¸Š,ç›´æ¥æ“ä½œè¿™ä¸ªå¯¹è±¡å› ä¸ºç½‘ç»œé€Ÿåº¦åŸå› å¯èƒ½æ¯”è¾ƒæ…¢,é‚£æˆ‘ä»¬å¯ä»¥å…ˆç”¨Proxyæ¥ä»£æ›¿é‚£ä¸ªå¯¹è±¡. æ€»ä¹‹åŸåˆ™æ˜¯,å¯¹äºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡,åªæœ‰åœ¨ä½¿ç”¨å®ƒæ—¶æ‰åˆ›å»º,è¿™ä¸ªåŸåˆ™å¯ä»¥ä¸ºæˆ‘ä»¬èŠ‚çœå¾ˆå¤šå®è´µçš„Javaå†…å­˜. æ‰€ä»¥,æœ‰äº›äººè®¤ä¸ºJavaè€—è´¹èµ„æºå†…å­˜,æˆ‘ä»¥ä¸ºè¿™å’Œç¨‹åºç¼–åˆ¶æ€è·¯ä¹Ÿæœ‰ä¸€å®šçš„å…³ç³».\nå¦‚ä½•ä½¿ç”¨Proxy? ä»¥Jiveè®ºå›ç³»ç»Ÿä¸ºä¾‹,è®¿é—®è®ºå›ç³»ç»Ÿçš„ç”¨æˆ·æœ‰å¤šç§ç±»å‹:æ³¨å†Œæ™®é€šç”¨æˆ· è®ºå›ç®¡ç†è€… ç³»ç»Ÿç®¡ç†è€… æ¸¸å®¢,æ³¨å†Œæ™®é€šç”¨æˆ·æ‰èƒ½å‘è¨€;è®ºå›ç®¡ç†è€…å¯ä»¥ç®¡ç†ä»–è¢«æˆæƒçš„è®ºå›;ç³»ç»Ÿç®¡ç†è€…å¯ä»¥ç®¡ç†æ‰€æœ‰äº‹åŠ¡ç­‰,è¿™äº›æƒé™åˆ’åˆ†å’Œç®¡ç†æ˜¯ä½¿ç”¨Proxyå®Œæˆçš„.\nForumæ˜¯Jiveçš„æ ¸å¿ƒæ¥å£,åœ¨Forumä¸­é™ˆåˆ—äº†æœ‰å…³è®ºå›æ“ä½œçš„ä¸»è¦è¡Œä¸º,å¦‚è®ºå›åç§° è®ºå›æè¿°çš„è·å–å’Œä¿®æ”¹,å¸–å­å‘è¡¨åˆ é™¤ç¼–è¾‘ç­‰.\nåœ¨ForumPermissionsä¸­å®šä¹‰äº†å„ç§çº§åˆ«æƒé™çš„ç”¨æˆ·:\npublic class ForumPermissions implements Cacheable { /** * Permission to read object. */ public static final int READ = 0; /** * Permission to administer the entire sytem. */ public static final int SYSTEM_ADMIN = 1; /** * Permission to administer a particular forum. */ public static final int FORUM_ADMIN = 2; /** * Permission to administer a particular user. */ public static final int USER_ADMIN = 3; /** * Permission to administer a particular group. */ public static final int GROUP_ADMIN = 4; /** * Permission to moderate threads. */ public static final int MODERATE_THREADS = 5; /** * Permission to create a new thread. */ public static final int CREATE_THREAD = 6; /** * Permission to create a new message. */ public static final int CREATE_MESSAGE = 7; /** * Permission to moderate messages. */ public static final int MODERATE_MESSAGES = 8; ..... public boolean isSystemOrForumAdmin() { return (values[FORUM_ADMIN] || values[SYSTEM_ADMIN]); } ..... } å› æ­¤,Forumä¸­å„ç§æ“ä½œæƒé™æ˜¯å’ŒForumPermissionså®šä¹‰çš„ç”¨æˆ·çº§åˆ«æœ‰å…³ç³»çš„,ä½œä¸ºæ¥å£Forumçš„å®ç°:ForumProxyæ­£æ˜¯å°†è¿™ç§å¯¹åº”å…³ç³»è”ç³»èµ·æ¥.æ¯”å¦‚,ä¿®æ”¹Forumçš„åç§°,åªæœ‰è®ºå›ç®¡ç†è€…æˆ–ç³»ç»Ÿç®¡ç†è€…å¯ä»¥ä¿®æ”¹,ä»£ç å¦‚ä¸‹:\npublic class ForumProxy implements Forum { private ForumPermissions permissions; private Forum forum; this.authorization = authorization; public ForumProxy(Forum forum, Authorization authorization, ForumPermissions permissions) { this.forum = forum; this.authorization = authorization; this.permissions = permissions; } ..... public void setName(String name) throws UnauthorizedException, ForumAlreadyExistsException { //åªæœ‰æ˜¯ç³»ç»Ÿæˆ–è®ºå›ç®¡ç†è€…æ‰å¯ä»¥ä¿®æ”¹åç§° if (permissions.isSystemOrForumAdmin()) { forum.setName(name); } else { throw new UnauthorizedException(); } } ... } è€ŒDbForumæ‰æ˜¯æ¥å£Forumçš„çœŸæ­£å®ç°,ä»¥ä¿®æ”¹è®ºå›åç§°ä¸ºä¾‹:\npublic class DbForum implements Forum, Cacheable { ... public void setName(String name) throws ForumAlreadyExistsException { .... this.name = name; //è¿™é‡ŒçœŸæ­£å°†æ–°åç§°ä¿å­˜åˆ°æ•°æ®åº“ä¸­ saveToDb(); .... } ... } å‡¡æ˜¯æ¶‰åŠåˆ°å¯¹è®ºå›åç§°ä¿®æ”¹è¿™ä¸€äº‹ä»¶,å…¶ä»–ç¨‹åºéƒ½é¦–å…ˆå¾—å’ŒForumProxyæ‰“äº¤é“,ç”±ForumProxyå†³å®šæ˜¯å¦æœ‰æƒé™åšæŸä¸€æ ·äº‹æƒ…,ForumProxyæ˜¯ä¸ªåå‰¯å…¶å®çš„\u0026quot;ç½‘å…³\u0026quot;,\u0026ldquo;å®‰å…¨ä»£ç†ç³»ç»Ÿ\u0026rdquo;.\nåœ¨å¹³æ—¶åº”ç”¨ä¸­,æ— å¯é¿å…æ€»è¦æ¶‰åŠåˆ°ç³»ç»Ÿçš„æˆæƒæˆ–å®‰å…¨ä½“ç³»,ä¸ç®¡ä½ æœ‰æ— æ„è¯†çš„ä½¿ç”¨Proxy,å®é™…ä½ å·²ç»åœ¨ä½¿ç”¨Proxyäº†.\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.2-proxy/","summary":"Proxy(ä»£ç†æ¨¡å¼)å®šä¹‰ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®.\nä»£ç†æ¨¡å¼æ˜¯æ¯”è¾ƒæœ‰ç”¨é€”çš„ä¸€ç§æ¨¡å¼,è€Œä¸”å˜ç§è¾ƒå¤š,åº”ç”¨åœºåˆè¦†ç›–ä»å°ç»“æ„åˆ°æ•´ä¸ªç³»ç»Ÿçš„å¤§ç»“æ„,Proxyæ˜¯ä»£ç†çš„æ„æ€,æˆ‘ä»¬ä¹Ÿè®¸æœ‰ä»£ç†æœåŠ¡å™¨ç­‰æ¦‚å¿µ,ä»£ç†æ¦‚å¿µå¯ä»¥è§£é‡Šä¸º:åœ¨å‡ºå‘ç‚¹åˆ°ç›®çš„åœ°ä¹‹é—´æœ‰ä¸€é“ä¸­é—´å±‚,æ„ä¸ºä»£ç†.\nä¸ºä»€ä¹ˆè¦ä½¿ç”¨Proxy? æˆæƒæœºåˆ¶ ä¸åŒçº§åˆ«çš„ç”¨æˆ·å¯¹åŒä¸€å¯¹è±¡æ‹¥æœ‰ä¸åŒçš„è®¿é—®æƒåˆ©,å¦‚Jiveè®ºå›ç³»ç»Ÿä¸­,å°±ä½¿ç”¨Proxyè¿›è¡Œæˆæƒæœºåˆ¶æ§åˆ¶,è®¿é—®è®ºå›æœ‰ä¸¤ç§äºº:æ³¨å†Œç”¨æˆ·å’Œæ¸¸å®¢(æœªæ³¨å†Œç”¨æˆ·),Jiveä¸­å°±é€šè¿‡ç±»ä¼¼ForumProxyè¿™æ ·çš„ä»£ç†æ¥æ§åˆ¶è¿™ä¸¤ç§ç”¨æˆ·å¯¹è®ºå›çš„è®¿é—®æƒé™.\næŸä¸ªå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥æ“ä½œåˆ°æŸä¸ªå¯¹è±¡,ä½†åˆå¿…é¡»å’Œé‚£ä¸ªå¯¹è±¡æœ‰æ‰€äº’åŠ¨. ä¸¾ä¾‹ä¸¤ä¸ªå…·ä½“æƒ…å†µ:\nå¦‚æœé‚£ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªæ˜¯å¾ˆå¤§çš„å›¾ç‰‡,éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥,é‚£ä¹ˆå½“è¿™ä¸ªå›¾ç‰‡åŒ…å«åœ¨æ–‡æ¡£ä¸­æ—¶,ä½¿ç”¨ç¼–è¾‘å™¨æˆ–æµè§ˆå™¨æ‰“å¼€è¿™ä¸ªæ–‡æ¡£,æ‰“å¼€æ–‡æ¡£å¿…é¡»å¾ˆè¿…é€Ÿ,ä¸èƒ½ç­‰å¾…å¤§å›¾ç‰‡å¤„ç†å®Œæˆ,è¿™æ—¶éœ€è¦åšä¸ªå›¾ç‰‡Proxyæ¥ä»£æ›¿çœŸæ­£çš„å›¾ç‰‡. å¦‚æœé‚£ä¸ªå¯¹è±¡åœ¨Internetçš„æŸä¸ªè¿œç«¯æœåŠ¡å™¨ä¸Š,ç›´æ¥æ“ä½œè¿™ä¸ªå¯¹è±¡å› ä¸ºç½‘ç»œé€Ÿåº¦åŸå› å¯èƒ½æ¯”è¾ƒæ…¢,é‚£æˆ‘ä»¬å¯ä»¥å…ˆç”¨Proxyæ¥ä»£æ›¿é‚£ä¸ªå¯¹è±¡. æ€»ä¹‹åŸåˆ™æ˜¯,å¯¹äºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡,åªæœ‰åœ¨ä½¿ç”¨å®ƒæ—¶æ‰åˆ›å»º,è¿™ä¸ªåŸåˆ™å¯ä»¥ä¸ºæˆ‘ä»¬èŠ‚çœå¾ˆå¤šå®è´µçš„Javaå†…å­˜. æ‰€ä»¥,æœ‰äº›äººè®¤ä¸ºJavaè€—è´¹èµ„æºå†…å­˜,æˆ‘ä»¥ä¸ºè¿™å’Œç¨‹åºç¼–åˆ¶æ€è·¯ä¹Ÿæœ‰ä¸€å®šçš„å…³ç³».\nå¦‚ä½•ä½¿ç”¨Proxy? ä»¥Jiveè®ºå›ç³»ç»Ÿä¸ºä¾‹,è®¿é—®è®ºå›ç³»ç»Ÿçš„ç”¨æˆ·æœ‰å¤šç§ç±»å‹:æ³¨å†Œæ™®é€šç”¨æˆ· è®ºå›ç®¡ç†è€… ç³»ç»Ÿç®¡ç†è€… æ¸¸å®¢,æ³¨å†Œæ™®é€šç”¨æˆ·æ‰èƒ½å‘è¨€;è®ºå›ç®¡ç†è€…å¯ä»¥ç®¡ç†ä»–è¢«æˆæƒçš„è®ºå›;ç³»ç»Ÿç®¡ç†è€…å¯ä»¥ç®¡ç†æ‰€æœ‰äº‹åŠ¡ç­‰,è¿™äº›æƒé™åˆ’åˆ†å’Œç®¡ç†æ˜¯ä½¿ç”¨Proxyå®Œæˆçš„.\nForumæ˜¯Jiveçš„æ ¸å¿ƒæ¥å£,åœ¨Forumä¸­é™ˆåˆ—äº†æœ‰å…³è®ºå›æ“ä½œçš„ä¸»è¦è¡Œä¸º,å¦‚è®ºå›åç§° è®ºå›æè¿°çš„è·å–å’Œä¿®æ”¹,å¸–å­å‘è¡¨åˆ é™¤ç¼–è¾‘ç­‰.\nåœ¨ForumPermissionsä¸­å®šä¹‰äº†å„ç§çº§åˆ«æƒé™çš„ç”¨æˆ·:\npublic class ForumPermissions implements Cacheable { /** * Permission to read object. */ public static final int READ = 0; /** * Permission to administer the entire sytem. */ public static final int SYSTEM_ADMIN = 1; /** * Permission to administer a particular forum. */ public static final int FORUM_ADMIN = 2; /** * Permission to administer a particular user.","title":"2.2 Proxy"},{"content":"Facade (å¤–è§‚ æ€»ç®¡æ¨¡å¼ï¼‰å®šä¹‰ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢.\né“¾æ¥\nFacadeä¸€ä¸ªå…¸å‹åº”ç”¨å°±æ˜¯æ•°æ®åº“JDBCçš„åº”ç”¨\næ‰€æœ‰ç¨‹åºå¯¹æ•°æ®åº“è®¿é—®éƒ½æ˜¯ä½¿ç”¨æ”¹æ¥å£,é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,å¢åŠ äº†çµæ´»æ€§.\nå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨è¿æ¥æ± ,ä¹Ÿåªè¦é’ˆå¯¹facadeæ¥å£ä¿®æ”¹å°±å¯ä»¥.\n","permalink":"https://blog.chalme.top/posts/design-patterns/2.1-facade/","summary":"Facade (å¤–è§‚ æ€»ç®¡æ¨¡å¼ï¼‰å®šä¹‰ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢.\né“¾æ¥\nFacadeä¸€ä¸ªå…¸å‹åº”ç”¨å°±æ˜¯æ•°æ®åº“JDBCçš„åº”ç”¨\næ‰€æœ‰ç¨‹åºå¯¹æ•°æ®åº“è®¿é—®éƒ½æ˜¯ä½¿ç”¨æ”¹æ¥å£,é™ä½ç³»ç»Ÿçš„å¤æ‚æ€§,å¢åŠ äº†çµæ´»æ€§.\nå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨è¿æ¥æ± ,ä¹Ÿåªè¦é’ˆå¯¹facadeæ¥å£ä¿®æ”¹å°±å¯ä»¥.","title":"2.1 Facade"},{"content":"Builder(å»ºé€ è€…æ¨¡å¼ï¼‰å®šä¹‰ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»,ä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º.\nBuilderæ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,å®ƒå…è®¸ç”¨æˆ·å¯ä»¥åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬.ç”¨æˆ·ä¸çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚.Builderæ¨¡å¼æ˜¯éå¸¸ç±»ä¼¼æŠ½è±¡å·¥å‚æ¨¡å¼,ç»†å¾®çš„åŒºåˆ«å¤§æ¦‚åªæœ‰åœ¨åå¤ä½¿ç”¨ä¸­æ‰èƒ½ä½“ä¼šåˆ°.\nä¸ºä½•ä½¿ç”¨? æ˜¯ä¸ºäº†å°†æ„å»ºå¤æ‚å¯¹è±¡çš„è¿‡ç¨‹å’Œå®ƒçš„éƒ¨ä»¶è§£è€¦.æ³¨æ„: æ˜¯è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶.\nå› ä¸ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,ä¸ä½†æœ‰å¾ˆå¤šå¤§é‡ç»„æˆéƒ¨åˆ†,å¦‚æ±½è½¦,æœ‰å¾ˆå¤šéƒ¨ä»¶:è½¦è½® æ–¹å‘ç›˜ å‘åŠ¨æœºè¿˜æœ‰å„ç§å°é›¶ä»¶ç­‰ç­‰,éƒ¨ä»¶å¾ˆå¤š,ä½†è¿œä¸æ­¢è¿™äº›,å¦‚ä½•å°†è¿™äº›éƒ¨ä»¶è£…é…æˆä¸€è¾†æ±½è½¦,è¿™ä¸ªè£…é…è¿‡ç¨‹ä¹Ÿå¾ˆå¤æ‚(éœ€è¦å¾ˆå¥½çš„ç»„è£…æŠ€æœ¯),Builderæ¨¡å¼å°±æ˜¯ä¸ºäº†å°†éƒ¨ä»¶å’Œç»„è£…è¿‡ç¨‹åˆ†å¼€.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆå‡è®¾ä¸€ä¸ªå¤æ‚å¯¹è±¡æ˜¯ç”±å¤šä¸ªéƒ¨ä»¶ç»„æˆçš„,Builderæ¨¡å¼æ˜¯æŠŠå¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œéƒ¨ä»¶çš„åˆ›å»ºåˆ†åˆ«å¼€æ¥,åˆ†åˆ«ç”¨Builderç±»å’ŒDirectorç±»æ¥è¡¨ç¤º.\né¦–å…ˆ,éœ€è¦ä¸€ä¸ªæ¥å£,å®ƒå®šä¹‰å¦‚ä½•åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶:\npublic interface Builder { //åˆ›å»ºéƒ¨ä»¶Aã€€æ¯”å¦‚åˆ›å»ºæ±½è½¦è½¦è½® void buildPartA(); //åˆ›å»ºéƒ¨ä»¶B æ¯”å¦‚åˆ›å»ºæ±½è½¦æ–¹å‘ç›˜ void buildPartB(); //åˆ›å»ºéƒ¨ä»¶C æ¯”å¦‚åˆ›å»ºæ±½è½¦å‘åŠ¨æœº void buildPartC(); //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ (è¿”å›æœ€åè£…é…å¥½çš„æ±½è½¦) //æˆå“çš„ç»„è£…è¿‡ç¨‹ä¸åœ¨è¿™é‡Œè¿›è¡Œ,è€Œæ˜¯è½¬ç§»åˆ°ä¸‹é¢çš„Directorç±»ä¸­è¿›è¡Œ. //ä»è€Œå®ç°äº†è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶ Product getResult(); } ç”¨Directoræ„å»ºæœ€åçš„å¤æ‚å¯¹è±¡,è€Œåœ¨ä¸Šé¢Builderæ¥å£ä¸­å°è£…çš„æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªä¸ªéƒ¨ä»¶(å¤æ‚å¯¹è±¡æ˜¯ç”±è¿™äº›éƒ¨ä»¶ç»„æˆçš„),ä¹Ÿå°±æ˜¯è¯´Directorçš„å†…å®¹æ˜¯å¦‚ä½•å°†éƒ¨ä»¶æœ€åç»„è£…æˆæˆå“:\npublic class Director { private Builder builder; public Director( Builder builder ) { this.builder = builder; } // å°†éƒ¨ä»¶partA partB partCæœ€åç»„æˆå¤æ‚å¯¹è±¡ //è¿™é‡Œæ˜¯å°†è½¦è½® æ–¹å‘ç›˜å’Œå‘åŠ¨æœºç»„è£…æˆæ±½è½¦çš„è¿‡ç¨‹ public void construct() { builder.buildPartA(); builder.buildPartB(); builder.buildPartC(); } } Builderçš„å…·ä½“å®ç°ConcreteBuilder:\né€šè¿‡å…·ä½“å®Œæˆæ¥å£Builderæ¥æ„å»ºæˆ–è£…é…äº§å“çš„éƒ¨ä»¶; å®šä¹‰å¹¶æ˜ç¡®å®ƒæ‰€è¦åˆ›å»ºçš„æ˜¯ä»€ä¹ˆå…·ä½“ä¸œè¥¿; æä¾›ä¸€ä¸ªå¯ä»¥é‡æ–°è·å–äº§å“çš„æ¥å£: public class ConcreteBuilder implements Builder { Part partA, partB, partC; public void buildPartA() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartAçš„ä»£ç  }; public void buildPartB() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public void buildPartC() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public Product getResult() { //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ }; } å¤æ‚å¯¹è±¡:äº§å“Product:\npublic interface Product { } å¤æ‚å¯¹è±¡çš„éƒ¨ä»¶:\npublic interface Part { } æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è°ƒç”¨Builderæ¨¡å¼:\nConcreteBuilder builder = new ConcreteBuilder(); Director director = new Director( builder ); director.construct(); Product product = builder.getResult(); åº”ç”¨ åœ¨Javaå®é™…ä½¿ç”¨ä¸­,æˆ‘ä»¬ç»å¸¸ç”¨åˆ°\u0026quot;æ± \u0026quot;(Pool)çš„æ¦‚å¿µ,å½“èµ„æºæä¾›è€…æ— æ³•æä¾›è¶³å¤Ÿçš„èµ„æº,å¹¶ä¸”è¿™äº›èµ„æºéœ€è¦è¢«å¾ˆå¤šç”¨æˆ·åå¤å…±äº«æ—¶,å°±éœ€è¦ä½¿ç”¨æ± .\n\u0026ldquo;æ± \u0026quot;å®é™…æ˜¯ä¸€æ®µå†…å­˜,å½“æ± ä¸­æœ‰ä¸€äº›å¤æ‚çš„èµ„æºçš„\u0026quot;æ–­è‚¢\u0026rdquo;(æ¯”å¦‚æ•°æ®åº“çš„è¿æ¥æ± ,ä¹Ÿè®¸æœ‰æ—¶ä¸€ä¸ªè¿æ¥ä¼šä¸­æ–­),å¦‚æœå¾ªç¯å†åˆ©ç”¨è¿™äº›\u0026quot;æ–­è‚¢\u0026quot;,å°†æé«˜å†…å­˜ä½¿ç”¨æ•ˆç‡,æé«˜æ± çš„æ€§èƒ½.ä¿®æ”¹Builderæ¨¡å¼ä¸­Directorç±»ä½¿ä¹‹èƒ½è¯Šæ–­\u0026quot;æ–­è‚¢\u0026quot;æ–­åœ¨å“ªä¸ªéƒ¨ä»¶ä¸Š,å†ä¿®å¤è¿™ä¸ªéƒ¨ä»¶.\n","permalink":"https://blog.chalme.top/posts/design-patterns/1.4-builder/","summary":"Builder(å»ºé€ è€…æ¨¡å¼ï¼‰å®šä¹‰ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»,ä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º.\nBuilderæ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,å®ƒå…è®¸ç”¨æˆ·å¯ä»¥åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬.ç”¨æˆ·ä¸çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚.Builderæ¨¡å¼æ˜¯éå¸¸ç±»ä¼¼æŠ½è±¡å·¥å‚æ¨¡å¼,ç»†å¾®çš„åŒºåˆ«å¤§æ¦‚åªæœ‰åœ¨åå¤ä½¿ç”¨ä¸­æ‰èƒ½ä½“ä¼šåˆ°.\nä¸ºä½•ä½¿ç”¨? æ˜¯ä¸ºäº†å°†æ„å»ºå¤æ‚å¯¹è±¡çš„è¿‡ç¨‹å’Œå®ƒçš„éƒ¨ä»¶è§£è€¦.æ³¨æ„: æ˜¯è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶.\nå› ä¸ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡,ä¸ä½†æœ‰å¾ˆå¤šå¤§é‡ç»„æˆéƒ¨åˆ†,å¦‚æ±½è½¦,æœ‰å¾ˆå¤šéƒ¨ä»¶:è½¦è½® æ–¹å‘ç›˜ å‘åŠ¨æœºè¿˜æœ‰å„ç§å°é›¶ä»¶ç­‰ç­‰,éƒ¨ä»¶å¾ˆå¤š,ä½†è¿œä¸æ­¢è¿™äº›,å¦‚ä½•å°†è¿™äº›éƒ¨ä»¶è£…é…æˆä¸€è¾†æ±½è½¦,è¿™ä¸ªè£…é…è¿‡ç¨‹ä¹Ÿå¾ˆå¤æ‚(éœ€è¦å¾ˆå¥½çš„ç»„è£…æŠ€æœ¯),Builderæ¨¡å¼å°±æ˜¯ä¸ºäº†å°†éƒ¨ä»¶å’Œç»„è£…è¿‡ç¨‹åˆ†å¼€.\nå¦‚ä½•ä½¿ç”¨? é¦–å…ˆå‡è®¾ä¸€ä¸ªå¤æ‚å¯¹è±¡æ˜¯ç”±å¤šä¸ªéƒ¨ä»¶ç»„æˆçš„,Builderæ¨¡å¼æ˜¯æŠŠå¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œéƒ¨ä»¶çš„åˆ›å»ºåˆ†åˆ«å¼€æ¥,åˆ†åˆ«ç”¨Builderç±»å’ŒDirectorç±»æ¥è¡¨ç¤º.\né¦–å…ˆ,éœ€è¦ä¸€ä¸ªæ¥å£,å®ƒå®šä¹‰å¦‚ä½•åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶:\npublic interface Builder { //åˆ›å»ºéƒ¨ä»¶Aã€€æ¯”å¦‚åˆ›å»ºæ±½è½¦è½¦è½® void buildPartA(); //åˆ›å»ºéƒ¨ä»¶B æ¯”å¦‚åˆ›å»ºæ±½è½¦æ–¹å‘ç›˜ void buildPartB(); //åˆ›å»ºéƒ¨ä»¶C æ¯”å¦‚åˆ›å»ºæ±½è½¦å‘åŠ¨æœº void buildPartC(); //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ (è¿”å›æœ€åè£…é…å¥½çš„æ±½è½¦) //æˆå“çš„ç»„è£…è¿‡ç¨‹ä¸åœ¨è¿™é‡Œè¿›è¡Œ,è€Œæ˜¯è½¬ç§»åˆ°ä¸‹é¢çš„Directorç±»ä¸­è¿›è¡Œ. //ä»è€Œå®ç°äº†è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶ Product getResult(); } ç”¨Directoræ„å»ºæœ€åçš„å¤æ‚å¯¹è±¡,è€Œåœ¨ä¸Šé¢Builderæ¥å£ä¸­å°è£…çš„æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªä¸ªéƒ¨ä»¶(å¤æ‚å¯¹è±¡æ˜¯ç”±è¿™äº›éƒ¨ä»¶ç»„æˆçš„),ä¹Ÿå°±æ˜¯è¯´Directorçš„å†…å®¹æ˜¯å¦‚ä½•å°†éƒ¨ä»¶æœ€åç»„è£…æˆæˆå“:\npublic class Director { private Builder builder; public Director( Builder builder ) { this.builder = builder; } // å°†éƒ¨ä»¶partA partB partCæœ€åç»„æˆå¤æ‚å¯¹è±¡ //è¿™é‡Œæ˜¯å°†è½¦è½® æ–¹å‘ç›˜å’Œå‘åŠ¨æœºç»„è£…æˆæ±½è½¦çš„è¿‡ç¨‹ public void construct() { builder.buildPartA(); builder.buildPartB(); builder.buildPartC(); } } Builderçš„å…·ä½“å®ç°ConcreteBuilder:\né€šè¿‡å…·ä½“å®Œæˆæ¥å£Builderæ¥æ„å»ºæˆ–è£…é…äº§å“çš„éƒ¨ä»¶; å®šä¹‰å¹¶æ˜ç¡®å®ƒæ‰€è¦åˆ›å»ºçš„æ˜¯ä»€ä¹ˆå…·ä½“ä¸œè¥¿; æä¾›ä¸€ä¸ªå¯ä»¥é‡æ–°è·å–äº§å“çš„æ¥å£: public class ConcreteBuilder implements Builder { Part partA, partB, partC; public void buildPartA() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartAçš„ä»£ç  }; public void buildPartB() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public void buildPartC() { //è¿™é‡Œæ˜¯å…·ä½“å¦‚ä½•æ„å»ºpartBçš„ä»£ç  }; public Product getResult() { //è¿”å›æœ€åç»„è£…æˆå“ç»“æœ }; } å¤æ‚å¯¹è±¡:äº§å“Product:","title":"1.4 Builder"},{"content":"Singleton (å•ä¾‹æ¨¡å¼ï¼‰å®šä¹‰ Singletonæ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯ä¿è¯åœ¨Javaåº”ç”¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªç±»Classåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚\nåœ¨å¾ˆå¤šæ“ä½œä¸­ï¼Œæ¯”å¦‚å»ºç«‹ç›®å½• æ•°æ®åº“è¿æ¥éƒ½éœ€è¦è¿™æ ·çš„å•çº¿ç¨‹æ“ä½œ. è¿˜æœ‰, singletonèƒ½å¤Ÿè¢«çŠ¶æ€åŒ–; è¿™æ ·ï¼Œå¤šä¸ªå•æ€ç±»åœ¨ä¸€èµ·å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªçŠ¶æ€ä»“åº“ä¸€æ ·å‘å¤–æä¾›æœåŠ¡ï¼Œæ¯”å¦‚ï¼Œä½ è¦è®ºå›ä¸­çš„å¸–å­è®¡æ•°å™¨ï¼Œæ¯æ¬¡æµè§ˆä¸€æ¬¡éœ€è¦è®¡æ•°ï¼Œå•æ€ç±»èƒ½å¦ä¿æŒä½è¿™ä¸ªè®¡æ•°ï¼Œå¹¶ä¸”èƒ½synchronizeçš„å®‰å…¨è‡ªåŠ¨åŠ 1ï¼Œå¦‚æœä½ è¦æŠŠè¿™ä¸ªæ•°å­—æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹å•æ€æ¥å£çš„æƒ…å†µä¸‹æ–¹ä¾¿çš„åšåˆ°ã€‚\nå¦å¤–æ–¹é¢ï¼ŒSingletonä¹Ÿèƒ½å¤Ÿè¢«æ— çŠ¶æ€åŒ–ã€‚æä¾›å·¥å…·æ€§è´¨çš„åŠŸèƒ½ï¼Œ\nSingletonæ¨¡å¼å°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·å®ç°çš„å¯èƒ½ã€‚ä½¿ç”¨Singletonçš„å¥½å¤„è¿˜åœ¨äºå¯ä»¥èŠ‚çœå†…å­˜ï¼Œå› ä¸ºå®ƒé™åˆ¶äº†å®ä¾‹çš„ä¸ªæ•°ï¼Œæœ‰åˆ©äºJavaåƒåœ¾å›æ”¶ï¼ˆgarbage collectionï¼‰ã€‚\næˆ‘ä»¬å¸¸å¸¸çœ‹åˆ°å·¥å‚æ¨¡å¼ä¸­ç±»è£…å…¥å™¨(class loader)ä¸­ä¹Ÿç”¨Singletonæ¨¡å¼å®ç°çš„,å› ä¸ºè¢«è£…å…¥çš„ç±»å®é™…ä¹Ÿå±äºèµ„æºã€‚\nå¦‚ä½•ä½¿ç”¨ public class Singleton { private Singleton(){} //åœ¨è‡ªå·±å†…éƒ¨å®šä¹‰è‡ªå·±ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Ÿ //æ³¨æ„è¿™æ˜¯private åªä¾›å†…éƒ¨è°ƒç”¨ private static Singleton instance = new Singleton(); //è¿™é‡Œæä¾›äº†ä¸€ä¸ªä¾›å¤–éƒ¨è®¿é—®æœ¬classçš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ã€€public static Singleton getInstance() { return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class TestInstance{ private static TestInstance instance; public static TestInstance getInstance{ if(instance==null){ synchronized(TestInstance.class){ if(instance==null){ instance=new TestInstance(); } } return instance; } } public class SingleClass2{ private static class SingleInstance{ private static SingleClass2 instance = new SingleClass2(); } private SingleClass2(){ } public static SingleClass2 CreateInstance(){ return SingleInstance.instance; } } ","permalink":"https://blog.chalme.top/posts/design-patterns/1.3-singleton/","summary":"Singleton (å•ä¾‹æ¨¡å¼ï¼‰å®šä¹‰ Singletonæ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯ä¿è¯åœ¨Javaåº”ç”¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªç±»Classåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚\nåœ¨å¾ˆå¤šæ“ä½œä¸­ï¼Œæ¯”å¦‚å»ºç«‹ç›®å½• æ•°æ®åº“è¿æ¥éƒ½éœ€è¦è¿™æ ·çš„å•çº¿ç¨‹æ“ä½œ. è¿˜æœ‰, singletonèƒ½å¤Ÿè¢«çŠ¶æ€åŒ–; è¿™æ ·ï¼Œå¤šä¸ªå•æ€ç±»åœ¨ä¸€èµ·å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªçŠ¶æ€ä»“åº“ä¸€æ ·å‘å¤–æä¾›æœåŠ¡ï¼Œæ¯”å¦‚ï¼Œä½ è¦è®ºå›ä¸­çš„å¸–å­è®¡æ•°å™¨ï¼Œæ¯æ¬¡æµè§ˆä¸€æ¬¡éœ€è¦è®¡æ•°ï¼Œå•æ€ç±»èƒ½å¦ä¿æŒä½è¿™ä¸ªè®¡æ•°ï¼Œå¹¶ä¸”èƒ½synchronizeçš„å®‰å…¨è‡ªåŠ¨åŠ 1ï¼Œå¦‚æœä½ è¦æŠŠè¿™ä¸ªæ•°å­—æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹å•æ€æ¥å£çš„æƒ…å†µä¸‹æ–¹ä¾¿çš„åšåˆ°ã€‚\nå¦å¤–æ–¹é¢ï¼ŒSingletonä¹Ÿèƒ½å¤Ÿè¢«æ— çŠ¶æ€åŒ–ã€‚æä¾›å·¥å…·æ€§è´¨çš„åŠŸèƒ½ï¼Œ\nSingletonæ¨¡å¼å°±ä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·å®ç°çš„å¯èƒ½ã€‚ä½¿ç”¨Singletonçš„å¥½å¤„è¿˜åœ¨äºå¯ä»¥èŠ‚çœå†…å­˜ï¼Œå› ä¸ºå®ƒé™åˆ¶äº†å®ä¾‹çš„ä¸ªæ•°ï¼Œæœ‰åˆ©äºJavaåƒåœ¾å›æ”¶ï¼ˆgarbage collectionï¼‰ã€‚\næˆ‘ä»¬å¸¸å¸¸çœ‹åˆ°å·¥å‚æ¨¡å¼ä¸­ç±»è£…å…¥å™¨(class loader)ä¸­ä¹Ÿç”¨Singletonæ¨¡å¼å®ç°çš„,å› ä¸ºè¢«è£…å…¥çš„ç±»å®é™…ä¹Ÿå±äºèµ„æºã€‚\nå¦‚ä½•ä½¿ç”¨ public class Singleton { private Singleton(){} //åœ¨è‡ªå·±å†…éƒ¨å®šä¹‰è‡ªå·±ä¸€ä¸ªå®ä¾‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Ÿ //æ³¨æ„è¿™æ˜¯private åªä¾›å†…éƒ¨è°ƒç”¨ private static Singleton instance = new Singleton(); //è¿™é‡Œæä¾›äº†ä¸€ä¸ªä¾›å¤–éƒ¨è®¿é—®æœ¬classçš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ã€€public static Singleton getInstance() { return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class Singleton { private static Singleton instance = null; public static synchronized Singleton getInstance() { if (instance==null) instanceï¼new Singleton(); return instance; } } public class TestInstance{ private static TestInstance instance; public static TestInstance getInstance{ if(instance==null){ synchronized(TestInstance.","title":"1.3 Singleton"},{"content":"Prototype Prototype ï¼ˆåŸå‹æ¨¡å¼ï¼‰å®šä¹‰ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»,å¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡. Prototypeæ¨¡å¼å…è®¸ä¸€ä¸ªå¯¹è±¡å†åˆ›å»ºå¦å¤–ä¸€ä¸ªå¯å®šåˆ¶çš„å¯¹è±¡ï¼Œæ ¹æœ¬æ— éœ€çŸ¥é“ä»»ä½•å¦‚ä½•åˆ›å»ºçš„ç»†èŠ‚,å·¥ä½œåŸç†æ˜¯:é€šè¿‡å°†ä¸€ä¸ªåŸå‹å¯¹è±¡ä¼ ç»™é‚£ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡é€šè¿‡è¯·æ±‚åŸå‹å¯¹è±¡æ‹·è´å®ƒä»¬è‡ªå·±æ¥å®æ–½åˆ›å»ºã€‚ ä½¿ç”¨ javaä¸­æœ‰ clone æ–¹æ³•æ¥å®ç°å¯¹è±¡çš„å…‹éš†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ ä»¥ å‹ºå­ä¸ºä¾‹\npublic abstract class AbstractSpoon implements Cloneable { String spoonName; public void setSpoonName(String spoonName) {this.spoonName = spoonName;} public String getSpoonName() {return this.spoonName;} public Object clone() { Object object = null; try { object = super.clone(); } catch (CloneNotSupportedException exception) { System.err.println(\u0026#34;AbstractSpoon is not Cloneable\u0026#34;); } return object; } } public class SoupSpoon extends AbstractSpoon { public SoupSpoon() { setSpoonName(\u0026#34;Soup Spoon\u0026#34;); } } è°ƒç”¨Prototypeæ¨¡å¼å¾ˆç®€å•:\nAbstractSpoon spoon = new SoupSpoon(); AbstractSpoon spoon2 = spoon.clone(); å½“ç„¶ä¹Ÿå¯ä»¥ç»“åˆå·¥å‚æ¨¡å¼æ¥åˆ›å»ºAbstractSpoonå®ä¾‹ã€‚ å®è´¨ï¼š java ä½¿ç”¨object ç±»çš„clone æ–¹æ³•\n","permalink":"https://blog.chalme.top/posts/design-patterns/1.2-prototype/","summary":"Prototype Prototype ï¼ˆåŸå‹æ¨¡å¼ï¼‰å®šä¹‰ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»,å¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡. Prototypeæ¨¡å¼å…è®¸ä¸€ä¸ªå¯¹è±¡å†åˆ›å»ºå¦å¤–ä¸€ä¸ªå¯å®šåˆ¶çš„å¯¹è±¡ï¼Œæ ¹æœ¬æ— éœ€çŸ¥é“ä»»ä½•å¦‚ä½•åˆ›å»ºçš„ç»†èŠ‚,å·¥ä½œåŸç†æ˜¯:é€šè¿‡å°†ä¸€ä¸ªåŸå‹å¯¹è±¡ä¼ ç»™é‚£ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡é€šè¿‡è¯·æ±‚åŸå‹å¯¹è±¡æ‹·è´å®ƒä»¬è‡ªå·±æ¥å®æ–½åˆ›å»ºã€‚ ä½¿ç”¨ javaä¸­æœ‰ clone æ–¹æ³•æ¥å®ç°å¯¹è±¡çš„å…‹éš†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ ä»¥ å‹ºå­ä¸ºä¾‹\npublic abstract class AbstractSpoon implements Cloneable { String spoonName; public void setSpoonName(String spoonName) {this.spoonName = spoonName;} public String getSpoonName() {return this.spoonName;} public Object clone() { Object object = null; try { object = super.clone(); } catch (CloneNotSupportedException exception) { System.err.println(\u0026#34;AbstractSpoon is not Cloneable\u0026#34;); } return object; } } public class SoupSpoon extends AbstractSpoon { public SoupSpoon() { setSpoonName(\u0026#34;Soup Spoon\u0026#34;); } } è°ƒç”¨Prototypeæ¨¡å¼å¾ˆç®€å•:","title":"1.2 Prototype"},{"content":"å·¥å‚æ¨¡å¼å®šä¹‰ æä¾›åˆ›å»ºå¯¹è±¡çš„æ¥å£\nè¯¦ç»†1\nè¯¦ç»†2\nç®€ä»‹ ç®€å•å·¥å‚æ¨¡å¼\nå·¥å‚æ–¹æ³•æ¨¡å¼\næŠ½è±¡å·¥å‚æ¨¡å¼\nç®€å•å·¥å‚æ¨¡å¼ å®ƒç”±ä¸‰ç§è§’è‰²ç»„æˆï¼ˆå…³ç³»è§ä¸‹é¢çš„ç±»å›¾ï¼‰ï¼š\nå·¥å‚ç±»è§’è‰²ï¼šè¿™æ˜¯æœ¬æ¨¡å¼çš„æ ¸å¿ƒï¼Œå«æœ‰ä¸€å®šçš„å•†ä¸šé€»è¾‘å’Œåˆ¤æ–­é€»è¾‘ã€‚åœ¨javaä¸­å®ƒå¾€å¾€ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒä¸€èˆ¬æ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ç”±æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°ã€‚\nå…·ä½“äº§å“è§’è‰²ï¼šå·¥å‚ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næœ¬è´¨ : åœ¨Creator ä¸­ create æ–¹æ³•ä¸­ ä½¿ç”¨ equals(string name)æ–¹æ³•æ¥åˆ›å»º Productã€‚\n//æŠ½è±¡äº§å“è§’è‰² public interface Car{ public void drive(); } //å…·ä½“äº§å“è§’è‰² public class Benz implements Car{ public void drive() { System.out.println(\u0026#34;Driving Benz \u0026#34;); } } public class Bmw implements Car{ public void drive() { System.out.println(\u0026#34;Driving Bmw \u0026#34;); } } ã€‚ã€‚ã€‚ï¼ˆå¥¥è¿ªæˆ‘å°±ä¸å†™äº†:Pï¼‰ //å·¥å‚ç±»è§’è‰² public class Driver{ //å·¥å‚æ–¹æ³• //æ³¨æ„ è¿”å›ç±»å‹ä¸ºæŠ½è±¡äº§å“è§’è‰² public static Car driverCar(String s)throws Exception { //åˆ¤æ–­é€»è¾‘ï¼Œè¿”å›å…·ä½“çš„äº§å“è§’è‰²ç»™Client if(s.equalsIgnoreCase(\u0026#34;Benz\u0026#34;)) return new Benz(); else if(s.equalsIgnoreCase(\u0026#34;Bmw\u0026#34;)) return new Bmw(); ...... else throw new Exception(); ã€‚ã€‚ã€‚ //æ¬¢è¿æš´å‘æˆ·å‡ºåœº...... public class Magnate{ public static void main(String[] args){ try{ //å‘Šè¯‰å¸æœºæˆ‘ä»Šå¤©åå¥”é©° Car car = Driver.driverCar(\u0026#34;benz\u0026#34;); //ä¸‹å‘½ä»¤ï¼šå¼€è½¦ car.drive(); ã€‚ã€‚ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼ å…ˆæ¥çœ‹ä¸‹å®ƒçš„ç»„æˆå§ï¼š\næŠ½è±¡å·¥å‚è§’è‰²ï¼šè¿™æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒä¸åº”ç”¨ç¨‹åºæ— å…³ã€‚æ˜¯å…·ä½“å·¥å‚è§’è‰²å¿…é¡»å®ç°çš„æ¥å£æˆ–è€…å¿…é¡»ç»§æ‰¿çš„çˆ¶ç±»ã€‚åœ¨javaä¸­å®ƒç”±æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“å·¥å‚è§’è‰²ï¼šå®ƒå«æœ‰å’Œå…·ä½“ä¸šåŠ¡é€»è¾‘æœ‰å…³çš„ä»£ç ã€‚ç”±åº”ç”¨ç¨‹åºè°ƒç”¨ä»¥åˆ›å»ºå¯¹åº”çš„å…·ä½“äº§å“çš„å¯¹è±¡ã€‚åœ¨javaä¸­å®ƒç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ æŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒæ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…æ˜¯å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ä¸€èˆ¬æœ‰æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ 4ã€å…·ä½“äº§å“è§’è‰²ï¼šå…·ä½“å·¥å‚è§’è‰²æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ //æŠ½è±¡å·¥å‚è§’è‰² public interface Driver{ public Car driverCar(); } public class BenzDriver implements Driver{ public Car driverCar(){ return new Benz(); } } public class BmwDriver implements Driver{ public Car driverCar() { return new Bmw(); } } ......//åº”è¯¥å’Œå…·ä½“äº§å“å½¢æˆå¯¹åº”å…³ç³»ï¼Œè¿™é‡Œç•¥... //æœ‰è¯·æš´å‘æˆ·å…ˆç”Ÿ public class Magnate { public static void main(String[] args) { try{ Driver driver = new BenzDriver(); Car car = driver.driverCar(); car.drive(); }catch(Exception e) { } } } æŠ½è±¡å·¥å‚æ¨¡å¼ æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç”¨æ„ä¸ºï¼šç»™å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªäº§å“æ—ä¸­çš„äº§å“å¯¹è±¡ã€‚è€Œä¸”ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼è¿˜è¦æ»¡è¶³ä¸€ä¸‹æ¡ä»¶ï¼š\nç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œè€Œç³»ç»Ÿä¸€æ¬¡åªå¯èƒ½æ¶ˆè´¹å…¶ä¸­ä¸€æ—äº§å“ åŒå±äºåŒä¸€ä¸ªäº§å“æ—çš„äº§å“ä¸€èµ·ä½¿ç”¨æ—¶ã€‚ æ¥çœ‹çœ‹æŠ½è±¡å·¥å‚æ¨¡å¼çš„å„ä¸ªè§’è‰²ï¼ˆå’Œå·¥å‚æ–¹æ³•çš„å¦‚å‡ºä¸€è¾™ï¼‰ï¼š\næŠ½è±¡å·¥å‚è§’è‰²ï¼šè¿™æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒä¸åº”ç”¨ç¨‹åºæ— å…³ã€‚æ˜¯å…·ä½“å·¥å‚è§’è‰²å¿…é¡»å®ç°çš„æ¥å£æˆ–è€…å¿…é¡»ç»§æ‰¿çš„çˆ¶ç±»ã€‚åœ¨javaä¸­å®ƒç”±æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“å·¥å‚è§’è‰²ï¼šå®ƒå«æœ‰å’Œå…·ä½“ä¸šåŠ¡é€»è¾‘æœ‰å…³çš„ä»£ç ã€‚ç”±åº”ç”¨ç¨‹åºè°ƒç”¨ä»¥åˆ›å»ºå¯¹åº”çš„å…·ä½“äº§å“çš„å¯¹è±¡ã€‚åœ¨javaä¸­å®ƒç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ æŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒæ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…æ˜¯å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ä¸€èˆ¬æœ‰æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“äº§å“è§’è‰²ï¼šå…·ä½“å·¥å‚è§’è‰²æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ ","permalink":"https://blog.chalme.top/posts/design-patterns/1.1-factory/","summary":"å·¥å‚æ¨¡å¼å®šä¹‰ æä¾›åˆ›å»ºå¯¹è±¡çš„æ¥å£\nè¯¦ç»†1\nè¯¦ç»†2\nç®€ä»‹ ç®€å•å·¥å‚æ¨¡å¼\nå·¥å‚æ–¹æ³•æ¨¡å¼\næŠ½è±¡å·¥å‚æ¨¡å¼\nç®€å•å·¥å‚æ¨¡å¼ å®ƒç”±ä¸‰ç§è§’è‰²ç»„æˆï¼ˆå…³ç³»è§ä¸‹é¢çš„ç±»å›¾ï¼‰ï¼š\nå·¥å‚ç±»è§’è‰²ï¼šè¿™æ˜¯æœ¬æ¨¡å¼çš„æ ¸å¿ƒï¼Œå«æœ‰ä¸€å®šçš„å•†ä¸šé€»è¾‘å’Œåˆ¤æ–­é€»è¾‘ã€‚åœ¨javaä¸­å®ƒå¾€å¾€ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒä¸€èˆ¬æ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ç”±æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°ã€‚\nå…·ä½“äº§å“è§’è‰²ï¼šå·¥å‚ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚\næœ¬è´¨ : åœ¨Creator ä¸­ create æ–¹æ³•ä¸­ ä½¿ç”¨ equals(string name)æ–¹æ³•æ¥åˆ›å»º Productã€‚\n//æŠ½è±¡äº§å“è§’è‰² public interface Car{ public void drive(); } //å…·ä½“äº§å“è§’è‰² public class Benz implements Car{ public void drive() { System.out.println(\u0026#34;Driving Benz \u0026#34;); } } public class Bmw implements Car{ public void drive() { System.out.println(\u0026#34;Driving Bmw \u0026#34;); } } ã€‚ã€‚ã€‚ï¼ˆå¥¥è¿ªæˆ‘å°±ä¸å†™äº†:Pï¼‰ //å·¥å‚ç±»è§’è‰² public class Driver{ //å·¥å‚æ–¹æ³• //æ³¨æ„ è¿”å›ç±»å‹ä¸ºæŠ½è±¡äº§å“è§’è‰² public static Car driverCar(String s)throws Exception { //åˆ¤æ–­é€»è¾‘ï¼Œè¿”å›å…·ä½“çš„äº§å“è§’è‰²ç»™Client if(s.","title":"1.1 Factory"},{"content":"è®¾è®¡æ¨¡å¼(Patterns in Java) é“¾æ¥ å¦ç±»çš„è®¾è®¡æ¨¡å¼\nå›¾è¯´è®¾è®¡æ¨¡å¼\nå¦‚ä»Šè®¾è®¡æ¨¡å¼å·²ç»æˆä¸ºæ¶æ„å¸ˆå’Œç¨‹åºå‘˜ä¹‹é—´æ²Ÿé€šçš„å¿…å¤‡è¯­è¨€ï¼Œä¹Ÿæ˜¯æ™®é€šç¨‹åºå‘˜æˆé•¿ä¸ºèµ„æ·±ç¨‹åºå‘˜çš„å¿…å¤‡åŸºç¡€ä¹‹ä¸€ã€‚åªæœ‰æŒæ¡äº†è®¾è®¡æ¨¡å¼ï¼Œæ‰èƒ½æ›´å¥½åœ°æŒæ¡DDDé¢†åŸŸé©±åŠ¨è®¾è®¡ç­‰OOåˆ†æè®¾è®¡æ–¹æ³•ï¼Œä¹Ÿæ‰èƒ½æ›´ç†Ÿç»ƒåœ°å­¦ä¹ ä½¿ç”¨ä¸æ–­æ¶Œç°çš„æ–°è¯­è¨€ã€‚\nåˆ›å»ºæ¨¡å¼ï¼ˆ5ï¼‰ Factory(å·¥å‚æ¨¡å¼ï¼‰\nPrototype(åŸå‹æ¨¡å¼ï¼‰\nBuilder\nSingleton(å•ä¾‹æ¨¡å¼ï¼‰\nç»“æ„æ¨¡å¼ï¼ˆ7ï¼‰ Facade\nProxy\nAdapter\nComposite\nDecorator\nBridge\nFlyweight\nè¡Œä¸ºæ¨¡å¼ï¼ˆ11ï¼‰ Template(æ¨¡æ¿æ¨¡å¼ï¼‰\nMemento(å¤‡å¿˜å½•æ¨¡å¼ï¼‰\nObserver(è§‚å¯Ÿè€…æ¨¡å¼ï¼‰\nChain of Responsibility(CoR)\nCommand\nState\nStrategy\nmediator\nInterperter\nVivistor\nIterator\n","permalink":"https://blog.chalme.top/posts/design-patterns/0.0-outline/","summary":"è®¾è®¡æ¨¡å¼(Patterns in Java) é“¾æ¥ å¦ç±»çš„è®¾è®¡æ¨¡å¼\nå›¾è¯´è®¾è®¡æ¨¡å¼\nå¦‚ä»Šè®¾è®¡æ¨¡å¼å·²ç»æˆä¸ºæ¶æ„å¸ˆå’Œç¨‹åºå‘˜ä¹‹é—´æ²Ÿé€šçš„å¿…å¤‡è¯­è¨€ï¼Œä¹Ÿæ˜¯æ™®é€šç¨‹åºå‘˜æˆé•¿ä¸ºèµ„æ·±ç¨‹åºå‘˜çš„å¿…å¤‡åŸºç¡€ä¹‹ä¸€ã€‚åªæœ‰æŒæ¡äº†è®¾è®¡æ¨¡å¼ï¼Œæ‰èƒ½æ›´å¥½åœ°æŒæ¡DDDé¢†åŸŸé©±åŠ¨è®¾è®¡ç­‰OOåˆ†æè®¾è®¡æ–¹æ³•ï¼Œä¹Ÿæ‰èƒ½æ›´ç†Ÿç»ƒåœ°å­¦ä¹ ä½¿ç”¨ä¸æ–­æ¶Œç°çš„æ–°è¯­è¨€ã€‚\nåˆ›å»ºæ¨¡å¼ï¼ˆ5ï¼‰ Factory(å·¥å‚æ¨¡å¼ï¼‰\nPrototype(åŸå‹æ¨¡å¼ï¼‰\nBuilder\nSingleton(å•ä¾‹æ¨¡å¼ï¼‰\nç»“æ„æ¨¡å¼ï¼ˆ7ï¼‰ Facade\nProxy\nAdapter\nComposite\nDecorator\nBridge\nFlyweight\nè¡Œä¸ºæ¨¡å¼ï¼ˆ11ï¼‰ Template(æ¨¡æ¿æ¨¡å¼ï¼‰\nMemento(å¤‡å¿˜å½•æ¨¡å¼ï¼‰\nObserver(è§‚å¯Ÿè€…æ¨¡å¼ï¼‰\nChain of Responsibility(CoR)\nCommand\nState\nStrategy\nmediator\nInterperter\nVivistor\nIterator","title":"0.0 outline"},{"content":"","permalink":"https://blog.chalme.top/categories/","summary":"categories","title":"Category"}]